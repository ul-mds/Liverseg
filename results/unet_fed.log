/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/hydra/_internal/defaults_list.py:251: UserWarning: In 'base': Defaults list is missing `_self_`. See https://hydra.cc/docs/1.2/upgrades/1.0_to_1.1/default_composition_order for more information
  warnings.warn(msg, UserWarning)
[92mINFO [0m:      Starting Flower simulation, config: num_rounds=40, no round_timeout
strategy:
  _target_: flwr.server.strategy.FedAvg
  fraction_fit: 0.0001
  min_fit_clients: ${num_clients_per_round_fit}
  fraction_evaluate: 0.0001
  min_evaluate_clients: ${num_clients_per_round_eval}
  min_available_clients: ${num_clients}
  on_fit_config_fn:
    _target_: server.get_on_fit_config
    config: ${config_fit}
model:
  _target_: model.unet.UNet
dataset:
  input-channels: 3
  image-ext: npy
  mask-ext: npy
  num_partitions: 1
  batch_size: ${batch_size}
  transformation: false
  val_ratio: 0.1
  test_ratio: 0.2
  lits_data_path: /home/sc.uni-leipzig.de/mp096jdyo/lits_dataset/npy_files
  ircad_data_path: /home/sc.uni-leipzig.de/mp096jdyo/3dircad/npy_files
  sliver_data_path: /home/sc.uni-leipzig.de/mp096jdyo/sliver07
num_rounds: 40
num_clients: 2
local_epochs: 4
batch_size: 4
num_classes: 2
num_clients_per_round_fit: 2
num_clients_per_round_eval: 2
device: cuda:0
config_fit:
  lr: 0.0003
  momentum: 0.9
  weight_decay: 1.0e-05
  nesterov: false
  optimizer: Adam
  loss: BCEWithLogitsLoss

/home/sc.uni-leipzig.de/mp096jdyo/3dircad/npy_files
test set size
414
3791
4205
training set size
1658
15165
trainset clients num:  2
2 15165
2 1658
3 3791
3 414
3 4205
cuda:0
[2024-11-13 16:56:46,804][flwr][INFO] - Starting Flower simulation, config: num_rounds=40, no round_timeout
2024-11-13 16:56:49,575	INFO worker.py:1752 -- Started a local Ray instance.
[92mINFO [0m:      Flower VCE: Ray initialized with resources: {'memory': 867674905600.0, 'node:__internal_head__': 1.0, 'node:172.18.62.3': 1.0, 'object_store_memory': 200000000000.0, 'CPU': 128.0, 'accelerator_type:A30': 1.0, 'GPU': 3.0}
[2024-11-13 16:57:09,694][flwr][INFO] - Flower VCE: Ray initialized with resources: {'memory': 867674905600.0, 'node:__internal_head__': 1.0, 'node:172.18.62.3': 1.0, 'object_store_memory': 200000000000.0, 'CPU': 128.0, 'accelerator_type:A30': 1.0, 'GPU': 3.0}
[92mINFO [0m:      Optimize your simulation with Flower VCE: https://flower.ai/docs/framework/how-to-run-simulations.html
[2024-11-13 16:57:09,694][flwr][INFO] - Optimize your simulation with Flower VCE: https://flower.ai/docs/framework/how-to-run-simulations.html
[92mINFO [0m:      Flower VCE: Resources for each Virtual Client: {'num_cpus': 3, 'num_gpus': 1.0}
[2024-11-13 16:57:09,694][flwr][INFO] - Flower VCE: Resources for each Virtual Client: {'num_cpus': 3, 'num_gpus': 1.0}
[92mINFO [0m:      Flower VCE: Creating VirtualClientEngineActorPool with 3 actors
[2024-11-13 16:57:09,705][flwr][INFO] - Flower VCE: Creating VirtualClientEngineActorPool with 3 actors
[92mINFO [0m:      [INIT]
[2024-11-13 16:57:09,705][flwr][INFO] - [INIT]
[92mINFO [0m:      Requesting initial parameters from one random client
[2024-11-13 16:57:09,705][flwr][INFO] - Requesting initial parameters from one random client
[92mINFO [0m:      Received initial parameters from one random client
[2024-11-13 16:57:13,232][flwr][INFO] - Received initial parameters from one random client
[92mINFO [0m:      Evaluating initial global parameters
[2024-11-13 16:57:13,232][flwr][INFO] - Evaluating initial global parameters
[92mINFO [0m:      initial parameters (loss, other metrics): 0.7386870193282999, OrderedDict([('ind_iou_0', 0.04767027702830368), ('ind_dice_liver_0', tensor(0.1510, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.0085, dtype=torch.float64)), ('ind_iou_1', 0.0469457567780348), ('ind_dice_liver_1', tensor(0.1493, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.0077, dtype=torch.float64)), ('all_iou', 0.04759902975987943), ('all_dice_liver', tensor(0.1507, dtype=torch.float64)), ('all_dice_tumour', tensor(0.0085, dtype=torch.float64))])
Entrei no test
Meio do test
Fim do test
[2024-11-13 17:02:50,177][flwr][INFO] - initial parameters (loss, other metrics): 0.7386870193282999, OrderedDict([('ind_iou_0', 0.04767027702830368), ('ind_dice_liver_0', tensor(0.1510, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.0085, dtype=torch.float64)), ('ind_iou_1', 0.0469457567780348), ('ind_dice_liver_1', tensor(0.1493, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.0077, dtype=torch.float64)), ('all_iou', 0.04759902975987943), ('all_dice_liver', tensor(0.1507, dtype=torch.float64)), ('all_dice_tumour', tensor(0.0085, dtype=torch.float64))])
[92mINFO [0m:      
[2024-11-13 17:02:50,205][flwr][INFO] - 
[92mINFO [0m:      [ROUND 1]
[2024-11-13 17:02:50,205][flwr][INFO] - [ROUND 1]
[92mINFO [0m:      configure_fit: strategy sampled 2 clients (out of 2)
[2024-11-13 17:02:50,205][flwr][INFO] - configure_fit: strategy sampled 2 clients (out of 2)
[92mINFO [0m:      aggregate_fit: received 2 results and 0 failures
[36m(ClientAppActor pid=2299152)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2299152)[0m epoch:  0
[36m(ClientAppActor pid=2299152)[0m train ious:  0.6595347603687779
[36m(ClientAppActor pid=2299152)[0m train dice liver:  tensor(0.3873, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m train dice tumour:  tensor(0.0070, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation ious:  0.7994244166039869
[36m(ClientAppActor pid=2299152)[0m validation dice liver:  tensor(0.5070, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation dice tumour:  tensor(0.0093, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m => new best model:  0
[36m(ClientAppActor pid=2299152)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2299152)[0m epoch:  1
[36m(ClientAppActor pid=2299152)[0m train ious:  0.8183572682789404
[36m(ClientAppActor pid=2299152)[0m train dice liver:  tensor(0.6708, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m train dice tumour:  tensor(0.0087, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation ious:  0.7741075224424095
[36m(ClientAppActor pid=2299152)[0m validation dice liver:  tensor(0.7200, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation dice tumour:  tensor(0.0091, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m => new best model:  1
[36m(ClientAppActor pid=2299152)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2299152)[0m epoch:  2
[36m(ClientAppActor pid=2299152)[0m train ious:  0.8603160765333575
[36m(ClientAppActor pid=2299152)[0m train dice liver:  tensor(0.8143, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m train dice tumour:  tensor(0.0127, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation ious:  0.8747171302967985
[36m(ClientAppActor pid=2299152)[0m validation dice liver:  tensor(0.8642, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation dice tumour:  tensor(0.0267, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m => new best model:  2
[36m(ClientAppActor pid=2299152)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2299152)[0m epoch:  3
[36m(ClientAppActor pid=2299152)[0m train ious:  0.8822817788304059
[36m(ClientAppActor pid=2299152)[0m train dice liver:  tensor(0.8777, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m train dice tumour:  tensor(0.0279, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation ious:  0.8704828770316141
[36m(ClientAppActor pid=2299152)[0m validation dice liver:  tensor(0.8833, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation dice tumour:  tensor(0.0508, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m => new best model:  3
[36m(ClientAppActor pid=2299151)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2299151)[0m epoch:  0
[36m(ClientAppActor pid=2299151)[0m train ious:  0.8144589928332231
[36m(ClientAppActor pid=2299151)[0m train dice liver:  
[36m(ClientAppActor pid=2299151)[0m tensor(0.7891, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m train dice tumour:  tensor(0.1020, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation ious:  0.8847162143199342
[36m(ClientAppActor pid=2299151)[0m validation dice liver:  tensor(0.9305, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation dice tumour:  tensor(0.2045, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m => new best model:  0
[36m(ClientAppActor pid=2299151)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2299151)[0m epoch:  1
[36m(ClientAppActor pid=2299151)[0m train ious:  0.9033264668677783
[36m(ClientAppActor pid=2299151)[0m train dice liver:  tensor(0.9374, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m train dice tumour:  tensor(0.3285, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation ious:  0.8982230890198328
[36m(ClientAppActor pid=2299151)[0m validation dice liver:  tensor(0.9385, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation dice tumour:  tensor(0.3028, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m => new best model:  1
[36m(ClientAppActor pid=2299151)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2299151)[0m epoch:  2
[36m(ClientAppActor pid=2299151)[0m train ious:  0.9241495185479802
[36m(ClientAppActor pid=2299151)[0m train dice liver:  tensor(0.9529, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m train dice tumour:  tensor(0.4304, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation ious:  0.9247831402525377
[36m(ClientAppActor pid=2299151)[0m validation dice liver:  tensor(0.9542, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation dice tumour:  tensor(0.4127, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m => new best model:  2
[36m(ClientAppActor pid=2299151)[0m Entrei no validation 1 3
[2024-11-13 17:56:15,024][flwr][INFO] - aggregate_fit: received 2 results and 0 failures
[93mWARNING [0m:   No fit_metrics_aggregation_fn provided
[36m(ClientAppActor pid=2299151)[0m epoch:  3
[36m(ClientAppActor pid=2299151)[0m train ious:  0.9329132069589546
[36m(ClientAppActor pid=2299151)[0m train dice liver:  tensor(0.9579, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m train dice tumour:  tensor(0.4824, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation ious:  0.923826930361007
[36m(ClientAppActor pid=2299151)[0m validation dice liver:  tensor(0.9519, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation dice tumour:  tensor(0.4677, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m => new best model:  3
[2024-11-13 17:56:15,092][flwr][WARNING] - No fit_metrics_aggregation_fn provided
[92mINFO [0m:      fit progress: (1, 0.01188617611019324, OrderedDict([('ind_iou_0', 0.9133894190965988), ('ind_dice_liver_0', tensor(0.9281, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.3703, dtype=torch.float64)), ('ind_iou_1', 0.8940878018244331), ('ind_dice_liver_1', tensor(0.9173, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.2521, dtype=torch.float64)), ('all_iou', 0.91154604148781), ('all_dice_liver', tensor(0.9271, dtype=torch.float64)), ('all_dice_tumour', tensor(0.3668, dtype=torch.float64))]), 3462.144307036884)
Entrei no test
Meio do test
Fim do test
[2024-11-13 18:00:32,349][flwr][INFO] - fit progress: (1, 0.01188617611019324, OrderedDict([('ind_iou_0', 0.9133894190965988), ('ind_dice_liver_0', tensor(0.9281, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.3703, dtype=torch.float64)), ('ind_iou_1', 0.8940878018244331), ('ind_dice_liver_1', tensor(0.9173, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.2521, dtype=torch.float64)), ('all_iou', 0.91154604148781), ('all_dice_liver', tensor(0.9271, dtype=torch.float64)), ('all_dice_tumour', tensor(0.3668, dtype=torch.float64))]), 3462.144307036884)
[92mINFO [0m:      configure_evaluate: strategy sampled 2 clients (out of 2)
[2024-11-13 18:00:32,376][flwr][INFO] - configure_evaluate: strategy sampled 2 clients (out of 2)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[36m(ClientAppActor pid=2299152)[0m Entrei no validation 1 3
[2024-11-13 18:00:42,894][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-11-13 18:00:42,894][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-11-13 18:01:29,751][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-11-13 18:01:29,752][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 2 failures
[2024-11-13 18:01:29,752][flwr][INFO] - aggregate_evaluate: received 0 results and 2 failures
[92mINFO [0m:      
[2024-11-13 18:01:29,753][flwr][INFO] - 
[92mINFO [0m:      [ROUND 2]
[2024-11-13 18:01:29,753][flwr][INFO] - [ROUND 2]
[92mINFO [0m:      configure_fit: strategy sampled 2 clients (out of 2)
[2024-11-13 18:01:29,753][flwr][INFO] - configure_fit: strategy sampled 2 clients (out of 2)
[92mINFO [0m:      aggregate_fit: received 2 results and 0 failures
[36m(ClientAppActor pid=2299152)[0m Entrei no validation 1 3[32m [repeated 2x across cluster] (Ray deduplicates logs by default. Set RAY_DEDUP_LOGS=0 to disable log deduplication, or see https://docs.ray.io/en/master/ray-observability/ray-logging.html#log-deduplication for more options.)[0m
[36m(ClientAppActor pid=2299152)[0m epoch:  0
[36m(ClientAppActor pid=2299152)[0m train ious:  0.9405750520438473
[36m(ClientAppActor pid=2299152)[0m train dice liver:  tensor(0.9620, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m train dice tumour:  tensor(0.4169, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation ious:  0.9456953504696728
[36m(ClientAppActor pid=2299152)[0m validation dice liver:  tensor(0.9655, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation dice tumour:  tensor(0.4405, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m => new best model:  0
[36m(ClientAppActor pid=2299152)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2299152)[0m epoch:  1
[36m(ClientAppActor pid=2299152)[0m train ious:  0.9450158744951331
[36m(ClientAppActor pid=2299152)[0m train dice liver:  tensor(0.9644, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m train dice tumour:  tensor(0.4559, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation ious:  0.9367405099993015
[36m(ClientAppActor pid=2299152)[0m validation dice liver:  tensor(0.9576, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation dice tumour:  tensor(0.4256, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m => new best model:  1
[36m(ClientAppActor pid=2299152)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2299152)[0m epoch:  2
[36m(ClientAppActor pid=2299152)[0m train ious:  0.9495994098731095
[36m(ClientAppActor pid=2299152)[0m train dice liver:  tensor(0.9666, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m train dice tumour:  tensor(0.5040, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation ious:  0.9529039075044903
[36m(ClientAppActor pid=2299152)[0m validation dice liver:  tensor(0.9698, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation dice tumour:  tensor(0.4943, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m => new best model:  2
[36m(ClientAppActor pid=2299152)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2299152)[0m epoch:  3
[36m(ClientAppActor pid=2299152)[0m train ious:  0.9544926145804927
[36m(ClientAppActor pid=2299152)[0m train dice liver:  tensor(0.9699, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m train dice tumour:  tensor(0.5282, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation ious:  0.9547920257362477
[36m(ClientAppActor pid=2299152)[0m validation dice liver:  tensor(0.9705, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation dice tumour:  tensor(0.5151, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m => new best model:  3
[36m(ClientAppActor pid=2299151)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2299151)[0m epoch:  0
[36m(ClientAppActor pid=2299151)[0m train ious:  0.9368083832143161
[36m(ClientAppActor pid=2299151)[0m train dice liver:  tensor(0.9603, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m train dice tumour:  tensor(0.5035, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation ious:  0.935374056548439
[36m(ClientAppActor pid=2299151)[0m validation dice liver:  tensor(0.9572, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation dice tumour:  tensor(0.5103, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m => new best model:  0
[36m(ClientAppActor pid=2299151)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2299151)[0m epoch:  1
[36m(ClientAppActor pid=2299151)[0m train ious:  0.9420187508494968
[36m(ClientAppActor pid=2299151)[0m train dice liver:  tensor(0.9633, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m train dice tumour:  tensor(0.5293, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation ious:  0.9431451815164399
[36m(ClientAppActor pid=2299151)[0m validation dice liver:  tensor(0.9630, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation dice tumour:  tensor(0.5456, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m => new best model:  1
[36m(ClientAppActor pid=2299151)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2299151)[0m epoch:  2
[36m(ClientAppActor pid=2299151)[0m train ious:  0.9447413532804305
[36m(ClientAppActor pid=2299151)[0m train dice liver:  tensor(0.9649, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m train dice tumour:  tensor(0.5506, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation ious:  0.9316366665451683
[36m(ClientAppActor pid=2299151)[0m validation dice liver:  tensor(0.9568, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation dice tumour:  tensor(0.4845, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m => new best model:  2
[36m(ClientAppActor pid=2299151)[0m Entrei no validation 1 3
[2024-11-13 18:39:35,248][flwr][INFO] - aggregate_fit: received 2 results and 0 failures
[92mINFO [0m:      fit progress: (2, 0.0064208258020356035, OrderedDict([('ind_iou_0', 0.9459624251984176), ('ind_dice_liver_0', tensor(0.9659, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.5393, dtype=torch.float64)), ('ind_iou_1', 0.9378480841897966), ('ind_dice_liver_1', tensor(0.9609, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.4191, dtype=torch.float64)), ('all_iou', 0.9451187460940903), ('all_dice_liver', tensor(0.9653, dtype=torch.float64)), ('all_dice_tumour', tensor(0.5361, dtype=torch.float64))]), 5993.353446281981)
[36m(ClientAppActor pid=2299151)[0m epoch:  3
[36m(ClientAppActor pid=2299151)[0m train ious:  0.9470627694714322
[36m(ClientAppActor pid=2299151)[0m train dice liver:  tensor(0.9664, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m train dice tumour:  tensor(0.5665, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation ious:  0.945142841222217
[36m(ClientAppActor pid=2299151)[0m validation dice liver:  tensor(0.9659, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation dice tumour:  tensor(0.5345, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m => new best model:  3
Entrei no test
Meio do test
Fim do test
[2024-11-13 18:42:43,558][flwr][INFO] - fit progress: (2, 0.0064208258020356035, OrderedDict([('ind_iou_0', 0.9459624251984176), ('ind_dice_liver_0', tensor(0.9659, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.5393, dtype=torch.float64)), ('ind_iou_1', 0.9378480841897966), ('ind_dice_liver_1', tensor(0.9609, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.4191, dtype=torch.float64)), ('all_iou', 0.9451187460940903), ('all_dice_liver', tensor(0.9653, dtype=torch.float64)), ('all_dice_tumour', tensor(0.5361, dtype=torch.float64))]), 5993.353446281981)
[92mINFO [0m:      configure_evaluate: strategy sampled 2 clients (out of 2)
[2024-11-13 18:42:43,562][flwr][INFO] - configure_evaluate: strategy sampled 2 clients (out of 2)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[36m(ClientAppActor pid=2299151)[0m Entrei no validation 1 3
[2024-11-13 18:42:53,510][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-11-13 18:42:53,510][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[2024-11-13 18:43:42,576][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-11-13 18:43:42,577][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 2 failures
[2024-11-13 18:43:42,577][flwr][INFO] - aggregate_evaluate: received 0 results and 2 failures
[92mINFO [0m:      
[2024-11-13 18:43:42,577][flwr][INFO] - 
[92mINFO [0m:      [ROUND 3]
[2024-11-13 18:43:42,577][flwr][INFO] - [ROUND 3]
[92mINFO [0m:      configure_fit: strategy sampled 2 clients (out of 2)
[2024-11-13 18:43:42,578][flwr][INFO] - configure_fit: strategy sampled 2 clients (out of 2)
[92mINFO [0m:      aggregate_fit: received 2 results and 0 failures
[36m(ClientAppActor pid=2299151)[0m Entrei no validation 1 3[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=2299151)[0m epoch:  0
[36m(ClientAppActor pid=2299151)[0m train ious:  0.9494950895134981
[36m(ClientAppActor pid=2299151)[0m train dice liver:  tensor(0.9669, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m train dice tumour:  tensor(0.4777, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation ious:  0.9519025236710124
[36m(ClientAppActor pid=2299151)[0m validation dice liver:  tensor(0.9682, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation dice tumour:  tensor(0.4994, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m => new best model:  0
[36m(ClientAppActor pid=2299151)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2299151)[0m epoch:  1
[36m(ClientAppActor pid=2299151)[0m train ious:  0.9563409802361577
[36m(ClientAppActor pid=2299151)[0m train dice liver:  tensor(0.9709, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m train dice tumour:  tensor(0.5259, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation ious:  0.9555438545384101
[36m(ClientAppActor pid=2299151)[0m validation dice liver:  tensor(0.9712, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation dice tumour:  tensor(0.5303, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m => new best model:  1
[36m(ClientAppActor pid=2299151)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2299151)[0m epoch:  2
[36m(ClientAppActor pid=2299151)[0m train ious:  0.958214688196564
[36m(ClientAppActor pid=2299151)[0m train dice liver:  tensor(0.9725, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m train dice tumour:  tensor(0.5162, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation ious:  0.9574209098376595
[36m(ClientAppActor pid=2299151)[0m validation dice liver:  tensor(0.9711, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation dice tumour:  tensor(0.5325, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m => new best model:  2
[36m(ClientAppActor pid=2299151)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2299151)[0m epoch:  3
[36m(ClientAppActor pid=2299151)[0m train ious:  0.960293197366361
[36m(ClientAppActor pid=2299151)[0m train dice liver:  tensor(0.9738, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m train dice tumour:  tensor(0.5509, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation ious:  0.9567184414000555
[36m(ClientAppActor pid=2299151)[0m validation dice liver:  tensor(0.9721, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation dice tumour:  tensor(0.5341, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m => new best model:  3
[36m(ClientAppActor pid=2299152)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2299152)[0m epoch:  0
[36m(ClientAppActor pid=2299152)[0m train ious:  0.9489405688985482
[36m(ClientAppActor pid=2299152)[0m train dice liver:  tensor(0.9676, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m train dice tumour:  tensor(0.5790, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation ious:  0.9522228937366458
[36m(ClientAppActor pid=2299152)[0m validation dice liver:  tensor(0.9695, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation dice tumour:  tensor(0.5897, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m => new best model:  0
[36m(ClientAppActor pid=2299152)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2299152)[0m epoch:  1
[36m(ClientAppActor pid=2299152)[0m train ious:  0.9521853754497898
[36m(ClientAppActor pid=2299152)[0m train dice liver:  tensor(0.9696, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m train dice tumour:  tensor(0.5942, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation ious:  0.9510013770009358
[36m(ClientAppActor pid=2299152)[0m validation dice liver:  tensor(0.9697, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation dice tumour:  tensor(0.5868, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m => new best model:  1
[36m(ClientAppActor pid=2299152)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2299152)[0m epoch:  2
[36m(ClientAppActor pid=2299152)[0m train ious:  0.953983824206165
[36m(ClientAppActor pid=2299152)[0m train dice liver:  tensor(0.9706, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m train dice tumour:  tensor(0.6053, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation ious:  0.9332754721864429
[36m(ClientAppActor pid=2299152)[0m validation dice liver:  tensor(0.9547, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation dice tumour:  tensor(0.5065, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m => new best model:  2
[36m(ClientAppActor pid=2299152)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2299152)[0m epoch:  3
[36m(ClientAppActor pid=2299152)[0m train ious:  0.9567760485644462
[36m(ClientAppActor pid=2299152)[0m train dice liver:  tensor(0.9724, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m train dice tumour:  tensor(0.6259, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation ious:  0.9551042645952857
[36m(ClientAppActor pid=2299152)[0m validation dice liver:  tensor(0.9719, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation dice tumour:  tensor(0.6107, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m => new best model:  3
[2024-11-13 19:27:29,599][flwr][INFO] - aggregate_fit: received 2 results and 0 failures
[92mINFO [0m:      fit progress: (3, 0.005089322167867296, OrderedDict([('ind_iou_0', 0.9553327079990791), ('ind_dice_liver_0', tensor(0.9722, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.6137, dtype=torch.float64)), ('ind_iou_1', 0.952012724281721), ('ind_dice_liver_1', tensor(0.9690, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5271, dtype=torch.float64)), ('all_iou', 0.9549645316890595), ('all_dice_liver', tensor(0.9718, dtype=torch.float64)), ('all_dice_tumour', tensor(0.6155, dtype=torch.float64))]), 8927.711935364176)
Entrei no test
Meio do test
Fim do test
[2024-11-13 19:31:37,917][flwr][INFO] - fit progress: (3, 0.005089322167867296, OrderedDict([('ind_iou_0', 0.9553327079990791), ('ind_dice_liver_0', tensor(0.9722, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.6137, dtype=torch.float64)), ('ind_iou_1', 0.952012724281721), ('ind_dice_liver_1', tensor(0.9690, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5271, dtype=torch.float64)), ('all_iou', 0.9549645316890595), ('all_dice_liver', tensor(0.9718, dtype=torch.float64)), ('all_dice_tumour', tensor(0.6155, dtype=torch.float64))]), 8927.711935364176)
[92mINFO [0m:      configure_evaluate: strategy sampled 2 clients (out of 2)
[2024-11-13 19:31:37,939][flwr][INFO] - configure_evaluate: strategy sampled 2 clients (out of 2)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[36m(ClientAppActor pid=2299152)[0m Entrei no validation 1 3
[2024-11-13 19:31:47,446][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-11-13 19:31:47,447][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[2024-11-13 19:32:37,489][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-11-13 19:32:37,489][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 2 failures
[2024-11-13 19:32:37,490][flwr][INFO] - aggregate_evaluate: received 0 results and 2 failures
[92mINFO [0m:      
[2024-11-13 19:32:37,490][flwr][INFO] - 
[92mINFO [0m:      [ROUND 4]
[2024-11-13 19:32:37,490][flwr][INFO] - [ROUND 4]
[92mINFO [0m:      configure_fit: strategy sampled 2 clients (out of 2)
[2024-11-13 19:32:37,490][flwr][INFO] - configure_fit: strategy sampled 2 clients (out of 2)
[92mINFO [0m:      aggregate_fit: received 2 results and 0 failures
[36m(ClientAppActor pid=2299151)[0m Entrei no validation 1 3[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=2299151)[0m epoch:  0
[36m(ClientAppActor pid=2299151)[0m train ious:  0.9568444104126713
[36m(ClientAppActor pid=2299151)[0m train dice liver:  tensor(0.9715, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m train dice tumour:  tensor(0.5158, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation ious:  0.9592927874120329
[36m(ClientAppActor pid=2299151)[0m validation dice liver:  tensor(0.9732, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation dice tumour:  tensor(0.5490, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m => new best model:  0
[36m(ClientAppActor pid=2299151)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2299151)[0m epoch:  1
[36m(ClientAppActor pid=2299151)[0m train ious:  0.9634021184385136
[36m(ClientAppActor pid=2299151)[0m train dice liver:  tensor(0.9757, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m train dice tumour:  tensor(0.5470, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation ious:  0.9607226295483953
[36m(ClientAppActor pid=2299151)[0m validation dice liver:  tensor(0.9749, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation dice tumour:  tensor(0.5521, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m => new best model:  1
[36m(ClientAppActor pid=2299151)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2299151)[0m epoch:  2
[36m(ClientAppActor pid=2299151)[0m train ious:  0.9646864844325839
[36m(ClientAppActor pid=2299151)[0m train dice liver:  tensor(0.9763, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m train dice tumour:  tensor(0.5578, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation ious:  0.9622641825865851
[36m(ClientAppActor pid=2299151)[0m validation dice liver:  tensor(0.9758, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation dice tumour:  tensor(0.5492, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m => new best model:  2
[36m(ClientAppActor pid=2299151)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2299151)[0m epoch:  3
[36m(ClientAppActor pid=2299151)[0m train ious:  0.9676467353486626
[36m(ClientAppActor pid=2299151)[0m train dice liver:  tensor(0.9785, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m train dice tumour:  tensor(0.5623, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation ious:  0.9651685446956385
[36m(ClientAppActor pid=2299151)[0m validation dice liver:  tensor(0.9780, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation dice tumour:  tensor(0.5848, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m => new best model:  3
[36m(ClientAppActor pid=2299152)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2299152)[0m epoch:  0
[36m(ClientAppActor pid=2299152)[0m train ious:  0.9569561657122518
[36m(ClientAppActor pid=2299152)[0m train dice liver:  tensor(0.9726, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m train dice tumour:  tensor(0.6196, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation ious:  0.9581770125161453
[36m(ClientAppActor pid=2299152)[0m validation dice liver:  tensor(0.9730, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation dice tumour:  tensor(0.6159, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m => new best model:  0
[36m(ClientAppActor pid=2299152)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2299152)[0m epoch:  1
[36m(ClientAppActor pid=2299152)[0m train ious:  0.9599852432669552
[36m(ClientAppActor pid=2299152)[0m train dice liver:  tensor(0.9744, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m train dice tumour:  tensor(0.6370, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation ious:  0.9588734109753787
[36m(ClientAppActor pid=2299152)[0m validation dice liver:  tensor(0.9739, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation dice tumour:  tensor(0.6342, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m => new best model:  1
[36m(ClientAppActor pid=2299152)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2299152)[0m epoch:  2
[36m(ClientAppActor pid=2299152)[0m train ious:  0.9607940510991522
[36m(ClientAppActor pid=2299152)[0m train dice liver:  tensor(0.9749, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m train dice tumour:  tensor(0.6477, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation ious:  0.9601099058521987
[36m(ClientAppActor pid=2299152)[0m validation dice liver:  tensor(0.9753, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation dice tumour:  tensor(0.6448, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m => new best model:  2
[36m(ClientAppActor pid=2299152)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2299152)[0m epoch:  3
[36m(ClientAppActor pid=2299152)[0m train ious:  0.9631289716604637
[36m(ClientAppActor pid=2299152)[0m train dice liver:  tensor(0.9765, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m train dice tumour:  tensor(0.6623, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation ious:  0.9593674041338416
[36m(ClientAppActor pid=2299152)[0m validation dice liver:  tensor(0.9748, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation dice tumour:  tensor(0.6223, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m => new best model:  3
[2024-11-13 20:17:40,203][flwr][INFO] - aggregate_fit: received 2 results and 0 failures
[92mINFO [0m:      fit progress: (4, 0.004513753807492218, OrderedDict([('ind_iou_0', 0.960239783606892), ('ind_dice_liver_0', tensor(0.9755, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.6296, dtype=torch.float64)), ('ind_iou_1', 0.9577119319694551), ('ind_dice_liver_1', tensor(0.9726, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5257, dtype=torch.float64)), ('all_iou', 0.9600180704806841), ('all_dice_liver', tensor(0.9751, dtype=torch.float64)), ('all_dice_tumour', tensor(0.6320, dtype=torch.float64))]), 11936.995173992123)
Entrei no test
Meio do test
Fim do test
[2024-11-13 20:21:47,200][flwr][INFO] - fit progress: (4, 0.004513753807492218, OrderedDict([('ind_iou_0', 0.960239783606892), ('ind_dice_liver_0', tensor(0.9755, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.6296, dtype=torch.float64)), ('ind_iou_1', 0.9577119319694551), ('ind_dice_liver_1', tensor(0.9726, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5257, dtype=torch.float64)), ('all_iou', 0.9600180704806841), ('all_dice_liver', tensor(0.9751, dtype=torch.float64)), ('all_dice_tumour', tensor(0.6320, dtype=torch.float64))]), 11936.995173992123)
[92mINFO [0m:      configure_evaluate: strategy sampled 2 clients (out of 2)
[2024-11-13 20:21:47,221][flwr][INFO] - configure_evaluate: strategy sampled 2 clients (out of 2)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[36m(ClientAppActor pid=2299152)[0m Entrei no validation 1 3
[2024-11-13 20:21:57,808][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-11-13 20:21:57,808][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[2024-11-13 20:22:46,051][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-11-13 20:22:46,051][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 2 failures
[2024-11-13 20:22:46,052][flwr][INFO] - aggregate_evaluate: received 0 results and 2 failures
[92mINFO [0m:      
[2024-11-13 20:22:46,052][flwr][INFO] - 
[92mINFO [0m:      [ROUND 5]
[2024-11-13 20:22:46,052][flwr][INFO] - [ROUND 5]
[92mINFO [0m:      configure_fit: strategy sampled 2 clients (out of 2)
[2024-11-13 20:22:46,052][flwr][INFO] - configure_fit: strategy sampled 2 clients (out of 2)
[92mINFO [0m:      aggregate_fit: received 2 results and 0 failures
[36m(ClientAppActor pid=2299151)[0m Entrei no validation 1 3[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=2299151)[0m epoch:  0
[36m(ClientAppActor pid=2299151)[0m train ious:  0.9621680610045367
[36m(ClientAppActor pid=2299151)[0m train dice liver:  tensor(0.9750, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m train dice tumour:  tensor(0.5431, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation ious:  0.9644566644559526
[36m(ClientAppActor pid=2299151)[0m validation dice liver:  tensor(0.9769, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation dice tumour:  tensor(0.5667, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m => new best model:  0
[36m(ClientAppActor pid=2299151)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2299151)[0m epoch:  1
[36m(ClientAppActor pid=2299151)[0m train ious:  0.9683639626005682
[36m(ClientAppActor pid=2299151)[0m train dice liver:  tensor(0.9789, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m train dice tumour:  tensor(0.5830, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation ious:  0.9635060385981346
[36m(ClientAppActor pid=2299151)[0m validation dice liver:  tensor(0.9765, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation dice tumour:  tensor(0.5718, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m => new best model:  1
[36m(ClientAppActor pid=2299151)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2299151)[0m epoch:  2
[36m(ClientAppActor pid=2299151)[0m train ious:  0.9703516271720847
[36m(ClientAppActor pid=2299151)[0m train dice liver:  tensor(0.9803, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m train dice tumour:  tensor(0.5937, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation ious:  0.9655104818335182
[36m(ClientAppActor pid=2299151)[0m validation dice liver:  tensor(0.9779, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation dice tumour:  tensor(0.5525, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m => new best model:  2
[36m(ClientAppActor pid=2299151)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2299151)[0m epoch:  3
[36m(ClientAppActor pid=2299151)[0m train ious:  0.9726962262098918
[36m(ClientAppActor pid=2299151)[0m train dice liver:  tensor(0.9818, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m train dice tumour:  tensor(0.5804, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation ious:  0.9694601466635012
[36m(ClientAppActor pid=2299151)[0m validation dice liver:  tensor(0.9811, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation dice tumour:  tensor(0.5840, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m => new best model:  3
[36m(ClientAppActor pid=2299152)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2299152)[0m epoch:  0
[36m(ClientAppActor pid=2299152)[0m train ious:  0.9637763087379352
[36m(ClientAppActor pid=2299152)[0m train dice liver:  tensor(0.9770, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m train dice tumour:  tensor(0.6647, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation ious:  0.9594770334520221
[36m(ClientAppActor pid=2299152)[0m validation dice liver:  tensor(0.9745, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation dice tumour:  tensor(0.6309, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m => new best model:  0
[36m(ClientAppActor pid=2299152)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2299152)[0m epoch:  1
[36m(ClientAppActor pid=2299152)[0m train ious:  0.966127369875901
[36m(ClientAppActor pid=2299152)[0m train dice liver:  tensor(0.9784, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m train dice tumour:  tensor(0.6664, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation ious:  0.9639741353092142
[36m(ClientAppActor pid=2299152)[0m validation dice liver:  tensor(0.9782, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation dice tumour:  tensor(0.6631, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m => new best model:  1
[36m(ClientAppActor pid=2299152)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2299152)[0m epoch:  2
[36m(ClientAppActor pid=2299152)[0m train ious:  0.9666866532120473
[36m(ClientAppActor pid=2299152)[0m train dice liver:  tensor(0.9788, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m train dice tumour:  tensor(0.6744, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation ious:  0.9658864232205989
[36m(ClientAppActor pid=2299152)[0m validation dice liver:  tensor(0.9792, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation dice tumour:  tensor(0.6647, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m => new best model:  2
[36m(ClientAppActor pid=2299152)[0m Entrei no validation 1 3
[2024-11-13 21:14:23,146][flwr][INFO] - aggregate_fit: received 2 results and 0 failures
[92mINFO [0m:      fit progress: (5, 0.003829612096552333, OrderedDict([('ind_iou_0', 0.9659839848971379), ('ind_dice_liver_0', tensor(0.9795, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.6697, dtype=torch.float64)), ('ind_iou_1', 0.9664848430138474), ('ind_dice_liver_1', tensor(0.9779, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5716, dtype=torch.float64)), ('all_iou', 0.9660077163641858), ('all_dice_liver', tensor(0.9793, dtype=torch.float64)), ('all_dice_tumour', tensor(0.6684, dtype=torch.float64))]), 15362.636731855106)
[36m(ClientAppActor pid=2299152)[0m epoch:  3
[36m(ClientAppActor pid=2299152)[0m train ious:  0.9691150592774413
[36m(ClientAppActor pid=2299152)[0m train dice liver:  tensor(0.9804, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m train dice tumour:  tensor(0.6881, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation ious:  0.9653776201356093
[36m(ClientAppActor pid=2299152)[0m validation dice liver:  tensor(0.9791, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation dice tumour:  tensor(0.6654, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m => new best model:  3
Entrei no test
Meio do test
Fim do test
[2024-11-13 21:18:52,842][flwr][INFO] - fit progress: (5, 0.003829612096552333, OrderedDict([('ind_iou_0', 0.9659839848971379), ('ind_dice_liver_0', tensor(0.9795, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.6697, dtype=torch.float64)), ('ind_iou_1', 0.9664848430138474), ('ind_dice_liver_1', tensor(0.9779, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5716, dtype=torch.float64)), ('all_iou', 0.9660077163641858), ('all_dice_liver', tensor(0.9793, dtype=torch.float64)), ('all_dice_tumour', tensor(0.6684, dtype=torch.float64))]), 15362.636731855106)
[92mINFO [0m:      configure_evaluate: strategy sampled 2 clients (out of 2)
[2024-11-13 21:18:52,863][flwr][INFO] - configure_evaluate: strategy sampled 2 clients (out of 2)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[36m(ClientAppActor pid=2299152)[0m Entrei no validation 1 3
[2024-11-13 21:19:03,974][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-11-13 21:19:03,975][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[2024-11-13 21:19:53,011][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-11-13 21:19:53,011][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 2 failures
[2024-11-13 21:19:53,012][flwr][INFO] - aggregate_evaluate: received 0 results and 2 failures
[92mINFO [0m:      
[2024-11-13 21:19:53,012][flwr][INFO] - 
[92mINFO [0m:      [ROUND 6]
[2024-11-13 21:19:53,013][flwr][INFO] - [ROUND 6]
[92mINFO [0m:      configure_fit: strategy sampled 2 clients (out of 2)
[2024-11-13 21:19:53,013][flwr][INFO] - configure_fit: strategy sampled 2 clients (out of 2)
[92mINFO [0m:      aggregate_fit: received 2 results and 0 failures
[36m(ClientAppActor pid=2299152)[0m Entrei no validation 1 3[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=2299152)[0m epoch:  0
[36m(ClientAppActor pid=2299152)[0m train ious:  0.9692007583544502
[36m(ClientAppActor pid=2299152)[0m train dice liver:  tensor(0.9796, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m train dice tumour:  tensor(0.5793, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation ious:  0.9688271098268741
[36m(ClientAppActor pid=2299152)[0m validation dice liver:  tensor(0.9801, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation dice tumour:  tensor(0.5826, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m => new best model:  0
[36m(ClientAppActor pid=2299152)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2299152)[0m epoch:  1
[36m(ClientAppActor pid=2299152)[0m train ious:  0.9726825128747113
[36m(ClientAppActor pid=2299152)[0m train dice liver:  tensor(0.9819, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m train dice tumour:  tensor(0.5967, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation ious:  0.9704436841649499
[36m(ClientAppActor pid=2299152)[0m validation dice liver:  tensor(0.9814, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation dice tumour:  tensor(0.5909, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m => new best model:  1
[36m(ClientAppActor pid=2299152)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2299152)[0m epoch:  2
[36m(ClientAppActor pid=2299152)[0m train ious:  0.9750546032588512
[36m(ClientAppActor pid=2299152)[0m train dice liver:  tensor(0.9834, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m train dice tumour:  tensor(0.6107, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation ious:  0.97196857147769
[36m(ClientAppActor pid=2299152)[0m validation dice liver:  tensor(0.9822, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation dice tumour:  tensor(0.5956, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m => new best model:  2
[36m(ClientAppActor pid=2299152)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2299152)[0m epoch:  3
[36m(ClientAppActor pid=2299152)[0m train ious:  0.9764304069495019
[36m(ClientAppActor pid=2299152)[0m train dice liver:  tensor(0.9844, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m train dice tumour:  tensor(0.5883, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation ious:  0.9715275607258367
[36m(ClientAppActor pid=2299152)[0m validation dice liver:  tensor(0.9826, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation dice tumour:  tensor(0.6009, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m => new best model:  3
[36m(ClientAppActor pid=2299151)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2299151)[0m epoch:  0
[36m(ClientAppActor pid=2299151)[0m train ious:  0.9698464124307679
[36m(ClientAppActor pid=2299151)[0m train dice liver:  tensor(0.9809, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m train dice tumour:  tensor(0.6931, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation ious:  0.965668614441684
[36m(ClientAppActor pid=2299151)[0m validation dice liver:  tensor(0.9790, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation dice tumour:  tensor(0.6729, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m => new best model:  0
[36m(ClientAppActor pid=2299151)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2299151)[0m epoch:  1
[36m(ClientAppActor pid=2299151)[0m train ious:  0.970886743936133
[36m(ClientAppActor pid=2299151)[0m train dice liver:  tensor(0.9815, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m train dice tumour:  tensor(0.6899, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation ious:  0.9683924440373789
[36m(ClientAppActor pid=2299151)[0m validation dice liver:  tensor(0.9811, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation dice tumour:  tensor(0.6767, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m => new best model:  1
[36m(ClientAppActor pid=2299151)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2299151)[0m epoch:  2
[36m(ClientAppActor pid=2299151)[0m train ious:  0.9719316085644514
[36m(ClientAppActor pid=2299151)[0m train dice liver:  tensor(0.9822, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m train dice tumour:  tensor(0.6973, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation ious:  0.9623081402963871
[36m(ClientAppActor pid=2299151)[0m validation dice liver:  tensor(0.9773, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation dice tumour:  tensor(0.6481, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m => new best model:  2
[36m(ClientAppActor pid=2299151)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2299151)[0m epoch:  3
[36m(ClientAppActor pid=2299151)[0m train ious:  0.9735213910332777
[36m(ClientAppActor pid=2299151)[0m train dice liver:  tensor(0.9833, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m train dice tumour:  tensor(0.7059, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation ious:  0.9693047174491921
[36m(ClientAppActor pid=2299151)[0m validation dice liver:  tensor(0.9817, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation dice tumour:  tensor(0.6858, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m => new best model:  3
[2024-11-13 22:11:20,829][flwr][INFO] - aggregate_fit: received 2 results and 0 failures
[92mINFO [0m:      fit progress: (6, 0.0033754124036905944, OrderedDict([('ind_iou_0', 0.9698199631877347), ('ind_dice_liver_0', tensor(0.9820, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.6888, dtype=torch.float64)), ('ind_iou_1', 0.9710426120219288), ('ind_dice_liver_1', tensor(0.9811, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5975, dtype=torch.float64)), ('all_iou', 0.9698711787351774), ('all_dice_liver', tensor(0.9819, dtype=torch.float64)), ('all_dice_tumour', tensor(0.6877, dtype=torch.float64))]), 18765.313959163148)
Entrei no test
Meio do test
Fim do test
[2024-11-13 22:15:35,519][flwr][INFO] - fit progress: (6, 0.0033754124036905944, OrderedDict([('ind_iou_0', 0.9698199631877347), ('ind_dice_liver_0', tensor(0.9820, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.6888, dtype=torch.float64)), ('ind_iou_1', 0.9710426120219288), ('ind_dice_liver_1', tensor(0.9811, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5975, dtype=torch.float64)), ('all_iou', 0.9698711787351774), ('all_dice_liver', tensor(0.9819, dtype=torch.float64)), ('all_dice_tumour', tensor(0.6877, dtype=torch.float64))]), 18765.313959163148)
[92mINFO [0m:      configure_evaluate: strategy sampled 2 clients (out of 2)
[2024-11-13 22:15:35,547][flwr][INFO] - configure_evaluate: strategy sampled 2 clients (out of 2)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[36m(ClientAppActor pid=2299152)[0m Entrei no validation 1 3
[2024-11-13 22:15:45,486][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-11-13 22:15:45,487][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[2024-11-13 22:16:34,232][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-11-13 22:16:34,232][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 2 failures
[2024-11-13 22:16:34,232][flwr][INFO] - aggregate_evaluate: received 0 results and 2 failures
[92mINFO [0m:      
[2024-11-13 22:16:34,232][flwr][INFO] - 
[92mINFO [0m:      [ROUND 7]
[2024-11-13 22:16:34,232][flwr][INFO] - [ROUND 7]
[92mINFO [0m:      configure_fit: strategy sampled 2 clients (out of 2)
[2024-11-13 22:16:34,232][flwr][INFO] - configure_fit: strategy sampled 2 clients (out of 2)
[92mINFO [0m:      aggregate_fit: received 2 results and 0 failures
[36m(ClientAppActor pid=2299152)[0m Entrei no validation 1 3[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=2299152)[0m epoch:  0
[36m(ClientAppActor pid=2299152)[0m train ious:  0.9737904633427692
[36m(ClientAppActor pid=2299152)[0m train dice liver:  tensor(0.9827, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m train dice tumour:  tensor(0.6105, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation ious:  0.9717089669023095
[36m(ClientAppActor pid=2299152)[0m validation dice liver:  tensor(0.9823, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation dice tumour:  tensor(0.5888, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m => new best model:  0
[36m(ClientAppActor pid=2299152)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2299152)[0m epoch:  1
[36m(ClientAppActor pid=2299152)[0m train ious:  0.9757630149592418
[36m(ClientAppActor pid=2299152)[0m train dice liver:  tensor(0.9840, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m train dice tumour:  tensor(0.6082, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation ious:  0.9734716589761272
[36m(ClientAppActor pid=2299152)[0m validation dice liver:  tensor(0.9834, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation dice tumour:  tensor(0.6051, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m => new best model:  1
[36m(ClientAppActor pid=2299152)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2299152)[0m epoch:  2
[36m(ClientAppActor pid=2299152)[0m train ious:  0.9779132972887922
[36m(ClientAppActor pid=2299152)[0m train dice liver:  tensor(0.9854, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m train dice tumour:  tensor(0.5757, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation ious:  0.9734707821097098
[36m(ClientAppActor pid=2299152)[0m validation dice liver:  tensor(0.9833, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation dice tumour:  tensor(0.6096, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m => new best model:  2
[36m(ClientAppActor pid=2299152)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2299152)[0m epoch:  3
[36m(ClientAppActor pid=2299152)[0m train ious:  0.9794368215872031
[36m(ClientAppActor pid=2299152)[0m train dice liver:  tensor(0.9863, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m train dice tumour:  tensor(0.6229, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation ious:  0.9751321443250515
[36m(ClientAppActor pid=2299152)[0m validation dice liver:  tensor(0.9845, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation dice tumour:  tensor(0.6136, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m => new best model:  3
[36m(ClientAppActor pid=2299151)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2299151)[0m epoch:  0
[36m(ClientAppActor pid=2299151)[0m train ious:  0.97390837039093
[36m(ClientAppActor pid=2299151)[0m train dice liver:  tensor(0.9835, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m train dice tumour:  tensor(0.7086, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation ious:  0.969482442333392
[36m(ClientAppActor pid=2299151)[0m validation dice liver:  tensor(0.9815, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation dice tumour:  tensor(0.6924, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m => new best model:  0
[36m(ClientAppActor pid=2299151)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2299151)[0m epoch:  1
[36m(ClientAppActor pid=2299151)[0m train ious:  0.9750322457510974
[36m(ClientAppActor pid=2299151)[0m train dice liver:  tensor(0.9843, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m train dice tumour:  tensor(0.7111, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation ious:  0.9704974690024806
[36m(ClientAppActor pid=2299151)[0m validation dice liver:  tensor(0.9827, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation dice tumour:  tensor(0.6954, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m => new best model:  1
[36m(ClientAppActor pid=2299151)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2299151)[0m epoch:  2
[36m(ClientAppActor pid=2299151)[0m train ious:  0.9760054500222906
[36m(ClientAppActor pid=2299151)[0m train dice liver:  tensor(0.9849, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m train dice tumour:  tensor(0.7144, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation ious:  0.9715910086171425
[36m(ClientAppActor pid=2299151)[0m validation dice liver:  tensor(0.9832, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation dice tumour:  tensor(0.6938, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m => new best model:  2
[36m(ClientAppActor pid=2299151)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2299151)[0m epoch:  3
[36m(ClientAppActor pid=2299151)[0m train ious:  0.9761440884426683
[36m(ClientAppActor pid=2299151)[0m train dice liver:  tensor(0.9849, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m train dice tumour:  tensor(0.7181, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation ious:  0.9720534915513499
[36m(ClientAppActor pid=2299151)[0m validation dice liver:  tensor(0.9838, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation dice tumour:  tensor(0.6960, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m => new best model:  3
[2024-11-13 23:03:11,773][flwr][INFO] - aggregate_fit: received 2 results and 0 failures
[92mINFO [0m:      fit progress: (7, 0.003109985891138242, OrderedDict([('ind_iou_0', 0.9725302212621035), ('ind_dice_liver_0', tensor(0.9841, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.6981, dtype=torch.float64)), ('ind_iou_1', 0.9750449600453485), ('ind_dice_liver_1', tensor(0.9840, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6039, dtype=torch.float64)), ('all_iou', 0.9727991328530132), ('all_dice_liver', tensor(0.9840, dtype=torch.float64)), ('all_dice_tumour', tensor(0.6966, dtype=torch.float64))]), 21802.896578738)
Entrei no test
Meio do test
Fim do test
[2024-11-13 23:06:13,101][flwr][INFO] - fit progress: (7, 0.003109985891138242, OrderedDict([('ind_iou_0', 0.9725302212621035), ('ind_dice_liver_0', tensor(0.9841, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.6981, dtype=torch.float64)), ('ind_iou_1', 0.9750449600453485), ('ind_dice_liver_1', tensor(0.9840, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6039, dtype=torch.float64)), ('all_iou', 0.9727991328530132), ('all_dice_liver', tensor(0.9840, dtype=torch.float64)), ('all_dice_tumour', tensor(0.6966, dtype=torch.float64))]), 21802.896578738)
[92mINFO [0m:      configure_evaluate: strategy sampled 2 clients (out of 2)
[2024-11-13 23:06:13,126][flwr][INFO] - configure_evaluate: strategy sampled 2 clients (out of 2)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[36m(ClientAppActor pid=2299151)[0m Entrei no validation 1 3
[2024-11-13 23:06:22,806][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-11-13 23:06:22,806][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[2024-11-13 23:07:11,636][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-11-13 23:07:11,636][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 2 failures
[2024-11-13 23:07:11,636][flwr][INFO] - aggregate_evaluate: received 0 results and 2 failures
[92mINFO [0m:      
[2024-11-13 23:07:11,636][flwr][INFO] - 
[92mINFO [0m:      [ROUND 8]
[2024-11-13 23:07:11,637][flwr][INFO] - [ROUND 8]
[92mINFO [0m:      configure_fit: strategy sampled 2 clients (out of 2)
[2024-11-13 23:07:11,637][flwr][INFO] - configure_fit: strategy sampled 2 clients (out of 2)
[92mINFO [0m:      aggregate_fit: received 2 results and 0 failures
[36m(ClientAppActor pid=2299151)[0m Entrei no validation 1 3[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=2299151)[0m epoch:  0
[36m(ClientAppActor pid=2299151)[0m train ious:  0.9762826799069959
[36m(ClientAppActor pid=2299151)[0m train dice liver:  tensor(0.9844, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m train dice tumour:  tensor(0.6222, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation ious:  0.9746628287561178
[36m(ClientAppActor pid=2299151)[0m validation dice liver:  tensor(0.9839, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation dice tumour:  tensor(0.6060, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m => new best model:  0
[36m(ClientAppActor pid=2299151)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2299151)[0m epoch:  1
[36m(ClientAppActor pid=2299151)[0m train ious:  0.9783975276420545
[36m(ClientAppActor pid=2299151)[0m train dice liver:  tensor(0.9858, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m train dice tumour:  tensor(0.5786, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation ious:  0.9757782782089517
[36m(ClientAppActor pid=2299151)[0m validation dice liver:  tensor(0.9846, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation dice tumour:  tensor(0.6103, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m => new best model:  1
[36m(ClientAppActor pid=2299151)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2299151)[0m epoch:  2
[36m(ClientAppActor pid=2299151)[0m train ious:  0.9802659794299119
[36m(ClientAppActor pid=2299151)[0m train dice liver:  tensor(0.9870, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m train dice tumour:  tensor(0.6153, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation ious:  0.9768161712589549
[36m(ClientAppActor pid=2299151)[0m validation dice liver:  tensor(0.9857, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation dice tumour:  tensor(0.6210, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m => new best model:  2
[36m(ClientAppActor pid=2299151)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2299151)[0m epoch:  3
[36m(ClientAppActor pid=2299151)[0m train ious:  0.9813733795754963
[36m(ClientAppActor pid=2299151)[0m train dice liver:  tensor(0.9878, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m train dice tumour:  tensor(0.6262, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation ious:  0.9767660579582702
[36m(ClientAppActor pid=2299151)[0m validation dice liver:  tensor(0.9858, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation dice tumour:  tensor(0.6191, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m => new best model:  3
[36m(ClientAppActor pid=2299152)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2299152)[0m epoch:  0
[36m(ClientAppActor pid=2299152)[0m train ious:  0.9772456912420882
[36m(ClientAppActor pid=2299152)[0m train dice liver:  tensor(0.9857, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m train dice tumour:  tensor(0.7150, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation ious:  0.972373617002372
[36m(ClientAppActor pid=2299152)[0m validation dice liver:  tensor(0.9836, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation dice tumour:  tensor(0.7007, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m => new best model:  0
[36m(ClientAppActor pid=2299152)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2299152)[0m epoch:  1
[36m(ClientAppActor pid=2299152)[0m train ious:  0.9778232992973485
[36m(ClientAppActor pid=2299152)[0m train dice liver:  tensor(0.9861, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m train dice tumour:  tensor(0.7235, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation ious:  0.9725980846666775
[36m(ClientAppActor pid=2299152)[0m validation dice liver:  tensor(0.9840, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation dice tumour:  tensor(0.6988, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m => new best model:  1
[36m(ClientAppActor pid=2299152)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2299152)[0m epoch:  2
[36m(ClientAppActor pid=2299152)[0m train ious:  0.9785061680270162
[36m(ClientAppActor pid=2299152)[0m train dice liver:  tensor(0.9865, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m train dice tumour:  tensor(0.7289, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation ious:  0.9730546968850863
[36m(ClientAppActor pid=2299152)[0m validation dice liver:  tensor(0.9844, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation dice tumour:  tensor(0.7018, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m => new best model:  2
[36m(ClientAppActor pid=2299152)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2299152)[0m epoch:  3
[36m(ClientAppActor pid=2299152)[0m train ious:  0.9791945046644918
[36m(ClientAppActor pid=2299152)[0m train dice liver:  tensor(0.9870, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m train dice tumour:  tensor(0.7245, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation ious:  0.9737991790492516
[36m(ClientAppActor pid=2299152)[0m validation dice liver:  tensor(0.9849, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation dice tumour:  tensor(0.7034, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m => new best model:  3
[2024-11-13 23:53:10,862][flwr][INFO] - aggregate_fit: received 2 results and 0 failures
[92mINFO [0m:      fit progress: (8, 0.0029361899322846753, OrderedDict([('ind_iou_0', 0.9743369741162398), ('ind_dice_liver_0', tensor(0.9851, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7061, dtype=torch.float64)), ('ind_iou_1', 0.976639104981043), ('ind_dice_liver_1', tensor(0.9851, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6120, dtype=torch.float64)), ('all_iou', 0.9745188992879574), ('all_dice_liver', tensor(0.9851, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7061, dtype=torch.float64))]), 24801.178597236983)
Entrei no test
Meio do test
Fim do test
[2024-11-13 23:56:11,383][flwr][INFO] - fit progress: (8, 0.0029361899322846753, OrderedDict([('ind_iou_0', 0.9743369741162398), ('ind_dice_liver_0', tensor(0.9851, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7061, dtype=torch.float64)), ('ind_iou_1', 0.976639104981043), ('ind_dice_liver_1', tensor(0.9851, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6120, dtype=torch.float64)), ('all_iou', 0.9745188992879574), ('all_dice_liver', tensor(0.9851, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7061, dtype=torch.float64))]), 24801.178597236983)
[92mINFO [0m:      configure_evaluate: strategy sampled 2 clients (out of 2)
[2024-11-13 23:56:11,387][flwr][INFO] - configure_evaluate: strategy sampled 2 clients (out of 2)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[36m(ClientAppActor pid=2299152)[0m Entrei no validation 1 3
[2024-11-13 23:56:21,659][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-11-13 23:56:21,659][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[2024-11-13 23:57:09,219][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-11-13 23:57:09,220][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 2 failures
[2024-11-13 23:57:09,220][flwr][INFO] - aggregate_evaluate: received 0 results and 2 failures
[92mINFO [0m:      
[2024-11-13 23:57:09,220][flwr][INFO] - 
[92mINFO [0m:      [ROUND 9]
[2024-11-13 23:57:09,220][flwr][INFO] - [ROUND 9]
[92mINFO [0m:      configure_fit: strategy sampled 2 clients (out of 2)
[2024-11-13 23:57:09,221][flwr][INFO] - configure_fit: strategy sampled 2 clients (out of 2)
[92mINFO [0m:      aggregate_fit: received 2 results and 0 failures
[36m(ClientAppActor pid=2299152)[0m Entrei no validation 1 3[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=2299152)[0m epoch:  0
[36m(ClientAppActor pid=2299152)[0m train ious:  0.978374702795764
[36m(ClientAppActor pid=2299152)[0m train dice liver:  tensor(0.9857, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m train dice tumour:  tensor(0.6162, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation ious:  0.9771723060340665
[36m(ClientAppActor pid=2299152)[0m validation dice liver:  tensor(0.9852, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation dice tumour:  tensor(0.6262, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m => new best model:  0
[36m(ClientAppActor pid=2299152)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2299152)[0m epoch:  1
[36m(ClientAppActor pid=2299152)[0m train ious:  0.9802602444988815
[36m(ClientAppActor pid=2299152)[0m train dice liver:  tensor(0.9870, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m train dice tumour:  tensor(0.6092, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation ious:  0.977416421671093
[36m(ClientAppActor pid=2299152)[0m validation dice liver:  tensor(0.9860, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation dice tumour:  tensor(0.6223, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m => new best model:  1
[36m(ClientAppActor pid=2299152)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2299152)[0m epoch:  2
[36m(ClientAppActor pid=2299152)[0m train ious:  0.9816313368979602
[36m(ClientAppActor pid=2299152)[0m train dice liver:  tensor(0.9879, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m train dice tumour:  tensor(0.6315, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation ious:  0.977271510415872
[36m(ClientAppActor pid=2299152)[0m validation dice liver:  tensor(0.9861, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation dice tumour:  tensor(0.6226, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m => new best model:  2
[36m(ClientAppActor pid=2299152)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2299152)[0m epoch:  3
[36m(ClientAppActor pid=2299152)[0m train ious:  0.9827021212135407
[36m(ClientAppActor pid=2299152)[0m train dice liver:  tensor(0.9888, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m train dice tumour:  tensor(0.6248, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation ious:  0.9782687998816627
[36m(ClientAppActor pid=2299152)[0m validation dice liver:  tensor(0.9869, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation dice tumour:  tensor(0.6251, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m => new best model:  3
[36m(ClientAppActor pid=2299151)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2299151)[0m epoch:  0
[36m(ClientAppActor pid=2299151)[0m train ious:  0.9795545313921459
[36m(ClientAppActor pid=2299151)[0m train dice liver:  tensor(0.9872, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m train dice tumour:  tensor(0.7314, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation ious:  0.9731288754204087
[36m(ClientAppActor pid=2299151)[0m validation dice liver:  tensor(0.9846, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation dice tumour:  tensor(0.7032, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m => new best model:  0
[36m(ClientAppActor pid=2299151)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2299151)[0m epoch:  1
[36m(ClientAppActor pid=2299151)[0m train ious:  0.9799885935693262
[36m(ClientAppActor pid=2299151)[0m train dice liver:  tensor(0.9875, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m train dice tumour:  tensor(0.7329, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation ious:  0.9739863485518374
[36m(ClientAppActor pid=2299151)[0m validation dice liver:  tensor(0.9851, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation dice tumour:  tensor(0.7053, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m => new best model:  1
[36m(ClientAppActor pid=2299151)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2299151)[0m epoch:  2
[36m(ClientAppActor pid=2299151)[0m train ious:  0.9794036694764575
[36m(ClientAppActor pid=2299151)[0m train dice liver:  tensor(0.9870, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m train dice tumour:  tensor(0.7398, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation ious:  0.9750156043002307
[36m(ClientAppActor pid=2299151)[0m validation dice liver:  tensor(0.9856, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation dice tumour:  tensor(0.7129, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m => new best model:  2
[36m(ClientAppActor pid=2299151)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2299151)[0m epoch:  3
[36m(ClientAppActor pid=2299151)[0m train ious:  0.9811637293307698
[36m(ClientAppActor pid=2299151)[0m train dice liver:  tensor(0.9882, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m train dice tumour:  tensor(0.7380, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation ious:  0.9744934289267101
[36m(ClientAppActor pid=2299151)[0m validation dice liver:  tensor(0.9855, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation dice tumour:  tensor(0.7071, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m => new best model:  3
[2024-11-14 00:41:04,220][flwr][INFO] - aggregate_fit: received 2 results and 0 failures
[92mINFO [0m:      fit progress: (9, 0.002871240207684026, OrderedDict([('ind_iou_0', 0.9751227084659523), ('ind_dice_liver_0', tensor(0.9858, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7098, dtype=torch.float64)), ('ind_iou_1', 0.9779744104310846), ('ind_dice_liver_1', tensor(0.9862, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6195, dtype=torch.float64)), ('all_iou', 0.975465105345783), ('all_dice_liver', tensor(0.9859, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7092, dtype=torch.float64))]), 27677.358719258104)
Entrei no test
Meio do test
Fim do test
[2024-11-14 00:44:07,564][flwr][INFO] - fit progress: (9, 0.002871240207684026, OrderedDict([('ind_iou_0', 0.9751227084659523), ('ind_dice_liver_0', tensor(0.9858, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7098, dtype=torch.float64)), ('ind_iou_1', 0.9779744104310846), ('ind_dice_liver_1', tensor(0.9862, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6195, dtype=torch.float64)), ('all_iou', 0.975465105345783), ('all_dice_liver', tensor(0.9859, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7092, dtype=torch.float64))]), 27677.358719258104)
[92mINFO [0m:      configure_evaluate: strategy sampled 2 clients (out of 2)
[2024-11-14 00:44:07,568][flwr][INFO] - configure_evaluate: strategy sampled 2 clients (out of 2)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[36m(ClientAppActor pid=2299151)[0m Entrei no validation 1 3
[2024-11-14 00:44:16,898][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-11-14 00:44:16,898][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[2024-11-14 00:45:06,680][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-11-14 00:45:06,680][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 2 failures
[2024-11-14 00:45:06,681][flwr][INFO] - aggregate_evaluate: received 0 results and 2 failures
[92mINFO [0m:      
[2024-11-14 00:45:06,681][flwr][INFO] - 
[92mINFO [0m:      [ROUND 10]
[2024-11-14 00:45:06,681][flwr][INFO] - [ROUND 10]
[92mINFO [0m:      configure_fit: strategy sampled 2 clients (out of 2)
[2024-11-14 00:45:06,681][flwr][INFO] - configure_fit: strategy sampled 2 clients (out of 2)
[92mINFO [0m:      aggregate_fit: received 2 results and 0 failures
[36m(ClientAppActor pid=2299151)[0m Entrei no validation 1 3[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=2299151)[0m epoch:  0
[36m(ClientAppActor pid=2299151)[0m train ious:  0.9800771793065993
[36m(ClientAppActor pid=2299151)[0m train dice liver:  tensor(0.9869, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m train dice tumour:  tensor(0.6116, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation ious:  0.9787378288803527
[36m(ClientAppActor pid=2299151)[0m validation dice liver:  tensor(0.9864, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation dice tumour:  tensor(0.6245, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m => new best model:  0
[36m(ClientAppActor pid=2299151)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2299151)[0m epoch:  1
[36m(ClientAppActor pid=2299151)[0m train ious:  0.9822866736029424
[36m(ClientAppActor pid=2299151)[0m train dice liver:  tensor(0.9883, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m train dice tumour:  tensor(0.6314, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation ious:  0.979027766153239
[36m(ClientAppActor pid=2299151)[0m validation dice liver:  tensor(0.9869, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation dice tumour:  tensor(0.6351, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m => new best model:  1
[36m(ClientAppActor pid=2299151)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2299151)[0m epoch:  2
[36m(ClientAppActor pid=2299151)[0m train ious:  0.9835051003076911
[36m(ClientAppActor pid=2299151)[0m train dice liver:  tensor(0.9892, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m train dice tumour:  tensor(0.6419, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation ious:  0.9792924440746238
[36m(ClientAppActor pid=2299151)[0m validation dice liver:  tensor(0.9875, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation dice tumour:  tensor(0.6355, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m => new best model:  2
[36m(ClientAppActor pid=2299151)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2299151)[0m epoch:  3
[36m(ClientAppActor pid=2299151)[0m train ious:  0.9839464665426271
[36m(ClientAppActor pid=2299151)[0m train dice liver:  tensor(0.9895, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m train dice tumour:  tensor(0.6237, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation ious:  0.9788149354828994
[36m(ClientAppActor pid=2299151)[0m validation dice liver:  tensor(0.9875, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation dice tumour:  tensor(0.6291, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m => new best model:  3
[36m(ClientAppActor pid=2299152)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2299152)[0m epoch:  0
[36m(ClientAppActor pid=2299152)[0m train ious:  0.9806095733428131
[36m(ClientAppActor pid=2299152)[0m train dice liver:  tensor(0.9878, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m train dice tumour:  tensor(0.7354, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation ious:  0.9751908261620765
[36m(ClientAppActor pid=2299152)[0m validation dice liver:  tensor(0.9862, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation dice tumour:  tensor(0.7171, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m => new best model:  0
[36m(ClientAppActor pid=2299152)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2299152)[0m epoch:  1
[36m(ClientAppActor pid=2299152)[0m train ious:  0.9817284615663932
[36m(ClientAppActor pid=2299152)[0m train dice liver:  tensor(0.9886, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m train dice tumour:  tensor(0.7389, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation ious:  0.9756896065717883
[36m(ClientAppActor pid=2299152)[0m validation dice liver:  tensor(0.9862, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation dice tumour:  tensor(0.7147, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m => new best model:  1
[36m(ClientAppActor pid=2299152)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2299152)[0m epoch:  2
[36m(ClientAppActor pid=2299152)[0m train ious:  0.9819045370806679
[36m(ClientAppActor pid=2299152)[0m train dice liver:  tensor(0.9887, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m train dice tumour:  tensor(0.7453, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation ious:  0.9754274946049281
[36m(ClientAppActor pid=2299152)[0m validation dice liver:  tensor(0.9862, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation dice tumour:  tensor(0.7141, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m => new best model:  2
[36m(ClientAppActor pid=2299152)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2299152)[0m epoch:  3
[36m(ClientAppActor pid=2299152)[0m train ious:  0.9823337483198995
[36m(ClientAppActor pid=2299152)[0m train dice liver:  tensor(0.9889, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m train dice tumour:  tensor(0.7391, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation ious:  0.975431450437336
[36m(ClientAppActor pid=2299152)[0m validation dice liver:  tensor(0.9861, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation dice tumour:  tensor(0.7131, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m => new best model:  3
[2024-11-14 01:34:53,182][flwr][INFO] - aggregate_fit: received 2 results and 0 failures
[92mINFO [0m:      fit progress: (10, 0.0028102813836455116, OrderedDict([('ind_iou_0', 0.9759816571696591), ('ind_dice_liver_0', tensor(0.9864, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7156, dtype=torch.float64)), ('ind_iou_1', 0.9794315031889315), ('ind_dice_liver_1', tensor(0.9871, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6295, dtype=torch.float64)), ('all_iou', 0.9764096038937841), ('all_dice_liver', tensor(0.9865, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7153, dtype=torch.float64))]), 30903.808998004068)
Entrei no test
Meio do test
Fim do test
[2024-11-14 01:37:54,014][flwr][INFO] - fit progress: (10, 0.0028102813836455116, OrderedDict([('ind_iou_0', 0.9759816571696591), ('ind_dice_liver_0', tensor(0.9864, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7156, dtype=torch.float64)), ('ind_iou_1', 0.9794315031889315), ('ind_dice_liver_1', tensor(0.9871, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6295, dtype=torch.float64)), ('all_iou', 0.9764096038937841), ('all_dice_liver', tensor(0.9865, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7153, dtype=torch.float64))]), 30903.808998004068)
[92mINFO [0m:      configure_evaluate: strategy sampled 2 clients (out of 2)
[2024-11-14 01:37:54,017][flwr][INFO] - configure_evaluate: strategy sampled 2 clients (out of 2)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[36m(ClientAppActor pid=2299152)[0m Entrei no validation 1 3
[2024-11-14 01:38:05,368][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-11-14 01:38:05,368][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[2024-11-14 01:38:54,543][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-11-14 01:38:54,543][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 2 failures
[2024-11-14 01:38:54,543][flwr][INFO] - aggregate_evaluate: received 0 results and 2 failures
[92mINFO [0m:      
[2024-11-14 01:38:54,543][flwr][INFO] - 
[92mINFO [0m:      [ROUND 11]
[2024-11-14 01:38:54,543][flwr][INFO] - [ROUND 11]
[92mINFO [0m:      configure_fit: strategy sampled 2 clients (out of 2)
[2024-11-14 01:38:54,544][flwr][INFO] - configure_fit: strategy sampled 2 clients (out of 2)
[92mINFO [0m:      aggregate_fit: received 2 results and 0 failures
[36m(ClientAppActor pid=2299151)[0m Entrei no validation 1 3[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=2299151)[0m epoch:  0
[36m(ClientAppActor pid=2299151)[0m train ious:  0.9813331987365267
[36m(ClientAppActor pid=2299151)[0m train dice liver:  tensor(0.9877, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m train dice tumour:  tensor(0.5983, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation ious:  0.9791978620567787
[36m(ClientAppActor pid=2299151)[0m validation dice liver:  tensor(0.9865, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation dice tumour:  tensor(0.6318, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m => new best model:  0
[36m(ClientAppActor pid=2299151)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2299151)[0m epoch:  1
[36m(ClientAppActor pid=2299151)[0m train ious:  0.9830774775547515
[36m(ClientAppActor pid=2299151)[0m train dice liver:  tensor(0.9888, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m train dice tumour:  tensor(0.6351, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation ious:  0.9804589911890614
[36m(ClientAppActor pid=2299151)[0m validation dice liver:  tensor(0.9875, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation dice tumour:  tensor(0.6354, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m => new best model:  1
[36m(ClientAppActor pid=2299151)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2299151)[0m epoch:  2
[36m(ClientAppActor pid=2299151)[0m train ious:  0.9842215589727252
[36m(ClientAppActor pid=2299151)[0m train dice liver:  tensor(0.9896, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m train dice tumour:  tensor(0.6283, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation ious:  0.9802418229865623
[36m(ClientAppActor pid=2299151)[0m validation dice liver:  tensor(0.9881, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation dice tumour:  tensor(0.6355, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m => new best model:  2
[36m(ClientAppActor pid=2299151)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2299151)[0m epoch:  3
[36m(ClientAppActor pid=2299151)[0m train ious:  0.9851772417526491
[36m(ClientAppActor pid=2299151)[0m train dice liver:  tensor(0.9903, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m train dice tumour:  tensor(0.6302, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation ious:  0.980198358193073
[36m(ClientAppActor pid=2299151)[0m validation dice liver:  tensor(0.9883, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation dice tumour:  tensor(0.6376, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m => new best model:  3
[36m(ClientAppActor pid=2299152)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2299152)[0m epoch:  0
[36m(ClientAppActor pid=2299152)[0m train ious:  0.982595040544419
[36m(ClientAppActor pid=2299152)[0m train dice liver:  tensor(0.9892, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m train dice tumour:  tensor(0.7500, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation ious:  0.9759858570388005
[36m(ClientAppActor pid=2299152)[0m validation dice liver:  tensor(0.9866, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation dice tumour:  tensor(0.7164, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m => new best model:  0
[36m(ClientAppActor pid=2299152)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2299152)[0m epoch:  1
[36m(ClientAppActor pid=2299152)[0m train ious:  0.9828989792337385
[36m(ClientAppActor pid=2299152)[0m train dice liver:  tensor(0.9893, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m train dice tumour:  tensor(0.7465, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation ious:  0.9760441193654155
[36m(ClientAppActor pid=2299152)[0m validation dice liver:  tensor(0.9867, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation dice tumour:  tensor(0.7165, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m => new best model:  1
[36m(ClientAppActor pid=2299152)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2299152)[0m epoch:  2
[36m(ClientAppActor pid=2299152)[0m train ious:  0.9833195055753041
[36m(ClientAppActor pid=2299152)[0m train dice liver:  tensor(0.9896, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m train dice tumour:  tensor(0.7465, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation ious:  0.9765157743903897
[36m(ClientAppActor pid=2299152)[0m validation dice liver:  tensor(0.9868, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation dice tumour:  tensor(0.7190, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m => new best model:  2
[36m(ClientAppActor pid=2299152)[0m Entrei no validation 1 3
[2024-11-14 02:25:35,385][flwr][INFO] - aggregate_fit: received 2 results and 0 failures
[92mINFO [0m:      fit progress: (11, 0.002749249578509524, OrderedDict([('ind_iou_0', 0.9769656142540658), ('ind_dice_liver_0', tensor(0.9873, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7185, dtype=torch.float64)), ('ind_iou_1', 0.9801829374540324), ('ind_dice_liver_1', tensor(0.9880, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6262, dtype=torch.float64)), ('all_iou', 0.9773300999278599), ('all_dice_liver', tensor(0.9874, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7170, dtype=torch.float64))]), 33938.92112290906)
[36m(ClientAppActor pid=2299152)[0m epoch:  3
[36m(ClientAppActor pid=2299152)[0m train ious:  0.9837273314784651
[36m(ClientAppActor pid=2299152)[0m train dice liver:  tensor(0.9899, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m train dice tumour:  tensor(0.7538, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation ious:  0.9763910992512448
[36m(ClientAppActor pid=2299152)[0m validation dice liver:  tensor(0.9870, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation dice tumour:  tensor(0.7155, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m => new best model:  3
Entrei no test
Meio do test
Fim do test
[2024-11-14 02:28:29,126][flwr][INFO] - fit progress: (11, 0.002749249578509524, OrderedDict([('ind_iou_0', 0.9769656142540658), ('ind_dice_liver_0', tensor(0.9873, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7185, dtype=torch.float64)), ('ind_iou_1', 0.9801829374540324), ('ind_dice_liver_1', tensor(0.9880, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6262, dtype=torch.float64)), ('all_iou', 0.9773300999278599), ('all_dice_liver', tensor(0.9874, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7170, dtype=torch.float64))]), 33938.92112290906)
[92mINFO [0m:      configure_evaluate: strategy sampled 2 clients (out of 2)
[2024-11-14 02:28:29,130][flwr][INFO] - configure_evaluate: strategy sampled 2 clients (out of 2)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[36m(ClientAppActor pid=2299152)[0m Entrei no validation 1 3
[2024-11-14 02:28:39,111][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-11-14 02:28:39,112][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[2024-11-14 02:29:28,364][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-11-14 02:29:28,365][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 2 failures
[2024-11-14 02:29:28,365][flwr][INFO] - aggregate_evaluate: received 0 results and 2 failures
[92mINFO [0m:      
[2024-11-14 02:29:28,365][flwr][INFO] - 
[92mINFO [0m:      [ROUND 12]
[2024-11-14 02:29:28,365][flwr][INFO] - [ROUND 12]
[92mINFO [0m:      configure_fit: strategy sampled 2 clients (out of 2)
[2024-11-14 02:29:28,366][flwr][INFO] - configure_fit: strategy sampled 2 clients (out of 2)
[92mINFO [0m:      aggregate_fit: received 2 results and 0 failures
[36m(ClientAppActor pid=2299152)[0m Entrei no validation 1 3[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=2299152)[0m epoch:  0
[36m(ClientAppActor pid=2299152)[0m train ious:  0.9822800266804343
[36m(ClientAppActor pid=2299152)[0m train dice liver:  tensor(0.9884, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m train dice tumour:  tensor(0.6079, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation ious:  0.9806692759680574
[36m(ClientAppActor pid=2299152)[0m validation dice liver:  tensor(0.9877, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation dice tumour:  tensor(0.6388, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m => new best model:  0
[36m(ClientAppActor pid=2299152)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2299152)[0m epoch:  1
[36m(ClientAppActor pid=2299152)[0m train ious:  0.9843350376202916
[36m(ClientAppActor pid=2299152)[0m train dice liver:  tensor(0.9897, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m train dice tumour:  tensor(0.6376, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation ious:  0.9811134377490954
[36m(ClientAppActor pid=2299152)[0m validation dice liver:  tensor(0.9883, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation dice tumour:  tensor(0.6429, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m => new best model:  1
[36m(ClientAppActor pid=2299152)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2299152)[0m epoch:  2
[36m(ClientAppActor pid=2299152)[0m train ious:  0.9849916303593288
[36m(ClientAppActor pid=2299152)[0m train dice liver:  tensor(0.9902, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m train dice tumour:  tensor(0.6440, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation ious:  0.9797308363028342
[36m(ClientAppActor pid=2299152)[0m validation dice liver:  tensor(0.9878, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation dice tumour:  tensor(0.6275, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m => new best model:  2
[36m(ClientAppActor pid=2299152)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2299152)[0m epoch:  3
[36m(ClientAppActor pid=2299152)[0m train ious:  0.9855642304966503
[36m(ClientAppActor pid=2299152)[0m train dice liver:  tensor(0.9906, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m train dice tumour:  tensor(0.6528, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation ious:  0.9808553166036755
[36m(ClientAppActor pid=2299152)[0m validation dice liver:  tensor(0.9887, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation dice tumour:  tensor(0.6413, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m => new best model:  3
[36m(ClientAppActor pid=2299151)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2299151)[0m epoch:  0
[36m(ClientAppActor pid=2299151)[0m train ious:  0.9839609674778473
[36m(ClientAppActor pid=2299151)[0m train dice liver:  
[36m(ClientAppActor pid=2299151)[0m tensor(0.9900, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m train dice tumour:  tensor(0.7560, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation ious:  0.976457917284229
[36m(ClientAppActor pid=2299151)[0m validation dice liver:  tensor(0.9871, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation dice tumour:  tensor(0.7168, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m => new best model:  0
[36m(ClientAppActor pid=2299151)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2299151)[0m epoch:  1
[36m(ClientAppActor pid=2299151)[0m train ious:  0.9840432128817997
[36m(ClientAppActor pid=2299151)[0m train dice liver:  tensor(0.9900, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m train dice tumour:  tensor(0.7474, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation ious:  0.9771925325534888
[36m(ClientAppActor pid=2299151)[0m validation dice liver:  tensor(0.9874, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation dice tumour:  tensor(0.7213, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m => new best model:  1
[36m(ClientAppActor pid=2299151)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2299151)[0m epoch:  2
[36m(ClientAppActor pid=2299151)[0m train ious:  0.9843963140574915
[36m(ClientAppActor pid=2299151)[0m train dice liver:  tensor(0.9903, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m train dice tumour:  tensor(0.7640, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation ious:  0.9770262541686083
[36m(ClientAppActor pid=2299151)[0m validation dice liver:  tensor(0.9873, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation dice tumour:  tensor(0.7231, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m => new best model:  2
[36m(ClientAppActor pid=2299151)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2299151)[0m epoch:  3
[36m(ClientAppActor pid=2299151)[0m train ious:  0.9847053479913993
[36m(ClientAppActor pid=2299151)[0m train dice liver:  tensor(0.9904, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m train dice tumour:  tensor(0.7488, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation ious:  0.9772895986806271
[36m(ClientAppActor pid=2299151)[0m validation dice liver:  tensor(0.9877, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation dice tumour:  tensor(0.7223, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m => new best model:  3
[2024-11-14 03:09:03,907][flwr][INFO] - aggregate_fit: received 2 results and 0 failures
[92mINFO [0m:      fit progress: (12, 0.0027283928440811774, OrderedDict([('ind_iou_0', 0.9777303401238416), ('ind_dice_liver_0', tensor(0.9878, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7241, dtype=torch.float64)), ('ind_iou_1', 0.9816876924661031), ('ind_dice_liver_1', tensor(0.9890, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6351, dtype=torch.float64)), ('all_iou', 0.9781784805738721), ('all_dice_liver', tensor(0.9880, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7223, dtype=torch.float64))]), 36548.16012153495)
Entrei no test
Meio do test
Fim do test
[2024-11-14 03:11:58,365][flwr][INFO] - fit progress: (12, 0.0027283928440811774, OrderedDict([('ind_iou_0', 0.9777303401238416), ('ind_dice_liver_0', tensor(0.9878, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7241, dtype=torch.float64)), ('ind_iou_1', 0.9816876924661031), ('ind_dice_liver_1', tensor(0.9890, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6351, dtype=torch.float64)), ('all_iou', 0.9781784805738721), ('all_dice_liver', tensor(0.9880, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7223, dtype=torch.float64))]), 36548.16012153495)
[92mINFO [0m:      configure_evaluate: strategy sampled 2 clients (out of 2)
[2024-11-14 03:11:58,368][flwr][INFO] - configure_evaluate: strategy sampled 2 clients (out of 2)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[36m(ClientAppActor pid=2299151)[0m Entrei no validation 1 3
[2024-11-14 03:12:09,252][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-11-14 03:12:09,252][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[2024-11-14 03:12:57,682][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-11-14 03:12:57,682][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 2 failures
[2024-11-14 03:12:57,682][flwr][INFO] - aggregate_evaluate: received 0 results and 2 failures
[92mINFO [0m:      
[2024-11-14 03:12:57,683][flwr][INFO] - 
[92mINFO [0m:      [ROUND 13]
[2024-11-14 03:12:57,683][flwr][INFO] - [ROUND 13]
[92mINFO [0m:      configure_fit: strategy sampled 2 clients (out of 2)
[2024-11-14 03:12:57,683][flwr][INFO] - configure_fit: strategy sampled 2 clients (out of 2)
[92mINFO [0m:      aggregate_fit: received 2 results and 0 failures
[36m(ClientAppActor pid=2299152)[0m Entrei no validation 1 3[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=2299152)[0m epoch:  0
[36m(ClientAppActor pid=2299152)[0m train ious:  0.9833704767237899
[36m(ClientAppActor pid=2299152)[0m train dice liver:  tensor(0.9891, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m train dice tumour:  tensor(0.6202, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation ious:  0.9813943711537348
[36m(ClientAppActor pid=2299152)[0m validation dice liver:  tensor(0.9882, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation dice tumour:  tensor(0.6357, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m => new best model:  0
[36m(ClientAppActor pid=2299152)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2299152)[0m epoch:  1
[36m(ClientAppActor pid=2299152)[0m train ious:  0.9847348645354964
[36m(ClientAppActor pid=2299152)[0m train dice liver:  tensor(0.9900, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m train dice tumour:  tensor(0.6193, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation ious:  0.9820165470002356
[36m(ClientAppActor pid=2299152)[0m validation dice liver:  tensor(0.9891, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation dice tumour:  tensor(0.6377, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m => new best model:  1
[36m(ClientAppActor pid=2299152)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2299152)[0m epoch:  2
[36m(ClientAppActor pid=2299152)[0m train ious:  0.9861083478362336
[36m(ClientAppActor pid=2299152)[0m train dice liver:  tensor(0.9909, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m train dice tumour:  tensor(0.6327, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation ious:  0.9815324831749646
[36m(ClientAppActor pid=2299152)[0m validation dice liver:  tensor(0.9890, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation dice tumour:  tensor(0.6358, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m => new best model:  2
[36m(ClientAppActor pid=2299152)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2299152)[0m epoch:  3
[36m(ClientAppActor pid=2299152)[0m train ious:  0.9864355052968964
[36m(ClientAppActor pid=2299152)[0m train dice liver:  tensor(0.9911, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m train dice tumour:  tensor(0.6485, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation ious:  0.9819620008084086
[36m(ClientAppActor pid=2299152)[0m validation dice liver:  tensor(0.9894, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation dice tumour:  tensor(0.6393, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m => new best model:  3
[36m(ClientAppActor pid=2299151)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2299151)[0m epoch:  0
[36m(ClientAppActor pid=2299151)[0m train ious:  0.9849494406919558
[36m(ClientAppActor pid=2299151)[0m train dice liver:  tensor(0.9906, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m train dice tumour:  tensor(0.7558, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation ious:  0.9765156825385242
[36m(ClientAppActor pid=2299151)[0m validation dice liver:  tensor(0.9870, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation dice tumour:  tensor(0.7185, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m => new best model:  0
[36m(ClientAppActor pid=2299151)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2299151)[0m epoch:  1
[36m(ClientAppActor pid=2299151)[0m train ious:  0.984863721985043
[36m(ClientAppActor pid=2299151)[0m train dice liver:  tensor(0.9905, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m train dice tumour:  tensor(0.7537, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation ious:  0.976848109395164
[36m(ClientAppActor pid=2299151)[0m validation dice liver:  tensor(0.9871, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation dice tumour:  tensor(0.7219, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m => new best model:  1
[36m(ClientAppActor pid=2299151)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2299151)[0m epoch:  2
[36m(ClientAppActor pid=2299151)[0m train ious:  0.9855000066077196
[36m(ClientAppActor pid=2299151)[0m train dice liver:  tensor(0.9910, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m train dice tumour:  tensor(0.7611, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation ious:  0.9775845060694995
[36m(ClientAppActor pid=2299151)[0m validation dice liver:  tensor(0.9878, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation dice tumour:  tensor(0.7250, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m => new best model:  2
[36m(ClientAppActor pid=2299151)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2299151)[0m epoch:  3
[36m(ClientAppActor pid=2299151)[0m train ious:  0.9854874901787007
[36m(ClientAppActor pid=2299151)[0m train dice liver:  tensor(0.9909, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m train dice tumour:  tensor(0.7542, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation ious:  0.9776568886407482
[36m(ClientAppActor pid=2299151)[0m validation dice liver:  tensor(0.9879, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation dice tumour:  tensor(0.7271, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m => new best model:  3
[2024-11-14 03:49:23,708][flwr][INFO] - aggregate_fit: received 2 results and 0 failures
[92mINFO [0m:      fit progress: (13, 0.002704672654453935, OrderedDict([('ind_iou_0', 0.9781108435010384), ('ind_dice_liver_0', tensor(0.9881, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7287, dtype=torch.float64)), ('ind_iou_1', 0.9818716794894885), ('ind_dice_liver_1', tensor(0.9892, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6380, dtype=torch.float64)), ('all_iou', 0.9785385197607027), ('all_dice_liver', tensor(0.9882, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7273, dtype=torch.float64))]), 38965.76457980415)
Entrei no test
Meio do test
Fim do test
[2024-11-14 03:52:15,969][flwr][INFO] - fit progress: (13, 0.002704672654453935, OrderedDict([('ind_iou_0', 0.9781108435010384), ('ind_dice_liver_0', tensor(0.9881, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7287, dtype=torch.float64)), ('ind_iou_1', 0.9818716794894885), ('ind_dice_liver_1', tensor(0.9892, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6380, dtype=torch.float64)), ('all_iou', 0.9785385197607027), ('all_dice_liver', tensor(0.9882, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7273, dtype=torch.float64))]), 38965.76457980415)
[92mINFO [0m:      configure_evaluate: strategy sampled 2 clients (out of 2)
[2024-11-14 03:52:15,973][flwr][INFO] - configure_evaluate: strategy sampled 2 clients (out of 2)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[36m(ClientAppActor pid=2299152)[0m Entrei no validation 1 3
[2024-11-14 03:52:27,280][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-11-14 03:52:27,280][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[2024-11-14 03:53:15,587][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-11-14 03:53:15,587][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 2 failures
[2024-11-14 03:53:15,587][flwr][INFO] - aggregate_evaluate: received 0 results and 2 failures
[92mINFO [0m:      
[2024-11-14 03:53:15,588][flwr][INFO] - 
[92mINFO [0m:      [ROUND 14]
[2024-11-14 03:53:15,588][flwr][INFO] - [ROUND 14]
[92mINFO [0m:      configure_fit: strategy sampled 2 clients (out of 2)
[2024-11-14 03:53:15,588][flwr][INFO] - configure_fit: strategy sampled 2 clients (out of 2)
[92mINFO [0m:      aggregate_fit: received 2 results and 0 failures
[36m(ClientAppActor pid=2299152)[0m Entrei no validation 1 3[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=2299152)[0m epoch:  0
[36m(ClientAppActor pid=2299152)[0m train ious:  0.9842124285274647
[36m(ClientAppActor pid=2299152)[0m train dice liver:  tensor(0.9896, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m train dice tumour:  tensor(0.6066, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation ious:  0.9824339220728098
[36m(ClientAppActor pid=2299152)[0m validation dice liver:  tensor(0.9888, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation dice tumour:  tensor(0.6391, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m => new best model:  0
[36m(ClientAppActor pid=2299152)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2299152)[0m epoch:  1
[36m(ClientAppActor pid=2299152)[0m train ious:  0.985421766824001
[36m(ClientAppActor pid=2299152)[0m train dice liver:  tensor(0.9903, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m train dice tumour:  tensor(0.6280, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation ious:  0.9824441279499208
[36m(ClientAppActor pid=2299152)[0m validation dice liver:  tensor(0.9894, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation dice tumour:  tensor(0.6445, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m => new best model:  1
[36m(ClientAppActor pid=2299152)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2299152)[0m epoch:  2
[36m(ClientAppActor pid=2299152)[0m train ious:  0.9866784002890462
[36m(ClientAppActor pid=2299152)[0m train dice liver:  tensor(0.9912, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m train dice tumour:  tensor(0.6359, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation ious:  0.9827133603108259
[36m(ClientAppActor pid=2299152)[0m validation dice liver:  tensor(0.9898, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation dice tumour:  tensor(0.6465, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m => new best model:  2
[36m(ClientAppActor pid=2299152)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2299152)[0m epoch:  3
[36m(ClientAppActor pid=2299152)[0m train ious:  0.9875667885948761
[36m(ClientAppActor pid=2299152)[0m train dice liver:  tensor(0.9918, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m train dice tumour:  tensor(0.6162, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation ious:  0.982776438547108
[36m(ClientAppActor pid=2299152)[0m validation dice liver:  tensor(0.9900, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation dice tumour:  tensor(0.6455, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m => new best model:  3
[36m(ClientAppActor pid=2299151)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2299151)[0m epoch:  0
[36m(ClientAppActor pid=2299151)[0m train ious:  0.9858194965942209
[36m(ClientAppActor pid=2299151)[0m train dice liver:  tensor(0.9912, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m train dice tumour:  tensor(0.7598, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation ious:  0.9778857413285907
[36m(ClientAppActor pid=2299151)[0m validation dice liver:  tensor(0.9880, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation dice tumour:  tensor(0.7269, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m => new best model:  0
[36m(ClientAppActor pid=2299151)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2299151)[0m epoch:  1
[36m(ClientAppActor pid=2299151)[0m train ious:  0.9859926191572211
[36m(ClientAppActor pid=2299151)[0m train dice liver:  tensor(0.9913, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m train dice tumour:  tensor(0.7609, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation ious:  0.9776396072972958
[36m(ClientAppActor pid=2299151)[0m validation dice liver:  tensor(0.9879, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation dice tumour:  tensor(0.7273, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m => new best model:  1
[36m(ClientAppActor pid=2299151)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2299151)[0m epoch:  2
[36m(ClientAppActor pid=2299151)[0m train ious:  0.98617565717818
[36m(ClientAppActor pid=2299151)[0m train dice liver:  tensor(0.9914, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m train dice tumour:  tensor(0.7626, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation ious:  0.9775674479421501
[36m(ClientAppActor pid=2299151)[0m validation dice liver:  tensor(0.9879, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation dice tumour:  tensor(0.7278, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m => new best model:  2
[36m(ClientAppActor pid=2299151)[0m Entrei no validation 1 3
[2024-11-14 04:29:26,420][flwr][INFO] - aggregate_fit: received 2 results and 0 failures
[92mINFO [0m:      fit progress: (14, 0.0026844234867176475, OrderedDict([('ind_iou_0', 0.9785937349133783), ('ind_dice_liver_0', tensor(0.9885, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7318, dtype=torch.float64)), ('ind_iou_1', 0.9826198055439568), ('ind_dice_liver_1', tensor(0.9897, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6420, dtype=torch.float64)), ('all_iou', 0.9790736139966004), ('all_dice_liver', tensor(0.9886, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7293, dtype=torch.float64))]), 41366.59710595803)
[36m(ClientAppActor pid=2299151)[0m epoch:  3
[36m(ClientAppActor pid=2299151)[0m train ious:  0.9863543079378866
[36m(ClientAppActor pid=2299151)[0m train dice liver:  tensor(0.9915, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m train dice tumour:  tensor(0.7637, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation ious:  0.9781536266467331
[36m(ClientAppActor pid=2299151)[0m validation dice liver:  tensor(0.9883, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation dice tumour:  tensor(0.7304, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m => new best model:  3
Entrei no test
Meio do test
Fim do test
[2024-11-14 04:32:16,802][flwr][INFO] - fit progress: (14, 0.0026844234867176475, OrderedDict([('ind_iou_0', 0.9785937349133783), ('ind_dice_liver_0', tensor(0.9885, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7318, dtype=torch.float64)), ('ind_iou_1', 0.9826198055439568), ('ind_dice_liver_1', tensor(0.9897, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6420, dtype=torch.float64)), ('all_iou', 0.9790736139966004), ('all_dice_liver', tensor(0.9886, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7293, dtype=torch.float64))]), 41366.59710595803)
[92mINFO [0m:      configure_evaluate: strategy sampled 2 clients (out of 2)
[2024-11-14 04:32:16,805][flwr][INFO] - configure_evaluate: strategy sampled 2 clients (out of 2)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[36m(ClientAppActor pid=2299151)[0m Entrei no validation 1 3
[2024-11-14 04:32:27,275][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-11-14 04:32:27,275][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[2024-11-14 04:33:14,570][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-11-14 04:33:14,570][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 2 failures
[2024-11-14 04:33:14,571][flwr][INFO] - aggregate_evaluate: received 0 results and 2 failures
[92mINFO [0m:      
[2024-11-14 04:33:14,571][flwr][INFO] - 
[92mINFO [0m:      [ROUND 15]
[2024-11-14 04:33:14,571][flwr][INFO] - [ROUND 15]
[92mINFO [0m:      configure_fit: strategy sampled 2 clients (out of 2)
[2024-11-14 04:33:14,571][flwr][INFO] - configure_fit: strategy sampled 2 clients (out of 2)
[92mINFO [0m:      aggregate_fit: received 2 results and 0 failures
[36m(ClientAppActor pid=2299152)[0m Entrei no validation 1 3[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=2299152)[0m epoch:  0
[36m(ClientAppActor pid=2299152)[0m train ious:  0.9848069580495906
[36m(ClientAppActor pid=2299152)[0m train dice liver:  tensor(0.9901, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m train dice tumour:  tensor(0.6228, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation ious:  0.9824098286806501
[36m(ClientAppActor pid=2299152)[0m validation dice liver:  tensor(0.9890, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation dice tumour:  tensor(0.6391, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m => new best model:  0
[36m(ClientAppActor pid=2299152)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2299152)[0m epoch:  1
[36m(ClientAppActor pid=2299152)[0m train ious:  0.9860549583180815
[36m(ClientAppActor pid=2299152)[0m train dice liver:  tensor(0.9909, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m train dice tumour:  tensor(0.6437, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation ious:  0.9827349634088708
[36m(ClientAppActor pid=2299152)[0m validation dice liver:  tensor(0.9895, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation dice tumour:  tensor(0.6424, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m => new best model:  1
[36m(ClientAppActor pid=2299152)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2299152)[0m epoch:  2
[36m(ClientAppActor pid=2299152)[0m train ious:  0.9875214672817905
[36m(ClientAppActor pid=2299152)[0m train dice liver:  tensor(0.9918, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m train dice tumour:  tensor(0.6399, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation ious:  0.9830283490934925
[36m(ClientAppActor pid=2299152)[0m validation dice liver:  tensor(0.9900, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation dice tumour:  tensor(0.6472, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m => new best model:  2
[36m(ClientAppActor pid=2299152)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2299152)[0m epoch:  3
[36m(ClientAppActor pid=2299152)[0m train ious:  0.9879260376325552
[36m(ClientAppActor pid=2299152)[0m train dice liver:  tensor(0.9921, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m train dice tumour:  tensor(0.6262, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation ious:  0.9826795582410355
[36m(ClientAppActor pid=2299152)[0m validation dice liver:  tensor(0.9901, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation dice tumour:  tensor(0.6469, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m => new best model:  3
[36m(ClientAppActor pid=2299151)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2299151)[0m epoch:  0
[36m(ClientAppActor pid=2299151)[0m train ious:  0.9865601275630378
[36m(ClientAppActor pid=2299151)[0m train dice liver:  tensor(0.9916, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m train dice tumour:  tensor(0.7589, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation ious:  0.9782814431737151
[36m(ClientAppActor pid=2299151)[0m validation dice liver:  tensor(0.9885, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation dice tumour:  tensor(0.7280, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m => new best model:  0
[36m(ClientAppActor pid=2299151)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2299151)[0m epoch:  1
[36m(ClientAppActor pid=2299151)[0m train ious:  0.9867452321497008
[36m(ClientAppActor pid=2299151)[0m train dice liver:  tensor(0.9917, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m train dice tumour:  tensor(0.7628, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation ious:  0.9783636526835362
[36m(ClientAppActor pid=2299151)[0m validation dice liver:  tensor(0.9884, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation dice tumour:  tensor(0.7288, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m => new best model:  1
[36m(ClientAppActor pid=2299151)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2299151)[0m epoch:  2
[36m(ClientAppActor pid=2299151)[0m train ious:  0.9863256082904603
[36m(ClientAppActor pid=2299151)[0m train dice liver:  tensor(0.9915, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m train dice tumour:  tensor(0.7527, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation ious:  0.9787338037687264
[36m(ClientAppActor pid=2299151)[0m validation dice liver:  tensor(0.9888, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation dice tumour:  tensor(0.7292, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m => new best model:  2
[36m(ClientAppActor pid=2299151)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2299151)[0m epoch:  3
[36m(ClientAppActor pid=2299151)[0m train ious:  0.987282961630652
[36m(ClientAppActor pid=2299151)[0m train dice liver:  tensor(0.9921, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m train dice tumour:  tensor(0.7662, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation ious:  0.9786702759774473
[36m(ClientAppActor pid=2299151)[0m validation dice liver:  tensor(0.9886, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation dice tumour:  tensor(0.7289, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m => new best model:  3
[2024-11-14 05:09:23,179][flwr][INFO] - aggregate_fit: received 2 results and 0 failures
[92mINFO [0m:      fit progress: (15, 0.002677192204998968, OrderedDict([('ind_iou_0', 0.9790503467111803), ('ind_dice_liver_0', tensor(0.9888, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7306, dtype=torch.float64)), ('ind_iou_1', 0.983558259031719), ('ind_dice_liver_1', tensor(0.9902, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6447, dtype=torch.float64)), ('all_iou', 0.979531098826283), ('all_dice_liver', tensor(0.9890, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7310, dtype=torch.float64))]), 43762.99801960308)
Entrei no test
Meio do test
Fim do test
[2024-11-14 05:12:13,203][flwr][INFO] - fit progress: (15, 0.002677192204998968, OrderedDict([('ind_iou_0', 0.9790503467111803), ('ind_dice_liver_0', tensor(0.9888, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7306, dtype=torch.float64)), ('ind_iou_1', 0.983558259031719), ('ind_dice_liver_1', tensor(0.9902, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6447, dtype=torch.float64)), ('all_iou', 0.979531098826283), ('all_dice_liver', tensor(0.9890, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7310, dtype=torch.float64))]), 43762.99801960308)
[92mINFO [0m:      configure_evaluate: strategy sampled 2 clients (out of 2)
[2024-11-14 05:12:13,207][flwr][INFO] - configure_evaluate: strategy sampled 2 clients (out of 2)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[36m(ClientAppActor pid=2299151)[0m Entrei no validation 1 3
[2024-11-14 05:12:22,873][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-11-14 05:12:22,874][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[2024-11-14 05:13:11,651][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-11-14 05:13:11,651][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 2 failures
[2024-11-14 05:13:11,651][flwr][INFO] - aggregate_evaluate: received 0 results and 2 failures
[92mINFO [0m:      
[2024-11-14 05:13:11,652][flwr][INFO] - 
[92mINFO [0m:      [ROUND 16]
[2024-11-14 05:13:11,652][flwr][INFO] - [ROUND 16]
[92mINFO [0m:      configure_fit: strategy sampled 2 clients (out of 2)
[2024-11-14 05:13:11,652][flwr][INFO] - configure_fit: strategy sampled 2 clients (out of 2)
[92mINFO [0m:      aggregate_fit: received 2 results and 0 failures
[36m(ClientAppActor pid=2299151)[0m Entrei no validation 1 3[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=2299151)[0m epoch:  0
[36m(ClientAppActor pid=2299151)[0m train ious:  0.9855714575588607
[36m(ClientAppActor pid=2299151)[0m train dice liver:  tensor(0.9905, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m train dice tumour:  tensor(0.6378, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation ious:  0.9835621370010957
[36m(ClientAppActor pid=2299151)[0m validation dice liver:  tensor(0.9897, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation dice tumour:  tensor(0.6442, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m => new best model:  0
[36m(ClientAppActor pid=2299151)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2299151)[0m epoch:  1
[36m(ClientAppActor pid=2299151)[0m train ious:  0.9869356493961267
[36m(ClientAppActor pid=2299151)[0m train dice liver:  tensor(0.9914, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m train dice tumour:  tensor(0.6242, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation ious:  0.9828779339491307
[36m(ClientAppActor pid=2299151)[0m validation dice liver:  tensor(0.9898, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation dice tumour:  tensor(0.6430, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m => new best model:  1
[36m(ClientAppActor pid=2299151)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2299151)[0m epoch:  2
[36m(ClientAppActor pid=2299151)[0m train ious:  0.9874769016580278
[36m(ClientAppActor pid=2299151)[0m train dice liver:  tensor(0.9918, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m train dice tumour:  tensor(0.6313, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation ious:  0.9830885533245172
[36m(ClientAppActor pid=2299151)[0m validation dice liver:  tensor(0.9899, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation dice tumour:  tensor(0.6481, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m => new best model:  2
[36m(ClientAppActor pid=2299151)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2299151)[0m epoch:  3
[36m(ClientAppActor pid=2299151)[0m train ious:  0.9881699944724989
[36m(ClientAppActor pid=2299151)[0m train dice liver:  tensor(0.9923, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m train dice tumour:  tensor(0.6493, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation ious:  0.9835853829216822
[36m(ClientAppActor pid=2299151)[0m validation dice liver:  tensor(0.9905, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation dice tumour:  tensor(0.6512, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m => new best model:  3
[36m(ClientAppActor pid=2299152)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2299152)[0m epoch:  0
[36m(ClientAppActor pid=2299152)[0m train ious:  0.9872877828480486
[36m(ClientAppActor pid=2299152)[0m train dice liver:  tensor(0.9921, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m train dice tumour:  tensor(0.7712, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation ious:  0.9787947126550047
[36m(ClientAppActor pid=2299152)[0m validation dice liver:  tensor(0.9887, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation dice tumour:  tensor(0.7330, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m => new best model:  0
[36m(ClientAppActor pid=2299152)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2299152)[0m epoch:  1
[36m(ClientAppActor pid=2299152)[0m train ious:  0.9871971202169659
[36m(ClientAppActor pid=2299152)[0m train dice liver:  tensor(0.9920, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m train dice tumour:  tensor(0.7670, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation ious:  0.9787168950165736
[36m(ClientAppActor pid=2299152)[0m validation dice liver:  tensor(0.9887, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation dice tumour:  tensor(0.7280, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m => new best model:  1
[36m(ClientAppActor pid=2299152)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2299152)[0m epoch:  2
[36m(ClientAppActor pid=2299152)[0m train ious:  0.987522996238769
[36m(ClientAppActor pid=2299152)[0m train dice liver:  tensor(0.9922, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m train dice tumour:  tensor(0.7752, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation ious:  0.9788150416459915
[36m(ClientAppActor pid=2299152)[0m validation dice liver:  tensor(0.9888, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation dice tumour:  tensor(0.7312, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m => new best model:  2
[36m(ClientAppActor pid=2299152)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2299152)[0m epoch:  3
[36m(ClientAppActor pid=2299152)[0m train ious:  0.9876310853716597
[36m(ClientAppActor pid=2299152)[0m train dice liver:  tensor(0.9923, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m train dice tumour:  tensor(0.7632, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation ious:  0.9789626433310781
[36m(ClientAppActor pid=2299152)[0m validation dice liver:  tensor(0.9889, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation dice tumour:  tensor(0.7328, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m => new best model:  3
[2024-11-14 05:49:10,150][flwr][INFO] - aggregate_fit: received 2 results and 0 failures
[92mINFO [0m:      fit progress: (16, 0.0026856854315332216, OrderedDict([('ind_iou_0', 0.9793385838207589), ('ind_dice_liver_0', tensor(0.9891, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7339, dtype=torch.float64)), ('ind_iou_1', 0.9836333441805486), ('ind_dice_liver_1', tensor(0.9905, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6444, dtype=torch.float64)), ('all_iou', 0.9797946244865164), ('all_dice_liver', tensor(0.9893, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7328, dtype=torch.float64))]), 46149.41734182183)
Entrei no test
Meio do test
Fim do test
[2024-11-14 05:51:59,622][flwr][INFO] - fit progress: (16, 0.0026856854315332216, OrderedDict([('ind_iou_0', 0.9793385838207589), ('ind_dice_liver_0', tensor(0.9891, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7339, dtype=torch.float64)), ('ind_iou_1', 0.9836333441805486), ('ind_dice_liver_1', tensor(0.9905, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6444, dtype=torch.float64)), ('all_iou', 0.9797946244865164), ('all_dice_liver', tensor(0.9893, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7328, dtype=torch.float64))]), 46149.41734182183)
[92mINFO [0m:      configure_evaluate: strategy sampled 2 clients (out of 2)
[2024-11-14 05:51:59,626][flwr][INFO] - configure_evaluate: strategy sampled 2 clients (out of 2)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[36m(ClientAppActor pid=2299151)[0m Entrei no validation 1 3
[2024-11-14 05:52:11,498][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-11-14 05:52:11,499][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[2024-11-14 05:52:57,714][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-11-14 05:52:57,714][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 2 failures
[2024-11-14 05:52:57,714][flwr][INFO] - aggregate_evaluate: received 0 results and 2 failures
[92mINFO [0m:      
[2024-11-14 05:52:57,715][flwr][INFO] - 
[92mINFO [0m:      [ROUND 17]
[2024-11-14 05:52:57,715][flwr][INFO] - [ROUND 17]
[92mINFO [0m:      configure_fit: strategy sampled 2 clients (out of 2)
[2024-11-14 05:52:57,715][flwr][INFO] - configure_fit: strategy sampled 2 clients (out of 2)
[92mINFO [0m:      aggregate_fit: received 2 results and 0 failures
[36m(ClientAppActor pid=2299151)[0m Entrei no validation 1 3[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=2299151)[0m epoch:  0
[36m(ClientAppActor pid=2299151)[0m train ious:  0.9856361524116355
[36m(ClientAppActor pid=2299151)[0m train dice liver:  tensor(0.9906, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m train dice tumour:  tensor(0.6274, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation ious:  0.9832063692623635
[36m(ClientAppActor pid=2299151)[0m validation dice liver:  tensor(0.9897, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation dice tumour:  tensor(0.6467, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m => new best model:  0
[36m(ClientAppActor pid=2299151)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2299151)[0m epoch:  1
[36m(ClientAppActor pid=2299151)[0m train ious:  0.9873389768939218
[36m(ClientAppActor pid=2299151)[0m train dice liver:  tensor(0.9917, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m train dice tumour:  tensor(0.6238, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation ious:  0.9841549784538329
[36m(ClientAppActor pid=2299151)[0m validation dice liver:  tensor(0.9904, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation dice tumour:  tensor(0.6557, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m => new best model:  1
[36m(ClientAppActor pid=2299151)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2299151)[0m epoch:  2
[36m(ClientAppActor pid=2299151)[0m train ious:  0.9878925797296938
[36m(ClientAppActor pid=2299151)[0m train dice liver:  tensor(0.9921, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m train dice tumour:  tensor(0.6382, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation ious:  0.9835258794614293
[36m(ClientAppActor pid=2299151)[0m validation dice liver:  tensor(0.9904, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation dice tumour:  tensor(0.6535, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m => new best model:  2
[36m(ClientAppActor pid=2299151)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2299151)[0m epoch:  3
[36m(ClientAppActor pid=2299151)[0m train ious:  0.9888609545441793
[36m(ClientAppActor pid=2299151)[0m train dice liver:  tensor(0.9927, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m train dice tumour:  tensor(0.6237, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation ious:  0.9839161755840048
[36m(ClientAppActor pid=2299151)[0m validation dice liver:  tensor(0.9908, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation dice tumour:  tensor(0.6599, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m => new best model:  3
[36m(ClientAppActor pid=2299152)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2299152)[0m epoch:  0
[36m(ClientAppActor pid=2299152)[0m train ious:  0.9877683929661972
[36m(ClientAppActor pid=2299152)[0m train dice liver:  tensor(0.9924, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m train dice tumour:  tensor(0.7677, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation ious:  0.9789877437983088
[36m(ClientAppActor pid=2299152)[0m validation dice liver:  tensor(0.9890, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation dice tumour:  tensor(0.7329, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m => new best model:  0
[36m(ClientAppActor pid=2299152)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2299152)[0m epoch:  1
[36m(ClientAppActor pid=2299152)[0m train ious:  0.987800257867398
[36m(ClientAppActor pid=2299152)[0m train dice liver:  tensor(0.9924, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m train dice tumour:  tensor(0.7639, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation ious:  0.9790099547715919
[36m(ClientAppActor pid=2299152)[0m validation dice liver:  tensor(0.9891, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation dice tumour:  tensor(0.7319, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m => new best model:  1
[36m(ClientAppActor pid=2299152)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2299152)[0m epoch:  2
[36m(ClientAppActor pid=2299152)[0m train ious:  0.98811117585574
[36m(ClientAppActor pid=2299152)[0m train dice liver:  tensor(0.9926, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m train dice tumour:  tensor(0.7783, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation ious:  0.9788714765748667
[36m(ClientAppActor pid=2299152)[0m validation dice liver:  tensor(0.9890, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation dice tumour:  tensor(0.7330, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m => new best model:  2
[36m(ClientAppActor pid=2299152)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2299152)[0m epoch:  3
[36m(ClientAppActor pid=2299152)[0m train ious:  0.988208249640833
[36m(ClientAppActor pid=2299152)[0m train dice liver:  tensor(0.9927, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m train dice tumour:  tensor(0.7714, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation ious:  0.9790875058719816
[36m(ClientAppActor pid=2299152)[0m validation dice liver:  tensor(0.9891, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation dice tumour:  tensor(0.7318, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m => new best model:  3
[2024-11-14 06:29:07,111][flwr][INFO] - aggregate_fit: received 2 results and 0 failures
[92mINFO [0m:      fit progress: (17, 0.0027445526089985477, OrderedDict([('ind_iou_0', 0.9794510196938129), ('ind_dice_liver_0', tensor(0.9893, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7334, dtype=torch.float64)), ('ind_iou_1', 0.984240791462803), ('ind_dice_liver_1', tensor(0.9909, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6461, dtype=torch.float64)), ('all_iou', 0.9799374903605863), ('all_dice_liver', tensor(0.9894, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7328, dtype=torch.float64))]), 48546.91979381675)
Entrei no test
Meio do test
Fim do test
[2024-11-14 06:31:57,125][flwr][INFO] - fit progress: (17, 0.0027445526089985477, OrderedDict([('ind_iou_0', 0.9794510196938129), ('ind_dice_liver_0', tensor(0.9893, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7334, dtype=torch.float64)), ('ind_iou_1', 0.984240791462803), ('ind_dice_liver_1', tensor(0.9909, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6461, dtype=torch.float64)), ('all_iou', 0.9799374903605863), ('all_dice_liver', tensor(0.9894, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7328, dtype=torch.float64))]), 48546.91979381675)
[92mINFO [0m:      configure_evaluate: strategy sampled 2 clients (out of 2)
[2024-11-14 06:31:57,128][flwr][INFO] - configure_evaluate: strategy sampled 2 clients (out of 2)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[36m(ClientAppActor pid=2299152)[0m Entrei no validation 1 3
[2024-11-14 06:32:08,141][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-11-14 06:32:08,141][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[2024-11-14 06:32:55,509][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-11-14 06:32:55,509][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 2 failures
[2024-11-14 06:32:55,510][flwr][INFO] - aggregate_evaluate: received 0 results and 2 failures
[92mINFO [0m:      
[2024-11-14 06:32:55,510][flwr][INFO] - 
[92mINFO [0m:      [ROUND 18]
[2024-11-14 06:32:55,510][flwr][INFO] - [ROUND 18]
[92mINFO [0m:      configure_fit: strategy sampled 2 clients (out of 2)
[2024-11-14 06:32:55,510][flwr][INFO] - configure_fit: strategy sampled 2 clients (out of 2)
[92mINFO [0m:      aggregate_fit: received 2 results and 0 failures
[36m(ClientAppActor pid=2299152)[0m Entrei no validation 1 3[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=2299152)[0m epoch:  0
[36m(ClientAppActor pid=2299152)[0m train ious:  0.9866021289449786
[36m(ClientAppActor pid=2299152)[0m train dice liver:  tensor(0.9912, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m train dice tumour:  tensor(0.6402, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation ious:  0.9842990874978306
[36m(ClientAppActor pid=2299152)[0m validation dice liver:  tensor(0.9902, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation dice tumour:  tensor(0.6494, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m => new best model:  0
[36m(ClientAppActor pid=2299152)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2299152)[0m epoch:  1
[36m(ClientAppActor pid=2299152)[0m train ious:  0.9878575500893609
[36m(ClientAppActor pid=2299152)[0m train dice liver:  tensor(0.9920, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m train dice tumour:  tensor(0.6484, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation ious:  0.9830560224598599
[36m(ClientAppActor pid=2299152)[0m validation dice liver:  tensor(0.9900, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation dice tumour:  tensor(0.6479, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m => new best model:  1
[36m(ClientAppActor pid=2299152)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2299152)[0m epoch:  2
[36m(ClientAppActor pid=2299152)[0m train ious:  0.9883988164871095
[36m(ClientAppActor pid=2299152)[0m train dice liver:  tensor(0.9924, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m train dice tumour:  tensor(0.6443, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation ious:  0.9847119618102713
[36m(ClientAppActor pid=2299152)[0m validation dice liver:  tensor(0.9910, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation dice tumour:  tensor(0.6505, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m => new best model:  2
[36m(ClientAppActor pid=2299152)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2299152)[0m epoch:  3
[36m(ClientAppActor pid=2299152)[0m train ious:  0.9889320514345943
[36m(ClientAppActor pid=2299152)[0m train dice liver:  tensor(0.9927, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m train dice tumour:  tensor(0.6440, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation ious:  0.9834739113965967
[36m(ClientAppActor pid=2299152)[0m validation dice liver:  tensor(0.9903, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation dice tumour:  tensor(0.6581, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m => new best model:  3
[36m(ClientAppActor pid=2299151)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2299151)[0m epoch:  0
[36m(ClientAppActor pid=2299151)[0m train ious:  0.9883490189862069
[36m(ClientAppActor pid=2299151)[0m train dice liver:  tensor(0.9928, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m train dice tumour:  tensor(0.7798, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation ious:  0.9791786269048075
[36m(ClientAppActor pid=2299151)[0m validation dice liver:  tensor(0.9891, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation dice tumour:  tensor(0.7329, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m => new best model:  0
[36m(ClientAppActor pid=2299151)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2299151)[0m epoch:  1
[36m(ClientAppActor pid=2299151)[0m train ious:  0.988451542980446
[36m(ClientAppActor pid=2299151)[0m train dice liver:  tensor(0.9928, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m train dice tumour:  tensor(0.7747, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation ious:  0.9791119123882538
[36m(ClientAppActor pid=2299151)[0m validation dice liver:  tensor(0.9891, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation dice tumour:  tensor(0.7349, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m => new best model:  1
[36m(ClientAppActor pid=2299151)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2299151)[0m epoch:  2
[36m(ClientAppActor pid=2299151)[0m train ious:  0.9885458547558583
[36m(ClientAppActor pid=2299151)[0m train dice liver:  tensor(0.9929, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m train dice tumour:  tensor(0.7720, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation ious:  0.9794180973506176
[36m(ClientAppActor pid=2299151)[0m validation dice liver:  tensor(0.9894, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation dice tumour:  tensor(0.7364, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m => new best model:  2
[36m(ClientAppActor pid=2299151)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2299151)[0m epoch:  3
[36m(ClientAppActor pid=2299151)[0m train ious:  0.9887368202236122
[36m(ClientAppActor pid=2299151)[0m train dice liver:  tensor(0.9930, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m train dice tumour:  tensor(0.7779, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation ious:  0.9791198643036875
[36m(ClientAppActor pid=2299151)[0m validation dice liver:  tensor(0.9892, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation dice tumour:  tensor(0.7353, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m => new best model:  3
[2024-11-14 07:20:40,080][flwr][INFO] - aggregate_fit: received 2 results and 0 failures
[92mINFO [0m:      fit progress: (18, 0.0027192615363503254, OrderedDict([('ind_iou_0', 0.9794821948883415), ('ind_dice_liver_0', tensor(0.9893, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7369, dtype=torch.float64)), ('ind_iou_1', 0.9843073192021001), ('ind_dice_liver_1', tensor(0.9910, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6479, dtype=torch.float64)), ('all_iou', 0.9800040724010971), ('all_dice_liver', tensor(0.9895, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7346, dtype=torch.float64))]), 51709.343151121866)
Entrei no test
Meio do test
Fim do test
[2024-11-14 07:24:39,548][flwr][INFO] - fit progress: (18, 0.0027192615363503254, OrderedDict([('ind_iou_0', 0.9794821948883415), ('ind_dice_liver_0', tensor(0.9893, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7369, dtype=torch.float64)), ('ind_iou_1', 0.9843073192021001), ('ind_dice_liver_1', tensor(0.9910, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6479, dtype=torch.float64)), ('all_iou', 0.9800040724010971), ('all_dice_liver', tensor(0.9895, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7346, dtype=torch.float64))]), 51709.343151121866)
[92mINFO [0m:      configure_evaluate: strategy sampled 2 clients (out of 2)
[2024-11-14 07:24:39,553][flwr][INFO] - configure_evaluate: strategy sampled 2 clients (out of 2)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[36m(ClientAppActor pid=2299151)[0m Entrei no validation 1 3
[2024-11-14 07:24:55,153][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-11-14 07:24:55,154][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[2024-11-14 07:26:06,464][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-11-14 07:26:06,464][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 2 failures
[2024-11-14 07:26:06,465][flwr][INFO] - aggregate_evaluate: received 0 results and 2 failures
[92mINFO [0m:      
[2024-11-14 07:26:06,465][flwr][INFO] - 
[92mINFO [0m:      [ROUND 19]
[2024-11-14 07:26:06,465][flwr][INFO] - [ROUND 19]
[92mINFO [0m:      configure_fit: strategy sampled 2 clients (out of 2)
[2024-11-14 07:26:06,466][flwr][INFO] - configure_fit: strategy sampled 2 clients (out of 2)
[92mINFO [0m:      aggregate_fit: received 2 results and 0 failures
[36m(ClientAppActor pid=2299152)[0m Entrei no validation 1 3[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=2299152)[0m epoch:  0
[36m(ClientAppActor pid=2299152)[0m train ious:  0.9869503763117757
[36m(ClientAppActor pid=2299152)[0m train dice liver:  tensor(0.9915, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m train dice tumour:  tensor(0.6435, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation ious:  0.9843840014226692
[36m(ClientAppActor pid=2299152)[0m validation dice liver:  tensor(0.9901, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation dice tumour:  tensor(0.6509, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m => new best model:  0
[36m(ClientAppActor pid=2299152)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2299152)[0m epoch:  1
[36m(ClientAppActor pid=2299152)[0m train ious:  0.9883202781229281
[36m(ClientAppActor pid=2299152)[0m train dice liver:  tensor(0.9923, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m train dice tumour:  tensor(0.6422, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation ious:  0.9849077704245903
[36m(ClientAppActor pid=2299152)[0m validation dice liver:  tensor(0.9909, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation dice tumour:  tensor(0.6457, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m => new best model:  1
[36m(ClientAppActor pid=2299152)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2299152)[0m epoch:  2
[36m(ClientAppActor pid=2299152)[0m train ious:  0.9891754617894111
[36m(ClientAppActor pid=2299152)[0m train dice liver:  tensor(0.9929, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m train dice tumour:  tensor(0.6355, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation ious:  0.9850621172731578
[36m(ClientAppActor pid=2299152)[0m validation dice liver:  tensor(0.9912, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation dice tumour:  tensor(0.6556, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m => new best model:  2
[36m(ClientAppActor pid=2299152)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2299152)[0m epoch:  3
[36m(ClientAppActor pid=2299152)[0m train ious:  0.9896917675005101
[36m(ClientAppActor pid=2299152)[0m train dice liver:  tensor(0.9933, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m train dice tumour:  tensor(0.6374, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation ious:  0.9849632432999846
[36m(ClientAppActor pid=2299152)[0m validation dice liver:  tensor(0.9913, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation dice tumour:  tensor(0.6550, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m => new best model:  3
[36m(ClientAppActor pid=2299151)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2299151)[0m epoch:  0
[36m(ClientAppActor pid=2299151)[0m train ious:  0.9889593328546773
[36m(ClientAppActor pid=2299151)[0m train dice liver:  tensor(0.9931, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m train dice tumour:  tensor(0.7771, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation ious:  0.9795427372745267
[36m(ClientAppActor pid=2299151)[0m validation dice liver:  tensor(0.9895, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation dice tumour:  tensor(0.7334, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m => new best model:  0
[36m(ClientAppActor pid=2299151)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2299151)[0m epoch:  1
[36m(ClientAppActor pid=2299151)[0m train ious:  0.9889299003071041
[36m(ClientAppActor pid=2299151)[0m train dice liver:  tensor(0.9931, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m train dice tumour:  tensor(0.7701, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation ious:  0.979454657733385
[36m(ClientAppActor pid=2299151)[0m validation dice liver:  tensor(0.9894, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation dice tumour:  tensor(0.7365, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m => new best model:  1
[36m(ClientAppActor pid=2299151)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2299151)[0m epoch:  2
[36m(ClientAppActor pid=2299151)[0m train ious:  0.9890982659476055
[36m(ClientAppActor pid=2299151)[0m train dice liver:  tensor(0.9932, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m train dice tumour:  tensor(0.7813, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation ious:  0.979664815185476
[36m(ClientAppActor pid=2299151)[0m validation dice liver:  tensor(0.9896, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation dice tumour:  tensor(0.7377, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m => new best model:  2
[36m(ClientAppActor pid=2299151)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2299151)[0m epoch:  3
[36m(ClientAppActor pid=2299151)[0m train ious:  0.9891730853047608
[36m(ClientAppActor pid=2299151)[0m train dice liver:  tensor(0.9933, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m train dice tumour:  tensor(0.7812, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation ious:  0.979449984938543
[36m(ClientAppActor pid=2299151)[0m validation dice liver:  tensor(0.9895, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation dice tumour:  tensor(0.7377, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m => new best model:  3
[2024-11-14 08:24:13,068][flwr][INFO] - aggregate_fit: received 2 results and 0 failures
[92mINFO [0m:      fit progress: (19, 0.0027728084777121948, OrderedDict([('ind_iou_0', 0.979826087350437), ('ind_dice_liver_0', tensor(0.9896, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7390, dtype=torch.float64)), ('ind_iou_1', 0.985136173495047), ('ind_dice_liver_1', tensor(0.9915, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6511, dtype=torch.float64)), ('all_iou', 0.9803803087437287), ('all_dice_liver', tensor(0.9899, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7369, dtype=torch.float64))]), 55522.566752181854)
Entrei no test
Meio do test
Fim do test
[2024-11-14 08:28:12,772][flwr][INFO] - fit progress: (19, 0.0027728084777121948, OrderedDict([('ind_iou_0', 0.979826087350437), ('ind_dice_liver_0', tensor(0.9896, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7390, dtype=torch.float64)), ('ind_iou_1', 0.985136173495047), ('ind_dice_liver_1', tensor(0.9915, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6511, dtype=torch.float64)), ('all_iou', 0.9803803087437287), ('all_dice_liver', tensor(0.9899, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7369, dtype=torch.float64))]), 55522.566752181854)
[92mINFO [0m:      configure_evaluate: strategy sampled 2 clients (out of 2)
[2024-11-14 08:28:12,777][flwr][INFO] - configure_evaluate: strategy sampled 2 clients (out of 2)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[36m(ClientAppActor pid=2299151)[0m Entrei no validation 1 3
[2024-11-14 08:28:25,619][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-11-14 08:28:25,619][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-11-14 08:30:06,026][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-11-14 08:30:06,028][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 2 failures
[2024-11-14 08:30:06,028][flwr][INFO] - aggregate_evaluate: received 0 results and 2 failures
[92mINFO [0m:      
[2024-11-14 08:30:06,029][flwr][INFO] - 
[92mINFO [0m:      [ROUND 20]
[2024-11-14 08:30:06,029][flwr][INFO] - [ROUND 20]
[92mINFO [0m:      configure_fit: strategy sampled 2 clients (out of 2)
[2024-11-14 08:30:06,029][flwr][INFO] - configure_fit: strategy sampled 2 clients (out of 2)
[92mINFO [0m:      aggregate_fit: received 2 results and 0 failures
[36m(ClientAppActor pid=2299151)[0m Entrei no validation 1 3[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=2299151)[0m epoch:  0
[36m(ClientAppActor pid=2299151)[0m train ious:  0.9873931534295003
[36m(ClientAppActor pid=2299151)[0m train dice liver:  tensor(0.9917, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m train dice tumour:  tensor(0.6189, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation ious:  0.9853286375103414
[36m(ClientAppActor pid=2299151)[0m validation dice liver:  tensor(0.9911, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation dice tumour:  tensor(0.6527, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m => new best model:  0
[36m(ClientAppActor pid=2299151)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2299151)[0m epoch:  1
[36m(ClientAppActor pid=2299151)[0m train ious:  0.9891378011203191
[36m(ClientAppActor pid=2299151)[0m train dice liver:  tensor(0.9928, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m train dice tumour:  tensor(0.6125, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation ious:  0.9851707227103241
[36m(ClientAppActor pid=2299151)[0m validation dice liver:  tensor(0.9912, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation dice tumour:  tensor(0.6561, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m => new best model:  1
[36m(ClientAppActor pid=2299151)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2299151)[0m epoch:  2
[36m(ClientAppActor pid=2299151)[0m train ious:  0.9894064682527433
[36m(ClientAppActor pid=2299151)[0m train dice liver:  tensor(0.9930, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m train dice tumour:  tensor(0.6198, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation ious:  0.9848469176634725
[36m(ClientAppActor pid=2299151)[0m validation dice liver:  tensor(0.9912, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation dice tumour:  tensor(0.6530, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m => new best model:  2
[36m(ClientAppActor pid=2299151)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2299151)[0m epoch:  3
[36m(ClientAppActor pid=2299151)[0m train ious:  0.9898661144141234
[36m(ClientAppActor pid=2299151)[0m train dice liver:  tensor(0.9934, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m train dice tumour:  tensor(0.6607, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation ious:  0.9852777551981511
[36m(ClientAppActor pid=2299151)[0m validation dice liver:  tensor(0.9915, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation dice tumour:  tensor(0.6530, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m => new best model:  3
[36m(ClientAppActor pid=2299152)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2299152)[0m epoch:  0
[36m(ClientAppActor pid=2299152)[0m train ious:  0.9893547257437542
[36m(ClientAppActor pid=2299152)[0m train dice liver:  tensor(0.9934, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m train dice tumour:  tensor(0.7763, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation ious:  0.9795785741618288
[36m(ClientAppActor pid=2299152)[0m validation dice liver:  tensor(0.9896, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation dice tumour:  tensor(0.7371, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m => new best model:  0
[36m(ClientAppActor pid=2299152)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2299152)[0m epoch:  1
[36m(ClientAppActor pid=2299152)[0m train ious:  0.9893514890474678
[36m(ClientAppActor pid=2299152)[0m train dice liver:  tensor(0.9934, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m train dice tumour:  tensor(0.7789, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation ious:  0.9798477156148584
[36m(ClientAppActor pid=2299152)[0m validation dice liver:  tensor(0.9897, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation dice tumour:  tensor(0.7390, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m => new best model:  1
[36m(ClientAppActor pid=2299152)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2299152)[0m epoch:  2
[36m(ClientAppActor pid=2299152)[0m train ious:  0.9895026398096235
[36m(ClientAppActor pid=2299152)[0m train dice liver:  tensor(0.9934, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m train dice tumour:  tensor(0.7769, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation ious:  0.9796576065298043
[36m(ClientAppActor pid=2299152)[0m validation dice liver:  tensor(0.9896, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation dice tumour:  tensor(0.7377, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m => new best model:  2
[36m(ClientAppActor pid=2299152)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2299152)[0m epoch:  3
[36m(ClientAppActor pid=2299152)[0m train ious:  0.989572871834296
[36m(ClientAppActor pid=2299152)[0m train dice liver:  tensor(0.9935, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m train dice tumour:  tensor(0.7785, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation ious:  0.9798210974778372
[36m(ClientAppActor pid=2299152)[0m validation dice liver:  tensor(0.9898, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation dice tumour:  tensor(0.7392, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m => new best model:  3
[2024-11-14 09:25:57,371][flwr][INFO] - aggregate_fit: received 2 results and 0 failures
[92mINFO [0m:      fit progress: (20, 0.002832774541149188, OrderedDict([('ind_iou_0', 0.9801664941591962), ('ind_dice_liver_0', tensor(0.9899, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7405, dtype=torch.float64)), ('ind_iou_1', 0.9851664910123269), ('ind_dice_liver_1', tensor(0.9917, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6496, dtype=torch.float64)), ('all_iou', 0.9806830832983348), ('all_dice_liver', tensor(0.9901, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7388, dtype=torch.float64))]), 59244.0475297682)
Entrei no test
Meio do test
Fim do test
[2024-11-14 09:30:14,252][flwr][INFO] - fit progress: (20, 0.002832774541149188, OrderedDict([('ind_iou_0', 0.9801664941591962), ('ind_dice_liver_0', tensor(0.9899, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7405, dtype=torch.float64)), ('ind_iou_1', 0.9851664910123269), ('ind_dice_liver_1', tensor(0.9917, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6496, dtype=torch.float64)), ('all_iou', 0.9806830832983348), ('all_dice_liver', tensor(0.9901, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7388, dtype=torch.float64))]), 59244.0475297682)
[92mINFO [0m:      configure_evaluate: strategy sampled 2 clients (out of 2)
[2024-11-14 09:30:14,278][flwr][INFO] - configure_evaluate: strategy sampled 2 clients (out of 2)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[36m(ClientAppActor pid=2299152)[0m Entrei no validation 1 3
[2024-11-14 09:30:30,621][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-11-14 09:30:30,625][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[2024-11-14 09:33:06,698][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-11-14 09:33:06,699][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 2 failures
[2024-11-14 09:33:06,700][flwr][INFO] - aggregate_evaluate: received 0 results and 2 failures
[92mINFO [0m:      
[2024-11-14 09:33:06,701][flwr][INFO] - 
[92mINFO [0m:      [ROUND 21]
[2024-11-14 09:33:06,701][flwr][INFO] - [ROUND 21]
[92mINFO [0m:      configure_fit: strategy sampled 2 clients (out of 2)
[2024-11-14 09:33:06,702][flwr][INFO] - configure_fit: strategy sampled 2 clients (out of 2)
[92mINFO [0m:      aggregate_fit: received 2 results and 0 failures
[36m(ClientAppActor pid=2299152)[0m Entrei no validation 1 3[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=2299152)[0m epoch:  0
[36m(ClientAppActor pid=2299152)[0m train ious:  0.9876947561412845
[36m(ClientAppActor pid=2299152)[0m train dice liver:  tensor(0.9919, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m train dice tumour:  tensor(0.6254, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation ious:  0.9850459544366145
[36m(ClientAppActor pid=2299152)[0m validation dice liver:  tensor(0.9907, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation dice tumour:  tensor(0.6463, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m => new best model:  0
[36m(ClientAppActor pid=2299152)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2299152)[0m epoch:  1
[36m(ClientAppActor pid=2299152)[0m train ious:  0.9888815937009525
[36m(ClientAppActor pid=2299152)[0m train dice liver:  tensor(0.9927, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m train dice tumour:  tensor(0.6472, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation ious:  0.9850965064496537
[36m(ClientAppActor pid=2299152)[0m validation dice liver:  tensor(0.9911, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation dice tumour:  tensor(0.6475, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m => new best model:  1
[36m(ClientAppActor pid=2299152)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2299152)[0m epoch:  2
[36m(ClientAppActor pid=2299152)[0m train ious:  0.988801562012035
[36m(ClientAppActor pid=2299152)[0m train dice liver:  tensor(0.9926, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m train dice tumour:  tensor(0.6505, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation ious:  0.9852360538318966
[36m(ClientAppActor pid=2299152)[0m validation dice liver:  tensor(0.9912, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation dice tumour:  tensor(0.6537, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m => new best model:  2
[36m(ClientAppActor pid=2299152)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2299152)[0m epoch:  3
[36m(ClientAppActor pid=2299152)[0m train ious:  0.9900711176055019
[36m(ClientAppActor pid=2299152)[0m train dice liver:  tensor(0.9934, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m train dice tumour:  tensor(0.6365, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation ious:  0.9856192731336921
[36m(ClientAppActor pid=2299152)[0m validation dice liver:  tensor(0.9916, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation dice tumour:  tensor(0.6613, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m => new best model:  3
[36m(ClientAppActor pid=2299151)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2299151)[0m epoch:  0
[36m(ClientAppActor pid=2299151)[0m train ious:  0.9897588060089214
[36m(ClientAppActor pid=2299151)[0m train dice liver:  tensor(0.9936, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m train dice tumour:  tensor(0.7865, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation ious:  0.9799619228932523
[36m(ClientAppActor pid=2299151)[0m validation dice liver:  tensor(0.9898, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation dice tumour:  tensor(0.7393, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m => new best model:  0
[36m(ClientAppActor pid=2299151)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2299151)[0m epoch:  1
[36m(ClientAppActor pid=2299151)[0m train ious:  0.9898198222319196
[36m(ClientAppActor pid=2299151)[0m train dice liver:  tensor(0.9937, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m train dice tumour:  tensor(0.7810, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation ious:  0.9795880354173768
[36m(ClientAppActor pid=2299151)[0m validation dice liver:  tensor(0.9895, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation dice tumour:  tensor(0.7361, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m => new best model:  1
[36m(ClientAppActor pid=2299151)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2299151)[0m epoch:  2
[36m(ClientAppActor pid=2299151)[0m train ious:  0.9898840281292451
[36m(ClientAppActor pid=2299151)[0m train dice liver:  tensor(0.9937, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m train dice tumour:  tensor(0.7777, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation ious:  0.9798448695858514
[36m(ClientAppActor pid=2299151)[0m validation dice liver:  tensor(0.9898, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation dice tumour:  tensor(0.7407, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m => new best model:  2
[36m(ClientAppActor pid=2299151)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2299151)[0m epoch:  3
[36m(ClientAppActor pid=2299151)[0m train ious:  
[2024-11-14 11:29:05,148][flwr][INFO] - aggregate_fit: received 2 results and 0 failures
[92mINFO [0m:      fit progress: (21, 0.0027813606576575466, OrderedDict([('ind_iou_0', 0.9802784749450095), ('ind_dice_liver_0', tensor(0.9899, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7385, dtype=torch.float64)), ('ind_iou_1', 0.9857906498290747), ('ind_dice_liver_1', tensor(0.9919, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6481, dtype=torch.float64)), ('all_iou', 0.9808755816546609), ('all_dice_liver', tensor(0.9902, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7379, dtype=torch.float64))]), 66846.66955043189)
[36m(ClientAppActor pid=2299151)[0m 0.9899582500917864
[36m(ClientAppActor pid=2299151)[0m train dice liver:  tensor(0.9937, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m train dice tumour:  tensor(0.7792, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation ious:  0.97993439535091
[36m(ClientAppActor pid=2299151)[0m validation dice liver:  tensor(0.9898, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation dice tumour:  tensor(0.7370, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m => new best model:  3
Entrei no test
Meio do test
Fim do test
[2024-11-14 11:36:56,874][flwr][INFO] - fit progress: (21, 0.0027813606576575466, OrderedDict([('ind_iou_0', 0.9802784749450095), ('ind_dice_liver_0', tensor(0.9899, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7385, dtype=torch.float64)), ('ind_iou_1', 0.9857906498290747), ('ind_dice_liver_1', tensor(0.9919, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6481, dtype=torch.float64)), ('all_iou', 0.9808755816546609), ('all_dice_liver', tensor(0.9902, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7379, dtype=torch.float64))]), 66846.66955043189)
[92mINFO [0m:      configure_evaluate: strategy sampled 2 clients (out of 2)
[2024-11-14 11:36:56,931][flwr][INFO] - configure_evaluate: strategy sampled 2 clients (out of 2)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[36m(ClientAppActor pid=2299151)[0m Entrei no validation 1 3
[2024-11-14 11:37:08,265][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-11-14 11:37:08,265][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[2024-11-14 11:37:57,917][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-11-14 11:37:57,918][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 2 failures
[2024-11-14 11:37:57,918][flwr][INFO] - aggregate_evaluate: received 0 results and 2 failures
[92mINFO [0m:      
[2024-11-14 11:37:57,918][flwr][INFO] - 
[92mINFO [0m:      [ROUND 22]
[2024-11-14 11:37:57,918][flwr][INFO] - [ROUND 22]
[92mINFO [0m:      configure_fit: strategy sampled 2 clients (out of 2)
[2024-11-14 11:37:57,918][flwr][INFO] - configure_fit: strategy sampled 2 clients (out of 2)
[92mINFO [0m:      aggregate_fit: received 2 results and 0 failures
[36m(ClientAppActor pid=2299151)[0m Entrei no validation 1 3[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=2299151)[0m epoch:  0
[36m(ClientAppActor pid=2299151)[0m train ious:  0.987970054525579
[36m(ClientAppActor pid=2299151)[0m train dice liver:  tensor(0.9921, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m train dice tumour:  tensor(0.6406, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation ious:  0.9855475945806905
[36m(ClientAppActor pid=2299151)[0m validation dice liver:  tensor(0.9912, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation dice tumour:  tensor(0.6518, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m => new best model:  0
[36m(ClientAppActor pid=2299151)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2299151)[0m epoch:  1
[36m(ClientAppActor pid=2299151)[0m train ious:  0.9895019529566692
[36m(ClientAppActor pid=2299151)[0m train dice liver:  tensor(0.9931, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m train dice tumour:  tensor(0.6251, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation ious:  0.9855427111652055
[36m(ClientAppActor pid=2299151)[0m validation dice liver:  tensor(0.9914, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation dice tumour:  tensor(0.6563, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m => new best model:  1
[36m(ClientAppActor pid=2299151)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2299151)[0m epoch:  2
[36m(ClientAppActor pid=2299151)[0m train ious:  0.9899615223799441
[36m(ClientAppActor pid=2299151)[0m train dice liver:  tensor(0.9934, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m train dice tumour:  tensor(0.6291, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation ious:  0.9855579060227758
[36m(ClientAppActor pid=2299151)[0m validation dice liver:  tensor(0.9916, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation dice tumour:  tensor(0.6555, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m => new best model:  2
[36m(ClientAppActor pid=2299151)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2299151)[0m epoch:  3
[36m(ClientAppActor pid=2299151)[0m train ious:  0.990528709294233
[36m(ClientAppActor pid=2299151)[0m train dice liver:  tensor(0.9938, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m train dice tumour:  tensor(0.6711, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation ious:  0.9852106268568529
[36m(ClientAppActor pid=2299151)[0m validation dice liver:  tensor(0.9917, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation dice tumour:  tensor(0.6520, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m => new best model:  3
[36m(ClientAppActor pid=2299152)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2299152)[0m epoch:  0
[36m(ClientAppActor pid=2299152)[0m train ious:  0.9901879762249153
[36m(ClientAppActor pid=2299152)[0m train dice liver:  tensor(0.9939, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m train dice tumour:  tensor(0.7822, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation ious:  0.9799743548342391
[36m(ClientAppActor pid=2299152)[0m validation dice liver:  tensor(0.9899, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation dice tumour:  tensor(0.7394, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m => new best model:  0
[36m(ClientAppActor pid=2299152)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2299152)[0m epoch:  1
[36m(ClientAppActor pid=2299152)[0m train ious:  0.9901287695120846
[36m(ClientAppActor pid=2299152)[0m train dice liver:  tensor(0.9938, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m train dice tumour:  tensor(0.7845, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation ious:  0.9799827459326321
[36m(ClientAppActor pid=2299152)[0m validation dice liver:  tensor(0.9898, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation dice tumour:  tensor(0.7396, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m => new best model:  1
[36m(ClientAppActor pid=2299152)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2299152)[0m epoch:  2
[36m(ClientAppActor pid=2299152)[0m train ious:  0.9902241833104692
[36m(ClientAppActor pid=2299152)[0m train dice liver:  tensor(0.9939, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m train dice tumour:  tensor(0.7813, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation ious:  0.9797730169376967
[36m(ClientAppActor pid=2299152)[0m validation dice liver:  tensor(0.9898, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation dice tumour:  tensor(0.7394, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m => new best model:  2
[36m(ClientAppActor pid=2299152)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2299152)[0m epoch:  3
[36m(ClientAppActor pid=2299152)[0m train ious:  0.9903346966735246
[36m(ClientAppActor pid=2299152)[0m train dice liver:  
[36m(ClientAppActor pid=2299152)[0m tensor(0.9940, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m train dice tumour:  tensor(0.7796, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation ious:  0.9797411486404559
[36m(ClientAppActor pid=2299152)[0m validation dice liver:  tensor(0.9898, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation dice tumour:  tensor(0.7369, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m => new best model:  3
[2024-11-14 13:23:49,364][flwr][INFO] - aggregate_fit: received 2 results and 0 failures
[92mINFO [0m:      fit progress: (22, 0.0028901958734009695, OrderedDict([('ind_iou_0', 0.9801062461711252), ('ind_dice_liver_0', tensor(0.9900, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7383, dtype=torch.float64)), ('ind_iou_1', 0.9855446407348689), ('ind_dice_liver_1', tensor(0.9919, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6475, dtype=torch.float64)), ('all_iou', 0.9807049104203065), ('all_dice_liver', tensor(0.9902, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7369, dtype=torch.float64))]), 73513.41567146918)
Entrei no test
Meio do test
Fim do test
[2024-11-14 13:28:03,621][flwr][INFO] - fit progress: (22, 0.0028901958734009695, OrderedDict([('ind_iou_0', 0.9801062461711252), ('ind_dice_liver_0', tensor(0.9900, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7383, dtype=torch.float64)), ('ind_iou_1', 0.9855446407348689), ('ind_dice_liver_1', tensor(0.9919, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6475, dtype=torch.float64)), ('all_iou', 0.9807049104203065), ('all_dice_liver', tensor(0.9902, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7369, dtype=torch.float64))]), 73513.41567146918)
[92mINFO [0m:      configure_evaluate: strategy sampled 2 clients (out of 2)
[2024-11-14 13:28:03,845][flwr][INFO] - configure_evaluate: strategy sampled 2 clients (out of 2)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[36m(ClientAppActor pid=2299152)[0m Entrei no validation 1 3
[2024-11-14 13:28:14,075][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-11-14 13:28:14,076][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[2024-11-14 13:29:05,129][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-11-14 13:29:05,129][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 2 failures
[2024-11-14 13:29:05,130][flwr][INFO] - aggregate_evaluate: received 0 results and 2 failures
[92mINFO [0m:      
[2024-11-14 13:29:05,130][flwr][INFO] - 
[92mINFO [0m:      [ROUND 23]
[2024-11-14 13:29:05,130][flwr][INFO] - [ROUND 23]
[92mINFO [0m:      configure_fit: strategy sampled 2 clients (out of 2)
[2024-11-14 13:29:05,130][flwr][INFO] - configure_fit: strategy sampled 2 clients (out of 2)
[92mINFO [0m:      aggregate_fit: received 2 results and 0 failures
[36m(ClientAppActor pid=2299152)[0m Entrei no validation 1 3[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=2299152)[0m epoch:  0
[36m(ClientAppActor pid=2299152)[0m train ious:  0.9879014610658193
[36m(ClientAppActor pid=2299152)[0m train dice liver:  tensor(0.9920, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m train dice tumour:  tensor(0.6603, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation ious:  0.9858291741243373
[36m(ClientAppActor pid=2299152)[0m validation dice liver:  tensor(0.9911, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation dice tumour:  tensor(0.6552, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m => new best model:  0
[36m(ClientAppActor pid=2299152)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2299152)[0m epoch:  1
[36m(ClientAppActor pid=2299152)[0m train ious:  0.9899568181669757
[36m(ClientAppActor pid=2299152)[0m train dice liver:  tensor(0.9933, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m train dice tumour:  tensor(0.6535, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation ious:  0.986159934953597
[36m(ClientAppActor pid=2299152)[0m validation dice liver:  tensor(0.9916, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation dice tumour:  tensor(0.6559, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m => new best model:  1
[36m(ClientAppActor pid=2299152)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2299152)[0m epoch:  2
[36m(ClientAppActor pid=2299152)[0m train ious:  0.9907894042971507
[36m(ClientAppActor pid=2299152)[0m train dice liver:  tensor(0.9939, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m train dice tumour:  tensor(0.6280, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation ious:  0.985864904787077
[36m(ClientAppActor pid=2299152)[0m validation dice liver:  tensor(0.9919, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation dice tumour:  tensor(0.6607, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m => new best model:  2
[36m(ClientAppActor pid=2299152)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2299152)[0m epoch:  3
[36m(ClientAppActor pid=2299152)[0m train ious:  0.9909874675675443
[36m(ClientAppActor pid=2299152)[0m train dice liver:  tensor(0.9941, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m train dice tumour:  tensor(0.6381, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation ious:  0.9859408709994817
[36m(ClientAppActor pid=2299152)[0m validation dice liver:  tensor(0.9921, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation dice tumour:  tensor(0.6626, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m => new best model:  3
[36m(ClientAppActor pid=2299151)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2299151)[0m epoch:  0
[36m(ClientAppActor pid=2299151)[0m train ious:  
[36m(ClientAppActor pid=2299151)[0m 0.9905366808624926
[36m(ClientAppActor pid=2299151)[0m train dice liver:  tensor(0.9941, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m train dice tumour:  tensor(0.7803, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation ious:  0.980006470753185
[36m(ClientAppActor pid=2299151)[0m validation dice liver:  tensor(0.9899, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation dice tumour:  tensor(0.7395, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m => new best model:  0
[36m(ClientAppActor pid=2299151)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2299151)[0m epoch:  1
[36m(ClientAppActor pid=2299151)[0m train ious:  0.9903832989660181
[36m(ClientAppActor pid=2299151)[0m train dice liver:  tensor(0.9940, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m train dice tumour:  tensor(0.7821, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation ious:  0.9800726912253886
[36m(ClientAppActor pid=2299151)[0m validation dice liver:  tensor(0.9900, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation dice tumour:  tensor(0.7407, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m => new best model:  1
[36m(ClientAppActor pid=2299151)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2299151)[0m epoch:  2
[36m(ClientAppActor pid=2299151)[0m train ious:  0.9905993798050517
[36m(ClientAppActor pid=2299151)[0m train dice liver:  tensor(0.9941, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m train dice tumour:  tensor(0.7871, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation ious:  0.980079254508542
[36m(ClientAppActor pid=2299151)[0m validation dice liver:  tensor(0.9900, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation dice tumour:  tensor(0.7387, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m => new best model:  2
[36m(ClientAppActor pid=2299151)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2299151)[0m epoch:  3
[36m(ClientAppActor pid=2299151)[0m train ious:  0.9906404444260292
[36m(ClientAppActor pid=2299151)[0m train dice liver:  tensor(0.9942, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m train dice tumour:  tensor(0.7886, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation ious:  0.9801160352073388
[36m(ClientAppActor pid=2299151)[0m validation dice liver:  tensor(0.9900, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation dice tumour:  tensor(0.7393, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m => new best model:  3
[2024-11-14 15:19:36,974][flwr][INFO] - aggregate_fit: received 2 results and 0 failures
[92mINFO [0m:      fit progress: (23, 0.002912630525450294, OrderedDict([('ind_iou_0', 0.980438047882067), ('ind_dice_liver_0', tensor(0.9902, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7407, dtype=torch.float64)), ('ind_iou_1', 0.9861537896163552), ('ind_dice_liver_1', tensor(0.9923, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6513, dtype=torch.float64)), ('all_iou', 0.9810549256044511), ('all_dice_liver', tensor(0.9904, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7405, dtype=torch.float64))]), 80450.04879391193)
Entrei no test
Meio do test
Fim do test
[2024-11-14 15:23:40,254][flwr][INFO] - fit progress: (23, 0.002912630525450294, OrderedDict([('ind_iou_0', 0.980438047882067), ('ind_dice_liver_0', tensor(0.9902, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7407, dtype=torch.float64)), ('ind_iou_1', 0.9861537896163552), ('ind_dice_liver_1', tensor(0.9923, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6513, dtype=torch.float64)), ('all_iou', 0.9810549256044511), ('all_dice_liver', tensor(0.9904, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7405, dtype=torch.float64))]), 80450.04879391193)
[92mINFO [0m:      configure_evaluate: strategy sampled 2 clients (out of 2)
[2024-11-14 15:23:40,258][flwr][INFO] - configure_evaluate: strategy sampled 2 clients (out of 2)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[36m(ClientAppActor pid=2299152)[0m Entrei no validation 1 3
[2024-11-14 15:23:50,511][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-11-14 15:23:50,511][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[2024-11-14 15:24:39,194][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-11-14 15:24:39,194][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 2 failures
[2024-11-14 15:24:39,194][flwr][INFO] - aggregate_evaluate: received 0 results and 2 failures
[92mINFO [0m:      
[2024-11-14 15:24:39,194][flwr][INFO] - 
[92mINFO [0m:      [ROUND 24]
[2024-11-14 15:24:39,194][flwr][INFO] - [ROUND 24]
[92mINFO [0m:      configure_fit: strategy sampled 2 clients (out of 2)
[2024-11-14 15:24:39,195][flwr][INFO] - configure_fit: strategy sampled 2 clients (out of 2)
[92mINFO [0m:      aggregate_fit: received 2 results and 0 failures
[36m(ClientAppActor pid=2299151)[0m Entrei no validation 1 3[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=2299151)[0m epoch:  0
[36m(ClientAppActor pid=2299151)[0m train ious:  0.988587715462101
[36m(ClientAppActor pid=2299151)[0m train dice liver:  tensor(0.9925, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m train dice tumour:  tensor(0.6300, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation ious:  0.9859041545757937
[36m(ClientAppActor pid=2299151)[0m validation dice liver:  tensor(0.9912, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation dice tumour:  tensor(0.6509, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m => new best model:  0
[36m(ClientAppActor pid=2299151)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2299151)[0m epoch:  1
[36m(ClientAppActor pid=2299151)[0m train ious:  0.9899665390102812
[36m(ClientAppActor pid=2299151)[0m train dice liver:  tensor(0.9933, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m train dice tumour:  tensor(0.6874, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation ious:  0.9859422647572361
[36m(ClientAppActor pid=2299151)[0m validation dice liver:  tensor(0.9916, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation dice tumour:  tensor(0.6582, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m => new best model:  1
[36m(ClientAppActor pid=2299151)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2299151)[0m epoch:  2
[36m(ClientAppActor pid=2299151)[0m train ious:  0.9903449144174099
[36m(ClientAppActor pid=2299151)[0m train dice liver:  tensor(0.9937, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m train dice tumour:  tensor(0.6637, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation ious:  0.9860146287378756
[36m(ClientAppActor pid=2299151)[0m validation dice liver:  tensor(0.9920, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation dice tumour:  tensor(0.6540, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m => new best model:  2
[36m(ClientAppActor pid=2299151)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2299151)[0m epoch:  3
[36m(ClientAppActor pid=2299151)[0m train ious:  0.9908350109947116
[36m(ClientAppActor pid=2299151)[0m train dice liver:  tensor(0.9940, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m train dice tumour:  tensor(0.6352, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation ious:  0.9858000336304473
[36m(ClientAppActor pid=2299151)[0m validation dice liver:  tensor(0.9919, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation dice tumour:  tensor(0.6580, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m => new best model:  3
[36m(ClientAppActor pid=2299152)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2299152)[0m epoch:  0
[36m(ClientAppActor pid=2299152)[0m train ious:  0.9908260514424657
[36m(ClientAppActor pid=2299152)[0m train dice liver:  tensor(0.9943, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m train dice tumour:  tensor(0.7842, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation ious:  0.9802415741503878
[36m(ClientAppActor pid=2299152)[0m validation dice liver:  tensor(0.9901, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation dice tumour:  tensor(0.7415, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m => new best model:  0
[36m(ClientAppActor pid=2299152)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2299152)[0m epoch:  1
[36m(ClientAppActor pid=2299152)[0m train ious:  0.9908019810073342
[36m(ClientAppActor pid=2299152)[0m train dice liver:  tensor(0.9943, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m train dice tumour:  tensor(0.7888, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation ious:  0.9800389988147659
[36m(ClientAppActor pid=2299152)[0m validation dice liver:  tensor(0.9901, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation dice tumour:  tensor(0.7397, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m => new best model:  1
[36m(ClientAppActor pid=2299152)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2299152)[0m epoch:  2
[36m(ClientAppActor pid=2299152)[0m train ious:  0.9909005070379967
[36m(ClientAppActor pid=2299152)[0m train dice liver:  tensor(0.9943, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m train dice tumour:  tensor(0.7935, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation ious:  0.9802808160962108
[36m(ClientAppActor pid=2299152)[0m validation dice liver:  tensor(0.9902, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation dice tumour:  tensor(0.7407, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m => new best model:  2
[36m(ClientAppActor pid=2299152)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2299152)[0m epoch:  3
[36m(ClientAppActor pid=2299152)[0m train ious:  0.9909675831889256
[36m(ClientAppActor pid=2299152)[0m train dice liver:  tensor(0.9944, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m train dice tumour:  tensor(0.7865, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation ious:  0.9801964807557925
[36m(ClientAppActor pid=2299152)[0m validation dice liver:  tensor(0.9902, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation dice tumour:  tensor(0.7409, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m => new best model:  3
[2024-11-14 16:48:31,954][flwr][INFO] - aggregate_fit: received 2 results and 0 failures
[92mINFO [0m:      fit progress: (24, 0.0029283246720197536, OrderedDict([('ind_iou_0', 0.9804934391397111), ('ind_dice_liver_0', tensor(0.9903, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7418, dtype=torch.float64)), ('ind_iou_1', 0.9860934062989678), ('ind_dice_liver_1', tensor(0.9923, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6535, dtype=torch.float64)), ('all_iou', 0.9811053789865207), ('all_dice_liver', tensor(0.9905, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7417, dtype=torch.float64))]), 85728.5435038819)
Entrei no test
Meio do test
Fim do test
[2024-11-14 16:51:38,748][flwr][INFO] - fit progress: (24, 0.0029283246720197536, OrderedDict([('ind_iou_0', 0.9804934391397111), ('ind_dice_liver_0', tensor(0.9903, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7418, dtype=torch.float64)), ('ind_iou_1', 0.9860934062989678), ('ind_dice_liver_1', tensor(0.9923, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6535, dtype=torch.float64)), ('all_iou', 0.9811053789865207), ('all_dice_liver', tensor(0.9905, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7417, dtype=torch.float64))]), 85728.5435038819)
[92mINFO [0m:      configure_evaluate: strategy sampled 2 clients (out of 2)
[2024-11-14 16:51:38,752][flwr][INFO] - configure_evaluate: strategy sampled 2 clients (out of 2)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[36m(ClientAppActor pid=2299152)[0m Entrei no validation 1 3
[2024-11-14 16:51:49,075][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-11-14 16:51:49,075][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[2024-11-14 16:52:38,023][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-11-14 16:52:38,023][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 2 failures
[2024-11-14 16:52:38,024][flwr][INFO] - aggregate_evaluate: received 0 results and 2 failures
[92mINFO [0m:      
[2024-11-14 16:52:38,024][flwr][INFO] - 
[92mINFO [0m:      [ROUND 25]
[2024-11-14 16:52:38,024][flwr][INFO] - [ROUND 25]
[92mINFO [0m:      configure_fit: strategy sampled 2 clients (out of 2)
[2024-11-14 16:52:38,024][flwr][INFO] - configure_fit: strategy sampled 2 clients (out of 2)
[92mINFO [0m:      aggregate_fit: received 2 results and 0 failures
[36m(ClientAppActor pid=2299151)[0m Entrei no validation 1 3[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=2299151)[0m epoch:  0
[36m(ClientAppActor pid=2299151)[0m train ious:  0.988965511202726
[36m(ClientAppActor pid=2299151)[0m train dice liver:  tensor(0.9928, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m train dice tumour:  tensor(0.6424, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation ious:  0.98637751854561
[36m(ClientAppActor pid=2299151)[0m validation dice liver:  tensor(0.9915, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation dice tumour:  tensor(0.6614, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m => new best model:  0
[36m(ClientAppActor pid=2299151)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2299151)[0m epoch:  1
[36m(ClientAppActor pid=2299151)[0m train ious:  0.9903194580994031
[36m(ClientAppActor pid=2299151)[0m train dice liver:  tensor(0.9936, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m train dice tumour:  tensor(0.6366, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation ious:  0.986607088437145
[36m(ClientAppActor pid=2299151)[0m validation dice liver:  tensor(0.9921, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation dice tumour:  tensor(0.6633, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m => new best model:  1
[36m(ClientAppActor pid=2299151)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2299151)[0m epoch:  2
[36m(ClientAppActor pid=2299151)[0m train ious:  0.9909538073005366
[36m(ClientAppActor pid=2299151)[0m train dice liver:  tensor(0.9941, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m train dice tumour:  tensor(0.6466, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation ious:  0.9864756137404879
[36m(ClientAppActor pid=2299151)[0m validation dice liver:  tensor(0.9922, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation dice tumour:  tensor(0.6679, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m => new best model:  2
[36m(ClientAppActor pid=2299151)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2299151)[0m epoch:  3
[36m(ClientAppActor pid=2299151)[0m train ious:  0.9913215030006072
[36m(ClientAppActor pid=2299151)[0m train dice liver:  tensor(0.9943, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m train dice tumour:  tensor(0.6452, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation ious:  0.9863378444210387
[36m(ClientAppActor pid=2299151)[0m validation dice liver:  tensor(0.9923, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation dice tumour:  tensor(0.6671, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m => new best model:  3
[36m(ClientAppActor pid=2299152)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2299152)[0m epoch:  0
[36m(ClientAppActor pid=2299152)[0m train ious:  0.9911017385909052
[36m(ClientAppActor pid=2299152)[0m train dice liver:  tensor(0.9944, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m train dice tumour:  tensor(0.7857, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation ious:  0.9801334846277018
[36m(ClientAppActor pid=2299152)[0m validation dice liver:  tensor(0.9902, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation dice tumour:  tensor(0.7431, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m => new best model:  0
[36m(ClientAppActor pid=2299152)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2299152)[0m epoch:  1
[36m(ClientAppActor pid=2299152)[0m train ious:  0.9911027905643759
[36m(ClientAppActor pid=2299152)[0m train dice liver:  tensor(0.9945, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m train dice tumour:  tensor(0.7916, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation ious:  0.9801974037243003
[36m(ClientAppActor pid=2299152)[0m validation dice liver:  tensor(0.9902, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation dice tumour:  tensor(0.7420, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m => new best model:  1
[36m(ClientAppActor pid=2299152)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2299152)[0m epoch:  2
[36m(ClientAppActor pid=2299152)[0m train ious:  0.9911423621988675
[36m(ClientAppActor pid=2299152)[0m train dice liver:  tensor(0.9945, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m train dice tumour:  tensor(0.7849, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation ious:  0.9802337893032094
[36m(ClientAppActor pid=2299152)[0m validation dice liver:  tensor(0.9902, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation dice tumour:  tensor(0.7410, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m => new best model:  2
[36m(ClientAppActor pid=2299152)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2299152)[0m epoch:  3
[36m(ClientAppActor pid=2299152)[0m train ious:  0.9913090470393515
[36m(ClientAppActor pid=2299152)[0m train dice liver:  tensor(0.9946, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m train dice tumour:  tensor(0.7864, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation ious:  0.9803234081519581
[36m(ClientAppActor pid=2299152)[0m validation dice liver:  tensor(0.9902, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation dice tumour:  tensor(0.7418, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m => new best model:  3
[2024-11-14 18:11:06,973][flwr][INFO] - aggregate_fit: received 2 results and 0 failures
[92mINFO [0m:      fit progress: (25, 0.0029166138869783356, OrderedDict([('ind_iou_0', 0.9806274640838769), ('ind_dice_liver_0', tensor(0.9903, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7428, dtype=torch.float64)), ('ind_iou_1', 0.9864021861530534), ('ind_dice_liver_1', tensor(0.9925, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6579, dtype=torch.float64)), ('all_iou', 0.9812584407172342), ('all_dice_liver', tensor(0.9906, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7433, dtype=torch.float64))]), 90856.96057937294)
Entrei no test
Meio do test
Fim do test
[2024-11-14 18:17:07,165][flwr][INFO] - fit progress: (25, 0.0029166138869783356, OrderedDict([('ind_iou_0', 0.9806274640838769), ('ind_dice_liver_0', tensor(0.9903, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7428, dtype=torch.float64)), ('ind_iou_1', 0.9864021861530534), ('ind_dice_liver_1', tensor(0.9925, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6579, dtype=torch.float64)), ('all_iou', 0.9812584407172342), ('all_dice_liver', tensor(0.9906, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7433, dtype=torch.float64))]), 90856.96057937294)
[92mINFO [0m:      configure_evaluate: strategy sampled 2 clients (out of 2)
[2024-11-14 18:17:07,185][flwr][INFO] - configure_evaluate: strategy sampled 2 clients (out of 2)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[36m(ClientAppActor pid=2299152)[0m Entrei no validation 1 3
[2024-11-14 18:17:18,774][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-11-14 18:17:18,774][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-11-14 18:18:08,171][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-11-14 18:18:08,172][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 2 failures
[2024-11-14 18:18:08,172][flwr][INFO] - aggregate_evaluate: received 0 results and 2 failures
[92mINFO [0m:      
[2024-11-14 18:18:08,172][flwr][INFO] - 
[92mINFO [0m:      [ROUND 26]
[2024-11-14 18:18:08,172][flwr][INFO] - [ROUND 26]
[92mINFO [0m:      configure_fit: strategy sampled 2 clients (out of 2)
[2024-11-14 18:18:08,173][flwr][INFO] - configure_fit: strategy sampled 2 clients (out of 2)
[92mINFO [0m:      aggregate_fit: received 2 results and 0 failures
[36m(ClientAppActor pid=2299152)[0m Entrei no validation 1 3[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=2299152)[0m epoch:  0
[36m(ClientAppActor pid=2299152)[0m train ious:  0.9890176938713502
[36m(ClientAppActor pid=2299152)[0m train dice liver:  tensor(0.9927, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m train dice tumour:  tensor(0.6368, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation ious:  0.9870452462257271
[36m(ClientAppActor pid=2299152)[0m validation dice liver:  tensor(0.9921, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation dice tumour:  tensor(0.6626, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m => new best model:  0
[36m(ClientAppActor pid=2299152)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2299152)[0m epoch:  1
[36m(ClientAppActor pid=2299152)[0m train ious:  0.9905481793396136
[36m(ClientAppActor pid=2299152)[0m train dice liver:  tensor(0.9938, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m train dice tumour:  tensor(0.6642, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation ious:  0.9869642246059482
[36m(ClientAppActor pid=2299152)[0m validation dice liver:  tensor(0.9923, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation dice tumour:  tensor(0.6681, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m => new best model:  1
[36m(ClientAppActor pid=2299152)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2299152)[0m epoch:  2
[36m(ClientAppActor pid=2299152)[0m train ious:  0.9911915980729471
[36m(ClientAppActor pid=2299152)[0m train dice liver:  tensor(0.9942, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m train dice tumour:  tensor(0.6614, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation ious:  0.9866344043311851
[36m(ClientAppActor pid=2299152)[0m validation dice liver:  tensor(0.9925, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation dice tumour:  tensor(0.6650, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m => new best model:  2
[36m(ClientAppActor pid=2299152)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2299152)[0m epoch:  3
[36m(ClientAppActor pid=2299152)[0m train ious:  0.9913808676941914
[36m(ClientAppActor pid=2299152)[0m train dice liver:  tensor(0.9944, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m train dice tumour:  tensor(0.6747, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation ious:  0.9866657913751008
[36m(ClientAppActor pid=2299152)[0m validation dice liver:  tensor(0.9926, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation dice tumour:  tensor(0.6680, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m => new best model:  3
[36m(ClientAppActor pid=2299151)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2299151)[0m epoch:  0
[36m(ClientAppActor pid=2299151)[0m train ious:  0.991437387942951
[36m(ClientAppActor pid=2299151)[0m train dice liver:  tensor(0.9947, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m train dice tumour:  tensor(0.7856, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation ious:  0.9804141490397525
[36m(ClientAppActor pid=2299151)[0m validation dice liver:  tensor(0.9903, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation dice tumour:  tensor(0.7417, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m => new best model:  0
[36m(ClientAppActor pid=2299151)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2299151)[0m epoch:  1
[36m(ClientAppActor pid=2299151)[0m train ious:  0.9913755137755714
[36m(ClientAppActor pid=2299151)[0m train dice liver:  tensor(0.9946, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m train dice tumour:  tensor(0.7910, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation ious:  0.9804570768846399
[36m(ClientAppActor pid=2299151)[0m validation dice liver:  tensor(0.9904, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation dice tumour:  tensor(0.7423, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m => new best model:  1
[36m(ClientAppActor pid=2299151)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2299151)[0m epoch:  2
[36m(ClientAppActor pid=2299151)[0m train ious:  0.9913860719352454
[36m(ClientAppActor pid=2299151)[0m train dice liver:  tensor(0.9946, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m train dice tumour:  tensor(0.7905, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation ious:  0.9803582087749498
[36m(ClientAppActor pid=2299151)[0m validation dice liver:  tensor(0.9903, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation dice tumour:  tensor(0.7411, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m => new best model:  2
[36m(ClientAppActor pid=2299151)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2299151)[0m epoch:  3
[36m(ClientAppActor pid=2299151)[0m train ious:  
[36m(ClientAppActor pid=2299151)[0m 0.9915425499789869
[36m(ClientAppActor pid=2299151)[0m train dice liver:  tensor(0.9947, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m train dice tumour:  tensor(0.7940, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation ious:  0.9803876627012655
[36m(ClientAppActor pid=2299151)[0m validation dice liver:  tensor(0.9903, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation dice tumour:  tensor(0.7409, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m => new best model:  3
[2024-11-14 19:41:17,044][flwr][INFO] - aggregate_fit: received 2 results and 0 failures
[92mINFO [0m:      fit progress: (26, 0.002974829914457498, OrderedDict([('ind_iou_0', 0.9806945665058423), ('ind_dice_liver_0', tensor(0.9904, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7420, dtype=torch.float64)), ('ind_iou_1', 0.9868926110472361), ('ind_dice_liver_1', tensor(0.9928, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6514, dtype=torch.float64)), ('all_iou', 0.9813734613595486), ('all_dice_liver', tensor(0.9907, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7423, dtype=torch.float64))]), 96115.15212473879)
Entrei no test
Meio do test
Fim do test
[2024-11-14 19:44:45,357][flwr][INFO] - fit progress: (26, 0.002974829914457498, OrderedDict([('ind_iou_0', 0.9806945665058423), ('ind_dice_liver_0', tensor(0.9904, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7420, dtype=torch.float64)), ('ind_iou_1', 0.9868926110472361), ('ind_dice_liver_1', tensor(0.9928, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6514, dtype=torch.float64)), ('all_iou', 0.9813734613595486), ('all_dice_liver', tensor(0.9907, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7423, dtype=torch.float64))]), 96115.15212473879)
[92mINFO [0m:      configure_evaluate: strategy sampled 2 clients (out of 2)
[2024-11-14 19:44:45,361][flwr][INFO] - configure_evaluate: strategy sampled 2 clients (out of 2)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[36m(ClientAppActor pid=2299151)[0m Entrei no validation 1 3
[2024-11-14 19:44:55,194][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-11-14 19:44:55,195][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[2024-11-14 19:45:44,310][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-11-14 19:45:44,310][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 2 failures
[2024-11-14 19:45:44,314][flwr][INFO] - aggregate_evaluate: received 0 results and 2 failures
[92mINFO [0m:      
[2024-11-14 19:45:44,315][flwr][INFO] - 
[92mINFO [0m:      [ROUND 27]
[2024-11-14 19:45:44,315][flwr][INFO] - [ROUND 27]
[92mINFO [0m:      configure_fit: strategy sampled 2 clients (out of 2)
[2024-11-14 19:45:44,315][flwr][INFO] - configure_fit: strategy sampled 2 clients (out of 2)
[92mINFO [0m:      aggregate_fit: received 2 results and 0 failures
[36m(ClientAppActor pid=2299152)[0m Entrei no validation 1 3[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=2299152)[0m epoch:  0
[36m(ClientAppActor pid=2299152)[0m train ious:  0.9893242343497697
[36m(ClientAppActor pid=2299152)[0m train dice liver:  tensor(0.9930, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m train dice tumour:  tensor(0.6474, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation ious:  0.9866550678840653
[36m(ClientAppActor pid=2299152)[0m validation dice liver:  tensor(0.9917, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation dice tumour:  tensor(0.6582, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m => new best model:  0
[36m(ClientAppActor pid=2299152)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2299152)[0m epoch:  1
[36m(ClientAppActor pid=2299152)[0m train ious:  0.9909557237357934
[36m(ClientAppActor pid=2299152)[0m train dice liver:  tensor(0.9940, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m train dice tumour:  tensor(0.6616, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation ious:  0.9870147034105867
[36m(ClientAppActor pid=2299152)[0m validation dice liver:  tensor(0.9924, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation dice tumour:  tensor(0.6607, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m => new best model:  1
[36m(ClientAppActor pid=2299152)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2299152)[0m epoch:  2
[36m(ClientAppActor pid=2299152)[0m train ious:  0.9913685299170935
[36m(ClientAppActor pid=2299152)[0m train dice liver:  tensor(0.9943, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m train dice tumour:  tensor(0.6806, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation ious:  0.9868769533930992
[36m(ClientAppActor pid=2299152)[0m validation dice liver:  tensor(0.9926, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation dice tumour:  tensor(0.6650, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m => new best model:  2
[36m(ClientAppActor pid=2299152)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2299152)[0m epoch:  3
[36m(ClientAppActor pid=2299152)[0m train ious:  0.9916242477698722
[36m(ClientAppActor pid=2299152)[0m train dice liver:  tensor(0.9945, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m train dice tumour:  tensor(0.6320, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation ious:  0.9869481592403192
[36m(ClientAppActor pid=2299152)[0m validation dice liver:  tensor(0.9926, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation dice tumour:  tensor(0.6638, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m => new best model:  3
[36m(ClientAppActor pid=2299151)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2299151)[0m epoch:  0
[36m(ClientAppActor pid=2299151)[0m train ious:  0.9917261323738132
[36m(ClientAppActor pid=2299151)[0m train dice liver:  tensor(0.9948, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m train dice tumour:  tensor(0.7905, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation ious:  0.9802364865313813
[36m(ClientAppActor pid=2299151)[0m validation dice liver:  tensor(0.9903, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation dice tumour:  tensor(0.7442, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m => new best model:  0
[36m(ClientAppActor pid=2299151)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2299151)[0m epoch:  1
[36m(ClientAppActor pid=2299151)[0m train ious:  0.9916322306621378
[36m(ClientAppActor pid=2299151)[0m train dice liver:  tensor(0.9948, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m train dice tumour:  tensor(0.7838, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation ious:  0.9801344370354942
[36m(ClientAppActor pid=2299151)[0m validation dice liver:  tensor(0.9902, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation dice tumour:  tensor(0.7411, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m => new best model:  1
[36m(ClientAppActor pid=2299151)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2299151)[0m epoch:  2
[36m(ClientAppActor pid=2299151)[0m train ious:  0.9916541753344658
[36m(ClientAppActor pid=2299151)[0m train dice liver:  tensor(0.9948, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m train dice tumour:  tensor(0.7956, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation ious:  0.980344209958597
[36m(ClientAppActor pid=2299151)[0m validation dice liver:  tensor(0.9903, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation dice tumour:  tensor(0.7443, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m => new best model:  2
[36m(ClientAppActor pid=2299151)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2299151)[0m epoch:  3
[36m(ClientAppActor pid=2299151)[0m train ious:  0.9917394695830559
[36m(ClientAppActor pid=2299151)[0m train dice liver:  tensor(0.9949, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m train dice tumour:  tensor(0.7973, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation ious:  0.980364484046781
[36m(ClientAppActor pid=2299151)[0m validation dice liver:  tensor(0.9902, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation dice tumour:  tensor(0.7436, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m => new best model:  3
[2024-11-14 21:04:22,102][flwr][INFO] - aggregate_fit: received 2 results and 0 failures
[92mINFO [0m:      fit progress: (27, 0.002932211649205478, OrderedDict([('ind_iou_0', 0.9806781694948855), ('ind_dice_liver_0', tensor(0.9904, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7443, dtype=torch.float64)), ('ind_iou_1', 0.987161025890523), ('ind_dice_liver_1', tensor(0.9928, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6539, dtype=torch.float64)), ('all_iou', 0.9813850298001152), ('all_dice_liver', tensor(0.9907, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7429, dtype=torch.float64))]), 101084.19059894793)
Entrei no test
Meio do test
Fim do test
[2024-11-14 21:07:34,395][flwr][INFO] - fit progress: (27, 0.002932211649205478, OrderedDict([('ind_iou_0', 0.9806781694948855), ('ind_dice_liver_0', tensor(0.9904, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7443, dtype=torch.float64)), ('ind_iou_1', 0.987161025890523), ('ind_dice_liver_1', tensor(0.9928, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6539, dtype=torch.float64)), ('all_iou', 0.9813850298001152), ('all_dice_liver', tensor(0.9907, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7429, dtype=torch.float64))]), 101084.19059894793)
[92mINFO [0m:      configure_evaluate: strategy sampled 2 clients (out of 2)
[2024-11-14 21:07:34,399][flwr][INFO] - configure_evaluate: strategy sampled 2 clients (out of 2)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[36m(ClientAppActor pid=2299152)[0m Entrei no validation 1 3
[2024-11-14 21:07:45,245][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-11-14 21:07:45,247][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[2024-11-14 21:08:35,931][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-11-14 21:08:35,931][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 2 failures
[2024-11-14 21:08:35,932][flwr][INFO] - aggregate_evaluate: received 0 results and 2 failures
[92mINFO [0m:      
[2024-11-14 21:08:35,932][flwr][INFO] - 
[92mINFO [0m:      [ROUND 28]
[2024-11-14 21:08:35,932][flwr][INFO] - [ROUND 28]
[92mINFO [0m:      configure_fit: strategy sampled 2 clients (out of 2)
[2024-11-14 21:08:35,933][flwr][INFO] - configure_fit: strategy sampled 2 clients (out of 2)
[92mINFO [0m:      aggregate_fit: received 2 results and 0 failures
[36m(ClientAppActor pid=2299151)[0m Entrei no validation 1 3[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=2299151)[0m epoch:  0
[36m(ClientAppActor pid=2299151)[0m train ious:  0.9897467488985056
[36m(ClientAppActor pid=2299151)[0m train dice liver:  tensor(0.9932, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m train dice tumour:  tensor(0.6368, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation ious:  0.9871179374507155
[36m(ClientAppActor pid=2299151)[0m validation dice liver:  tensor(0.9920, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation dice tumour:  tensor(0.6585, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m => new best model:  0
[36m(ClientAppActor pid=2299151)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2299151)[0m epoch:  1
[36m(ClientAppActor pid=2299151)[0m train ious:  0.9911481844699228
[36m(ClientAppActor pid=2299151)[0m train dice liver:  tensor(0.9941, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m train dice tumour:  tensor(0.6550, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation ious:  0.9864213500709568
[36m(ClientAppActor pid=2299151)[0m validation dice liver:  tensor(0.9920, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation dice tumour:  tensor(0.6615, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m => new best model:  1
[36m(ClientAppActor pid=2299151)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2299151)[0m epoch:  2
[36m(ClientAppActor pid=2299151)[0m train ious:  0.9910022308834532
[36m(ClientAppActor pid=2299151)[0m train dice liver:  tensor(0.9941, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m train dice tumour:  tensor(0.6637, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation ious:  0.9869054388539487
[36m(ClientAppActor pid=2299151)[0m validation dice liver:  tensor(0.9925, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation dice tumour:  tensor(0.6638, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m => new best model:  2
[36m(ClientAppActor pid=2299151)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2299151)[0m epoch:  3
[36m(ClientAppActor pid=2299151)[0m train ious:  0.9919357015628912
[36m(ClientAppActor pid=2299151)[0m train dice liver:  tensor(0.9947, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m train dice tumour:  tensor(0.6624, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation ious:  0.9869258092911882
[36m(ClientAppActor pid=2299151)[0m validation dice liver:  tensor(0.9926, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation dice tumour:  tensor(0.6615, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m => new best model:  3
[36m(ClientAppActor pid=2299152)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2299152)[0m epoch:  0
[36m(ClientAppActor pid=2299152)[0m train ious:  0.9919331189937189
[36m(ClientAppActor pid=2299152)[0m train dice liver:  tensor(0.9950, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m train dice tumour:  tensor(0.7879, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation ious:  0.9805227326004157
[36m(ClientAppActor pid=2299152)[0m validation dice liver:  tensor(0.9904, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation dice tumour:  tensor(0.7455, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m => new best model:  0
[36m(ClientAppActor pid=2299152)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2299152)[0m epoch:  1
[36m(ClientAppActor pid=2299152)[0m train ious:  0.9918677446011395
[36m(ClientAppActor pid=2299152)[0m train dice liver:  tensor(0.9949, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m train dice tumour:  tensor(0.7912, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation ious:  0.9805802343729574
[36m(ClientAppActor pid=2299152)[0m validation dice liver:  tensor(0.9905, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation dice tumour:  tensor(0.7438, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m => new best model:  1
[36m(ClientAppActor pid=2299152)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2299152)[0m epoch:  2
[36m(ClientAppActor pid=2299152)[0m train ious:  0.9919517279603306
[36m(ClientAppActor pid=2299152)[0m train dice liver:  tensor(0.9950, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m train dice tumour:  tensor(0.7902, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation ious:  0.9803673322076042
[36m(ClientAppActor pid=2299152)[0m validation dice liver:  tensor(0.9904, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation dice tumour:  tensor(0.7441, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m => new best model:  2
[36m(ClientAppActor pid=2299152)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2299152)[0m epoch:  3
[36m(ClientAppActor pid=2299152)[0m train ious:  
[36m(ClientAppActor pid=2299152)[0m 0.9920216330879013
[36m(ClientAppActor pid=2299152)[0m train dice liver:  tensor(0.9950, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m train dice tumour:  tensor(0.7904, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation ious:  0.9804806337160615
[36m(ClientAppActor pid=2299152)[0m validation dice liver:  tensor(0.9905, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation dice tumour:  tensor(0.7436, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m => new best model:  3
[2024-11-14 22:27:20,523][flwr][INFO] - aggregate_fit: received 2 results and 0 failures
[92mINFO [0m:      fit progress: (28, 0.003033191422136184, OrderedDict([('ind_iou_0', 0.9807858563358428), ('ind_dice_liver_0', tensor(0.9906, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7447, dtype=torch.float64)), ('ind_iou_1', 0.9868841084814503), ('ind_dice_liver_1', tensor(0.9930, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6579, dtype=torch.float64)), ('all_iou', 0.9814408848768761), ('all_dice_liver', tensor(0.9909, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7439, dtype=torch.float64))]), 106261.56043172115)
Entrei no test
Meio do test
Fim do test
[2024-11-14 22:33:51,765][flwr][INFO] - fit progress: (28, 0.003033191422136184, OrderedDict([('ind_iou_0', 0.9807858563358428), ('ind_dice_liver_0', tensor(0.9906, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7447, dtype=torch.float64)), ('ind_iou_1', 0.9868841084814503), ('ind_dice_liver_1', tensor(0.9930, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6579, dtype=torch.float64)), ('all_iou', 0.9814408848768761), ('all_dice_liver', tensor(0.9909, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7439, dtype=torch.float64))]), 106261.56043172115)
[92mINFO [0m:      configure_evaluate: strategy sampled 2 clients (out of 2)
[2024-11-14 22:33:51,793][flwr][INFO] - configure_evaluate: strategy sampled 2 clients (out of 2)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[36m(ClientAppActor pid=2299152)[0m Entrei no validation 1 3
[2024-11-14 22:34:01,344][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-11-14 22:34:01,345][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[2024-11-14 22:34:50,482][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-11-14 22:34:50,482][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 2 failures
[2024-11-14 22:34:50,483][flwr][INFO] - aggregate_evaluate: received 0 results and 2 failures
[92mINFO [0m:      
[2024-11-14 22:34:50,483][flwr][INFO] - 
[92mINFO [0m:      [ROUND 29]
[2024-11-14 22:34:50,483][flwr][INFO] - [ROUND 29]
[92mINFO [0m:      configure_fit: strategy sampled 2 clients (out of 2)
[2024-11-14 22:34:50,484][flwr][INFO] - configure_fit: strategy sampled 2 clients (out of 2)
[92mINFO [0m:      aggregate_fit: received 2 results and 0 failures
[36m(ClientAppActor pid=2299151)[0m Entrei no validation 1 3[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=2299151)[0m epoch:  0
[36m(ClientAppActor pid=2299151)[0m train ious:  0.9899680351985527
[36m(ClientAppActor pid=2299151)[0m train dice liver:  tensor(0.9934, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m train dice tumour:  tensor(0.6522, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation ious:  0.987427240422747
[36m(ClientAppActor pid=2299151)[0m validation dice liver:  tensor(0.9924, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation dice tumour:  tensor(0.6650, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m => new best model:  0
[36m(ClientAppActor pid=2299151)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2299151)[0m epoch:  1
[36m(ClientAppActor pid=2299151)[0m train ious:  0.9908517430466591
[36m(ClientAppActor pid=2299151)[0m train dice liver:  tensor(0.9939, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m train dice tumour:  tensor(0.6302, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation ious:  0.9873837357495782
[36m(ClientAppActor pid=2299151)[0m validation dice liver:  tensor(0.9925, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation dice tumour:  tensor(0.6720, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m => new best model:  1
[36m(ClientAppActor pid=2299151)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2299151)[0m epoch:  2
[36m(ClientAppActor pid=2299151)[0m train ious:  0.9917364339830766
[36m(ClientAppActor pid=2299151)[0m train dice liver:  tensor(0.9945, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m train dice tumour:  tensor(0.6602, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation ious:  0.9873189638736096
[36m(ClientAppActor pid=2299151)[0m validation dice liver:  tensor(0.9927, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation dice tumour:  tensor(0.6646, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m => new best model:  2
[36m(ClientAppActor pid=2299151)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2299151)[0m epoch:  3
[36m(ClientAppActor pid=2299151)[0m train ious:  0.9923775576740154
[36m(ClientAppActor pid=2299151)[0m train dice liver:  tensor(0.9950, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m train dice tumour:  tensor(0.6747, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation ious:  0.9871396905021255
[36m(ClientAppActor pid=2299151)[0m validation dice liver:  tensor(0.9928, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation dice tumour:  tensor(0.6698, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m => new best model:  3
[36m(ClientAppActor pid=2299152)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2299152)[0m epoch:  0
[36m(ClientAppActor pid=2299152)[0m train ious:  0.9921607893313182
[36m(ClientAppActor pid=2299152)[0m train dice liver:  tensor(0.9951, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m train dice tumour:  tensor(0.7873, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation ious:  0.9806240428223524
[36m(ClientAppActor pid=2299152)[0m validation dice liver:  tensor(0.9905, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation dice tumour:  tensor(0.7445, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m => new best model:  0
[36m(ClientAppActor pid=2299152)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2299152)[0m epoch:  1
[36m(ClientAppActor pid=2299152)[0m train ious:  0.9921318843274385
[36m(ClientAppActor pid=2299152)[0m train dice liver:  tensor(0.9951, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m train dice tumour:  tensor(0.7885, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation ious:  0.9806506741168158
[36m(ClientAppActor pid=2299152)[0m validation dice liver:  tensor(0.9905, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation dice tumour:  tensor(0.7442, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m => new best model:  1
[36m(ClientAppActor pid=2299152)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2299152)[0m epoch:  2
[36m(ClientAppActor pid=2299152)[0m train ious:  0.9921548294020489
[36m(ClientAppActor pid=2299152)[0m train dice liver:  tensor(0.9951, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m train dice tumour:  tensor(0.7976, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation ious:  0.9804800954471699
[36m(ClientAppActor pid=2299152)[0m validation dice liver:  tensor(0.9905, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation dice tumour:  tensor(0.7436, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m => new best model:  2
[36m(ClientAppActor pid=2299152)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2299152)[0m epoch:  3
[36m(ClientAppActor pid=2299152)[0m train ious:  0.9921415618208461
[36m(ClientAppActor pid=2299152)[0m train dice liver:  tensor(0.9951, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m train dice tumour:  tensor(0.7903, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation ious:  0.980488003548369
[36m(ClientAppActor pid=2299152)[0m validation dice liver:  tensor(0.9905, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation dice tumour:  tensor(0.7454, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m => new best model:  3
[2024-11-14 23:51:16,891][flwr][INFO] - aggregate_fit: received 2 results and 0 failures
[92mINFO [0m:      fit progress: (29, 0.0030927105272586337, OrderedDict([('ind_iou_0', 0.9807867740844473), ('ind_dice_liver_0', tensor(0.9906, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7463, dtype=torch.float64)), ('ind_iou_1', 0.9874147954770707), ('ind_dice_liver_1', tensor(0.9931, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6584, dtype=torch.float64)), ('all_iou', 0.9814990019459132), ('all_dice_liver', tensor(0.9909, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7454, dtype=torch.float64))]), 111271.24414613377)
Entrei no test
Meio do test
Fim do test
[2024-11-14 23:57:21,449][flwr][INFO] - fit progress: (29, 0.0030927105272586337, OrderedDict([('ind_iou_0', 0.9807867740844473), ('ind_dice_liver_0', tensor(0.9906, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7463, dtype=torch.float64)), ('ind_iou_1', 0.9874147954770707), ('ind_dice_liver_1', tensor(0.9931, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6584, dtype=torch.float64)), ('all_iou', 0.9814990019459132), ('all_dice_liver', tensor(0.9909, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7454, dtype=torch.float64))]), 111271.24414613377)
[92mINFO [0m:      configure_evaluate: strategy sampled 2 clients (out of 2)
[2024-11-14 23:57:21,504][flwr][INFO] - configure_evaluate: strategy sampled 2 clients (out of 2)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[36m(ClientAppActor pid=2299151)[0m Entrei no validation 1 3
[2024-11-14 23:57:32,517][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-11-14 23:57:32,518][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-11-14 23:58:20,515][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-11-14 23:58:20,515][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 2 failures
[2024-11-14 23:58:20,516][flwr][INFO] - aggregate_evaluate: received 0 results and 2 failures
[92mINFO [0m:      
[2024-11-14 23:58:20,516][flwr][INFO] - 
[92mINFO [0m:      [ROUND 30]
[2024-11-14 23:58:20,516][flwr][INFO] - [ROUND 30]
[92mINFO [0m:      configure_fit: strategy sampled 2 clients (out of 2)
[2024-11-14 23:58:20,516][flwr][INFO] - configure_fit: strategy sampled 2 clients (out of 2)
[92mINFO [0m:      aggregate_fit: received 2 results and 0 failures
[36m(ClientAppActor pid=2299151)[0m Entrei no validation 1 3[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=2299151)[0m epoch:  0
[36m(ClientAppActor pid=2299151)[0m train ious:  0.9899495717890614
[36m(ClientAppActor pid=2299151)[0m train dice liver:  tensor(0.9934, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m train dice tumour:  tensor(0.6511, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation ious:  0.98734372216169
[36m(ClientAppActor pid=2299151)[0m validation dice liver:  tensor(0.9923, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation dice tumour:  tensor(0.6663, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m => new best model:  0
[36m(ClientAppActor pid=2299151)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2299151)[0m epoch:  1
[36m(ClientAppActor pid=2299151)[0m train ious:  0.9915760276184582
[36m(ClientAppActor pid=2299151)[0m train dice liver:  tensor(0.9944, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m train dice tumour:  tensor(0.6485, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation ious:  0.987521072736822
[36m(ClientAppActor pid=2299151)[0m validation dice liver:  tensor(0.9929, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation dice tumour:  tensor(0.6648, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m => new best model:  1
[36m(ClientAppActor pid=2299151)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2299151)[0m epoch:  2
[36m(ClientAppActor pid=2299151)[0m train ious:  0.991816301830296
[36m(ClientAppActor pid=2299151)[0m train dice liver:  tensor(0.9946, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m train dice tumour:  tensor(0.6742, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation ious:  0.9869977677686118
[36m(ClientAppActor pid=2299151)[0m validation dice liver:  tensor(0.9925, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation dice tumour:  tensor(0.6624, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m => new best model:  2
[36m(ClientAppActor pid=2299151)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2299151)[0m epoch:  3
[36m(ClientAppActor pid=2299151)[0m train ious:  0.9920075539828037
[36m(ClientAppActor pid=2299151)[0m train dice liver:  tensor(0.9948, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m train dice tumour:  tensor(0.6714, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation ious:  0.9873345585979125
[36m(ClientAppActor pid=2299151)[0m validation dice liver:  tensor(0.9929, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation dice tumour:  tensor(0.6610, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m => new best model:  3
[36m(ClientAppActor pid=2299152)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2299152)[0m epoch:  0
[36m(ClientAppActor pid=2299152)[0m train ious:  
[36m(ClientAppActor pid=2299152)[0m 0.9923242050839841
[36m(ClientAppActor pid=2299152)[0m train dice liver:  tensor(0.9952, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m train dice tumour:  tensor(0.7952, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation ious:  0.9804888213592431
[36m(ClientAppActor pid=2299152)[0m validation dice liver:  tensor(0.9905, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation dice tumour:  tensor(0.7455, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m => new best model:  0
[36m(ClientAppActor pid=2299152)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2299152)[0m epoch:  1
[36m(ClientAppActor pid=2299152)[0m train ious:  0.9922649455538463
[36m(ClientAppActor pid=2299152)[0m train dice liver:  tensor(0.9952, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m train dice tumour:  tensor(0.7884, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation ious:  0.980731124425951
[36m(ClientAppActor pid=2299152)[0m validation dice liver:  tensor(0.9906, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation dice tumour:  tensor(0.7459, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m => new best model:  1
[36m(ClientAppActor pid=2299152)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2299152)[0m epoch:  2
[36m(ClientAppActor pid=2299152)[0m train ious:  0.9923794842295507
[36m(ClientAppActor pid=2299152)[0m train dice liver:  tensor(0.9952, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m train dice tumour:  tensor(0.7923, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation ious:  0.9803990766653367
[36m(ClientAppActor pid=2299152)[0m validation dice liver:  tensor(0.9905, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation dice tumour:  tensor(0.7431, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m => new best model:  2
[36m(ClientAppActor pid=2299152)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2299152)[0m epoch:  3
[36m(ClientAppActor pid=2299152)[0m train ious:  
[36m(ClientAppActor pid=2299152)[0m 0.9923824339934266
[36m(ClientAppActor pid=2299152)[0m train dice liver:  tensor(0.9953, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m train dice tumour:  tensor(0.8010, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation ious:  0.980460718767436
[36m(ClientAppActor pid=2299152)[0m validation dice liver:  tensor(0.9905, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation dice tumour:  tensor(0.7459, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m => new best model:  3
[2024-11-15 01:18:36,533][flwr][INFO] - aggregate_fit: received 2 results and 0 failures
[92mINFO [0m:      fit progress: (30, 0.0031245973302404684, OrderedDict([('ind_iou_0', 0.9807770382993556), ('ind_dice_liver_0', tensor(0.9907, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7466, dtype=torch.float64)), ('ind_iou_1', 0.9875033905594672), ('ind_dice_liver_1', tensor(0.9932, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6600, dtype=torch.float64)), ('all_iou', 0.9815027655141337), ('all_dice_liver', tensor(0.9910, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7452, dtype=torch.float64))]), 116340.34870492294)
Entrei no test
Meio do test
Fim do test
[2024-11-15 01:21:50,554][flwr][INFO] - fit progress: (30, 0.0031245973302404684, OrderedDict([('ind_iou_0', 0.9807770382993556), ('ind_dice_liver_0', tensor(0.9907, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7466, dtype=torch.float64)), ('ind_iou_1', 0.9875033905594672), ('ind_dice_liver_1', tensor(0.9932, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6600, dtype=torch.float64)), ('all_iou', 0.9815027655141337), ('all_dice_liver', tensor(0.9910, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7452, dtype=torch.float64))]), 116340.34870492294)
[92mINFO [0m:      configure_evaluate: strategy sampled 2 clients (out of 2)
[2024-11-15 01:21:50,585][flwr][INFO] - configure_evaluate: strategy sampled 2 clients (out of 2)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[36m(ClientAppActor pid=2299151)[0m Entrei no validation 1 3
[2024-11-15 01:22:00,728][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-11-15 01:22:00,728][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[2024-11-15 01:22:50,502][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-11-15 01:22:50,502][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 2 failures
[2024-11-15 01:22:50,503][flwr][INFO] - aggregate_evaluate: received 0 results and 2 failures
[92mINFO [0m:      
[2024-11-15 01:22:50,503][flwr][INFO] - 
[92mINFO [0m:      [ROUND 31]
[2024-11-15 01:22:50,503][flwr][INFO] - [ROUND 31]
[92mINFO [0m:      configure_fit: strategy sampled 2 clients (out of 2)
[2024-11-15 01:22:50,503][flwr][INFO] - configure_fit: strategy sampled 2 clients (out of 2)
[92mINFO [0m:      aggregate_fit: received 2 results and 0 failures
[36m(ClientAppActor pid=2299151)[0m Entrei no validation 1 3[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=2299151)[0m epoch:  0
[36m(ClientAppActor pid=2299151)[0m train ious:  0.9901261593291575
[36m(ClientAppActor pid=2299151)[0m train dice liver:  tensor(0.9935, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m train dice tumour:  tensor(0.6478, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation ious:  0.9876157504037028
[36m(ClientAppActor pid=2299151)[0m validation dice liver:  tensor(0.9925, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation dice tumour:  tensor(0.6524, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m => new best model:  0
[36m(ClientAppActor pid=2299151)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2299151)[0m epoch:  1
[36m(ClientAppActor pid=2299151)[0m train ious:  0.9916684500830167
[36m(ClientAppActor pid=2299151)[0m train dice liver:  tensor(0.9945, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m train dice tumour:  tensor(0.6554, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation ious:  0.9876099060150744
[36m(ClientAppActor pid=2299151)[0m validation dice liver:  tensor(0.9929, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation dice tumour:  tensor(0.6605, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m => new best model:  1
[36m(ClientAppActor pid=2299151)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2299151)[0m epoch:  2
[36m(ClientAppActor pid=2299151)[0m train ious:  0.9915909707121541
[36m(ClientAppActor pid=2299151)[0m train dice liver:  tensor(0.9944, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m train dice tumour:  tensor(0.6453, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation ious:  0.9874397382697074
[36m(ClientAppActor pid=2299151)[0m validation dice liver:  tensor(0.9927, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation dice tumour:  tensor(0.6622, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m => new best model:  2
[36m(ClientAppActor pid=2299151)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2299151)[0m epoch:  3
[36m(ClientAppActor pid=2299151)[0m train ious:  0.9922815297094071
[36m(ClientAppActor pid=2299151)[0m train dice liver:  tensor(0.9949, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m train dice tumour:  tensor(0.6615, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation ious:  0.9876047028392692
[36m(ClientAppActor pid=2299151)[0m validation dice liver:  tensor(0.9930, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation dice tumour:  tensor(0.6670, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m => new best model:  3
[36m(ClientAppActor pid=2299152)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2299152)[0m epoch:  0
[36m(ClientAppActor pid=2299152)[0m train ious:  0.9925723012890411
[36m(ClientAppActor pid=2299152)[0m train dice liver:  tensor(0.9954, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m train dice tumour:  tensor(0.7870, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation ious:  0.9805978870250381
[36m(ClientAppActor pid=2299152)[0m validation dice liver:  tensor(0.9907, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation dice tumour:  tensor(0.7458, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m => new best model:  0
[36m(ClientAppActor pid=2299152)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2299152)[0m epoch:  1
[36m(ClientAppActor pid=2299152)[0m train ious:  0.9924552837181432
[36m(ClientAppActor pid=2299152)[0m train dice liver:  tensor(0.9953, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m train dice tumour:  tensor(0.7971, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation ious:  0.9807671593081203
[36m(ClientAppActor pid=2299152)[0m validation dice liver:  tensor(0.9907, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation dice tumour:  tensor(0.7466, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m => new best model:  1
[36m(ClientAppActor pid=2299152)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2299152)[0m epoch:  2
[36m(ClientAppActor pid=2299152)[0m train ious:  0.9925630104631326
[36m(ClientAppActor pid=2299152)[0m train dice liver:  tensor(0.9954, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m train dice tumour:  tensor(0.8020, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation ious:  0.980667244291368
[36m(ClientAppActor pid=2299152)[0m validation dice liver:  tensor(0.9906, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation dice tumour:  tensor(0.7470, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m => new best model:  2
[36m(ClientAppActor pid=2299152)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2299152)[0m epoch:  3
[36m(ClientAppActor pid=2299152)[0m train ious:  
[36m(ClientAppActor pid=2299152)[0m 0.9926242125036561
[36m(ClientAppActor pid=2299152)[0m train dice liver:  tensor(0.9953, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m train dice tumour:  tensor(0.8098, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation ious:  0.9806552731635729
[36m(ClientAppActor pid=2299152)[0m validation dice liver:  tensor(0.9907, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation dice tumour:  tensor(0.7450, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m => new best model:  3
[2024-11-15 02:42:50,056][flwr][INFO] - aggregate_fit: received 2 results and 0 failures
[92mINFO [0m:      fit progress: (31, 0.003145138270666825, OrderedDict([('ind_iou_0', 0.9809420188226233), ('ind_dice_liver_0', tensor(0.9908, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7460, dtype=torch.float64)), ('ind_iou_1', 0.987630021999761), ('ind_dice_liver_1', tensor(0.9933, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6604, dtype=torch.float64)), ('all_iou', 0.9816477327470984), ('all_dice_liver', tensor(0.9910, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7459, dtype=torch.float64))]), 121524.79376896005)
Entrei no test
Meio do test
Fim do test
[2024-11-15 02:48:14,999][flwr][INFO] - fit progress: (31, 0.003145138270666825, OrderedDict([('ind_iou_0', 0.9809420188226233), ('ind_dice_liver_0', tensor(0.9908, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7460, dtype=torch.float64)), ('ind_iou_1', 0.987630021999761), ('ind_dice_liver_1', tensor(0.9933, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6604, dtype=torch.float64)), ('all_iou', 0.9816477327470984), ('all_dice_liver', tensor(0.9910, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7459, dtype=torch.float64))]), 121524.79376896005)
[92mINFO [0m:      configure_evaluate: strategy sampled 2 clients (out of 2)
[2024-11-15 02:48:15,033][flwr][INFO] - configure_evaluate: strategy sampled 2 clients (out of 2)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[36m(ClientAppActor pid=2299152)[0m Entrei no validation 1 3
[2024-11-15 02:48:25,982][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-11-15 02:48:25,983][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[2024-11-15 02:49:15,878][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-11-15 02:49:15,878][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 2 failures
[2024-11-15 02:49:15,879][flwr][INFO] - aggregate_evaluate: received 0 results and 2 failures
[92mINFO [0m:      
[2024-11-15 02:49:15,879][flwr][INFO] - 
[92mINFO [0m:      [ROUND 32]
[2024-11-15 02:49:15,879][flwr][INFO] - [ROUND 32]
[92mINFO [0m:      configure_fit: strategy sampled 2 clients (out of 2)
[2024-11-15 02:49:15,879][flwr][INFO] - configure_fit: strategy sampled 2 clients (out of 2)
[36m(ClientAppActor pid=2299151)[0m Entrei no validation 1 3[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=2299151)[0m epoch:  0
[36m(ClientAppActor pid=2299151)[0m train ious:  0.9904589367724409
[36m(ClientAppActor pid=2299151)[0m train dice liver:  tensor(0.9937, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m train dice tumour:  tensor(0.6563, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation ious:  0.9878165856485162
[36m(ClientAppActor pid=2299151)[0m validation dice liver:  tensor(0.9926, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation dice tumour:  tensor(0.6694, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m => new best model:  0
[36m(ClientAppActor pid=2299151)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2299151)[0m epoch:  1
[36m(ClientAppActor pid=2299151)[0m train ious:  0.9919467841606779
[36m(ClientAppActor pid=2299151)[0m train dice liver:  tensor(0.9946, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m train dice tumour:  tensor(0.6665, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation ious:  0.9879335727772408
[36m(ClientAppActor pid=2299151)[0m validation dice liver:  tensor(0.9930, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation dice tumour:  tensor(0.6705, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m => new best model:  1
[36m(ClientAppActor pid=2299151)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2299151)[0m epoch:  2
[36m(ClientAppActor pid=2299151)[0m train ious:  0.9923001426311172
[36m(ClientAppActor pid=2299151)[0m train dice liver:  tensor(0.9949, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m train dice tumour:  tensor(0.6678, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation ious:  0.9875588638973004
[36m(ClientAppActor pid=2299151)[0m validation dice liver:  tensor(0.9928, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation dice tumour:  tensor(0.6704, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m => new best model:  2
[36m(ClientAppActor pid=2299151)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2299151)[0m epoch:  3
[36m(ClientAppActor pid=2299151)[0m train ious:  0.9925283725312011
[36m(ClientAppActor pid=2299151)[0m train dice liver:  tensor(0.9951, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m train dice tumour:  tensor(0.6558, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation ious:  0.9873668470938816
[36m(ClientAppActor pid=2299151)[0m validation dice liver:  tensor(0.9927, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation dice tumour:  tensor(0.6727, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m => new best model:  3
[36m(ClientAppActor pid=2299152)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2299152)[0m epoch:  0
[36m(ClientAppActor pid=2299152)[0m train ious:  
[36m(ClientAppActor pid=2299152)[0m 0.9927729047832236
[36m(ClientAppActor pid=2299152)[0m train dice liver:  tensor(0.9955, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m train dice tumour:  tensor(0.7989, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation ious:  0.9807960669385508
[36m(ClientAppActor pid=2299152)[0m validation dice liver:  tensor(0.9907, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation dice tumour:  tensor(0.7469, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m => new best model:  0
[36m(ClientAppActor pid=2299152)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2299152)[0m epoch:  1
[36m(ClientAppActor pid=2299152)[0m train ious:  0.9926655614070382
[36m(ClientAppActor pid=2299152)[0m train dice liver:  tensor(0.9954, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m train dice tumour:  tensor(0.7944, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation ious:  0.9807405181120217
[92mINFO [0m:      aggregate_fit: received 2 results and 0 failures
[36m(ClientAppActor pid=2299152)[0m validation dice liver:  tensor(0.9907, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation dice tumour:  tensor(0.7477, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m => new best model:  1
[36m(ClientAppActor pid=2299152)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2299152)[0m epoch:  2
[36m(ClientAppActor pid=2299152)[0m train ious:  0.9927567618343199
[36m(ClientAppActor pid=2299152)[0m train dice liver:  tensor(0.9955, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m train dice tumour:  tensor(0.8010, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation ious:  0.9804995098110046
[36m(ClientAppActor pid=2299152)[0m validation dice liver:  tensor(0.9905, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation dice tumour:  tensor(0.7468, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m => new best model:  2
[36m(ClientAppActor pid=2299152)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2299152)[0m epoch:  3
[36m(ClientAppActor pid=2299152)[0m train ious:  0.9928162112143433
[36m(ClientAppActor pid=2299152)[0m train dice liver:  tensor(0.9955, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m train dice tumour:  tensor(0.7927, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation ious:  0.9807283569533538
[36m(ClientAppActor pid=2299152)[0m validation dice liver:  tensor(0.9907, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation dice tumour:  tensor(0.7468, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m => new best model:  3
[2024-11-15 04:07:00,924][flwr][INFO] - aggregate_fit: received 2 results and 0 failures
[92mINFO [0m:      fit progress: (32, 0.0031509861470073878, OrderedDict([('ind_iou_0', 0.9810080552507865), ('ind_dice_liver_0', tensor(0.9908, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7477, dtype=torch.float64)), ('ind_iou_1', 0.9876913720710354), ('ind_dice_liver_1', tensor(0.9933, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6606, dtype=torch.float64)), ('all_iou', 0.9817298098631053), ('all_dice_liver', tensor(0.9911, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7464, dtype=torch.float64))]), 126778.9214122761)
Entrei no test
Meio do test
Fim do test
[2024-11-15 04:15:49,126][flwr][INFO] - fit progress: (32, 0.0031509861470073878, OrderedDict([('ind_iou_0', 0.9810080552507865), ('ind_dice_liver_0', tensor(0.9908, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7477, dtype=torch.float64)), ('ind_iou_1', 0.9876913720710354), ('ind_dice_liver_1', tensor(0.9933, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6606, dtype=torch.float64)), ('all_iou', 0.9817298098631053), ('all_dice_liver', tensor(0.9911, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7464, dtype=torch.float64))]), 126778.9214122761)
[92mINFO [0m:      configure_evaluate: strategy sampled 2 clients (out of 2)
[2024-11-15 04:15:49,177][flwr][INFO] - configure_evaluate: strategy sampled 2 clients (out of 2)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[36m(ClientAppActor pid=2299151)[0m Entrei no validation 1 3
[2024-11-15 04:15:59,085][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-11-15 04:15:59,085][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[2024-11-15 04:16:48,764][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-11-15 04:16:48,764][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 2 failures
[2024-11-15 04:16:48,765][flwr][INFO] - aggregate_evaluate: received 0 results and 2 failures
[92mINFO [0m:      
[2024-11-15 04:16:48,765][flwr][INFO] - 
[92mINFO [0m:      [ROUND 33]
[2024-11-15 04:16:48,765][flwr][INFO] - [ROUND 33]
[92mINFO [0m:      configure_fit: strategy sampled 2 clients (out of 2)
[2024-11-15 04:16:48,765][flwr][INFO] - configure_fit: strategy sampled 2 clients (out of 2)
[92mINFO [0m:      aggregate_fit: received 2 results and 0 failures
[36m(ClientAppActor pid=2299151)[0m Entrei no validation 1 3[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=2299151)[0m epoch:  0
[36m(ClientAppActor pid=2299151)[0m train ious:  0.9905195416977105
[36m(ClientAppActor pid=2299151)[0m train dice liver:  tensor(0.9937, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m train dice tumour:  tensor(0.6678, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation ious:  0.9876870788525421
[36m(ClientAppActor pid=2299151)[0m validation dice liver:  tensor(0.9923, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation dice tumour:  tensor(0.6663, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m => new best model:  0
[36m(ClientAppActor pid=2299151)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2299151)[0m epoch:  1
[36m(ClientAppActor pid=2299151)[0m train ious:  0.9921304712006386
[36m(ClientAppActor pid=2299151)[0m train dice liver:  tensor(0.9948, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m train dice tumour:  tensor(0.6582, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation ious:  0.987924593801489
[36m(ClientAppActor pid=2299151)[0m validation dice liver:  tensor(0.9930, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation dice tumour:  tensor(0.6658, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m => new best model:  1
[36m(ClientAppActor pid=2299151)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2299151)[0m epoch:  2
[36m(ClientAppActor pid=2299151)[0m train ious:  0.9924016216161391
[36m(ClientAppActor pid=2299151)[0m train dice liver:  tensor(0.9949, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m train dice tumour:  tensor(0.6426, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation ious:  0.9878293731553958
[36m(ClientAppActor pid=2299151)[0m validation dice liver:  tensor(0.9932, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation dice tumour:  tensor(0.6692, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m => new best model:  2
[36m(ClientAppActor pid=2299151)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2299151)[0m epoch:  3
[36m(ClientAppActor pid=2299151)[0m train ious:  0.9927312198428528
[36m(ClientAppActor pid=2299151)[0m train dice liver:  tensor(0.9952, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m train dice tumour:  tensor(0.6442, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation ious:  0.9876664156977747
[36m(ClientAppActor pid=2299151)[0m validation dice liver:  tensor(0.9931, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation dice tumour:  tensor(0.6703, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m => new best model:  3
[36m(ClientAppActor pid=2299152)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2299152)[0m epoch:  0
[36m(ClientAppActor pid=2299152)[0m train ious:  0.9929719014286305
[36m(ClientAppActor pid=2299152)[0m train dice liver:  tensor(0.9956, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m train dice tumour:  tensor(0.7941, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation ious:  0.9808284695627704
[36m(ClientAppActor pid=2299152)[0m validation dice liver:  tensor(0.9908, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation dice tumour:  tensor(0.7477, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m => new best model:  0
[36m(ClientAppActor pid=2299152)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2299152)[0m epoch:  1
[36m(ClientAppActor pid=2299152)[0m train ious:  0.9928532760537582
[36m(ClientAppActor pid=2299152)[0m train dice liver:  tensor(0.9955, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m train dice tumour:  tensor(0.7919, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation ious:  0.9806771552043574
[36m(ClientAppActor pid=2299152)[0m validation dice liver:  tensor(0.9907, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation dice tumour:  tensor(0.7471, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m => new best model:  1
[36m(ClientAppActor pid=2299152)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2299152)[0m epoch:  2
[36m(ClientAppActor pid=2299152)[0m train ious:  0.9929163350312719
[36m(ClientAppActor pid=2299152)[0m train dice liver:  tensor(0.9956, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m train dice tumour:  tensor(0.7921, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation ious:  0.980722411988442
[36m(ClientAppActor pid=2299152)[0m validation dice liver:  tensor(0.9907, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation dice tumour:  tensor(0.7470, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m => new best model:  2
[36m(ClientAppActor pid=2299152)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2299152)[0m epoch:  3
[36m(ClientAppActor pid=2299152)[0m train ious:  
[2024-11-15 05:36:55,978][flwr][INFO] - aggregate_fit: received 2 results and 0 failures
[92mINFO [0m:      fit progress: (33, 0.0032074319885591848, OrderedDict([('ind_iou_0', 0.9810402144926662), ('ind_dice_liver_0', tensor(0.9908, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7476, dtype=torch.float64)), ('ind_iou_1', 0.988065078218748), ('ind_dice_liver_1', tensor(0.9936, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6640, dtype=torch.float64)), ('all_iou', 0.9818005536698506), ('all_dice_liver', tensor(0.9912, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7469, dtype=torch.float64))]), 132036.6901311162)
[36m(ClientAppActor pid=2299152)[0m 0.9929524966259662
[36m(ClientAppActor pid=2299152)[0m train dice liver:  tensor(0.9956, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m train dice tumour:  tensor(0.7945, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation ious:  0.9807534523408377
[36m(ClientAppActor pid=2299152)[0m validation dice liver:  tensor(0.9907, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation dice tumour:  tensor(0.7466, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m => new best model:  3
Entrei no test
Meio do test
Fim do test
[2024-11-15 05:43:26,895][flwr][INFO] - fit progress: (33, 0.0032074319885591848, OrderedDict([('ind_iou_0', 0.9810402144926662), ('ind_dice_liver_0', tensor(0.9908, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7476, dtype=torch.float64)), ('ind_iou_1', 0.988065078218748), ('ind_dice_liver_1', tensor(0.9936, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6640, dtype=torch.float64)), ('all_iou', 0.9818005536698506), ('all_dice_liver', tensor(0.9912, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7469, dtype=torch.float64))]), 132036.6901311162)
[92mINFO [0m:      configure_evaluate: strategy sampled 2 clients (out of 2)
[2024-11-15 05:43:26,939][flwr][INFO] - configure_evaluate: strategy sampled 2 clients (out of 2)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[36m(ClientAppActor pid=2299152)[0m Entrei no validation 1 3
[2024-11-15 05:43:37,596][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-11-15 05:43:37,596][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-11-15 05:44:26,338][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-11-15 05:44:26,338][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 2 failures
[2024-11-15 05:44:26,339][flwr][INFO] - aggregate_evaluate: received 0 results and 2 failures
[92mINFO [0m:      
[2024-11-15 05:44:26,339][flwr][INFO] - 
[92mINFO [0m:      [ROUND 34]
[2024-11-15 05:44:26,339][flwr][INFO] - [ROUND 34]
[92mINFO [0m:      configure_fit: strategy sampled 2 clients (out of 2)
[2024-11-15 05:44:26,340][flwr][INFO] - configure_fit: strategy sampled 2 clients (out of 2)
[92mINFO [0m:      aggregate_fit: received 2 results and 0 failures
[36m(ClientAppActor pid=2299152)[0m Entrei no validation 1 3[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=2299152)[0m epoch:  0
[36m(ClientAppActor pid=2299152)[0m train ious:  0.9906411059578891
[36m(ClientAppActor pid=2299152)[0m train dice liver:  tensor(0.9938, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m train dice tumour:  tensor(0.6549, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation ious:  0.9877016156689353
[36m(ClientAppActor pid=2299152)[0m validation dice liver:  tensor(0.9925, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation dice tumour:  tensor(0.6647, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m => new best model:  0
[36m(ClientAppActor pid=2299152)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2299152)[0m epoch:  1
[36m(ClientAppActor pid=2299152)[0m train ious:  0.9922344803195023
[36m(ClientAppActor pid=2299152)[0m train dice liver:  tensor(0.9948, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m train dice tumour:  tensor(0.6544, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation ious:  0.9878119439819026
[36m(ClientAppActor pid=2299152)[0m validation dice liver:  tensor(0.9929, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation dice tumour:  tensor(0.6674, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m => new best model:  1
[36m(ClientAppActor pid=2299152)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2299152)[0m epoch:  2
[36m(ClientAppActor pid=2299152)[0m train ious:  0.9927739605472151
[36m(ClientAppActor pid=2299152)[0m train dice liver:  tensor(0.9952, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m train dice tumour:  tensor(0.6321, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation ious:  0.9880383364853342
[36m(ClientAppActor pid=2299152)[0m validation dice liver:  tensor(0.9933, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation dice tumour:  tensor(0.6692, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m => new best model:  2
[36m(ClientAppActor pid=2299152)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2299152)[0m epoch:  3
[36m(ClientAppActor pid=2299152)[0m train ious:  0.9928565761332283
[36m(ClientAppActor pid=2299152)[0m train dice liver:  tensor(0.9953, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m train dice tumour:  tensor(0.6397, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation ious:  0.9877047009563381
[36m(ClientAppActor pid=2299152)[0m validation dice liver:  tensor(0.9932, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation dice tumour:  tensor(0.6673, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m => new best model:  3
[36m(ClientAppActor pid=2299151)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2299151)[0m epoch:  0
[36m(ClientAppActor pid=2299151)[0m train ious:  0.9930878898567471
[36m(ClientAppActor pid=2299151)[0m train dice liver:  tensor(0.9957, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m train dice tumour:  tensor(0.8050, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation ious:  0.9807542728675301
[36m(ClientAppActor pid=2299151)[0m validation dice liver:  tensor(0.9908, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation dice tumour:  tensor(0.7469, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m => new best model:  0
[36m(ClientAppActor pid=2299151)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2299151)[0m epoch:  1
[36m(ClientAppActor pid=2299151)[0m train ious:  0.9930563602275798
[36m(ClientAppActor pid=2299151)[0m train dice liver:  tensor(0.9957, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m train dice tumour:  tensor(0.7940, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation ious:  0.9807002272035055
[36m(ClientAppActor pid=2299151)[0m validation dice liver:  tensor(0.9907, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation dice tumour:  tensor(0.7486, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m => new best model:  1
[36m(ClientAppActor pid=2299151)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2299151)[0m epoch:  2
[36m(ClientAppActor pid=2299151)[0m train ious:  0.9929807894898034
[36m(ClientAppActor pid=2299151)[0m train dice liver:  tensor(0.9956, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m train dice tumour:  tensor(0.7963, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation ious:  0.9807289823933414
[36m(ClientAppActor pid=2299151)[0m validation dice liver:  tensor(0.9907, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation dice tumour:  tensor(0.7460, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m => new best model:  2
[36m(ClientAppActor pid=2299151)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2299151)[0m epoch:  3
[36m(ClientAppActor pid=2299151)[0m train ious:  0.9930728312086498
[36m(ClientAppActor pid=2299151)[0m train dice liver:  tensor(0.9957, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m train dice tumour:  tensor(0.7964, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation ious:  0.9807998128079817
[36m(ClientAppActor pid=2299151)[0m validation dice liver:  tensor(0.9908, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation dice tumour:  tensor(0.7488, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m => new best model:  3
[2024-11-15 07:03:22,496][flwr][INFO] - aggregate_fit: received 2 results and 0 failures
[92mINFO [0m:      fit progress: (34, 0.0032246610105029936, OrderedDict([('ind_iou_0', 0.9810605125473157), ('ind_dice_liver_0', tensor(0.9909, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7496, dtype=torch.float64)), ('ind_iou_1', 0.9881273870707611), ('ind_dice_liver_1', tensor(0.9936, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6641, dtype=torch.float64)), ('all_iou', 0.9818437789043013), ('all_dice_liver', tensor(0.9912, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7479, dtype=torch.float64))]), 137149.37320587784)
Entrei no test
Meio do test
Fim do test
[2024-11-15 07:08:39,578][flwr][INFO] - fit progress: (34, 0.0032246610105029936, OrderedDict([('ind_iou_0', 0.9810605125473157), ('ind_dice_liver_0', tensor(0.9909, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7496, dtype=torch.float64)), ('ind_iou_1', 0.9881273870707611), ('ind_dice_liver_1', tensor(0.9936, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6641, dtype=torch.float64)), ('all_iou', 0.9818437789043013), ('all_dice_liver', tensor(0.9912, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7479, dtype=torch.float64))]), 137149.37320587784)
[92mINFO [0m:      configure_evaluate: strategy sampled 2 clients (out of 2)
[2024-11-15 07:08:39,609][flwr][INFO] - configure_evaluate: strategy sampled 2 clients (out of 2)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[36m(ClientAppActor pid=2299152)[0m Entrei no validation 1 3
[2024-11-15 07:08:49,703][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-11-15 07:08:49,704][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[2024-11-15 07:09:38,511][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-11-15 07:09:38,511][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 2 failures
[2024-11-15 07:09:38,511][flwr][INFO] - aggregate_evaluate: received 0 results and 2 failures
[92mINFO [0m:      
[2024-11-15 07:09:38,511][flwr][INFO] - 
[92mINFO [0m:      [ROUND 35]
[2024-11-15 07:09:38,512][flwr][INFO] - [ROUND 35]
[92mINFO [0m:      configure_fit: strategy sampled 2 clients (out of 2)
[2024-11-15 07:09:38,512][flwr][INFO] - configure_fit: strategy sampled 2 clients (out of 2)
[92mINFO [0m:      aggregate_fit: received 2 results and 0 failures
[36m(ClientAppActor pid=2299151)[0m Entrei no validation 1 3[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=2299151)[0m epoch:  0
[36m(ClientAppActor pid=2299151)[0m train ious:  0.9908776887063286
[36m(ClientAppActor pid=2299151)[0m train dice liver:  tensor(0.9940, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m train dice tumour:  tensor(0.6782, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation ious:  0.9881448782828613
[36m(ClientAppActor pid=2299151)[0m validation dice liver:  tensor(0.9928, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation dice tumour:  tensor(0.6668, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m => new best model:  0
[36m(ClientAppActor pid=2299151)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2299151)[0m epoch:  1
[36m(ClientAppActor pid=2299151)[0m train ious:  0.9922593557836644
[36m(ClientAppActor pid=2299151)[0m train dice liver:  tensor(0.9949, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m train dice tumour:  tensor(0.6453, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation ious:  0.9877845757043623
[36m(ClientAppActor pid=2299151)[0m validation dice liver:  tensor(0.9930, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation dice tumour:  tensor(0.6632, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m => new best model:  1
[36m(ClientAppActor pid=2299151)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2299151)[0m epoch:  2
[36m(ClientAppActor pid=2299151)[0m train ious:  0.9927077681883102
[36m(ClientAppActor pid=2299151)[0m train dice liver:  tensor(0.9952, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m train dice tumour:  tensor(0.6760, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation ious:  0.9880275892895886
[36m(ClientAppActor pid=2299151)[0m validation dice liver:  tensor(0.9932, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation dice tumour:  tensor(0.6679, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m => new best model:  2
[36m(ClientAppActor pid=2299151)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2299151)[0m epoch:  3
[36m(ClientAppActor pid=2299151)[0m train ious:  0.9929441226846735
[36m(ClientAppActor pid=2299151)[0m train dice liver:  tensor(0.9954, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m train dice tumour:  tensor(0.6469, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation ious:  0.9876990628433917
[36m(ClientAppActor pid=2299151)[0m validation dice liver:  tensor(0.9932, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation dice tumour:  tensor(0.6649, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m => new best model:  3
[36m(ClientAppActor pid=2299152)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2299152)[0m epoch:  0
[36m(ClientAppActor pid=2299152)[0m train ious:  
[36m(ClientAppActor pid=2299152)[0m 0.9932630956070408
[36m(ClientAppActor pid=2299152)[0m train dice liver:  tensor(0.9958, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m train dice tumour:  tensor(0.8020, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation ious:  0.9809295197508918
[36m(ClientAppActor pid=2299152)[0m validation dice liver:  tensor(0.9909, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation dice tumour:  tensor(0.7470, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m => new best model:  0
[36m(ClientAppActor pid=2299152)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2299152)[0m epoch:  1
[36m(ClientAppActor pid=2299152)[0m train ious:  0.9931549433737147
[36m(ClientAppActor pid=2299152)[0m train dice liver:  tensor(0.9957, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m train dice tumour:  tensor(0.7987, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation ious:  0.9807395758888576
[36m(ClientAppActor pid=2299152)[0m validation dice liver:  tensor(0.9908, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation dice tumour:  tensor(0.7456, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m => new best model:  1
[36m(ClientAppActor pid=2299152)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2299152)[0m epoch:  2
[36m(ClientAppActor pid=2299152)[0m train ious:  0.9932139947298537
[36m(ClientAppActor pid=2299152)[0m train dice liver:  tensor(0.9958, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m train dice tumour:  tensor(0.8081, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation ious:  0.9808698748296297
[36m(ClientAppActor pid=2299152)[0m validation dice liver:  tensor(0.9908, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation dice tumour:  tensor(0.7477, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m => new best model:  2
[36m(ClientAppActor pid=2299152)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2299152)[0m epoch:  3
[36m(ClientAppActor pid=2299152)[0m train ious:  
[2024-11-15 08:29:26,966][flwr][INFO] - aggregate_fit: received 2 results and 0 failures
[92mINFO [0m:      fit progress: (35, 0.0032733304687697046, OrderedDict([('ind_iou_0', 0.9811462549218833), ('ind_dice_liver_0', tensor(0.9910, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7476, dtype=torch.float64)), ('ind_iou_1', 0.9881254223114805), ('ind_dice_liver_1', tensor(0.9937, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6611, dtype=torch.float64)), ('all_iou', 0.9818994264891394), ('all_dice_liver', tensor(0.9913, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7469, dtype=torch.float64))]), 142329.04343887884)
[36m(ClientAppActor pid=2299152)[0m 0.9932309462771959
[36m(ClientAppActor pid=2299152)[0m train dice liver:  tensor(0.9958, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m train dice tumour:  tensor(0.8034, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation ious:  0.9808766056465036
[36m(ClientAppActor pid=2299152)[0m validation dice liver:  tensor(0.9909, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation dice tumour:  tensor(0.7463, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m => new best model:  3
Entrei no test
Meio do test
Fim do test
[2024-11-15 08:34:59,248][flwr][INFO] - fit progress: (35, 0.0032733304687697046, OrderedDict([('ind_iou_0', 0.9811462549218833), ('ind_dice_liver_0', tensor(0.9910, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7476, dtype=torch.float64)), ('ind_iou_1', 0.9881254223114805), ('ind_dice_liver_1', tensor(0.9937, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6611, dtype=torch.float64)), ('all_iou', 0.9818994264891394), ('all_dice_liver', tensor(0.9913, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7469, dtype=torch.float64))]), 142329.04343887884)
[92mINFO [0m:      configure_evaluate: strategy sampled 2 clients (out of 2)
[2024-11-15 08:34:59,279][flwr][INFO] - configure_evaluate: strategy sampled 2 clients (out of 2)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[36m(ClientAppActor pid=2299152)[0m Entrei no validation 1 3
[2024-11-15 08:35:09,703][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-11-15 08:35:09,703][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-11-15 08:35:59,402][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-11-15 08:35:59,403][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 2 failures
[2024-11-15 08:35:59,404][flwr][INFO] - aggregate_evaluate: received 0 results and 2 failures
[92mINFO [0m:      
[2024-11-15 08:35:59,404][flwr][INFO] - 
[92mINFO [0m:      [ROUND 36]
[2024-11-15 08:35:59,404][flwr][INFO] - [ROUND 36]
[92mINFO [0m:      configure_fit: strategy sampled 2 clients (out of 2)
[2024-11-15 08:35:59,404][flwr][INFO] - configure_fit: strategy sampled 2 clients (out of 2)
[92mINFO [0m:      aggregate_fit: received 2 results and 0 failures
[36m(ClientAppActor pid=2299151)[0m Entrei no validation 1 3[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=2299151)[0m epoch:  0
[36m(ClientAppActor pid=2299151)[0m train ious:  0.9910522979971107
[36m(ClientAppActor pid=2299151)[0m train dice liver:  tensor(0.9941, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m train dice tumour:  tensor(0.6727, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation ious:  0.9881844359953157
[36m(ClientAppActor pid=2299151)[0m validation dice liver:  tensor(0.9926, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation dice tumour:  tensor(0.6668, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m => new best model:  0
[36m(ClientAppActor pid=2299151)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2299151)[0m epoch:  1
[36m(ClientAppActor pid=2299151)[0m train ious:  0.9925602818209024
[36m(ClientAppActor pid=2299151)[0m train dice liver:  tensor(0.9950, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m train dice tumour:  tensor(0.6542, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation ious:  0.9879149439829834
[36m(ClientAppActor pid=2299151)[0m validation dice liver:  tensor(0.9930, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation dice tumour:  tensor(0.6609, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m => new best model:  1
[36m(ClientAppActor pid=2299151)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2299151)[0m epoch:  2
[36m(ClientAppActor pid=2299151)[0m train ious:  0.992757769719239
[36m(ClientAppActor pid=2299151)[0m train dice liver:  tensor(0.9952, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m train dice tumour:  tensor(0.6309, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation ious:  0.9879194552835183
[36m(ClientAppActor pid=2299151)[0m validation dice liver:  tensor(0.9932, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation dice tumour:  tensor(0.6642, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m => new best model:  2
[36m(ClientAppActor pid=2299151)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2299151)[0m epoch:  3
[36m(ClientAppActor pid=2299151)[0m train ious:  0.9930197325891794
[36m(ClientAppActor pid=2299151)[0m train dice liver:  tensor(0.9954, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m train dice tumour:  tensor(0.6505, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation ious:  0.9879990361244355
[36m(ClientAppActor pid=2299151)[0m validation dice liver:  tensor(0.9933, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation dice tumour:  tensor(0.6676, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m => new best model:  3
[36m(ClientAppActor pid=2299152)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2299152)[0m epoch:  0
[36m(ClientAppActor pid=2299152)[0m train ious:  0.9934005284906443
[36m(ClientAppActor pid=2299152)[0m train dice liver:  tensor(0.9959, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m train dice tumour:  tensor(0.7954, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation ious:  0.9807824491991912
[36m(ClientAppActor pid=2299152)[0m validation dice liver:  tensor(0.9908, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation dice tumour:  tensor(0.7477, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m => new best model:  0
[36m(ClientAppActor pid=2299152)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2299152)[0m epoch:  1
[36m(ClientAppActor pid=2299152)[0m train ious:  0.993385668607507
[36m(ClientAppActor pid=2299152)[0m train dice liver:  tensor(0.9959, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m train dice tumour:  tensor(0.8044, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation ious:  0.9808758261485564
[36m(ClientAppActor pid=2299152)[0m validation dice liver:  tensor(0.9909, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation dice tumour:  tensor(0.7476, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m => new best model:  1
[36m(ClientAppActor pid=2299152)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2299152)[0m epoch:  2
[36m(ClientAppActor pid=2299152)[0m train ious:  0.9933995597430691
[36m(ClientAppActor pid=2299152)[0m train dice liver:  tensor(0.9959, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m train dice tumour:  tensor(0.7971, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation ious:  0.9808630727503868
[36m(ClientAppActor pid=2299152)[0m validation dice liver:  tensor(0.9909, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation dice tumour:  tensor(0.7488, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m => new best model:  2
[36m(ClientAppActor pid=2299152)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2299152)[0m epoch:  3
[36m(ClientAppActor pid=2299152)[0m train ious:  0.9934378156158984
[36m(ClientAppActor pid=2299152)[0m train dice liver:  tensor(0.9959, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m train dice tumour:  tensor(0.8039, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation ious:  0.9808433289474924
[36m(ClientAppActor pid=2299152)[0m validation dice liver:  tensor(0.9909, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation dice tumour:  tensor(0.7472, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m => new best model:  3
[2024-11-15 09:57:47,583][flwr][INFO] - aggregate_fit: received 2 results and 0 failures
[92mINFO [0m:      fit progress: (36, 0.003296733335104597, OrderedDict([('ind_iou_0', 0.9810930991272008), ('ind_dice_liver_0', tensor(0.9910, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7481, dtype=torch.float64)), ('ind_iou_1', 0.9882871766740609), ('ind_dice_liver_1', tensor(0.9938, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6619, dtype=torch.float64)), ('all_iou', 0.9818586496058248), ('all_dice_liver', tensor(0.9913, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7470, dtype=torch.float64))]), 147659.21689032298)
Entrei no test
Meio do test
Fim do test
[2024-11-15 10:03:49,422][flwr][INFO] - fit progress: (36, 0.003296733335104597, OrderedDict([('ind_iou_0', 0.9810930991272008), ('ind_dice_liver_0', tensor(0.9910, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7481, dtype=torch.float64)), ('ind_iou_1', 0.9882871766740609), ('ind_dice_liver_1', tensor(0.9938, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6619, dtype=torch.float64)), ('all_iou', 0.9818586496058248), ('all_dice_liver', tensor(0.9913, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7470, dtype=torch.float64))]), 147659.21689032298)
[92mINFO [0m:      configure_evaluate: strategy sampled 2 clients (out of 2)
[2024-11-15 10:03:49,457][flwr][INFO] - configure_evaluate: strategy sampled 2 clients (out of 2)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[36m(ClientAppActor pid=2299152)[0m Entrei no validation 1 3
[2024-11-15 10:03:59,060][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-11-15 10:03:59,060][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[2024-11-15 10:04:48,143][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-11-15 10:04:48,143][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 2 failures
[2024-11-15 10:04:48,144][flwr][INFO] - aggregate_evaluate: received 0 results and 2 failures
[92mINFO [0m:      
[2024-11-15 10:04:48,144][flwr][INFO] - 
[92mINFO [0m:      [ROUND 37]
[2024-11-15 10:04:48,144][flwr][INFO] - [ROUND 37]
[92mINFO [0m:      configure_fit: strategy sampled 2 clients (out of 2)
[2024-11-15 10:04:48,145][flwr][INFO] - configure_fit: strategy sampled 2 clients (out of 2)
[92mINFO [0m:      aggregate_fit: received 2 results and 0 failures
[36m(ClientAppActor pid=2299151)[0m Entrei no validation 1 3[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=2299151)[0m epoch:  0
[36m(ClientAppActor pid=2299151)[0m train ious:  0.9912126750673537
[36m(ClientAppActor pid=2299151)[0m train dice liver:  tensor(0.9942, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m train dice tumour:  tensor(0.6574, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation ious:  0.9881738703006523
[36m(ClientAppActor pid=2299151)[0m validation dice liver:  tensor(0.9929, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation dice tumour:  tensor(0.6666, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m => new best model:  0
[36m(ClientAppActor pid=2299151)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2299151)[0m epoch:  1
[36m(ClientAppActor pid=2299151)[0m train ious:  0.992699511480271
[36m(ClientAppActor pid=2299151)[0m train dice liver:  tensor(0.9951, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m train dice tumour:  tensor(0.6811, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation ious:  0.9885456144598558
[36m(ClientAppActor pid=2299151)[0m validation dice liver:  tensor(0.9934, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation dice tumour:  tensor(0.6665, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m => new best model:  1
[36m(ClientAppActor pid=2299151)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2299151)[0m epoch:  2
[36m(ClientAppActor pid=2299151)[0m train ious:  0.9930534814352325
[36m(ClientAppActor pid=2299151)[0m train dice liver:  tensor(0.9954, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m train dice tumour:  tensor(0.6813, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation ious:  0.9883816025568377
[36m(ClientAppActor pid=2299151)[0m validation dice liver:  tensor(0.9935, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation dice tumour:  tensor(0.6690, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m => new best model:  2
[36m(ClientAppActor pid=2299151)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2299151)[0m epoch:  3
[36m(ClientAppActor pid=2299151)[0m train ious:  0.9933147237465244
[36m(ClientAppActor pid=2299151)[0m train dice liver:  tensor(0.9956, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m train dice tumour:  tensor(0.6772, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation ious:  0.9883037255457274
[36m(ClientAppActor pid=2299151)[0m validation dice liver:  tensor(0.9935, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation dice tumour:  tensor(0.6672, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m => new best model:  3
[36m(ClientAppActor pid=2299152)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2299152)[0m epoch:  0
[36m(ClientAppActor pid=2299152)[0m train ious:  
[36m(ClientAppActor pid=2299152)[0m 0.9935288890530629
[36m(ClientAppActor pid=2299152)[0m train dice liver:  tensor(0.9960, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m train dice tumour:  tensor(0.8034, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation ious:  0.9809457198650184
[36m(ClientAppActor pid=2299152)[0m validation dice liver:  tensor(0.9909, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation dice tumour:  tensor(0.7480, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m => new best model:  0
[36m(ClientAppActor pid=2299152)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2299152)[0m epoch:  1
[36m(ClientAppActor pid=2299152)[0m train ious:  0.9934929533804556
[36m(ClientAppActor pid=2299152)[0m train dice liver:  tensor(0.9959, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m train dice tumour:  tensor(0.7981, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation ious:  0.980834743019446
[36m(ClientAppActor pid=2299152)[0m validation dice liver:  tensor(0.9909, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation dice tumour:  tensor(0.7463, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m => new best model:  1
[36m(ClientAppActor pid=2299152)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2299152)[0m epoch:  2
[36m(ClientAppActor pid=2299152)[0m train ious:  0.9935360966754654
[36m(ClientAppActor pid=2299152)[0m train dice liver:  tensor(0.9960, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m train dice tumour:  tensor(0.8014, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation ious:  0.980863006777009
[36m(ClientAppActor pid=2299152)[0m validation dice liver:  tensor(0.9909, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation dice tumour:  tensor(0.7487, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m => new best model:  2
[36m(ClientAppActor pid=2299152)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2299152)[0m epoch:  3
[36m(ClientAppActor pid=2299152)[0m train ious:  
[36m(ClientAppActor pid=2299152)[0m 0.9935600483964502
[36m(ClientAppActor pid=2299152)[0m train dice liver:  tensor(0.9960, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m train dice tumour:  tensor(0.8066, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation ious:  0.981002993226144
[36m(ClientAppActor pid=2299152)[0m validation dice liver:  tensor(0.9909, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation dice tumour:  tensor(0.7481, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m => new best model:  3
[2024-11-15 12:28:09,838][flwr][INFO] - aggregate_fit: received 2 results and 0 failures
[92mINFO [0m:      fit progress: (37, 0.0033003540282158733, OrderedDict([('ind_iou_0', 0.981255538554834), ('ind_dice_liver_0', tensor(0.9910, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7489, dtype=torch.float64)), ('ind_iou_1', 0.9883380435456242), ('ind_dice_liver_1', tensor(0.9938, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6638, dtype=torch.float64)), ('all_iou', 0.9820124261753345), ('all_dice_liver', tensor(0.9914, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7483, dtype=torch.float64))]), 157007.89747237694)
Entrei no test
Meio do test
Fim do test
[2024-11-15 12:39:38,102][flwr][INFO] - fit progress: (37, 0.0033003540282158733, OrderedDict([('ind_iou_0', 0.981255538554834), ('ind_dice_liver_0', tensor(0.9910, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7489, dtype=torch.float64)), ('ind_iou_1', 0.9883380435456242), ('ind_dice_liver_1', tensor(0.9938, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6638, dtype=torch.float64)), ('all_iou', 0.9820124261753345), ('all_dice_liver', tensor(0.9914, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7483, dtype=torch.float64))]), 157007.89747237694)
[92mINFO [0m:      configure_evaluate: strategy sampled 2 clients (out of 2)
[2024-11-15 12:39:38,122][flwr][INFO] - configure_evaluate: strategy sampled 2 clients (out of 2)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[36m(ClientAppActor pid=2299152)[0m Entrei no validation 1 3
[2024-11-15 12:39:49,164][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-11-15 12:39:49,164][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[2024-11-15 12:40:36,749][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-11-15 12:40:36,749][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 2 failures
[2024-11-15 12:40:36,749][flwr][INFO] - aggregate_evaluate: received 0 results and 2 failures
[92mINFO [0m:      
[2024-11-15 12:40:36,750][flwr][INFO] - 
[92mINFO [0m:      [ROUND 38]
[2024-11-15 12:40:36,750][flwr][INFO] - [ROUND 38]
[92mINFO [0m:      configure_fit: strategy sampled 2 clients (out of 2)
[2024-11-15 12:40:36,750][flwr][INFO] - configure_fit: strategy sampled 2 clients (out of 2)
[92mINFO [0m:      aggregate_fit: received 2 results and 0 failures
[36m(ClientAppActor pid=2299151)[0m Entrei no validation 1 3[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=2299151)[0m epoch:  0
[36m(ClientAppActor pid=2299151)[0m train ious:  0.9912462808312132
[36m(ClientAppActor pid=2299151)[0m train dice liver:  tensor(0.9942, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m train dice tumour:  tensor(0.6588, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation ious:  0.9885057694613426
[36m(ClientAppActor pid=2299151)[0m validation dice liver:  tensor(0.9930, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation dice tumour:  tensor(0.6672, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m => new best model:  0
[36m(ClientAppActor pid=2299151)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2299151)[0m epoch:  1
[36m(ClientAppActor pid=2299151)[0m train ious:  0.9922269300358956
[36m(ClientAppActor pid=2299151)[0m train dice liver:  tensor(0.9947, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m train dice tumour:  tensor(0.6783, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation ious:  0.9883695339028886
[36m(ClientAppActor pid=2299151)[0m validation dice liver:  tensor(0.9932, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation dice tumour:  tensor(0.6714, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m => new best model:  1
[36m(ClientAppActor pid=2299151)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2299151)[0m epoch:  2
[36m(ClientAppActor pid=2299151)[0m train ious:  0.9932154780560022
[36m(ClientAppActor pid=2299151)[0m train dice liver:  tensor(0.9955, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m train dice tumour:  tensor(0.6492, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation ious:  0.9883566204945943
[36m(ClientAppActor pid=2299151)[0m validation dice liver:  tensor(0.9935, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation dice tumour:  tensor(0.6701, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m => new best model:  2
[36m(ClientAppActor pid=2299151)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2299151)[0m epoch:  3
[36m(ClientAppActor pid=2299151)[0m train ious:  0.9933447083748305
[36m(ClientAppActor pid=2299151)[0m train dice liver:  tensor(0.9957, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m train dice tumour:  tensor(0.6482, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation ious:  0.987991443301392
[36m(ClientAppActor pid=2299151)[0m validation dice liver:  tensor(0.9934, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m validation dice tumour:  tensor(0.6681, dtype=torch.float64)
[36m(ClientAppActor pid=2299151)[0m => new best model:  3
[36m(ClientAppActor pid=2299152)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2299152)[0m epoch:  0
[36m(ClientAppActor pid=2299152)[0m train ious:  0.9936853825371227
[36m(ClientAppActor pid=2299152)[0m train dice liver:  tensor(0.9961, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m train dice tumour:  tensor(0.8029, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation ious:  0.9806837477570387
[36m(ClientAppActor pid=2299152)[0m validation dice liver:  tensor(0.9908, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation dice tumour:  tensor(0.7471, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m => new best model:  0
[36m(ClientAppActor pid=2299152)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2299152)[0m epoch:  1
[36m(ClientAppActor pid=2299152)[0m train ious:  0.9936203737242181
[36m(ClientAppActor pid=2299152)[0m train dice liver:  tensor(0.9960, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m train dice tumour:  tensor(0.7965, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation ious:  0.9808403521477156
[36m(ClientAppActor pid=2299152)[0m validation dice liver:  tensor(0.9909, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation dice tumour:  tensor(0.7475, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m => new best model:  1
[36m(ClientAppActor pid=2299152)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2299152)[0m epoch:  2
[36m(ClientAppActor pid=2299152)[0m train ious:  0.9936420174342597
[36m(ClientAppActor pid=2299152)[0m train dice liver:  tensor(0.9960, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m train dice tumour:  tensor(0.7945, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation ious:  0.9809480865232852
[36m(ClientAppActor pid=2299152)[0m validation dice liver:  tensor(0.9910, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation dice tumour:  tensor(0.7483, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m => new best model:  2
[36m(ClientAppActor pid=2299152)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=2299152)[0m epoch:  3
[36m(ClientAppActor pid=2299152)[0m train ious:  0.993717922461708
[36m(ClientAppActor pid=2299152)[0m train dice liver:  tensor(0.9961, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m train dice tumour:  tensor(0.8011, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation ious:  0.9809065838116687
[36m(ClientAppActor pid=2299152)[0m validation dice liver:  tensor(0.9910, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m validation dice tumour:  tensor(0.7486, dtype=torch.float64)
[36m(ClientAppActor pid=2299152)[0m => new best model:  3
[2024-11-15 14:51:21,027][flwr][INFO] - aggregate_fit: received 2 results and 0 failures
[92mINFO [0m:      fit progress: (38, 0.0033923542049218427, OrderedDict([('ind_iou_0', 0.9811653761216033), ('ind_dice_liver_0', tensor(0.9911, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7493, dtype=torch.float64)), ('ind_iou_1', 0.9884021186193479), ('ind_dice_liver_1', tensor(0.9939, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6627, dtype=torch.float64)), ('all_iou', 0.9819562586785373), ('all_dice_liver', tensor(0.9914, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7482, dtype=torch.float64))]), 165374.351038259)
Entrei no test
Meio do test
Fim do test
[2024-11-15 14:59:04,556][flwr][INFO] - fit progress: (38, 0.0033923542049218427, OrderedDict([('ind_iou_0', 0.9811653761216033), ('ind_dice_liver_0', tensor(0.9911, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7493, dtype=torch.float64)), ('ind_iou_1', 0.9884021186193479), ('ind_dice_liver_1', tensor(0.9939, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6627, dtype=torch.float64)), ('all_iou', 0.9819562586785373), ('all_dice_liver', tensor(0.9914, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7482, dtype=torch.float64))]), 165374.351038259)
[92mINFO [0m:      configure_evaluate: strategy sampled 2 clients (out of 2)
[2024-11-15 14:59:04,742][flwr][INFO] - configure_evaluate: strategy sampled 2 clients (out of 2)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[36m(ClientAppActor pid=2299151)[0m Entrei no validation 1 3
[2024-11-15 14:59:15,266][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-11-15 14:59:15,267][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299151, ip=172.18.62.3, actor_id=25fbe341cc90eb1165d1d27b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x146e7d7cd4f0>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[2024-11-15 15:00:04,365][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2024-11-15 15:00:04,365][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=2299152, ip=172.18.62.3, actor_id=be922e5e0996c9cfa3e9ca9301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x1516ee718460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 2 failures
[2024-11-15 15:00:04,365][flwr][INFO] - aggregate_evaluate: received 0 results and 2 failures
[92mINFO [0m:      
[2024-11-15 15:00:04,365][flwr][INFO] - 
[92mINFO [0m:      [ROUND 39]
[2024-11-15 15:00:04,366][flwr][INFO] - [ROUND 39]
[92mINFO [0m:      configure_fit: strategy sampled 2 clients (out of 2)
[2024-11-15 15:00:04,366][flwr][INFO] - configure_fit: strategy sampled 2 clients (out of 2)
srun: Job step aborted: Waiting up to 32 seconds for job step to finish.
slurmstepd: error: *** STEP 11051989.0 ON paula03 CANCELLED AT 2024-11-15T16:56:22 DUE TO TIME LIMIT ***
[failure_signal_handler.cc : 332] RAW: Signal 15 raised at PC=0x1487bdc26623 while already in AbslFailureSignalHandler()
*** SIGTERM received at time=1731686182 on cpu 1 ***
PC: @     0x1487bdc26623  (unknown)  __strchrnul_avx2
