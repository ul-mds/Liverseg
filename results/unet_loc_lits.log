cat: /sys/module/amdgpu/initstate: No such file or directory
ERROR:root:Driver not initialized (amdgpu not found in modules)
/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/hydra/_internal/defaults_list.py:251: UserWarning: In 'base': Defaults list is missing `_self_`. See https://hydra.cc/docs/1.2/upgrades/1.0_to_1.1/default_composition_order for more information
  warnings.warn(msg, UserWarning)
[92mINFO [0m:      Starting Flower simulation, config: num_rounds=40, no round_timeout
strategy:
  _target_: flwr.server.strategy.FedAvg
  fraction_fit: 0.0001
  min_fit_clients: ${num_clients_per_round_fit}
  fraction_evaluate: 0.0001
  min_evaluate_clients: ${num_clients_per_round_eval}
  min_available_clients: ${num_clients}
  on_fit_config_fn:
    _target_: server.get_on_fit_config
    config: ${config_fit}
model:
  _target_: model.unet.UNet
dataset:
  input-channels: 3
  image-ext: npy
  mask-ext: npy
  num_partitions: 1
  batch_size: ${batch_size}
  transformation: false
  val_ratio: 0.1
  test_ratio: 0.2
  lits_data_path: /home/sc.uni-leipzig.de/mp096jdyo/lits_dataset/npy_files
  ircad_data_path: /home/sc.uni-leipzig.de/mp096jdyo/3dircad/npy_files
  sliver_data_path: /home/sc.uni-leipzig.de/mp096jdyo/sliver07
num_rounds: 40
num_clients: 1
local_epochs: 4
batch_size: 4
num_classes: 2
num_clients_per_round_fit: 1
num_clients_per_round_eval: 1
device: cuda:0
config_fit:
  lr: 0.0003
  momentum: 0.9
  weight_decay: 1.0e-05
  nesterov: false
  optimizer: Adam
  loss: BCEWithLogitsLoss

test set size
414
3791
4205
training set size
1658
15165
trainset clients num:  1
1 15165
3 3791
3 414
3 4205
cuda:0
[2024-12-04 12:10:10,405][flwr][INFO] - Starting Flower simulation, config: num_rounds=40, no round_timeout
2024-12-04 12:10:12,496	INFO worker.py:1752 -- Started a local Ray instance.
[92mINFO [0m:      Flower VCE: Ray initialized with resources: {'memory': 832211639296.0, 'GPU': 3.0, 'accelerator_type:A30': 1.0, 'CPU': 128.0, 'node:172.18.62.1': 1.0, 'object_store_memory': 200000000000.0, 'node:__internal_head__': 1.0}
[2024-12-04 12:10:49,253][flwr][INFO] - Flower VCE: Ray initialized with resources: {'memory': 832211639296.0, 'GPU': 3.0, 'accelerator_type:A30': 1.0, 'CPU': 128.0, 'node:172.18.62.1': 1.0, 'object_store_memory': 200000000000.0, 'node:__internal_head__': 1.0}
[92mINFO [0m:      Optimize your simulation with Flower VCE: https://flower.ai/docs/framework/how-to-run-simulations.html
[2024-12-04 12:10:49,254][flwr][INFO] - Optimize your simulation with Flower VCE: https://flower.ai/docs/framework/how-to-run-simulations.html
[92mINFO [0m:      Flower VCE: Resources for each Virtual Client: {'num_cpus': 3, 'num_gpus': 1.0}
[2024-12-04 12:10:49,254][flwr][INFO] - Flower VCE: Resources for each Virtual Client: {'num_cpus': 3, 'num_gpus': 1.0}
[92mINFO [0m:      Flower VCE: Creating VirtualClientEngineActorPool with 3 actors
[2024-12-04 12:10:49,273][flwr][INFO] - Flower VCE: Creating VirtualClientEngineActorPool with 3 actors
[92mINFO [0m:      [INIT]
[2024-12-04 12:10:49,274][flwr][INFO] - [INIT]
[92mINFO [0m:      Requesting initial parameters from one random client
[2024-12-04 12:10:49,274][flwr][INFO] - Requesting initial parameters from one random client
[33m(raylet)[0m cat: /sys/module/amdgpu/initstate: No such file or directory
[33m(raylet)[0m ERROR:root:Driver not initialized (amdgpu not found in modules)
[92mINFO [0m:      Received initial parameters from one random client
[2024-12-04 12:10:54,689][flwr][INFO] - Received initial parameters from one random client
[92mINFO [0m:      Evaluating initial global parameters
[2024-12-04 12:10:54,692][flwr][INFO] - Evaluating initial global parameters
[92mINFO [0m:      initial parameters (loss, other metrics): 0.6361709236673453, OrderedDict([('ind_iou_0', 1.568745675242773e-10), ('ind_dice_liver_0', tensor(0.1504, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.0085, dtype=torch.float64)), ('ind_iou_1', 1.5929912288390675e-10), ('ind_dice_liver_1', tensor(0.1487, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.0077, dtype=torch.float64)), ('all_iou', 1.57065041257157e-10), ('all_dice_liver', tensor(0.1502, dtype=torch.float64)), ('all_dice_tumour', tensor(0.0084, dtype=torch.float64))])
Entrei no test
Meio do test
Fim do test
[2024-12-04 12:16:09,185][flwr][INFO] - initial parameters (loss, other metrics): 0.6361709236673453, OrderedDict([('ind_iou_0', 1.568745675242773e-10), ('ind_dice_liver_0', tensor(0.1504, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.0085, dtype=torch.float64)), ('ind_iou_1', 1.5929912288390675e-10), ('ind_dice_liver_1', tensor(0.1487, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.0077, dtype=torch.float64)), ('all_iou', 1.57065041257157e-10), ('all_dice_liver', tensor(0.1502, dtype=torch.float64)), ('all_dice_tumour', tensor(0.0084, dtype=torch.float64))])
[92mINFO [0m:      
[2024-12-04 12:16:09,273][flwr][INFO] - 
[92mINFO [0m:      [ROUND 1]
[2024-12-04 12:16:09,274][flwr][INFO] - [ROUND 1]
[92mINFO [0m:      configure_fit: strategy sampled 1 clients (out of 1)
[2024-12-04 12:16:09,275][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[92mINFO [0m:      aggregate_fit: received 1 results and 0 failures
[36m(ClientAppActor pid=3654519)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3654519)[0m epoch:  0
[36m(ClientAppActor pid=3654519)[0m train ious:  0.8055245963445754
[36m(ClientAppActor pid=3654519)[0m train dice liver:  tensor(0.7713, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m train dice tumour:  tensor(0.1026, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation ious:  0.8823758111431631
[36m(ClientAppActor pid=3654519)[0m validation dice liver:  tensor(0.9254, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation dice tumour:  tensor(0.2298, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m => new best model:  0
[36m(ClientAppActor pid=3654519)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3654519)[0m epoch:  1
[36m(ClientAppActor pid=3654519)[0m train ious:  0.8987200727637908
[36m(ClientAppActor pid=3654519)[0m train dice liver:  tensor(0.9345, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m train dice tumour:  tensor(0.3187, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation ious:  0.9046017848334024
[36m(ClientAppActor pid=3654519)[0m validation dice liver:  tensor(0.9428, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation dice tumour:  tensor(0.3793, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m => new best model:  1
[36m(ClientAppActor pid=3654519)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3654519)[0m epoch:  2
[36m(ClientAppActor pid=3654519)[0m train ious:  0.9210936722550644
[36m(ClientAppActor pid=3654519)[0m train dice liver:  tensor(0.9503, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m train dice tumour:  tensor(0.4207, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation ious:  0.9263708840466327
[36m(ClientAppActor pid=3654519)[0m validation dice liver:  tensor(0.9525, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation dice tumour:  tensor(0.4354, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m => new best model:  2
[36m(ClientAppActor pid=3654519)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3654519)[0m epoch:  3
[36m(ClientAppActor pid=3654519)[0m train ious:  0.9309481221317989
[36m(ClientAppActor pid=3654519)[0m train dice liver:  tensor(0.9566, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m train dice tumour:  tensor(0.4720, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation ious:  0.9396470844317266
[36m(ClientAppActor pid=3654519)[0m validation dice liver:  tensor(0.9619, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation dice tumour:  tensor(0.5143, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m => new best model:  3
[2024-12-04 13:07:27,617][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[93mWARNING [0m:   No fit_metrics_aggregation_fn provided
[2024-12-04 13:07:27,676][flwr][WARNING] - No fit_metrics_aggregation_fn provided
[92mINFO [0m:      fit progress: (1, 0.007309191065810523, OrderedDict([('ind_iou_0', 0.9396470844317266), ('ind_dice_liver_0', tensor(0.9619, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.5143, dtype=torch.float64)), ('ind_iou_1', 0.9279683534505377), ('ind_dice_liver_1', tensor(0.9548, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.3782, dtype=torch.float64)), ('all_iou', 0.9386167649692311), ('all_dice_liver', tensor(0.9612, dtype=torch.float64)), ('all_dice_tumour', tensor(0.5046, dtype=torch.float64))]), 3344.981040206738)
Entrei no test
Meio do test
Fim do test
[2024-12-04 13:11:54,255][flwr][INFO] - fit progress: (1, 0.007309191065810523, OrderedDict([('ind_iou_0', 0.9396470844317266), ('ind_dice_liver_0', tensor(0.9619, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.5143, dtype=torch.float64)), ('ind_iou_1', 0.9279683534505377), ('ind_dice_liver_1', tensor(0.9548, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.3782, dtype=torch.float64)), ('all_iou', 0.9386167649692311), ('all_dice_liver', tensor(0.9612, dtype=torch.float64)), ('all_dice_tumour', tensor(0.5046, dtype=torch.float64))]), 3344.981040206738)
[92mINFO [0m:      configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-12-04 13:11:54,268][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[36m(ClientAppActor pid=3654519)[0m Entrei no validation 1 3
[2024-12-04 13:14:08,776][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-12-04 13:14:08,776][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 1 failures
[2024-12-04 13:14:08,803][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[92mINFO [0m:      
[2024-12-04 13:14:08,803][flwr][INFO] - 
[92mINFO [0m:      [ROUND 2]
[2024-12-04 13:14:08,804][flwr][INFO] - [ROUND 2]
[2024-12-04 13:14:08,804][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[92mINFO [0m:      configure_fit: strategy sampled 1 clients (out of 1)
[92mINFO [0m:      aggregate_fit: received 1 results and 0 failures
[36m(ClientAppActor pid=3654519)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3654519)[0m epoch:  0
[36m(ClientAppActor pid=3654519)[0m train ious:  0.937760498442699
[36m(ClientAppActor pid=3654519)[0m train dice liver:  tensor(0.9608, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m train dice tumour:  tensor(0.5133, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation ious:  0.943994817942454
[36m(ClientAppActor pid=3654519)[0m validation dice liver:  tensor(0.9645, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation dice tumour:  tensor(0.5541, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m => new best model:  0
[36m(ClientAppActor pid=3654519)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3654519)[0m epoch:  1
[36m(ClientAppActor pid=3654519)[0m train ious:  0.941862385311754
[36m(ClientAppActor pid=3654519)[0m train dice liver:  tensor(0.9632, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m train dice tumour:  tensor(0.5406, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation ious:  0.9454469273697399
[36m(ClientAppActor pid=3654519)[0m validation dice liver:  tensor(0.9659, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation dice tumour:  tensor(0.5475, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m => new best model:  1
[36m(ClientAppActor pid=3654519)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3654519)[0m epoch:  2
[36m(ClientAppActor pid=3654519)[0m train ious:  0.9447215671165896
[36m(ClientAppActor pid=3654519)[0m train dice liver:  tensor(0.9651, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m train dice tumour:  tensor(0.5475, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation ious:  0.9468626753598759
[36m(ClientAppActor pid=3654519)[0m validation dice liver:  tensor(0.9666, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation dice tumour:  tensor(0.5539, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m => new best model:  2
[36m(ClientAppActor pid=3654519)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3654519)[0m epoch:  3
[36m(ClientAppActor pid=3654519)[0m train ious:  0.9479433446612797
[36m(ClientAppActor pid=3654519)[0m train dice liver:  tensor(0.9670, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m train dice tumour:  tensor(0.5717, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation ious:  0.948530183129443
[36m(ClientAppActor pid=3654519)[0m validation dice liver:  tensor(0.9663, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation dice tumour:  tensor(0.5766, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m => new best model:  3
[2024-12-04 14:22:44,502][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[92mINFO [0m:      fit progress: (2, 0.005999681662090397, OrderedDict([('ind_iou_0', 0.948530183129443), ('ind_dice_liver_0', tensor(0.9663, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.5766, dtype=torch.float64)), ('ind_iou_1', 0.9422741827408425), ('ind_dice_liver_1', tensor(0.9607, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.4817, dtype=torch.float64)), ('all_iou', 0.9480325690091613), ('all_dice_liver', tensor(0.9658, dtype=torch.float64)), ('all_dice_tumour', tensor(0.5706, dtype=torch.float64))]), 7985.874334636144)
Entrei no test
Meio do test
Fim do test
[2024-12-04 14:29:15,148][flwr][INFO] - fit progress: (2, 0.005999681662090397, OrderedDict([('ind_iou_0', 0.948530183129443), ('ind_dice_liver_0', tensor(0.9663, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.5766, dtype=torch.float64)), ('ind_iou_1', 0.9422741827408425), ('ind_dice_liver_1', tensor(0.9607, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.4817, dtype=torch.float64)), ('all_iou', 0.9480325690091613), ('all_dice_liver', tensor(0.9658, dtype=torch.float64)), ('all_dice_tumour', tensor(0.5706, dtype=torch.float64))]), 7985.874334636144)
[92mINFO [0m:      configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-12-04 14:29:15,153][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[36m(ClientAppActor pid=3654519)[0m Entrei no validation 1 3
[2024-12-04 14:31:46,576][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-12-04 14:31:46,577][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 1 failures
[2024-12-04 14:31:46,578][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[92mINFO [0m:      
[2024-12-04 14:31:46,579][flwr][INFO] - 
[92mINFO [0m:      [ROUND 3]
[2024-12-04 14:31:46,579][flwr][INFO] - [ROUND 3]
[92mINFO [0m:      configure_fit: strategy sampled 1 clients (out of 1)
[2024-12-04 14:31:46,580][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[92mINFO [0m:      aggregate_fit: received 1 results and 0 failures
[36m(ClientAppActor pid=3654519)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3654519)[0m epoch:  0
[36m(ClientAppActor pid=3654519)[0m train ious:  0.9498344779574154
[36m(ClientAppActor pid=3654519)[0m train dice liver:  tensor(0.9681, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m train dice tumour:  tensor(0.5855, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation ious:  0.9533938029155821
[36m(ClientAppActor pid=3654519)[0m validation dice liver:  tensor(0.9694, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation dice tumour:  tensor(0.6003, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m => new best model:  0
[36m(ClientAppActor pid=3654519)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3654519)[0m epoch:  1
[36m(ClientAppActor pid=3654519)[0m train ious:  0.9528142610640026
[36m(ClientAppActor pid=3654519)[0m train dice liver:  tensor(0.9701, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m train dice tumour:  tensor(0.6011, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation ious:  0.9519703534759477
[36m(ClientAppActor pid=3654519)[0m validation dice liver:  tensor(0.9694, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation dice tumour:  tensor(0.6039, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m => new best model:  1
[36m(ClientAppActor pid=3654519)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3654519)[0m epoch:  2
[36m(ClientAppActor pid=3654519)[0m train ious:  0.9549794400545061
[36m(ClientAppActor pid=3654519)[0m train dice liver:  tensor(0.9713, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m train dice tumour:  tensor(0.6156, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation ious:  0.9556753090230481
[36m(ClientAppActor pid=3654519)[0m validation dice liver:  tensor(0.9720, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation dice tumour:  tensor(0.6191, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m => new best model:  2
[36m(ClientAppActor pid=3654519)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3654519)[0m epoch:  3
[36m(ClientAppActor pid=3654519)[0m train ious:  0.9566923038976666
[36m(ClientAppActor pid=3654519)[0m train dice liver:  tensor(0.9723, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m train dice tumour:  tensor(0.6288, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation ious:  0.9569305898169702
[36m(ClientAppActor pid=3654519)[0m validation dice liver:  tensor(0.9725, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation dice tumour:  tensor(0.6175, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m => new best model:  3
[2024-12-04 15:47:12,347][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[92mINFO [0m:      fit progress: (3, 0.004877382856721721, OrderedDict([('ind_iou_0', 0.9569305898169702), ('ind_dice_liver_0', tensor(0.9725, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.6175, dtype=torch.float64)), ('ind_iou_1', 0.9521626762634431), ('ind_dice_liver_1', tensor(0.9682, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5189, dtype=torch.float64)), ('all_iou', 0.9565716408907092), ('all_dice_liver', tensor(0.9721, dtype=torch.float64)), ('all_dice_tumour', tensor(0.6101, dtype=torch.float64))]), 13042.125027588569)
Entrei no test
Meio do test
Fim do test
[2024-12-04 15:53:31,398][flwr][INFO] - fit progress: (3, 0.004877382856721721, OrderedDict([('ind_iou_0', 0.9569305898169702), ('ind_dice_liver_0', tensor(0.9725, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.6175, dtype=torch.float64)), ('ind_iou_1', 0.9521626762634431), ('ind_dice_liver_1', tensor(0.9682, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5189, dtype=torch.float64)), ('all_iou', 0.9565716408907092), ('all_dice_liver', tensor(0.9721, dtype=torch.float64)), ('all_dice_tumour', tensor(0.6101, dtype=torch.float64))]), 13042.125027588569)
[92mINFO [0m:      configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-12-04 15:53:31,403][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[36m(ClientAppActor pid=3654519)[0m Entrei no validation 1 3
[2024-12-04 15:58:56,746][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-12-04 15:58:56,747][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 1 failures
[2024-12-04 15:58:56,748][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[92mINFO [0m:      
[2024-12-04 15:58:56,748][flwr][INFO] - 
[92mINFO [0m:      [ROUND 4]
[2024-12-04 15:58:56,748][flwr][INFO] - [ROUND 4]
[92mINFO [0m:      configure_fit: strategy sampled 1 clients (out of 1)
[2024-12-04 15:58:56,749][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[92mINFO [0m:      aggregate_fit: received 1 results and 0 failures
[36m(ClientAppActor pid=3654519)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3654519)[0m epoch:  0
[36m(ClientAppActor pid=3654519)[0m train ious:  0.9588148769178593
[36m(ClientAppActor pid=3654519)[0m train dice liver:  tensor(0.9737, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m train dice tumour:  tensor(0.6319, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation ious:  0.9591814272074863
[36m(ClientAppActor pid=3654519)[0m validation dice liver:  tensor(0.9750, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation dice tumour:  tensor(0.6289, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m => new best model:  0
[36m(ClientAppActor pid=3654519)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3654519)[0m epoch:  1
[36m(ClientAppActor pid=3654519)[0m train ious:  0.9595271784949976
[36m(ClientAppActor pid=3654519)[0m train dice liver:  tensor(0.9742, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m train dice tumour:  tensor(0.6371, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation ious:  0.9596381805410016
[36m(ClientAppActor pid=3654519)[0m validation dice liver:  tensor(0.9746, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation dice tumour:  tensor(0.6321, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m => new best model:  1
[36m(ClientAppActor pid=3654519)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3654519)[0m epoch:  2
[36m(ClientAppActor pid=3654519)[0m train ious:  0.9630056018225694
[36m(ClientAppActor pid=3654519)[0m train dice liver:  tensor(0.9765, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m train dice tumour:  tensor(0.6522, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation ious:  0.9617315971114226
[36m(ClientAppActor pid=3654519)[0m validation dice liver:  tensor(0.9757, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation dice tumour:  tensor(0.6518, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m => new best model:  2
[36m(ClientAppActor pid=3654519)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3654519)[0m epoch:  3
[36m(ClientAppActor pid=3654519)[0m train ious:  0.9644132750616436
[36m(ClientAppActor pid=3654519)[0m train dice liver:  tensor(0.9774, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m train dice tumour:  tensor(0.6630, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation ious:  0.9632444633527052
[36m(ClientAppActor pid=3654519)[0m validation dice liver:  tensor(0.9771, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation dice tumour:  tensor(0.6529, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m => new best model:  3
[2024-12-04 17:03:01,770][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[92mINFO [0m:      fit progress: (4, 0.004114746909442399, OrderedDict([('ind_iou_0', 0.9632444633527052), ('ind_dice_liver_0', tensor(0.9771, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.6529, dtype=torch.float64)), ('ind_iou_1', 0.9606060884754033), ('ind_dice_liver_1', tensor(0.9744, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5497, dtype=torch.float64)), ('all_iou', 0.9630616845607723), ('all_dice_liver', tensor(0.9768, dtype=torch.float64)), ('all_dice_tumour', tensor(0.6456, dtype=torch.float64))]), 17530.98350684438)
Entrei no test
Meio do test
Fim do test
[2024-12-04 17:08:20,257][flwr][INFO] - fit progress: (4, 0.004114746909442399, OrderedDict([('ind_iou_0', 0.9632444633527052), ('ind_dice_liver_0', tensor(0.9771, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.6529, dtype=torch.float64)), ('ind_iou_1', 0.9606060884754033), ('ind_dice_liver_1', tensor(0.9744, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5497, dtype=torch.float64)), ('all_iou', 0.9630616845607723), ('all_dice_liver', tensor(0.9768, dtype=torch.float64)), ('all_dice_tumour', tensor(0.6456, dtype=torch.float64))]), 17530.98350684438)
[92mINFO [0m:      configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-12-04 17:08:20,262][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[36m(ClientAppActor pid=3654519)[0m Entrei no validation 1 3
[2024-12-04 17:10:42,235][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-12-04 17:10:42,236][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 1 failures
[2024-12-04 17:10:42,237][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[92mINFO [0m:      
[2024-12-04 17:10:42,238][flwr][INFO] - 
[92mINFO [0m:      [ROUND 5]
[2024-12-04 17:10:42,239][flwr][INFO] - [ROUND 5]
[92mINFO [0m:      configure_fit: strategy sampled 1 clients (out of 1)
[2024-12-04 17:10:42,239][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[92mINFO [0m:      aggregate_fit: received 1 results and 0 failures
[36m(ClientAppActor pid=3654519)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3654519)[0m epoch:  0
[36m(ClientAppActor pid=3654519)[0m train ious:  0.9650896316549091
[36m(ClientAppActor pid=3654519)[0m train dice liver:  tensor(0.9778, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m train dice tumour:  tensor(0.6612, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation ious:  0.9648323825976017
[36m(ClientAppActor pid=3654519)[0m validation dice liver:  tensor(0.9785, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation dice tumour:  tensor(0.6676, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m => new best model:  0
[36m(ClientAppActor pid=3654519)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3654519)[0m epoch:  1
[36m(ClientAppActor pid=3654519)[0m train ious:  0.9673346478244212
[36m(ClientAppActor pid=3654519)[0m train dice liver:  tensor(0.9793, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m train dice tumour:  tensor(0.6713, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation ious:  0.9651896821894405
[36m(ClientAppActor pid=3654519)[0m validation dice liver:  tensor(0.9784, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation dice tumour:  tensor(0.6659, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m => new best model:  1
[36m(ClientAppActor pid=3654519)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3654519)[0m epoch:  2
[36m(ClientAppActor pid=3654519)[0m train ious:  0.9685929627373188
[36m(ClientAppActor pid=3654519)[0m train dice liver:  tensor(0.9801, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m train dice tumour:  tensor(0.6780, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation ious:  0.9646694753575292
[36m(ClientAppActor pid=3654519)[0m validation dice liver:  tensor(0.9785, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation dice tumour:  tensor(0.6635, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m => new best model:  2
[36m(ClientAppActor pid=3654519)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3654519)[0m epoch:  3
[36m(ClientAppActor pid=3654519)[0m train ious:  0.9701740984503646
[36m(ClientAppActor pid=3654519)[0m train dice liver:  tensor(0.9811, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m train dice tumour:  tensor(0.6941, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation ious:  0.9672453536128813
[36m(ClientAppActor pid=3654519)[0m validation dice liver:  tensor(0.9805, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation dice tumour:  tensor(0.6669, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m => new best model:  3
[2024-12-04 18:10:32,952][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[92mINFO [0m:      fit progress: (5, 0.003674693956337736, OrderedDict([('ind_iou_0', 0.9672453536128813), ('ind_dice_liver_0', tensor(0.9805, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.6669, dtype=torch.float64)), ('ind_iou_1', 0.9680131477798649), ('ind_dice_liver_1', tensor(0.9794, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5803, dtype=torch.float64)), ('all_iou', 0.9673490812760697), ('all_dice_liver', tensor(0.9804, dtype=torch.float64)), ('all_dice_tumour', tensor(0.6610, dtype=torch.float64))]), 21587.68735046964)
Entrei no test
Meio do test
Fim do test
[2024-12-04 18:15:56,961][flwr][INFO] - fit progress: (5, 0.003674693956337736, OrderedDict([('ind_iou_0', 0.9672453536128813), ('ind_dice_liver_0', tensor(0.9805, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.6669, dtype=torch.float64)), ('ind_iou_1', 0.9680131477798649), ('ind_dice_liver_1', tensor(0.9794, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5803, dtype=torch.float64)), ('all_iou', 0.9673490812760697), ('all_dice_liver', tensor(0.9804, dtype=torch.float64)), ('all_dice_tumour', tensor(0.6610, dtype=torch.float64))]), 21587.68735046964)
[92mINFO [0m:      configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-12-04 18:15:56,968][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[36m(ClientAppActor pid=3654519)[0m Entrei no validation 1 3
[2024-12-04 18:18:11,921][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-12-04 18:18:11,922][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 1 failures
[2024-12-04 18:18:11,922][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[92mINFO [0m:      
[2024-12-04 18:18:11,923][flwr][INFO] - 
[92mINFO [0m:      [ROUND 6]
[2024-12-04 18:18:11,923][flwr][INFO] - [ROUND 6]
[92mINFO [0m:      configure_fit: strategy sampled 1 clients (out of 1)
[2024-12-04 18:18:11,924][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[92mINFO [0m:      aggregate_fit: received 1 results and 0 failures
[36m(ClientAppActor pid=3654519)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3654519)[0m epoch:  0
[36m(ClientAppActor pid=3654519)[0m train ious:  0.9703771515728313
[36m(ClientAppActor pid=3654519)[0m train dice liver:  tensor(0.9812, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m train dice tumour:  tensor(0.6938, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation ious:  0.9687578397991938
[36m(ClientAppActor pid=3654519)[0m validation dice liver:  tensor(0.9812, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation dice tumour:  tensor(0.6805, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m => new best model:  0
[36m(ClientAppActor pid=3654519)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3654519)[0m epoch:  1
[36m(ClientAppActor pid=3654519)[0m train ious:  0.9727685902302476
[36m(ClientAppActor pid=3654519)[0m train dice liver:  tensor(0.9828, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m train dice tumour:  tensor(0.7099, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation ious:  0.968836969427587
[36m(ClientAppActor pid=3654519)[0m validation dice liver:  tensor(0.9812, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation dice tumour:  tensor(0.6836, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m => new best model:  1
[36m(ClientAppActor pid=3654519)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3654519)[0m epoch:  2
[36m(ClientAppActor pid=3654519)[0m train ious:  0.9733553773117184
[36m(ClientAppActor pid=3654519)[0m train dice liver:  tensor(0.9832, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m train dice tumour:  tensor(0.7054, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation ious:  0.9694611874416196
[36m(ClientAppActor pid=3654519)[0m validation dice liver:  tensor(0.9819, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation dice tumour:  tensor(0.6871, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m => new best model:  2
[36m(ClientAppActor pid=3654519)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3654519)[0m epoch:  3
[36m(ClientAppActor pid=3654519)[0m train ious:  0.9744650368989722
[36m(ClientAppActor pid=3654519)[0m train dice liver:  tensor(0.9840, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m train dice tumour:  tensor(0.7048, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation ious:  0.9701311595344998
[36m(ClientAppActor pid=3654519)[0m validation dice liver:  tensor(0.9820, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation dice tumour:  
[36m(ClientAppActor pid=3654519)[0m tensor(0.6856, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m => new best model:  3
[2024-12-04 19:15:41,489][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
Entrei no test
Meio do test
Fim do test
[2024-12-04 19:20:37,938][flwr][INFO] - fit progress: (6, 0.003343490719314616, OrderedDict([('ind_iou_0', 0.9701311595344998), ('ind_dice_liver_0', tensor(0.9820, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.6856, dtype=torch.float64)), ('ind_iou_1', 0.9716150863678239), ('ind_dice_liver_1', tensor(0.9812, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5927, dtype=torch.float64)), ('all_iou', 0.9702936864649568), ('all_dice_liver', tensor(0.9819, dtype=torch.float64)), ('all_dice_tumour', tensor(0.6793, dtype=torch.float64))]), 25468.66411369387)
[92mINFO [0m:      fit progress: (6, 0.003343490719314616, OrderedDict([('ind_iou_0', 0.9701311595344998), ('ind_dice_liver_0', tensor(0.9820, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.6856, dtype=torch.float64)), ('ind_iou_1', 0.9716150863678239), ('ind_dice_liver_1', tensor(0.9812, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5927, dtype=torch.float64)), ('all_iou', 0.9702936864649568), ('all_dice_liver', tensor(0.9819, dtype=torch.float64)), ('all_dice_tumour', tensor(0.6793, dtype=torch.float64))]), 25468.66411369387)
[92mINFO [0m:      configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-12-04 19:20:37,944][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[36m(ClientAppActor pid=3654519)[0m Entrei no validation 1 3
[2024-12-04 19:22:32,085][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-12-04 19:22:32,086][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 1 failures
[2024-12-04 19:22:32,087][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[92mINFO [0m:      
[2024-12-04 19:22:32,088][flwr][INFO] - 
[92mINFO [0m:      [ROUND 7]
[2024-12-04 19:22:32,088][flwr][INFO] - [ROUND 7]
[92mINFO [0m:      configure_fit: strategy sampled 1 clients (out of 1)
[2024-12-04 19:22:32,089][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[92mINFO [0m:      aggregate_fit: received 1 results and 0 failures
[36m(ClientAppActor pid=3654519)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3654519)[0m epoch:  0
[36m(ClientAppActor pid=3654519)[0m train ious:  0.9752944521333916
[36m(ClientAppActor pid=3654519)[0m train dice liver:  tensor(0.9845, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m train dice tumour:  tensor(0.7109, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation ious:  0.9703968286236511
[36m(ClientAppActor pid=3654519)[0m validation dice liver:  tensor(0.9829, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation dice tumour:  tensor(0.6924, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m => new best model:  0
[36m(ClientAppActor pid=3654519)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3654519)[0m epoch:  1
[36m(ClientAppActor pid=3654519)[0m train ious:  0.9759512726579014
[36m(ClientAppActor pid=3654519)[0m train dice liver:  tensor(0.9849, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m train dice tumour:  tensor(0.7123, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation ious:  0.971787677288467
[36m(ClientAppActor pid=3654519)[0m validation dice liver:  tensor(0.9834, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation dice tumour:  tensor(0.6935, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m => new best model:  1
[36m(ClientAppActor pid=3654519)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3654519)[0m epoch:  2
[36m(ClientAppActor pid=3654519)[0m train ious:  0.9770625243451447
[36m(ClientAppActor pid=3654519)[0m train dice liver:  tensor(0.9856, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m train dice tumour:  tensor(0.7198, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation ious:  0.9716236476874562
[36m(ClientAppActor pid=3654519)[0m validation dice liver:  tensor(0.9836, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation dice tumour:  tensor(0.6969, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m => new best model:  2
[36m(ClientAppActor pid=3654519)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3654519)[0m epoch:  3
[36m(ClientAppActor pid=3654519)[0m train ious:  0.9776788000126366
[36m(ClientAppActor pid=3654519)[0m train dice liver:  tensor(0.9860, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m train dice tumour:  tensor(0.7254, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation ious:  0.9729366720537237
[36m(ClientAppActor pid=3654519)[0m validation dice liver:  tensor(0.9841, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation dice tumour:  tensor(0.6990, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m => new best model:  3
[2024-12-04 20:20:42,641][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[92mINFO [0m:      fit progress: (7, 0.0030828677261232726, OrderedDict([('ind_iou_0', 0.9729366720537237), ('ind_dice_liver_0', tensor(0.9841, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.6990, dtype=torch.float64)), ('ind_iou_1', 0.9749556336019467), ('ind_dice_liver_1', tensor(0.9839, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6094, dtype=torch.float64)), ('all_iou', 0.9731518338974533), ('all_dice_liver', tensor(0.9841, dtype=torch.float64)), ('all_dice_tumour', tensor(0.6929, dtype=torch.float64))]), 29345.771678640507)
Entrei no test
Meio do test
Fim do test
[2024-12-04 20:25:15,045][flwr][INFO] - fit progress: (7, 0.0030828677261232726, OrderedDict([('ind_iou_0', 0.9729366720537237), ('ind_dice_liver_0', tensor(0.9841, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.6990, dtype=torch.float64)), ('ind_iou_1', 0.9749556336019467), ('ind_dice_liver_1', tensor(0.9839, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6094, dtype=torch.float64)), ('all_iou', 0.9731518338974533), ('all_dice_liver', tensor(0.9841, dtype=torch.float64)), ('all_dice_tumour', tensor(0.6929, dtype=torch.float64))]), 29345.771678640507)
[92mINFO [0m:      configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-12-04 20:25:15,051][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[36m(ClientAppActor pid=3654519)[0m Entrei no validation 1 3
[2024-12-04 20:27:20,152][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-12-04 20:27:20,153][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 1 failures
[2024-12-04 20:27:20,155][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[92mINFO [0m:      
[2024-12-04 20:27:20,155][flwr][INFO] - 
[92mINFO [0m:      [ROUND 8]
[2024-12-04 20:27:20,156][flwr][INFO] - [ROUND 8]
[92mINFO [0m:      configure_fit: strategy sampled 1 clients (out of 1)
[2024-12-04 20:27:20,156][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[92mINFO [0m:      aggregate_fit: received 1 results and 0 failures
[36m(ClientAppActor pid=3654519)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3654519)[0m epoch:  0
[36m(ClientAppActor pid=3654519)[0m train ious:  0.978091087445624
[36m(ClientAppActor pid=3654519)[0m train dice liver:  tensor(0.9862, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m train dice tumour:  tensor(0.7235, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation ious:  0.973344543870039
[36m(ClientAppActor pid=3654519)[0m validation dice liver:  tensor(0.9848, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation dice tumour:  tensor(0.7068, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m => new best model:  0
[36m(ClientAppActor pid=3654519)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3654519)[0m epoch:  1
[36m(ClientAppActor pid=3654519)[0m train ious:  0.9783719107899704
[36m(ClientAppActor pid=3654519)[0m train dice liver:  tensor(0.9864, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m train dice tumour:  tensor(0.7194, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation ious:  0.9744177752775823
[36m(ClientAppActor pid=3654519)[0m validation dice liver:  tensor(0.9854, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation dice tumour:  tensor(0.7041, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m => new best model:  1
[36m(ClientAppActor pid=3654519)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3654519)[0m epoch:  2
[36m(ClientAppActor pid=3654519)[0m train ious:  0.9797506631603078
[36m(ClientAppActor pid=3654519)[0m train dice liver:  tensor(0.9873, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m train dice tumour:  tensor(0.7352, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation ious:  0.9740213366123159
[36m(ClientAppActor pid=3654519)[0m validation dice liver:  tensor(0.9852, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation dice tumour:  tensor(0.7048, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m => new best model:  2
[36m(ClientAppActor pid=3654519)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3654519)[0m epoch:  3
[36m(ClientAppActor pid=3654519)[0m train ious:  0.9797901003694914
[36m(ClientAppActor pid=3654519)[0m train dice liver:  tensor(0.9873, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m train dice tumour:  tensor(0.7362, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation ious:  0.9742213045766417
[36m(ClientAppActor pid=3654519)[0m validation dice liver:  tensor(0.9851, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation dice tumour:  tensor(0.7075, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m => new best model:  3
[2024-12-04 21:32:17,280][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[92mINFO [0m:      fit progress: (8, 0.002961892542494605, OrderedDict([('ind_iou_0', 0.9742213045766417), ('ind_dice_liver_0', tensor(0.9851, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7075, dtype=torch.float64)), ('ind_iou_1', 0.9765056482338446), ('ind_dice_liver_1', tensor(0.9851, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6083, dtype=torch.float64)), ('all_iou', 0.9744806431261388), ('all_dice_liver', tensor(0.9851, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7012, dtype=torch.float64))]), 33615.789484796114)
Entrei no test
Meio do test
Fim do test
[2024-12-04 21:36:25,063][flwr][INFO] - fit progress: (8, 0.002961892542494605, OrderedDict([('ind_iou_0', 0.9742213045766417), ('ind_dice_liver_0', tensor(0.9851, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7075, dtype=torch.float64)), ('ind_iou_1', 0.9765056482338446), ('ind_dice_liver_1', tensor(0.9851, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6083, dtype=torch.float64)), ('all_iou', 0.9744806431261388), ('all_dice_liver', tensor(0.9851, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7012, dtype=torch.float64))]), 33615.789484796114)
[92mINFO [0m:      configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-12-04 21:36:25,074][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[36m(ClientAppActor pid=3654519)[0m Entrei no validation 1 3
[2024-12-04 21:38:14,520][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-12-04 21:38:14,521][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 1 failures
[2024-12-04 21:38:14,521][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[92mINFO [0m:      
[2024-12-04 21:38:14,521][flwr][INFO] - 
[92mINFO [0m:      [ROUND 9]
[2024-12-04 21:38:14,522][flwr][INFO] - [ROUND 9]
[92mINFO [0m:      configure_fit: strategy sampled 1 clients (out of 1)
[2024-12-04 21:38:14,522][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[92mINFO [0m:      aggregate_fit: received 1 results and 0 failures
[36m(ClientAppActor pid=3654519)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3654519)[0m epoch:  0
[36m(ClientAppActor pid=3654519)[0m train ious:  0.9803867604204829
[36m(ClientAppActor pid=3654519)[0m train dice liver:  tensor(0.9877, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m train dice tumour:  tensor(0.7350, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation ious:  0.9745524228305159
[36m(ClientAppActor pid=3654519)[0m validation dice liver:  tensor(0.9857, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation dice tumour:  tensor(0.7067, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m => new best model:  0
[36m(ClientAppActor pid=3654519)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3654519)[0m epoch:  1
[36m(ClientAppActor pid=3654519)[0m train ious:  0.980945240165248
[36m(ClientAppActor pid=3654519)[0m train dice liver:  tensor(0.9881, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m train dice tumour:  tensor(0.7382, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation ious:  0.9745326351471201
[36m(ClientAppActor pid=3654519)[0m validation dice liver:  tensor(0.9856, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation dice tumour:  tensor(0.7085, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m => new best model:  1
[36m(ClientAppActor pid=3654519)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3654519)[0m epoch:  2
[36m(ClientAppActor pid=3654519)[0m train ious:  0.9814101593517978
[36m(ClientAppActor pid=3654519)[0m train dice liver:  tensor(0.9884, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m train dice tumour:  tensor(0.7300, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation ious:  0.9753666889076372
[36m(ClientAppActor pid=3654519)[0m validation dice liver:  tensor(0.9861, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation dice tumour:  tensor(0.7145, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m => new best model:  2
[36m(ClientAppActor pid=3654519)[0m Entrei no validation 1 3
[2024-12-04 22:44:12,324][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[92mINFO [0m:      fit progress: (9, 0.0029793664326893516, OrderedDict([('ind_iou_0', 0.9749532875956729), ('ind_dice_liver_0', tensor(0.9861, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7158, dtype=torch.float64)), ('ind_iou_1', 0.9773770339658858), ('ind_dice_liver_1', tensor(0.9864, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6222, dtype=torch.float64)), ('all_iou', 0.9752016474715582), ('all_dice_liver', tensor(0.9861, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7100, dtype=torch.float64))]), 38041.8549388228)
[36m(ClientAppActor pid=3654519)[0m epoch:  3
[36m(ClientAppActor pid=3654519)[0m train ious:  0.9817698583005009
[36m(ClientAppActor pid=3654519)[0m train dice liver:  tensor(0.9886, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m train dice tumour:  tensor(0.7385, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation ious:  0.9749532875956729
[36m(ClientAppActor pid=3654519)[0m validation dice liver:  tensor(0.9861, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation dice tumour:  tensor(0.7158, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m => new best model:  3
Entrei no test
Meio do test
Fim do test
[2024-12-04 22:50:11,128][flwr][INFO] - fit progress: (9, 0.0029793664326893516, OrderedDict([('ind_iou_0', 0.9749532875956729), ('ind_dice_liver_0', tensor(0.9861, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7158, dtype=torch.float64)), ('ind_iou_1', 0.9773770339658858), ('ind_dice_liver_1', tensor(0.9864, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6222, dtype=torch.float64)), ('all_iou', 0.9752016474715582), ('all_dice_liver', tensor(0.9861, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7100, dtype=torch.float64))]), 38041.8549388228)
[92mINFO [0m:      configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-12-04 22:50:11,134][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[36m(ClientAppActor pid=3654519)[0m Entrei no validation 1 3
[2024-12-04 22:52:43,756][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-12-04 22:52:43,756][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 1 failures
[2024-12-04 22:52:43,757][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[92mINFO [0m:      
[2024-12-04 22:52:43,758][flwr][INFO] - 
[92mINFO [0m:      [ROUND 10]
[2024-12-04 22:52:43,758][flwr][INFO] - [ROUND 10]
[92mINFO [0m:      configure_fit: strategy sampled 1 clients (out of 1)
[2024-12-04 22:52:43,760][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[92mINFO [0m:      aggregate_fit: received 1 results and 0 failures
[36m(ClientAppActor pid=3654519)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3654519)[0m epoch:  0
[36m(ClientAppActor pid=3654519)[0m train ious:  0.9819928187463366
[36m(ClientAppActor pid=3654519)[0m train dice liver:  tensor(0.9888, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m train dice tumour:  tensor(0.7448, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation ious:  0.9754928385159082
[36m(ClientAppActor pid=3654519)[0m validation dice liver:  tensor(0.9861, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation dice tumour:  tensor(0.7133, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m => new best model:  0
[36m(ClientAppActor pid=3654519)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3654519)[0m epoch:  1
[36m(ClientAppActor pid=3654519)[0m train ious:  0.982608364976895
[36m(ClientAppActor pid=3654519)[0m train dice liver:  tensor(0.9891, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m train dice tumour:  tensor(0.7430, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation ious:  0.9763140651999347
[36m(ClientAppActor pid=3654519)[0m validation dice liver:  tensor(0.9869, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation dice tumour:  tensor(0.7158, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m => new best model:  1
[36m(ClientAppActor pid=3654519)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3654519)[0m epoch:  2
[36m(ClientAppActor pid=3654519)[0m train ious:  0.9829402868920135
[36m(ClientAppActor pid=3654519)[0m train dice liver:  tensor(0.9894, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m train dice tumour:  tensor(0.7452, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation ious:  0.9763847801536913
[36m(ClientAppActor pid=3654519)[0m validation dice liver:  tensor(0.9869, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation dice tumour:  tensor(0.7208, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m => new best model:  2
[36m(ClientAppActor pid=3654519)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3654519)[0m epoch:  3
[36m(ClientAppActor pid=3654519)[0m train ious:  0.9832345785715026
[36m(ClientAppActor pid=3654519)[0m train dice liver:  tensor(0.9895, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m train dice tumour:  tensor(0.7534, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation ious:  0.9755585946503212
[36m(ClientAppActor pid=3654519)[0m validation dice liver:  tensor(0.9865, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation dice tumour:  tensor(0.7158, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m => new best model:  3
[2024-12-05 00:03:12,853][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[92mINFO [0m:      fit progress: (10, 0.002931450000951924, OrderedDict([('ind_iou_0', 0.9755585946503212), ('ind_dice_liver_0', tensor(0.9865, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7158, dtype=torch.float64)), ('ind_iou_1', 0.9787096725065478), ('ind_dice_liver_1', tensor(0.9870, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6279, dtype=torch.float64)), ('all_iou', 0.9758783590974501), ('all_dice_liver', tensor(0.9866, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7108, dtype=torch.float64))]), 42762.21016470343)
Entrei no test
Meio do test
Fim do test
[2024-12-05 00:08:51,484][flwr][INFO] - fit progress: (10, 0.002931450000951924, OrderedDict([('ind_iou_0', 0.9755585946503212), ('ind_dice_liver_0', tensor(0.9865, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7158, dtype=torch.float64)), ('ind_iou_1', 0.9787096725065478), ('ind_dice_liver_1', tensor(0.9870, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6279, dtype=torch.float64)), ('all_iou', 0.9758783590974501), ('all_dice_liver', tensor(0.9866, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7108, dtype=torch.float64))]), 42762.21016470343)
[92mINFO [0m:      configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-12-05 00:08:51,490][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[36m(ClientAppActor pid=3654519)[0m Entrei no validation 1 3
[2024-12-05 00:11:01,804][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-12-05 00:11:01,806][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 1 failures
[2024-12-05 00:11:01,807][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[92mINFO [0m:      
[2024-12-05 00:11:01,808][flwr][INFO] - 
[92mINFO [0m:      [ROUND 11]
[2024-12-05 00:11:01,808][flwr][INFO] - [ROUND 11]
[92mINFO [0m:      configure_fit: strategy sampled 1 clients (out of 1)
[2024-12-05 00:11:01,808][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[92mINFO [0m:      aggregate_fit: received 1 results and 0 failures
[36m(ClientAppActor pid=3654519)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3654519)[0m epoch:  0
[36m(ClientAppActor pid=3654519)[0m train ious:  0.9828810981818743
[36m(ClientAppActor pid=3654519)[0m train dice liver:  tensor(0.9892, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m train dice tumour:  tensor(0.7437, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation ious:  0.976965258022691
[36m(ClientAppActor pid=3654519)[0m validation dice liver:  tensor(0.9875, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation dice tumour:  tensor(0.7212, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m => new best model:  0
[36m(ClientAppActor pid=3654519)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3654519)[0m epoch:  1
[36m(ClientAppActor pid=3654519)[0m train ious:  0.9840886984988706
[36m(ClientAppActor pid=3654519)[0m train dice liver:  tensor(0.9901, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m train dice tumour:  tensor(0.7565, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation ious:  0.9770957047278331
[36m(ClientAppActor pid=3654519)[0m validation dice liver:  tensor(0.9874, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation dice tumour:  tensor(0.7188, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m => new best model:  1
[36m(ClientAppActor pid=3654519)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3654519)[0m epoch:  2
[36m(ClientAppActor pid=3654519)[0m train ious:  0.9841426814491271
[36m(ClientAppActor pid=3654519)[0m train dice liver:  
[36m(ClientAppActor pid=3654519)[0m tensor(0.9901, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m train dice tumour:  tensor(0.7508, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation ious:  0.9765308629462649
[36m(ClientAppActor pid=3654519)[0m validation dice liver:  tensor(0.9871, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation dice tumour:  tensor(0.7172, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m => new best model:  2
[36m(ClientAppActor pid=3654519)[0m Entrei no validation 1 3
[2024-12-05 01:15:50,779][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[92mINFO [0m:      fit progress: (11, 0.002835746582455747, OrderedDict([('ind_iou_0', 0.9771057827067156), ('ind_dice_liver_0', tensor(0.9877, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7204, dtype=torch.float64)), ('ind_iou_1', 0.9804931154079066), ('ind_dice_liver_1', tensor(0.9885, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6312, dtype=torch.float64)), ('all_iou', 0.9774528064246356), ('all_dice_liver', tensor(0.9878, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7151, dtype=torch.float64))]), 47086.6556754522)
[36m(ClientAppActor pid=3654519)[0m epoch:  3
[36m(ClientAppActor pid=3654519)[0m train ious:  0.9842438625973395
[36m(ClientAppActor pid=3654519)[0m train dice liver:  tensor(0.9902, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m train dice tumour:  tensor(0.7547, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation ious:  0.9771057827067156
[36m(ClientAppActor pid=3654519)[0m validation dice liver:  tensor(0.9877, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation dice tumour:  tensor(0.7204, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m => new best model:  3
Entrei no test
Meio do test
Fim do test
[2024-12-05 01:20:55,929][flwr][INFO] - fit progress: (11, 0.002835746582455747, OrderedDict([('ind_iou_0', 0.9771057827067156), ('ind_dice_liver_0', tensor(0.9877, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7204, dtype=torch.float64)), ('ind_iou_1', 0.9804931154079066), ('ind_dice_liver_1', tensor(0.9885, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6312, dtype=torch.float64)), ('all_iou', 0.9774528064246356), ('all_dice_liver', tensor(0.9878, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7151, dtype=torch.float64))]), 47086.6556754522)
[92mINFO [0m:      configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-12-05 01:20:55,934][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[36m(ClientAppActor pid=3654519)[0m Entrei no validation 1 3
[2024-12-05 01:23:02,751][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-12-05 01:23:02,752][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 1 failures
[2024-12-05 01:23:02,753][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[92mINFO [0m:      
[2024-12-05 01:23:02,754][flwr][INFO] - 
[92mINFO [0m:      [ROUND 12]
[2024-12-05 01:23:02,754][flwr][INFO] - [ROUND 12]
[92mINFO [0m:      configure_fit: strategy sampled 1 clients (out of 1)
[2024-12-05 01:23:02,755][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[92mINFO [0m:      aggregate_fit: received 1 results and 0 failures
[36m(ClientAppActor pid=3654519)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3654519)[0m epoch:  0
[36m(ClientAppActor pid=3654519)[0m train ious:  0.9846075159640835
[36m(ClientAppActor pid=3654519)[0m train dice liver:  tensor(0.9904, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m train dice tumour:  tensor(0.7556, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation ious:  0.9770619297377799
[36m(ClientAppActor pid=3654519)[0m validation dice liver:  tensor(0.9876, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation dice tumour:  tensor(0.7235, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m => new best model:  0
[36m(ClientAppActor pid=3654519)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3654519)[0m epoch:  1
[36m(ClientAppActor pid=3654519)[0m train ious:  0.9848488172776673
[36m(ClientAppActor pid=3654519)[0m train dice liver:  tensor(0.9906, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m train dice tumour:  tensor(0.7594, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation ious:  0.9772513515453963
[36m(ClientAppActor pid=3654519)[0m validation dice liver:  tensor(0.9876, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation dice tumour:  tensor(0.7263, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m => new best model:  1
[36m(ClientAppActor pid=3654519)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3654519)[0m epoch:  2
[36m(ClientAppActor pid=3654519)[0m train ious:  0.9850744329094403
[36m(ClientAppActor pid=3654519)[0m train dice liver:  tensor(0.9907, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m train dice tumour:  tensor(0.7593, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation ious:  0.977392703253503
[36m(ClientAppActor pid=3654519)[0m validation dice liver:  tensor(0.9876, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation dice tumour:  tensor(0.7236, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m => new best model:  2
[36m(ClientAppActor pid=3654519)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3654519)[0m epoch:  3
[36m(ClientAppActor pid=3654519)[0m train ious:  0.9853078791763608
[36m(ClientAppActor pid=3654519)[0m train dice liver:  tensor(0.9908, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m train dice tumour:  tensor(0.7592, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation ious:  0.9775585144507694
[36m(ClientAppActor pid=3654519)[0m validation dice liver:  tensor(0.9879, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation dice tumour:  tensor(0.7246, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m => new best model:  3
[2024-12-05 02:22:56,703][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[92mINFO [0m:      fit progress: (12, 0.002819015741277393, OrderedDict([('ind_iou_0', 0.9775585144507694), ('ind_dice_liver_0', tensor(0.9879, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7246, dtype=torch.float64)), ('ind_iou_1', 0.9810897637723638), ('ind_dice_liver_1', tensor(0.9888, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6339, dtype=torch.float64)), ('all_iou', 0.9779222352364113), ('all_dice_liver', tensor(0.9880, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7189, dtype=torch.float64))]), 51141.1536735408)
Entrei no test
Meio do test
Fim do test
[2024-12-05 02:28:30,428][flwr][INFO] - fit progress: (12, 0.002819015741277393, OrderedDict([('ind_iou_0', 0.9775585144507694), ('ind_dice_liver_0', tensor(0.9879, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7246, dtype=torch.float64)), ('ind_iou_1', 0.9810897637723638), ('ind_dice_liver_1', tensor(0.9888, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6339, dtype=torch.float64)), ('all_iou', 0.9779222352364113), ('all_dice_liver', tensor(0.9880, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7189, dtype=torch.float64))]), 51141.1536735408)
[92mINFO [0m:      configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-12-05 02:28:30,435][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[36m(ClientAppActor pid=3654519)[0m Entrei no validation 1 3
[2024-12-05 02:31:45,936][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-12-05 02:31:45,937][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 1 failures
[2024-12-05 02:31:45,938][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[92mINFO [0m:      
[2024-12-05 02:31:45,939][flwr][INFO] - 
[92mINFO [0m:      [ROUND 13]
[2024-12-05 02:31:45,939][flwr][INFO] - [ROUND 13]
[92mINFO [0m:      configure_fit: strategy sampled 1 clients (out of 1)
[2024-12-05 02:31:45,940][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[92mINFO [0m:      aggregate_fit: received 1 results and 0 failures
[36m(ClientAppActor pid=3654519)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3654519)[0m epoch:  0
[36m(ClientAppActor pid=3654519)[0m train ious:  0.9855175229207312
[36m(ClientAppActor pid=3654519)[0m train dice liver:  tensor(0.9910, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m train dice tumour:  tensor(0.7583, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation ious:  0.9776530768118118
[36m(ClientAppActor pid=3654519)[0m validation dice liver:  tensor(0.9879, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation dice tumour:  tensor(0.7268, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m => new best model:  0
[36m(ClientAppActor pid=3654519)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3654519)[0m epoch:  1
[36m(ClientAppActor pid=3654519)[0m train ious:  0.9858046829375015
[36m(ClientAppActor pid=3654519)[0m train dice liver:  tensor(0.9911, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m train dice tumour:  tensor(0.7519, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation ious:  0.9775596484735932
[36m(ClientAppActor pid=3654519)[0m validation dice liver:  tensor(0.9880, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation dice tumour:  tensor(0.7307, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m => new best model:  1
[36m(ClientAppActor pid=3654519)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3654519)[0m epoch:  2
[36m(ClientAppActor pid=3654519)[0m train ious:  0.9859556389248052
[36m(ClientAppActor pid=3654519)[0m train dice liver:  tensor(0.9912, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m train dice tumour:  tensor(0.7594, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation ious:  0.9780696075589901
[36m(ClientAppActor pid=3654519)[0m validation dice liver:  tensor(0.9882, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation dice tumour:  tensor(0.7268, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m => new best model:  2
[36m(ClientAppActor pid=3654519)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3654519)[0m epoch:  3
[36m(ClientAppActor pid=3654519)[0m train ious:  0.9862504898726827
[36m(ClientAppActor pid=3654519)[0m train dice liver:  tensor(0.9914, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m train dice tumour:  tensor(0.7627, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation ious:  0.9780513997752021
[36m(ClientAppActor pid=3654519)[0m validation dice liver:  tensor(0.9883, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation dice tumour:  tensor(0.7294, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m => new best model:  3
[2024-12-05 03:31:32,154][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[92mINFO [0m:      fit progress: (13, 0.0028225321303853735, OrderedDict([('ind_iou_0', 0.9780513997752021), ('ind_dice_liver_0', tensor(0.9883, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7294, dtype=torch.float64)), ('ind_iou_1', 0.9817646682916628), ('ind_dice_liver_1', tensor(0.9893, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6353, dtype=torch.float64)), ('all_iou', 0.9784281164065824), ('all_dice_liver', tensor(0.9884, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7240, dtype=torch.float64))]), 55249.21291993465)
Entrei no test
Meio do test
Fim do test
[2024-12-05 03:36:58,486][flwr][INFO] - fit progress: (13, 0.0028225321303853735, OrderedDict([('ind_iou_0', 0.9780513997752021), ('ind_dice_liver_0', tensor(0.9883, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7294, dtype=torch.float64)), ('ind_iou_1', 0.9817646682916628), ('ind_dice_liver_1', tensor(0.9893, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6353, dtype=torch.float64)), ('all_iou', 0.9784281164065824), ('all_dice_liver', tensor(0.9884, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7240, dtype=torch.float64))]), 55249.21291993465)
[92mINFO [0m:      configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-12-05 03:36:58,491][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[36m(ClientAppActor pid=3654519)[0m Entrei no validation 1 3
[2024-12-05 03:39:06,946][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-12-05 03:39:06,947][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 1 failures
[2024-12-05 03:39:06,948][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[92mINFO [0m:      
[2024-12-05 03:39:06,949][flwr][INFO] - 
[92mINFO [0m:      [ROUND 14]
[2024-12-05 03:39:06,950][flwr][INFO] - [ROUND 14]
[92mINFO [0m:      configure_fit: strategy sampled 1 clients (out of 1)
[2024-12-05 03:39:06,951][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[92mINFO [0m:      aggregate_fit: received 1 results and 0 failures
[36m(ClientAppActor pid=3654519)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3654519)[0m epoch:  0
[36m(ClientAppActor pid=3654519)[0m train ious:  0.9864177356347147
[36m(ClientAppActor pid=3654519)[0m train dice liver:  tensor(0.9915, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m train dice tumour:  tensor(0.7634, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation ious:  0.9782581770848987
[36m(ClientAppActor pid=3654519)[0m validation dice liver:  tensor(0.9883, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation dice tumour:  tensor(0.7302, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m => new best model:  0
[36m(ClientAppActor pid=3654519)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3654519)[0m epoch:  1
[36m(ClientAppActor pid=3654519)[0m train ious:  0.9865094435714155
[36m(ClientAppActor pid=3654519)[0m train dice liver:  tensor(0.9916, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m train dice tumour:  tensor(0.7560, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation ious:  0.9778623318877678
[36m(ClientAppActor pid=3654519)[0m validation dice liver:  tensor(0.9882, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation dice tumour:  tensor(0.7242, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m => new best model:  1
[36m(ClientAppActor pid=3654519)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3654519)[0m epoch:  2
[36m(ClientAppActor pid=3654519)[0m train ious:  0.9869113391807884
[36m(ClientAppActor pid=3654519)[0m train dice liver:  tensor(0.9918, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m train dice tumour:  tensor(0.7658, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation ious:  0.9784297693709944
[36m(ClientAppActor pid=3654519)[0m validation dice liver:  tensor(0.9885, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation dice tumour:  tensor(0.7287, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m => new best model:  2
[36m(ClientAppActor pid=3654519)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3654519)[0m epoch:  3
[36m(ClientAppActor pid=3654519)[0m train ious:  0.9870054380116542
[36m(ClientAppActor pid=3654519)[0m train dice liver:  tensor(0.9919, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m train dice tumour:  tensor(0.7622, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation ious:  0.9774996637046156
[36m(ClientAppActor pid=3654519)[0m validation dice liver:  tensor(0.9882, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation dice tumour:  tensor(0.7286, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m => new best model:  3
[2024-12-05 04:44:40,763][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[92mINFO [0m:      fit progress: (14, 0.002945382673931214, OrderedDict([('ind_iou_0', 0.9774996637046156), ('ind_dice_liver_0', tensor(0.9882, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7286, dtype=torch.float64)), ('ind_iou_1', 0.9817258819590473), ('ind_dice_liver_1', tensor(0.9895, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6374, dtype=torch.float64)), ('all_iou', 0.9779347654689567), ('all_dice_liver', tensor(0.9883, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7231, dtype=torch.float64))]), 59631.813534174114)
Entrei no test
Meio do test
Fim do test
[2024-12-05 04:50:01,087][flwr][INFO] - fit progress: (14, 0.002945382673931214, OrderedDict([('ind_iou_0', 0.9774996637046156), ('ind_dice_liver_0', tensor(0.9882, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7286, dtype=torch.float64)), ('ind_iou_1', 0.9817258819590473), ('ind_dice_liver_1', tensor(0.9895, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6374, dtype=torch.float64)), ('all_iou', 0.9779347654689567), ('all_dice_liver', tensor(0.9883, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7231, dtype=torch.float64))]), 59631.813534174114)
[92mINFO [0m:      configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-12-05 04:50:01,098][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[36m(ClientAppActor pid=3654519)[0m Entrei no validation 1 3
[2024-12-05 04:52:05,407][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-12-05 04:52:05,408][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 1 failures
[2024-12-05 04:52:05,410][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[92mINFO [0m:      
[2024-12-05 04:52:05,410][flwr][INFO] - 
[92mINFO [0m:      [ROUND 15]
[2024-12-05 04:52:05,410][flwr][INFO] - [ROUND 15]
[92mINFO [0m:      configure_fit: strategy sampled 1 clients (out of 1)
[2024-12-05 04:52:05,411][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[92mINFO [0m:      aggregate_fit: received 1 results and 0 failures
[36m(ClientAppActor pid=3654519)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3654519)[0m epoch:  0
[36m(ClientAppActor pid=3654519)[0m train ious:  0.987212020660503
[36m(ClientAppActor pid=3654519)[0m train dice liver:  tensor(0.9920, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m train dice tumour:  tensor(0.7624, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation ious:  0.9784553060630221
[36m(ClientAppActor pid=3654519)[0m validation dice liver:  tensor(0.9887, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation dice tumour:  tensor(0.7286, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m => new best model:  0
[36m(ClientAppActor pid=3654519)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3654519)[0m epoch:  1
[36m(ClientAppActor pid=3654519)[0m train ious:  0.9873665613232403
[36m(ClientAppActor pid=3654519)[0m train dice liver:  tensor(0.9921, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m train dice tumour:  tensor(0.7720, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation ious:  0.9785498678082711
[36m(ClientAppActor pid=3654519)[0m validation dice liver:  tensor(0.9886, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation dice tumour:  tensor(0.7303, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m => new best model:  1
[36m(ClientAppActor pid=3654519)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3654519)[0m epoch:  2
[36m(ClientAppActor pid=3654519)[0m train ious:  0.9875651890412304
[36m(ClientAppActor pid=3654519)[0m train dice liver:  tensor(0.9922, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m train dice tumour:  tensor(0.7696, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation ious:  0.9786622453670308
[36m(ClientAppActor pid=3654519)[0m validation dice liver:  tensor(0.9888, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation dice tumour:  tensor(0.7317, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m => new best model:  2
[36m(ClientAppActor pid=3654519)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3654519)[0m epoch:  3
[36m(ClientAppActor pid=3654519)[0m train ious:  0.9876798244547839
[36m(ClientAppActor pid=3654519)[0m train dice liver:  tensor(0.9923, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m train dice tumour:  tensor(0.7730, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation ious:  0.9787129697883933
[36m(ClientAppActor pid=3654519)[0m validation dice liver:  tensor(0.9889, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation dice tumour:  tensor(0.7286, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m => new best model:  3
[2024-12-05 05:59:41,004][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[92mINFO [0m:      fit progress: (15, 0.002851507365681435, OrderedDict([('ind_iou_0', 0.9787129697883933), ('ind_dice_liver_0', tensor(0.9889, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7286, dtype=torch.float64)), ('ind_iou_1', 0.9827936456618482), ('ind_dice_liver_1', tensor(0.9902, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6421, dtype=torch.float64)), ('all_iou', 0.9791353131550928), ('all_dice_liver', tensor(0.9890, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7237, dtype=torch.float64))]), 64110.82740444038)
Entrei no test
Meio do test
Fim do test
[2024-12-05 06:04:40,101][flwr][INFO] - fit progress: (15, 0.002851507365681435, OrderedDict([('ind_iou_0', 0.9787129697883933), ('ind_dice_liver_0', tensor(0.9889, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7286, dtype=torch.float64)), ('ind_iou_1', 0.9827936456618482), ('ind_dice_liver_1', tensor(0.9902, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6421, dtype=torch.float64)), ('all_iou', 0.9791353131550928), ('all_dice_liver', tensor(0.9890, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7237, dtype=torch.float64))]), 64110.82740444038)
[92mINFO [0m:      configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-12-05 06:04:40,107][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[36m(ClientAppActor pid=3654519)[0m Entrei no validation 1 3
[2024-12-05 06:06:57,625][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-12-05 06:06:57,626][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 1 failures
[2024-12-05 06:06:57,626][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[92mINFO [0m:      
[2024-12-05 06:06:57,627][flwr][INFO] - 
[92mINFO [0m:      [ROUND 16]
[2024-12-05 06:06:57,627][flwr][INFO] - [ROUND 16]
[92mINFO [0m:      configure_fit: strategy sampled 1 clients (out of 1)
[2024-12-05 06:06:57,628][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[92mINFO [0m:      aggregate_fit: received 1 results and 0 failures
[36m(ClientAppActor pid=3654519)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3654519)[0m epoch:  0
[36m(ClientAppActor pid=3654519)[0m train ious:  0.9878587849368198
[36m(ClientAppActor pid=3654519)[0m train dice liver:  tensor(0.9925, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m train dice tumour:  tensor(0.7738, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation ious:  0.9786102204245251
[36m(ClientAppActor pid=3654519)[0m validation dice liver:  tensor(0.9889, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation dice tumour:  tensor(0.7326, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m => new best model:  0
[36m(ClientAppActor pid=3654519)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3654519)[0m epoch:  1
[36m(ClientAppActor pid=3654519)[0m train ious:  0.9880121305017069
[36m(ClientAppActor pid=3654519)[0m train dice liver:  tensor(0.9925, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m train dice tumour:  tensor(0.7625, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation ious:  0.9789553207679922
[36m(ClientAppActor pid=3654519)[0m validation dice liver:  tensor(0.9891, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation dice tumour:  tensor(0.7323, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m => new best model:  1
[36m(ClientAppActor pid=3654519)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3654519)[0m epoch:  2
[36m(ClientAppActor pid=3654519)[0m train ious:  0.9881468632672925
[36m(ClientAppActor pid=3654519)[0m train dice liver:  tensor(0.9926, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m train dice tumour:  tensor(0.7737, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation ious:  0.978979921274756
[36m(ClientAppActor pid=3654519)[0m validation dice liver:  tensor(0.9891, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation dice tumour:  tensor(0.7315, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m => new best model:  2
[36m(ClientAppActor pid=3654519)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3654519)[0m epoch:  3
[36m(ClientAppActor pid=3654519)[0m train ious:  0.9883307113478763
[36m(ClientAppActor pid=3654519)[0m train dice liver:  tensor(0.9927, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m train dice tumour:  tensor(0.7715, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation ious:  0.9790258688006265
[36m(ClientAppActor pid=3654519)[0m validation dice liver:  tensor(0.9891, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation dice tumour:  tensor(0.7316, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m => new best model:  3
[2024-12-05 07:07:42,453][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[92mINFO [0m:      fit progress: (16, 0.0028903455226255777, OrderedDict([('ind_iou_0', 0.9790258688006265), ('ind_dice_liver_0', tensor(0.9891, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7316, dtype=torch.float64)), ('ind_iou_1', 0.983699885432905), ('ind_dice_liver_1', tensor(0.9907, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6465, dtype=torch.float64)), ('all_iou', 0.979506409420907), ('all_dice_liver', tensor(0.9893, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7272, dtype=torch.float64))]), 68209.59765859507)
Entrei no test
Meio do test
Fim do test
[2024-12-05 07:12:58,871][flwr][INFO] - fit progress: (16, 0.0028903455226255777, OrderedDict([('ind_iou_0', 0.9790258688006265), ('ind_dice_liver_0', tensor(0.9891, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7316, dtype=torch.float64)), ('ind_iou_1', 0.983699885432905), ('ind_dice_liver_1', tensor(0.9907, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6465, dtype=torch.float64)), ('all_iou', 0.979506409420907), ('all_dice_liver', tensor(0.9893, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7272, dtype=torch.float64))]), 68209.59765859507)
[92mINFO [0m:      configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-12-05 07:12:58,875][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[36m(ClientAppActor pid=3654519)[0m Entrei no validation 1 3
[2024-12-05 07:15:05,867][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-12-05 07:15:05,868][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 1 failures
[2024-12-05 07:15:05,869][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[92mINFO [0m:      
[2024-12-05 07:15:05,870][flwr][INFO] - 
[92mINFO [0m:      [ROUND 17]
[2024-12-05 07:15:05,870][flwr][INFO] - [ROUND 17]
[92mINFO [0m:      configure_fit: strategy sampled 1 clients (out of 1)
[2024-12-05 07:15:05,871][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[92mINFO [0m:      aggregate_fit: received 1 results and 0 failures
[36m(ClientAppActor pid=3654519)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3654519)[0m epoch:  0
[36m(ClientAppActor pid=3654519)[0m train ious:  0.9884231906787156
[36m(ClientAppActor pid=3654519)[0m train dice liver:  tensor(0.9928, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m train dice tumour:  tensor(0.7717, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation ious:  0.9791064375625431
[36m(ClientAppActor pid=3654519)[0m validation dice liver:  tensor(0.9893, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation dice tumour:  tensor(0.7329, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m => new best model:  0
[36m(ClientAppActor pid=3654519)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3654519)[0m epoch:  1
[36m(ClientAppActor pid=3654519)[0m train ious:  0.9886356329306687
[36m(ClientAppActor pid=3654519)[0m train dice liver:  tensor(0.9929, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m train dice tumour:  tensor(0.7804, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation ious:  0.9791085592961221
[36m(ClientAppActor pid=3654519)[0m validation dice liver:  tensor(0.9893, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation dice tumour:  tensor(0.7339, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m => new best model:  1
[36m(ClientAppActor pid=3654519)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3654519)[0m epoch:  2
[36m(ClientAppActor pid=3654519)[0m train ious:  0.9887427646045653
[36m(ClientAppActor pid=3654519)[0m train dice liver:  tensor(0.9930, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m train dice tumour:  tensor(0.7826, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation ious:  0.979105787919447
[36m(ClientAppActor pid=3654519)[0m validation dice liver:  tensor(0.9892, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation dice tumour:  tensor(0.7339, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m => new best model:  2
[36m(ClientAppActor pid=3654519)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3654519)[0m epoch:  3
[36m(ClientAppActor pid=3654519)[0m train ious:  0.9888002774402093
[36m(ClientAppActor pid=3654519)[0m train dice liver:  tensor(0.9930, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m train dice tumour:  tensor(0.7731, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation ious:  0.9790783668283077
[36m(ClientAppActor pid=3654519)[0m validation dice liver:  tensor(0.9893, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation dice tumour:  tensor(0.7338, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m => new best model:  3
[2024-12-05 08:18:25,719][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[92mINFO [0m:      fit progress: (17, 0.002981101287563202, OrderedDict([('ind_iou_0', 0.9790783668283077), ('ind_dice_liver_0', tensor(0.9893, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7338, dtype=torch.float64)), ('ind_iou_1', 0.9836633101950607), ('ind_dice_liver_1', tensor(0.9909, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6489, dtype=torch.float64)), ('all_iou', 0.9795542152565662), ('all_dice_liver', tensor(0.9895, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7291, dtype=torch.float64))]), 72457.99179929122)
Entrei no test
Meio do test
Fim do test
[2024-12-05 08:23:47,265][flwr][INFO] - fit progress: (17, 0.002981101287563202, OrderedDict([('ind_iou_0', 0.9790783668283077), ('ind_dice_liver_0', tensor(0.9893, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7338, dtype=torch.float64)), ('ind_iou_1', 0.9836633101950607), ('ind_dice_liver_1', tensor(0.9909, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6489, dtype=torch.float64)), ('all_iou', 0.9795542152565662), ('all_dice_liver', tensor(0.9895, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7291, dtype=torch.float64))]), 72457.99179929122)
[92mINFO [0m:      configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-12-05 08:23:47,271][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[36m(ClientAppActor pid=3654519)[0m Entrei no validation 1 3
[2024-12-05 08:26:21,206][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-12-05 08:26:21,207][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 1 failures
[2024-12-05 08:26:21,208][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[92mINFO [0m:      
[2024-12-05 08:26:21,209][flwr][INFO] - 
[92mINFO [0m:      [ROUND 18]
[2024-12-05 08:26:21,209][flwr][INFO] - [ROUND 18]
[92mINFO [0m:      configure_fit: strategy sampled 1 clients (out of 1)
[2024-12-05 08:26:21,209][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[92mINFO [0m:      aggregate_fit: received 1 results and 0 failures
[36m(ClientAppActor pid=3654519)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3654519)[0m epoch:  0
[36m(ClientAppActor pid=3654519)[0m train ious:  0.9889755045567692
[36m(ClientAppActor pid=3654519)[0m train dice liver:  tensor(0.9931, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m train dice tumour:  tensor(0.7816, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation ious:  0.979390817972695
[36m(ClientAppActor pid=3654519)[0m validation dice liver:  tensor(0.9895, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation dice tumour:  tensor(0.7366, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m => new best model:  0
[36m(ClientAppActor pid=3654519)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3654519)[0m epoch:  1
[36m(ClientAppActor pid=3654519)[0m train ious:  0.9891340901698948
[36m(ClientAppActor pid=3654519)[0m train dice liver:  tensor(0.9932, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m train dice tumour:  tensor(0.7774, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation ious:  0.9794602259851928
[36m(ClientAppActor pid=3654519)[0m validation dice liver:  tensor(0.9895, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation dice tumour:  tensor(0.7367, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m => new best model:  1
[36m(ClientAppActor pid=3654519)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3654519)[0m epoch:  2
[36m(ClientAppActor pid=3654519)[0m train ious:  0.9885457168113518
[36m(ClientAppActor pid=3654519)[0m train dice liver:  tensor(0.9928, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m train dice tumour:  tensor(0.7748, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation ious:  0.9773579701899269
[36m(ClientAppActor pid=3654519)[0m validation dice liver:  tensor(0.9879, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation dice tumour:  tensor(0.7233, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m => new best model:  2
[36m(ClientAppActor pid=3654519)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3654519)[0m epoch:  3
[36m(ClientAppActor pid=3654519)[0m train ious:  0.9892356951033255
[36m(ClientAppActor pid=3654519)[0m train dice liver:  tensor(0.9933, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m train dice tumour:  tensor(0.7758, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation ious:  0.9795632566208574
[36m(ClientAppActor pid=3654519)[0m validation dice liver:  tensor(0.9896, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation dice tumour:  tensor(0.7371, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m => new best model:  3
[2024-12-05 09:28:29,909][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[92mINFO [0m:      fit progress: (18, 0.0029185861430222814, OrderedDict([('ind_iou_0', 0.9795632566208574), ('ind_dice_liver_0', tensor(0.9896, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7371, dtype=torch.float64)), ('ind_iou_1', 0.9847325019454835), ('ind_dice_liver_1', tensor(0.9913, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6521, dtype=torch.float64)), ('all_iou', 0.9800859255290736), ('all_dice_liver', tensor(0.9897, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7325, dtype=torch.float64))]), 76648.9366113767)
Entrei no test
Meio do test
Fim do test
[2024-12-05 09:33:38,210][flwr][INFO] - fit progress: (18, 0.0029185861430222814, OrderedDict([('ind_iou_0', 0.9795632566208574), ('ind_dice_liver_0', tensor(0.9896, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7371, dtype=torch.float64)), ('ind_iou_1', 0.9847325019454835), ('ind_dice_liver_1', tensor(0.9913, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6521, dtype=torch.float64)), ('all_iou', 0.9800859255290736), ('all_dice_liver', tensor(0.9897, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7325, dtype=torch.float64))]), 76648.9366113767)
[92mINFO [0m:      configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-12-05 09:33:38,218][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[36m(ClientAppActor pid=3654519)[0m Entrei no validation 1 3
[2024-12-05 09:36:02,100][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-12-05 09:36:02,101][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 1 failures
[2024-12-05 09:36:02,102][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[92mINFO [0m:      
[2024-12-05 09:36:02,103][flwr][INFO] - 
[92mINFO [0m:      [ROUND 19]
[2024-12-05 09:36:02,103][flwr][INFO] - [ROUND 19]
[92mINFO [0m:      configure_fit: strategy sampled 1 clients (out of 1)
[2024-12-05 09:36:02,103][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[92mINFO [0m:      aggregate_fit: received 1 results and 0 failures
[36m(ClientAppActor pid=3654519)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3654519)[0m epoch:  0
[36m(ClientAppActor pid=3654519)[0m train ious:  0.9894649475854589
[36m(ClientAppActor pid=3654519)[0m train dice liver:  tensor(0.9934, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m train dice tumour:  tensor(0.7838, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation ious:  0.9795527500348392
[36m(ClientAppActor pid=3654519)[0m validation dice liver:  tensor(0.9895, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation dice tumour:  
[36m(ClientAppActor pid=3654519)[0m tensor(0.7367, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m => new best model:  0
[36m(ClientAppActor pid=3654519)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3654519)[0m epoch:  1
[36m(ClientAppActor pid=3654519)[0m train ious:  0.9895096524199127
[36m(ClientAppActor pid=3654519)[0m train dice liver:  tensor(0.9935, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m train dice tumour:  tensor(0.7783, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation ious:  0.979406515843467
[36m(ClientAppActor pid=3654519)[0m validation dice liver:  tensor(0.9895, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation dice tumour:  tensor(0.7369, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m => new best model:  1
[36m(ClientAppActor pid=3654519)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3654519)[0m epoch:  2
[36m(ClientAppActor pid=3654519)[0m train ious:  0.9896171092756245
[36m(ClientAppActor pid=3654519)[0m train dice liver:  tensor(0.9935, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m train dice tumour:  tensor(0.7796, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation ious:  0.9795491797197663
[36m(ClientAppActor pid=3654519)[0m validation dice liver:  tensor(0.9896, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation dice tumour:  tensor(0.7360, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m => new best model:  2
[36m(ClientAppActor pid=3654519)[0m Entrei no validation 1 3
[2024-12-05 10:32:54,946][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[92mINFO [0m:      fit progress: (19, 0.0029778361188715122, OrderedDict([('ind_iou_0', 0.9795482438629819), ('ind_dice_liver_0', tensor(0.9896, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7372, dtype=torch.float64)), ('ind_iou_1', 0.9845212804209821), ('ind_dice_liver_1', tensor(0.9913, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6530, dtype=torch.float64)), ('all_iou', 0.9800570414927205), ('all_dice_liver', tensor(0.9898, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7327, dtype=torch.float64))]), 80487.31750693265)
[36m(ClientAppActor pid=3654519)[0m epoch:  3
[36m(ClientAppActor pid=3654519)[0m train ious:  0.9897192898892484
[36m(ClientAppActor pid=3654519)[0m train dice liver:  tensor(0.9936, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m train dice tumour:  tensor(0.7800, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation ious:  0.9795482438629819
[36m(ClientAppActor pid=3654519)[0m validation dice liver:  tensor(0.9896, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation dice tumour:  tensor(0.7372, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m => new best model:  3
Entrei no test
Meio do test
Fim do test
[2024-12-05 10:37:36,591][flwr][INFO] - fit progress: (19, 0.0029778361188715122, OrderedDict([('ind_iou_0', 0.9795482438629819), ('ind_dice_liver_0', tensor(0.9896, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7372, dtype=torch.float64)), ('ind_iou_1', 0.9845212804209821), ('ind_dice_liver_1', tensor(0.9913, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6530, dtype=torch.float64)), ('all_iou', 0.9800570414927205), ('all_dice_liver', tensor(0.9898, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7327, dtype=torch.float64))]), 80487.31750693265)
[92mINFO [0m:      configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-12-05 10:37:36,597][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[36m(ClientAppActor pid=3654519)[0m Entrei no validation 1 3
[2024-12-05 10:39:19,917][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-12-05 10:39:19,918][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 1 failures
[2024-12-05 10:39:19,919][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[92mINFO [0m:      
[2024-12-05 10:39:19,920][flwr][INFO] - 
[92mINFO [0m:      [ROUND 20]
[2024-12-05 10:39:19,920][flwr][INFO] - [ROUND 20]
[92mINFO [0m:      configure_fit: strategy sampled 1 clients (out of 1)
[2024-12-05 10:39:19,920][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[92mINFO [0m:      aggregate_fit: received 1 results and 0 failures
[36m(ClientAppActor pid=3654519)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3654519)[0m epoch:  0
[36m(ClientAppActor pid=3654519)[0m train ious:  0.9898327609083132
[36m(ClientAppActor pid=3654519)[0m train dice liver:  tensor(0.9937, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m train dice tumour:  tensor(0.7838, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation ious:  0.9795465141946704
[36m(ClientAppActor pid=3654519)[0m validation dice liver:  tensor(0.9897, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation dice tumour:  tensor(0.7386, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m => new best model:  0
[36m(ClientAppActor pid=3654519)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3654519)[0m epoch:  1
[36m(ClientAppActor pid=3654519)[0m train ious:  0.9899327700558608
[36m(ClientAppActor pid=3654519)[0m train dice liver:  tensor(0.9937, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m train dice tumour:  tensor(0.7806, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation ious:  0.9796681637492036
[36m(ClientAppActor pid=3654519)[0m validation dice liver:  tensor(0.9897, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation dice tumour:  tensor(0.7375, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m => new best model:  1
[36m(ClientAppActor pid=3654519)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3654519)[0m epoch:  2
[36m(ClientAppActor pid=3654519)[0m train ious:  0.9900823760985363
[36m(ClientAppActor pid=3654519)[0m train dice liver:  tensor(0.9938, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m train dice tumour:  tensor(0.7810, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation ious:  0.979473696294306
[36m(ClientAppActor pid=3654519)[0m validation dice liver:  tensor(0.9897, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation dice tumour:  tensor(0.7359, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m => new best model:  2
[36m(ClientAppActor pid=3654519)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3654519)[0m epoch:  3
[36m(ClientAppActor pid=3654519)[0m train ious:  0.9901436121315973
[36m(ClientAppActor pid=3654519)[0m train dice liver:  tensor(0.9939, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m train dice tumour:  tensor(0.7848, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation ious:  0.9794188233331589
[36m(ClientAppActor pid=3654519)[0m validation dice liver:  tensor(0.9896, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation dice tumour:  tensor(0.7366, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m => new best model:  3
[2024-12-05 11:35:23,715][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[92mINFO [0m:      fit progress: (20, 0.003069441032116429, OrderedDict([('ind_iou_0', 0.9794188233331589), ('ind_dice_liver_0', tensor(0.9896, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7366, dtype=torch.float64)), ('ind_iou_1', 0.9845431555152111), ('ind_dice_liver_1', tensor(0.9915, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6540, dtype=torch.float64)), ('all_iou', 0.9799466230551032), ('all_dice_liver', tensor(0.9898, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7322, dtype=torch.float64))]), 84214.93178351317)
Entrei no test
Meio do test
Fim do test
[2024-12-05 11:39:44,205][flwr][INFO] - fit progress: (20, 0.003069441032116429, OrderedDict([('ind_iou_0', 0.9794188233331589), ('ind_dice_liver_0', tensor(0.9896, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7366, dtype=torch.float64)), ('ind_iou_1', 0.9845431555152111), ('ind_dice_liver_1', tensor(0.9915, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6540, dtype=torch.float64)), ('all_iou', 0.9799466230551032), ('all_dice_liver', tensor(0.9898, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7322, dtype=torch.float64))]), 84214.93178351317)
[92mINFO [0m:      configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-12-05 11:39:44,209][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[36m(ClientAppActor pid=3654519)[0m Entrei no validation 1 3
[2024-12-05 11:41:39,076][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-12-05 11:41:39,077][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 1 failures
[2024-12-05 11:41:39,078][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[92mINFO [0m:      
[2024-12-05 11:41:39,079][flwr][INFO] - 
[92mINFO [0m:      [ROUND 21]
[2024-12-05 11:41:39,079][flwr][INFO] - [ROUND 21]
[92mINFO [0m:      configure_fit: strategy sampled 1 clients (out of 1)
[2024-12-05 11:41:39,080][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[92mINFO [0m:      aggregate_fit: received 1 results and 0 failures
[36m(ClientAppActor pid=3654519)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3654519)[0m epoch:  0
[36m(ClientAppActor pid=3654519)[0m train ious:  0.9902212783897673
[36m(ClientAppActor pid=3654519)[0m train dice liver:  tensor(0.9939, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m train dice tumour:  tensor(0.7844, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation ious:  0.979517627813709
[36m(ClientAppActor pid=3654519)[0m validation dice liver:  tensor(0.9897, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation dice tumour:  tensor(0.7376, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m => new best model:  0
[36m(ClientAppActor pid=3654519)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3654519)[0m epoch:  1
[36m(ClientAppActor pid=3654519)[0m train ious:  0.9902770367911217
[36m(ClientAppActor pid=3654519)[0m train dice liver:  tensor(0.9939, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m train dice tumour:  tensor(0.7877, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation ious:  0.9796416529387392
[36m(ClientAppActor pid=3654519)[0m validation dice liver:  tensor(0.9898, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation dice tumour:  tensor(0.7400, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m => new best model:  1
[36m(ClientAppActor pid=3654519)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3654519)[0m epoch:  2
[36m(ClientAppActor pid=3654519)[0m train ious:  0.9903951134072098
[36m(ClientAppActor pid=3654519)[0m train dice liver:  tensor(0.9940, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m train dice tumour:  tensor(0.7804, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation ious:  0.9798578858748501
[36m(ClientAppActor pid=3654519)[0m validation dice liver:  tensor(0.9899, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation dice tumour:  tensor(0.7388, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m => new best model:  2
[36m(ClientAppActor pid=3654519)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3654519)[0m epoch:  3
[36m(ClientAppActor pid=3654519)[0m train ious:  0.9905010219500723
[36m(ClientAppActor pid=3654519)[0m train dice liver:  tensor(0.9941, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m train dice tumour:  tensor(0.7840, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation ious:  0.9798966802547555
[36m(ClientAppActor pid=3654519)[0m validation dice liver:  tensor(0.9900, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation dice tumour:  tensor(0.7403, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m => new best model:  3
[2024-12-05 12:36:21,989][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[92mINFO [0m:      fit progress: (21, 0.0030454325812229806, OrderedDict([('ind_iou_0', 0.9798966802547555), ('ind_dice_liver_0', tensor(0.9900, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7403, dtype=torch.float64)), ('ind_iou_1', 0.9854512857308466), ('ind_dice_liver_1', tensor(0.9920, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6551, dtype=torch.float64)), ('all_iou', 0.9804645655732592), ('all_dice_liver', tensor(0.9902, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7357, dtype=torch.float64))]), 87938.9059287943)
Entrei no test
Meio do test
Fim do test
[2024-12-05 12:41:48,179][flwr][INFO] - fit progress: (21, 0.0030454325812229806, OrderedDict([('ind_iou_0', 0.9798966802547555), ('ind_dice_liver_0', tensor(0.9900, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7403, dtype=torch.float64)), ('ind_iou_1', 0.9854512857308466), ('ind_dice_liver_1', tensor(0.9920, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6551, dtype=torch.float64)), ('all_iou', 0.9804645655732592), ('all_dice_liver', tensor(0.9902, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7357, dtype=torch.float64))]), 87938.9059287943)
[92mINFO [0m:      configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-12-05 12:41:48,185][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[36m(ClientAppActor pid=3654519)[0m Entrei no validation 1 3
[2024-12-05 12:43:51,096][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-12-05 12:43:51,097][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 1 failures
[2024-12-05 12:43:51,099][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[92mINFO [0m:      
[2024-12-05 12:43:51,099][flwr][INFO] - 
[92mINFO [0m:      [ROUND 22]
[2024-12-05 12:43:51,099][flwr][INFO] - [ROUND 22]
[92mINFO [0m:      configure_fit: strategy sampled 1 clients (out of 1)
[2024-12-05 12:43:51,100][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[92mINFO [0m:      aggregate_fit: received 1 results and 0 failures
[36m(ClientAppActor pid=3654519)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3654519)[0m epoch:  0
[36m(ClientAppActor pid=3654519)[0m train ious:  0.990562834611375
[36m(ClientAppActor pid=3654519)[0m train dice liver:  tensor(0.9941, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m train dice tumour:  tensor(0.7857, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation ious:  0.9798781305081073
[36m(ClientAppActor pid=3654519)[0m validation dice liver:  tensor(0.9900, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation dice tumour:  tensor(0.7391, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m => new best model:  0
[36m(ClientAppActor pid=3654519)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3654519)[0m epoch:  1
[36m(ClientAppActor pid=3654519)[0m train ious:  0.9905821308710988
[36m(ClientAppActor pid=3654519)[0m train dice liver:  tensor(0.9941, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m train dice tumour:  tensor(0.7843, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation ious:  0.9797813263581184
[36m(ClientAppActor pid=3654519)[0m validation dice liver:  tensor(0.9899, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation dice tumour:  tensor(0.7362, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m => new best model:  1
[36m(ClientAppActor pid=3654519)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3654519)[0m epoch:  2
[36m(ClientAppActor pid=3654519)[0m train ious:  0.9907713197920233
[36m(ClientAppActor pid=3654519)[0m train dice liver:  tensor(0.9942, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m train dice tumour:  tensor(0.7931, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation ious:  0.9797889324459332
[36m(ClientAppActor pid=3654519)[0m validation dice liver:  tensor(0.9899, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation dice tumour:  tensor(0.7419, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m => new best model:  2
[36m(ClientAppActor pid=3654519)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3654519)[0m epoch:  3
[36m(ClientAppActor pid=3654519)[0m train ious:  0.9908857637428868
[36m(ClientAppActor pid=3654519)[0m train dice liver:  tensor(0.9943, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m train dice tumour:  tensor(0.7863, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation ious:  0.9798619112384731
[36m(ClientAppActor pid=3654519)[0m validation dice liver:  tensor(0.9901, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation dice tumour:  tensor(0.7417, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m => new best model:  3
[2024-12-05 13:39:51,574][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[92mINFO [0m:      fit progress: (22, 0.003151106251172243, OrderedDict([('ind_iou_0', 0.9798619112384731), ('ind_dice_liver_0', tensor(0.9901, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7417, dtype=torch.float64)), ('ind_iou_1', 0.9854489062436487), ('ind_dice_liver_1', tensor(0.9921, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6549, dtype=torch.float64)), ('all_iou', 0.9804260694351024), ('all_dice_liver', tensor(0.9903, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7372, dtype=torch.float64))]), 91738.5163835967)
Entrei no test
Meio do test
Fim do test
[2024-12-05 13:45:07,790][flwr][INFO] - fit progress: (22, 0.003151106251172243, OrderedDict([('ind_iou_0', 0.9798619112384731), ('ind_dice_liver_0', tensor(0.9901, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7417, dtype=torch.float64)), ('ind_iou_1', 0.9854489062436487), ('ind_dice_liver_1', tensor(0.9921, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6549, dtype=torch.float64)), ('all_iou', 0.9804260694351024), ('all_dice_liver', tensor(0.9903, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7372, dtype=torch.float64))]), 91738.5163835967)
[92mINFO [0m:      configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-12-05 13:45:07,796][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[36m(ClientAppActor pid=3654519)[0m Entrei no validation 1 3
[2024-12-05 13:47:05,692][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-12-05 13:47:05,695][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 1 failures
[2024-12-05 13:47:05,697][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[92mINFO [0m:      
[2024-12-05 13:47:05,698][flwr][INFO] - 
[92mINFO [0m:      [ROUND 23]
[2024-12-05 13:47:05,700][flwr][INFO] - [ROUND 23]
[92mINFO [0m:      configure_fit: strategy sampled 1 clients (out of 1)
[2024-12-05 13:47:05,701][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[92mINFO [0m:      aggregate_fit: received 1 results and 0 failures
[36m(ClientAppActor pid=3654519)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3654519)[0m epoch:  0
[36m(ClientAppActor pid=3654519)[0m train ious:  0.9908870366454771
[36m(ClientAppActor pid=3654519)[0m train dice liver:  tensor(0.9943, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m train dice tumour:  tensor(0.7916, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation ious:  0.9801226597176907
[36m(ClientAppActor pid=3654519)[0m validation dice liver:  tensor(0.9901, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation dice tumour:  tensor(0.7418, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m => new best model:  0
[36m(ClientAppActor pid=3654519)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3654519)[0m epoch:  1
[36m(ClientAppActor pid=3654519)[0m train ious:  0.9910374362358383
[36m(ClientAppActor pid=3654519)[0m train dice liver:  tensor(0.9944, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m train dice tumour:  tensor(0.7852, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation ious:  0.9799180078002289
[36m(ClientAppActor pid=3654519)[0m validation dice liver:  tensor(0.9901, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation dice tumour:  tensor(0.7412, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m => new best model:  1
[36m(ClientAppActor pid=3654519)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3654519)[0m epoch:  2
[36m(ClientAppActor pid=3654519)[0m train ious:  0.9910258777008567
[36m(ClientAppActor pid=3654519)[0m train dice liver:  tensor(0.9944, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m train dice tumour:  tensor(0.7912, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation ious:  0.9800571808303509
[36m(ClientAppActor pid=3654519)[0m validation dice liver:  tensor(0.9901, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation dice tumour:  tensor(0.7415, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m => new best model:  2
[36m(ClientAppActor pid=3654519)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3654519)[0m epoch:  3
[36m(ClientAppActor pid=3654519)[0m train ious:  0.9911550273851915
[36m(ClientAppActor pid=3654519)[0m train dice liver:  tensor(0.9945, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m train dice tumour:  tensor(0.7865, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation ious:  0.9798777448117227
[36m(ClientAppActor pid=3654519)[0m validation dice liver:  tensor(0.9902, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation dice tumour:  tensor(0.7410, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m => new best model:  
[36m(ClientAppActor pid=3654519)[0m 3
[2024-12-05 14:44:32,446][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[92mINFO [0m:      fit progress: (23, 0.003194383338180135, OrderedDict([('ind_iou_0', 0.9798777448117227), ('ind_dice_liver_0', tensor(0.9902, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7410, dtype=torch.float64)), ('ind_iou_1', 0.9855275710310719), ('ind_dice_liver_1', tensor(0.9922, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6567, dtype=torch.float64)), ('all_iou', 0.980452015392803), ('all_dice_liver', tensor(0.9904, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7363, dtype=torch.float64))]), 95594.03605693206)
Entrei no test
Meio do test
Fim do test
[2024-12-05 14:49:23,310][flwr][INFO] - fit progress: (23, 0.003194383338180135, OrderedDict([('ind_iou_0', 0.9798777448117227), ('ind_dice_liver_0', tensor(0.9902, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7410, dtype=torch.float64)), ('ind_iou_1', 0.9855275710310719), ('ind_dice_liver_1', tensor(0.9922, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6567, dtype=torch.float64)), ('all_iou', 0.980452015392803), ('all_dice_liver', tensor(0.9904, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7363, dtype=torch.float64))]), 95594.03605693206)
[92mINFO [0m:      configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-12-05 14:49:23,315][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[36m(ClientAppActor pid=3654519)[0m Entrei no validation 1 3
[2024-12-05 14:51:22,475][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-12-05 14:51:22,476][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 1 failures
[2024-12-05 14:51:22,477][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[92mINFO [0m:      
[2024-12-05 14:51:22,478][flwr][INFO] - 
[92mINFO [0m:      [ROUND 24]
[2024-12-05 14:51:22,478][flwr][INFO] - [ROUND 24]
[92mINFO [0m:      configure_fit: strategy sampled 1 clients (out of 1)
[2024-12-05 14:51:22,478][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[92mINFO [0m:      aggregate_fit: received 1 results and 0 failures
[36m(ClientAppActor pid=3654519)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3654519)[0m epoch:  0
[36m(ClientAppActor pid=3654519)[0m train ious:  0.9912138944691279
[36m(ClientAppActor pid=3654519)[0m train dice liver:  tensor(0.9945, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m train dice tumour:  tensor(0.7926, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation ious:  0.9799986936550591
[36m(ClientAppActor pid=3654519)[0m validation dice liver:  tensor(0.9901, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation dice tumour:  tensor(0.7404, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m => new best model:  0
[36m(ClientAppActor pid=3654519)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3654519)[0m epoch:  1
[36m(ClientAppActor pid=3654519)[0m train ious:  0.9913215286169325
[36m(ClientAppActor pid=3654519)[0m train dice liver:  tensor(0.9946, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m train dice tumour:  tensor(0.7943, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation ious:  0.9800518572066783
[36m(ClientAppActor pid=3654519)[0m validation dice liver:  tensor(0.9902, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation dice tumour:  tensor(0.7418, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m => new best model:  1
[36m(ClientAppActor pid=3654519)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3654519)[0m epoch:  2
[36m(ClientAppActor pid=3654519)[0m train ious:  0.9912511528873786
[36m(ClientAppActor pid=3654519)[0m train dice liver:  tensor(0.9945, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m train dice tumour:  tensor(0.7876, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation ious:  0.9799872725034334
[36m(ClientAppActor pid=3654519)[0m validation dice liver:  tensor(0.9902, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation dice tumour:  tensor(0.7418, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m => new best model:  2
[36m(ClientAppActor pid=3654519)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3654519)[0m epoch:  3
[36m(ClientAppActor pid=3654519)[0m train ious:  0.9915197537092678
[36m(ClientAppActor pid=3654519)[0m train dice liver:  tensor(0.9947, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m train dice tumour:  tensor(0.7887, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation ious:  0.9800730770939928
[36m(ClientAppActor pid=3654519)[0m validation dice liver:  tensor(0.9902, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation dice tumour:  tensor(0.7423, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m => new best model:  3
[2024-12-05 15:49:52,693][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[92mINFO [0m:      fit progress: (24, 0.003201173000701002, OrderedDict([('ind_iou_0', 0.9800730770939928), ('ind_dice_liver_0', tensor(0.9902, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7423, dtype=torch.float64)), ('ind_iou_1', 0.9861303660393511), ('ind_dice_liver_1', tensor(0.9925, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6564, dtype=torch.float64)), ('all_iou', 0.9806770163719891), ('all_dice_liver', tensor(0.9905, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7372, dtype=torch.float64))]), 99547.68167318217)
Entrei no test
Meio do test
Fim do test
[2024-12-05 15:55:16,955][flwr][INFO] - fit progress: (24, 0.003201173000701002, OrderedDict([('ind_iou_0', 0.9800730770939928), ('ind_dice_liver_0', tensor(0.9902, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7423, dtype=torch.float64)), ('ind_iou_1', 0.9861303660393511), ('ind_dice_liver_1', tensor(0.9925, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6564, dtype=torch.float64)), ('all_iou', 0.9806770163719891), ('all_dice_liver', tensor(0.9905, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7372, dtype=torch.float64))]), 99547.68167318217)
[92mINFO [0m:      configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-12-05 15:55:16,960][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[36m(ClientAppActor pid=3654519)[0m Entrei no validation 1 3
[2024-12-05 15:57:28,723][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-12-05 15:57:28,724][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 1 failures
[2024-12-05 15:57:28,729][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[92mINFO [0m:      
[2024-12-05 15:57:28,729][flwr][INFO] - 
[92mINFO [0m:      [ROUND 25]
[2024-12-05 15:57:28,730][flwr][INFO] - [ROUND 25]
[92mINFO [0m:      configure_fit: strategy sampled 1 clients (out of 1)
[2024-12-05 15:57:28,730][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[92mINFO [0m:      aggregate_fit: received 1 results and 0 failures
[36m(ClientAppActor pid=3654519)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3654519)[0m epoch:  0
[36m(ClientAppActor pid=3654519)[0m train ious:  0.9915037694925071
[36m(ClientAppActor pid=3654519)[0m train dice liver:  tensor(0.9947, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m train dice tumour:  tensor(0.7977, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation ious:  0.9799448398094625
[36m(ClientAppActor pid=3654519)[0m validation dice liver:  tensor(0.9902, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation dice tumour:  tensor(0.7425, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m => new best model:  0
[36m(ClientAppActor pid=3654519)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3654519)[0m epoch:  1
[36m(ClientAppActor pid=3654519)[0m train ious:  0.9915706544236181
[36m(ClientAppActor pid=3654519)[0m train dice liver:  tensor(0.9947, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m train dice tumour:  tensor(0.7934, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation ious:  0.9800761408197537
[36m(ClientAppActor pid=3654519)[0m validation dice liver:  tensor(0.9902, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation dice tumour:  tensor(0.7422, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m => new best model:  1
[36m(ClientAppActor pid=3654519)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3654519)[0m epoch:  2
[36m(ClientAppActor pid=3654519)[0m train ious:  0.9916591817922253
[36m(ClientAppActor pid=3654519)[0m train dice liver:  tensor(0.9948, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m train dice tumour:  tensor(0.7889, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation ious:  0.9799721971984325
[36m(ClientAppActor pid=3654519)[0m validation dice liver:  tensor(0.9902, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation dice tumour:  tensor(0.7430, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m => new best model:  2
[36m(ClientAppActor pid=3654519)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3654519)[0m epoch:  3
[36m(ClientAppActor pid=3654519)[0m train ious:  0.9917355565664946
[36m(ClientAppActor pid=3654519)[0m train dice liver:  tensor(0.9949, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m train dice tumour:  tensor(0.7978, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation ious:  0.9801961712750589
[36m(ClientAppActor pid=3654519)[0m validation dice liver:  tensor(0.9903, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation dice tumour:  tensor(0.7430, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m => new best model:  3
[2024-12-05 16:56:33,455][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[92mINFO [0m:      fit progress: (25, 0.0032329137489647028, OrderedDict([('ind_iou_0', 0.9801961712750589), ('ind_dice_liver_0', tensor(0.9903, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7430, dtype=torch.float64)), ('ind_iou_1', 0.9863405139579186), ('ind_dice_liver_1', tensor(0.9926, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6579, dtype=torch.float64)), ('all_iou', 0.9808191685690155), ('all_dice_liver', tensor(0.9905, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7383, dtype=torch.float64))]), 103524.65561342053)
Entrei no test
Meio do test
Fim do test
[2024-12-05 17:01:33,929][flwr][INFO] - fit progress: (25, 0.0032329137489647028, OrderedDict([('ind_iou_0', 0.9801961712750589), ('ind_dice_liver_0', tensor(0.9903, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7430, dtype=torch.float64)), ('ind_iou_1', 0.9863405139579186), ('ind_dice_liver_1', tensor(0.9926, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6579, dtype=torch.float64)), ('all_iou', 0.9808191685690155), ('all_dice_liver', tensor(0.9905, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7383, dtype=torch.float64))]), 103524.65561342053)
[92mINFO [0m:      configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-12-05 17:01:33,938][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[36m(ClientAppActor pid=3654519)[0m Entrei no validation 1 3
[2024-12-05 17:03:46,403][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-12-05 17:03:46,404][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 1 failures
[2024-12-05 17:03:46,405][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[92mINFO [0m:      
[2024-12-05 17:03:46,405][flwr][INFO] - 
[92mINFO [0m:      [ROUND 26]
[2024-12-05 17:03:46,405][flwr][INFO] - [ROUND 26]
[92mINFO [0m:      configure_fit: strategy sampled 1 clients (out of 1)
[2024-12-05 17:03:46,405][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[92mINFO [0m:      aggregate_fit: received 1 results and 0 failures
[36m(ClientAppActor pid=3654519)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3654519)[0m epoch:  0
[36m(ClientAppActor pid=3654519)[0m train ious:  0.9917999215210571
[36m(ClientAppActor pid=3654519)[0m train dice liver:  tensor(0.9949, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m train dice tumour:  tensor(0.7957, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation ious:  0.9802898509577542
[36m(ClientAppActor pid=3654519)[0m validation dice liver:  tensor(0.9904, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation dice tumour:  tensor(0.7440, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m => new best model:  0
[36m(ClientAppActor pid=3654519)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3654519)[0m epoch:  1
[36m(ClientAppActor pid=3654519)[0m train ious:  0.9918603019776301
[36m(ClientAppActor pid=3654519)[0m train dice liver:  tensor(0.9949, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m train dice tumour:  tensor(0.7862, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation ious:  0.9803057402524125
[36m(ClientAppActor pid=3654519)[0m validation dice liver:  tensor(0.9905, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation dice tumour:  tensor(0.7440, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m => new best model:  1
[36m(ClientAppActor pid=3654519)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3654519)[0m epoch:  2
[36m(ClientAppActor pid=3654519)[0m train ious:  0.9919200241950906
[36m(ClientAppActor pid=3654519)[0m train dice liver:  
[36m(ClientAppActor pid=3654519)[0m tensor(0.9950, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m train dice tumour:  tensor(0.7926, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation ious:  0.980072457291475
[36m(ClientAppActor pid=3654519)[0m validation dice liver:  tensor(0.9903, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation dice tumour:  tensor(0.7431, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m => new best model:  2
[36m(ClientAppActor pid=3654519)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3654519)[0m epoch:  3
[36m(ClientAppActor pid=3654519)[0m train ious:  0.991941909657484
[36m(ClientAppActor pid=3654519)[0m train dice liver:  tensor(0.9950, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m train dice tumour:  tensor(0.7902, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation ious:  0.9801720946479946
[36m(ClientAppActor pid=3654519)[0m validation dice liver:  tensor(0.9903, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation dice tumour:  tensor(0.7428, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m => new best model:  3
[2024-12-05 18:04:14,175][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[92mINFO [0m:      fit progress: (26, 0.003236916543988956, OrderedDict([('ind_iou_0', 0.9801720946479946), ('ind_dice_liver_0', tensor(0.9903, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7428, dtype=torch.float64)), ('ind_iou_1', 0.986488093000365), ('ind_dice_liver_1', tensor(0.9927, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6606, dtype=torch.float64)), ('all_iou', 0.9808140816480584), ('all_dice_liver', tensor(0.9906, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7387, dtype=torch.float64))]), 107559.48269970808)
Entrei no test
Meio do test
Fim do test
[2024-12-05 18:08:48,756][flwr][INFO] - fit progress: (26, 0.003236916543988956, OrderedDict([('ind_iou_0', 0.9801720946479946), ('ind_dice_liver_0', tensor(0.9903, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7428, dtype=torch.float64)), ('ind_iou_1', 0.986488093000365), ('ind_dice_liver_1', tensor(0.9927, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6606, dtype=torch.float64)), ('all_iou', 0.9808140816480584), ('all_dice_liver', tensor(0.9906, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7387, dtype=torch.float64))]), 107559.48269970808)
[92mINFO [0m:      configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-12-05 18:08:48,762][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[36m(ClientAppActor pid=3654519)[0m Entrei no validation 1 3
[2024-12-05 18:11:06,346][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-12-05 18:11:06,347][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 1 failures
[2024-12-05 18:11:06,349][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[92mINFO [0m:      
[2024-12-05 18:11:06,349][flwr][INFO] - 
[92mINFO [0m:      [ROUND 27]
[2024-12-05 18:11:06,349][flwr][INFO] - [ROUND 27]
[92mINFO [0m:      configure_fit: strategy sampled 1 clients (out of 1)
[2024-12-05 18:11:06,350][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[92mINFO [0m:      aggregate_fit: received 1 results and 0 failures
[36m(ClientAppActor pid=3654519)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3654519)[0m epoch:  0
[36m(ClientAppActor pid=3654519)[0m train ious:  0.9919774117128246
[36m(ClientAppActor pid=3654519)[0m train dice liver:  tensor(0.9950, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m train dice tumour:  tensor(0.7871, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation ious:  0.9802200227711045
[36m(ClientAppActor pid=3654519)[0m validation dice liver:  tensor(0.9904, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation dice tumour:  tensor(0.7432, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m => new best model:  0
[36m(ClientAppActor pid=3654519)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3654519)[0m epoch:  1
[36m(ClientAppActor pid=3654519)[0m train ious:  0.9919480020445547
[36m(ClientAppActor pid=3654519)[0m train dice liver:  tensor(0.9950, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m train dice tumour:  tensor(0.7948, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation ious:  0.9802560996817276
[36m(ClientAppActor pid=3654519)[0m validation dice liver:  tensor(0.9904, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation dice tumour:  tensor(0.7430, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m => new best model:  1
[36m(ClientAppActor pid=3654519)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3654519)[0m epoch:  2
[36m(ClientAppActor pid=3654519)[0m train ious:  0.9922432428024764
[36m(ClientAppActor pid=3654519)[0m train dice liver:  tensor(0.9951, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m train dice tumour:  tensor(0.7879, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation ious:  0.9803530712041496
[36m(ClientAppActor pid=3654519)[0m validation dice liver:  tensor(0.9905, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation dice tumour:  tensor(0.7440, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m => new best model:  2
[36m(ClientAppActor pid=3654519)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3654519)[0m epoch:  3
[36m(ClientAppActor pid=3654519)[0m train ious:  0.9921515612056299
[36m(ClientAppActor pid=3654519)[0m train dice liver:  tensor(0.9951, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m train dice tumour:  tensor(0.7844, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation ious:  0.9801539728370199
[36m(ClientAppActor pid=3654519)[0m validation dice liver:  tensor(0.9903, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation dice tumour:  tensor(0.7425, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m => new best model:  3
[2024-12-05 19:07:59,891][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[92mINFO [0m:      fit progress: (27, 0.0032611715839898896, OrderedDict([('ind_iou_0', 0.9801539728370199), ('ind_dice_liver_0', tensor(0.9903, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7425, dtype=torch.float64)), ('ind_iou_1', 0.98652969026575), ('ind_dice_liver_1', tensor(0.9927, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6595, dtype=torch.float64)), ('all_iou', 0.9807965655534554), ('all_dice_liver', tensor(0.9906, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7385, dtype=torch.float64))]), 111400.7285606591)
Entrei no test
Meio do test
Fim do test
[2024-12-05 19:12:50,002][flwr][INFO] - fit progress: (27, 0.0032611715839898896, OrderedDict([('ind_iou_0', 0.9801539728370199), ('ind_dice_liver_0', tensor(0.9903, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7425, dtype=torch.float64)), ('ind_iou_1', 0.98652969026575), ('ind_dice_liver_1', tensor(0.9927, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6595, dtype=torch.float64)), ('all_iou', 0.9807965655534554), ('all_dice_liver', tensor(0.9906, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7385, dtype=torch.float64))]), 111400.7285606591)
[92mINFO [0m:      configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-12-05 19:12:50,008][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[36m(ClientAppActor pid=3654519)[0m Entrei no validation 1 3
[2024-12-05 19:14:30,008][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-12-05 19:14:30,009][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 1 failures
[2024-12-05 19:14:30,010][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[92mINFO [0m:      
[2024-12-05 19:14:30,011][flwr][INFO] - 
[92mINFO [0m:      [ROUND 28]
[2024-12-05 19:14:30,011][flwr][INFO] - [ROUND 28]
[92mINFO [0m:      configure_fit: strategy sampled 1 clients (out of 1)
[2024-12-05 19:14:30,011][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[92mINFO [0m:      aggregate_fit: received 1 results and 0 failures
[36m(ClientAppActor pid=3654519)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3654519)[0m epoch:  0
[36m(ClientAppActor pid=3654519)[0m train ious:  0.992103817103784
[36m(ClientAppActor pid=3654519)[0m train dice liver:  tensor(0.9951, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m train dice tumour:  tensor(0.7905, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation ious:  0.9803689563261243
[36m(ClientAppActor pid=3654519)[0m validation dice liver:  tensor(0.9905, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation dice tumour:  tensor(0.7431, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m => new best model:  0
[36m(ClientAppActor pid=3654519)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3654519)[0m epoch:  1
[36m(ClientAppActor pid=3654519)[0m train ious:  0.9923813086430155
[36m(ClientAppActor pid=3654519)[0m train dice liver:  tensor(0.9953, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m train dice tumour:  tensor(0.7943, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation ious:  0.9801010537796417
[36m(ClientAppActor pid=3654519)[0m validation dice liver:  tensor(0.9903, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation dice tumour:  tensor(0.7442, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m => new best model:  1
[36m(ClientAppActor pid=3654519)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3654519)[0m epoch:  2
[36m(ClientAppActor pid=3654519)[0m train ious:  0.992368053196366
[36m(ClientAppActor pid=3654519)[0m train dice liver:  tensor(0.9952, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m train dice tumour:  tensor(0.7924, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation ious:  0.9802470106601306
[36m(ClientAppActor pid=3654519)[0m validation dice liver:  tensor(0.9904, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation dice tumour:  tensor(0.7461, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m => new best model:  2
[36m(ClientAppActor pid=3654519)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3654519)[0m epoch:  3
[36m(ClientAppActor pid=3654519)[0m train ious:  0.9923652033057088
[36m(ClientAppActor pid=3654519)[0m train dice liver:  tensor(0.9952, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m train dice tumour:  tensor(0.7999, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation ious:  0.9803204932551977
[36m(ClientAppActor pid=3654519)[0m validation dice liver:  tensor(0.9905, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation dice tumour:  tensor(0.7448, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m => new best model:  3
[2024-12-05 20:09:51,068][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[92mINFO [0m:      fit progress: (28, 0.0033295927750053023, OrderedDict([('ind_iou_0', 0.9803204932551977), ('ind_dice_liver_0', tensor(0.9905, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7448, dtype=torch.float64)), ('ind_iou_1', 0.9866649780647514), ('ind_dice_liver_1', tensor(0.9929, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6611, dtype=torch.float64)), ('all_iou', 0.98096153193942), ('all_dice_liver', tensor(0.9908, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7408, dtype=torch.float64))]), 115102.95193178486)
Entrei no test
Meio do test
Fim do test
[2024-12-05 20:14:32,225][flwr][INFO] - fit progress: (28, 0.0033295927750053023, OrderedDict([('ind_iou_0', 0.9803204932551977), ('ind_dice_liver_0', tensor(0.9905, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7448, dtype=torch.float64)), ('ind_iou_1', 0.9866649780647514), ('ind_dice_liver_1', tensor(0.9929, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6611, dtype=torch.float64)), ('all_iou', 0.98096153193942), ('all_dice_liver', tensor(0.9908, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7408, dtype=torch.float64))]), 115102.95193178486)
[92mINFO [0m:      configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-12-05 20:14:32,229][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[36m(ClientAppActor pid=3654519)[0m Entrei no validation 1 3
[2024-12-05 20:16:16,517][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-12-05 20:16:16,518][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 1 failures
[2024-12-05 20:16:16,519][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[92mINFO [0m:      
[2024-12-05 20:16:16,520][flwr][INFO] - 
[92mINFO [0m:      [ROUND 29]
[2024-12-05 20:16:16,520][flwr][INFO] - [ROUND 29]
[92mINFO [0m:      configure_fit: strategy sampled 1 clients (out of 1)
[2024-12-05 20:16:16,520][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[92mINFO [0m:      aggregate_fit: received 1 results and 0 failures
[36m(ClientAppActor pid=3654519)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3654519)[0m epoch:  0
[36m(ClientAppActor pid=3654519)[0m train ious:  0.9924244481553293
[36m(ClientAppActor pid=3654519)[0m train dice liver:  tensor(0.9953, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m train dice tumour:  tensor(0.7955, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation ious:  0.9801802361394021
[36m(ClientAppActor pid=3654519)[0m validation dice liver:  tensor(0.9904, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation dice tumour:  tensor(0.7439, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m => new best model:  0
[36m(ClientAppActor pid=3654519)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3654519)[0m epoch:  1
[36m(ClientAppActor pid=3654519)[0m train ious:  0.9925592255578364
[36m(ClientAppActor pid=3654519)[0m train dice liver:  tensor(0.9954, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m train dice tumour:  tensor(0.8012, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation ious:  0.9802788050310111
[36m(ClientAppActor pid=3654519)[0m validation dice liver:  tensor(0.9905, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation dice tumour:  tensor(0.7448, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m => new best model:  1
[36m(ClientAppActor pid=3654519)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3654519)[0m epoch:  2
[36m(ClientAppActor pid=3654519)[0m train ious:  0.9925295829778409
[36m(ClientAppActor pid=3654519)[0m train dice liver:  tensor(0.9953, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m train dice tumour:  
[36m(ClientAppActor pid=3654519)[0m tensor(0.7931, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation ious:  0.9803440550714821
[36m(ClientAppActor pid=3654519)[0m validation dice liver:  tensor(0.9905, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation dice tumour:  tensor(0.7456, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m => new best model:  2
[36m(ClientAppActor pid=3654519)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3654519)[0m epoch:  3
[36m(ClientAppActor pid=3654519)[0m train ious:  0.992547281846542
[36m(ClientAppActor pid=3654519)[0m train dice liver:  tensor(0.9953, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m train dice tumour:  tensor(0.7940, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation ious:  0.9803765020449099
[36m(ClientAppActor pid=3654519)[0m validation dice liver:  tensor(0.9905, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation dice tumour:  tensor(0.7459, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m => new best model:  3
[2024-12-05 21:12:35,797][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[92mINFO [0m:      fit progress: (29, 0.003369556012365183, OrderedDict([('ind_iou_0', 0.9803765020449099), ('ind_dice_liver_0', tensor(0.9905, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7459, dtype=torch.float64)), ('ind_iou_1', 0.9871253303445999), ('ind_dice_liver_1', tensor(0.9931, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6613, dtype=torch.float64)), ('all_iou', 0.9810556426580472), ('all_dice_liver', tensor(0.9908, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7416, dtype=torch.float64))]), 118910.9947921997)
Entrei no test
Meio do test
Fim do test
[2024-12-05 21:18:00,268][flwr][INFO] - fit progress: (29, 0.003369556012365183, OrderedDict([('ind_iou_0', 0.9803765020449099), ('ind_dice_liver_0', tensor(0.9905, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7459, dtype=torch.float64)), ('ind_iou_1', 0.9871253303445999), ('ind_dice_liver_1', tensor(0.9931, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6613, dtype=torch.float64)), ('all_iou', 0.9810556426580472), ('all_dice_liver', tensor(0.9908, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7416, dtype=torch.float64))]), 118910.9947921997)
[92mINFO [0m:      configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-12-05 21:18:00,275][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[36m(ClientAppActor pid=3654519)[0m Entrei no validation 1 3
[2024-12-05 21:20:26,376][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-12-05 21:20:26,377][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 1 failures
[2024-12-05 21:20:26,378][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[92mINFO [0m:      
[2024-12-05 21:20:26,379][flwr][INFO] - 
[92mINFO [0m:      [ROUND 30]
[2024-12-05 21:20:26,379][flwr][INFO] - [ROUND 30]
[92mINFO [0m:      configure_fit: strategy sampled 1 clients (out of 1)
[2024-12-05 21:20:26,379][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[92mINFO [0m:      aggregate_fit: received 1 results and 0 failures
[36m(ClientAppActor pid=3654519)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3654519)[0m epoch:  0
[36m(ClientAppActor pid=3654519)[0m train ious:  0.9926865079991859
[36m(ClientAppActor pid=3654519)[0m train dice liver:  tensor(0.9954, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m train dice tumour:  tensor(0.7920, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation ious:  0.9804659081047606
[36m(ClientAppActor pid=3654519)[0m validation dice liver:  tensor(0.9906, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation dice tumour:  tensor(0.7458, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m => new best model:  0
[36m(ClientAppActor pid=3654519)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3654519)[0m epoch:  1
[36m(ClientAppActor pid=3654519)[0m train ious:  0.9926608651306559
[36m(ClientAppActor pid=3654519)[0m train dice liver:  tensor(0.9954, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m train dice tumour:  tensor(0.7977, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation ious:  0.9804642792991529
[36m(ClientAppActor pid=3654519)[0m validation dice liver:  tensor(0.9906, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation dice tumour:  tensor(0.7456, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m => new best model:  1
[36m(ClientAppActor pid=3654519)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3654519)[0m epoch:  2
[36m(ClientAppActor pid=3654519)[0m train ious:  0.9927883008362162
[36m(ClientAppActor pid=3654519)[0m train dice liver:  tensor(0.9955, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m train dice tumour:  tensor(0.7992, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation ious:  0.9804672485185054
[36m(ClientAppActor pid=3654519)[0m validation dice liver:  tensor(0.9906, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation dice tumour:  tensor(0.7443, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m => new best model:  2
[36m(ClientAppActor pid=3654519)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3654519)[0m epoch:  3
[36m(ClientAppActor pid=3654519)[0m train ious:  0.9928204072144237
[36m(ClientAppActor pid=3654519)[0m train dice liver:  tensor(0.9955, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m train dice tumour:  tensor(0.7980, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation ious:  0.9803805257702991
[36m(ClientAppActor pid=3654519)[0m validation dice liver:  tensor(0.9906, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation dice tumour:  tensor(0.7456, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m => new best model:  3
[2024-12-05 22:21:27,823][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[92mINFO [0m:      fit progress: (30, 0.003443805533228719, OrderedDict([('ind_iou_0', 0.9803805257702991), ('ind_dice_liver_0', tensor(0.9906, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7456, dtype=torch.float64)), ('ind_iou_1', 0.9871052817041691), ('ind_dice_liver_1', tensor(0.9932, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6636, dtype=torch.float64)), ('all_iou', 0.9810619462591109), ('all_dice_liver', tensor(0.9909, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7413, dtype=torch.float64))]), 122999.63548722211)
Entrei no test
Meio do test
Fim do test
[2024-12-05 22:26:08,909][flwr][INFO] - fit progress: (30, 0.003443805533228719, OrderedDict([('ind_iou_0', 0.9803805257702991), ('ind_dice_liver_0', tensor(0.9906, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7456, dtype=torch.float64)), ('ind_iou_1', 0.9871052817041691), ('ind_dice_liver_1', tensor(0.9932, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6636, dtype=torch.float64)), ('all_iou', 0.9810619462591109), ('all_dice_liver', tensor(0.9909, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7413, dtype=torch.float64))]), 122999.63548722211)
[92mINFO [0m:      configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-12-05 22:26:08,916][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[36m(ClientAppActor pid=3654519)[0m Entrei no validation 1 3
[2024-12-05 22:28:18,008][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-12-05 22:28:18,009][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 1 failures
[2024-12-05 22:28:18,013][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[92mINFO [0m:      
[2024-12-05 22:28:18,013][flwr][INFO] - 
[92mINFO [0m:      [ROUND 31]
[2024-12-05 22:28:18,013][flwr][INFO] - [ROUND 31]
[92mINFO [0m:      configure_fit: strategy sampled 1 clients (out of 1)
[2024-12-05 22:28:18,013][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[92mINFO [0m:      aggregate_fit: received 1 results and 0 failures
[36m(ClientAppActor pid=3654519)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3654519)[0m epoch:  0
[36m(ClientAppActor pid=3654519)[0m train ious:  0.9928743956359259
[36m(ClientAppActor pid=3654519)[0m train dice liver:  tensor(0.9956, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m train dice tumour:  tensor(0.7951, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation ious:  0.9804728902975716
[36m(ClientAppActor pid=3654519)[0m validation dice liver:  tensor(0.9906, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation dice tumour:  tensor(0.7456, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m => new best model:  0
[36m(ClientAppActor pid=3654519)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3654519)[0m epoch:  1
[36m(ClientAppActor pid=3654519)[0m train ious:  0.9928933137397489
[36m(ClientAppActor pid=3654519)[0m train dice liver:  tensor(0.9956, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m train dice tumour:  tensor(0.7962, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation ious:  0.9804009677694426
[36m(ClientAppActor pid=3654519)[0m validation dice liver:  tensor(0.9907, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation dice tumour:  tensor(0.7440, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m => new best model:  1
[36m(ClientAppActor pid=3654519)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3654519)[0m epoch:  2
[36m(ClientAppActor pid=3654519)[0m train ious:  0.9929164454933589
[36m(ClientAppActor pid=3654519)[0m train dice liver:  tensor(0.9956, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m train dice tumour:  tensor(0.7970, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation ious:  0.9802788768496189
[36m(ClientAppActor pid=3654519)[0m validation dice liver:  tensor(0.9905, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation dice tumour:  tensor(0.7464, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m => new best model:  2
[36m(ClientAppActor pid=3654519)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3654519)[0m epoch:  3
[36m(ClientAppActor pid=3654519)[0m train ious:  0.9929898716542195
[36m(ClientAppActor pid=3654519)[0m train dice liver:  tensor(0.9956, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m train dice tumour:  tensor(0.7968, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation ious:  0.9804924413128645
[36m(ClientAppActor pid=3654519)[0m validation dice liver:  tensor(0.9906, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation dice tumour:  tensor(0.7482, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m => new best model:  3
[2024-12-05 23:31:48,438][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[92mINFO [0m:      fit progress: (31, 0.003432301622809893, OrderedDict([('ind_iou_0', 0.9804924413128645), ('ind_dice_liver_0', tensor(0.9906, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7482, dtype=torch.float64)), ('ind_iou_1', 0.9875455921584697), ('ind_dice_liver_1', tensor(0.9934, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6644, dtype=torch.float64)), ('all_iou', 0.9811969110940825), ('all_dice_liver', tensor(0.9909, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7442, dtype=torch.float64))]), 127204.94067054521)
Entrei no test
Meio do test
Fim do test
[2024-12-05 23:36:14,214][flwr][INFO] - fit progress: (31, 0.003432301622809893, OrderedDict([('ind_iou_0', 0.9804924413128645), ('ind_dice_liver_0', tensor(0.9906, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7482, dtype=torch.float64)), ('ind_iou_1', 0.9875455921584697), ('ind_dice_liver_1', tensor(0.9934, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6644, dtype=torch.float64)), ('all_iou', 0.9811969110940825), ('all_dice_liver', tensor(0.9909, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7442, dtype=torch.float64))]), 127204.94067054521)
[92mINFO [0m:      configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-12-05 23:36:14,220][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[36m(ClientAppActor pid=3654519)[0m Entrei no validation 1 3
[2024-12-05 23:38:05,020][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-12-05 23:38:05,021][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 1 failures
[2024-12-05 23:38:05,022][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[92mINFO [0m:      
[2024-12-05 23:38:05,022][flwr][INFO] - 
[92mINFO [0m:      [ROUND 32]
[2024-12-05 23:38:05,023][flwr][INFO] - [ROUND 32]
[92mINFO [0m:      configure_fit: strategy sampled 1 clients (out of 1)
[2024-12-05 23:38:05,023][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[92mINFO [0m:      aggregate_fit: received 1 results and 0 failures
[36m(ClientAppActor pid=3654519)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3654519)[0m epoch:  0
[36m(ClientAppActor pid=3654519)[0m train ious:  0.993034139949528
[36m(ClientAppActor pid=3654519)[0m train dice liver:  tensor(0.9957, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m train dice tumour:  tensor(0.7975, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation ious:  0.9803895815726763
[36m(ClientAppActor pid=3654519)[0m validation dice liver:  tensor(0.9906, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation dice tumour:  tensor(0.7473, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m => new best model:  0
[36m(ClientAppActor pid=3654519)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3654519)[0m epoch:  1
[36m(ClientAppActor pid=3654519)[0m train ious:  0.9930716282687924
[36m(ClientAppActor pid=3654519)[0m train dice liver:  tensor(0.9957, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m train dice tumour:  tensor(0.8023, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation ious:  0.9804248079141102
[36m(ClientAppActor pid=3654519)[0m validation dice liver:  tensor(0.9907, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation dice tumour:  tensor(0.7464, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m => new best model:  1
[36m(ClientAppActor pid=3654519)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3654519)[0m epoch:  2
[36m(ClientAppActor pid=3654519)[0m train ious:  0.993104818760626
[36m(ClientAppActor pid=3654519)[0m train dice liver:  tensor(0.9957, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m train dice tumour:  tensor(0.7973, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation ious:  0.9803865150610152
[36m(ClientAppActor pid=3654519)[0m validation dice liver:  tensor(0.9907, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation dice tumour:  tensor(0.7481, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m => new best model:  2
[36m(ClientAppActor pid=3654519)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3654519)[0m epoch:  3
[36m(ClientAppActor pid=3654519)[0m train ious:  0.9931194131473244
[36m(ClientAppActor pid=3654519)[0m train dice liver:  tensor(0.9957, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m train dice tumour:  tensor(0.7996, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation ious:  0.98022160733947
[36m(ClientAppActor pid=3654519)[0m validation dice liver:  tensor(0.9906, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation dice tumour:  tensor(0.7452, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m => new best model:  3
[2024-12-06 00:37:51,149][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[92mINFO [0m:      fit progress: (32, 0.0035083443612994253, OrderedDict([('ind_iou_0', 0.98022160733947), ('ind_dice_liver_0', tensor(0.9906, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7452, dtype=torch.float64)), ('ind_iou_1', 0.9869060371067591), ('ind_dice_liver_1', tensor(0.9932, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6627, dtype=torch.float64)), ('all_iou', 0.980902278562422), ('all_dice_liver', tensor(0.9908, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7410, dtype=torch.float64))]), 131198.60635207966)
Entrei no test
Meio do test
Fim do test
[2024-12-06 00:42:47,880][flwr][INFO] - fit progress: (32, 0.0035083443612994253, OrderedDict([('ind_iou_0', 0.98022160733947), ('ind_dice_liver_0', tensor(0.9906, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7452, dtype=torch.float64)), ('ind_iou_1', 0.9869060371067591), ('ind_dice_liver_1', tensor(0.9932, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6627, dtype=torch.float64)), ('all_iou', 0.980902278562422), ('all_dice_liver', tensor(0.9908, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7410, dtype=torch.float64))]), 131198.60635207966)
[92mINFO [0m:      configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-12-06 00:42:47,885][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[36m(ClientAppActor pid=3654519)[0m Entrei no validation 1 3
[2024-12-06 00:45:02,049][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-12-06 00:45:02,050][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 1 failures
[2024-12-06 00:45:02,051][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[92mINFO [0m:      
[2024-12-06 00:45:02,051][flwr][INFO] - 
[92mINFO [0m:      [ROUND 33]
[2024-12-06 00:45:02,051][flwr][INFO] - [ROUND 33]
[92mINFO [0m:      configure_fit: strategy sampled 1 clients (out of 1)
[2024-12-06 00:45:02,052][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[92mINFO [0m:      aggregate_fit: received 1 results and 0 failures
[36m(ClientAppActor pid=3654519)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3654519)[0m epoch:  0
[36m(ClientAppActor pid=3654519)[0m train ious:  0.9932472122294239
[36m(ClientAppActor pid=3654519)[0m train dice liver:  tensor(0.9958, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m train dice tumour:  tensor(0.8043, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation ious:  0.9804730265784286
[36m(ClientAppActor pid=3654519)[0m validation dice liver:  tensor(0.9907, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation dice tumour:  tensor(0.7464, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m => new best model:  0
[36m(ClientAppActor pid=3654519)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3654519)[0m epoch:  1
[36m(ClientAppActor pid=3654519)[0m train ious:  0.9932619992932666
[36m(ClientAppActor pid=3654519)[0m train dice liver:  tensor(0.9958, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m train dice tumour:  tensor(0.8028, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation ious:  0.9804060297214301
[36m(ClientAppActor pid=3654519)[0m validation dice liver:  tensor(0.9907, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation dice tumour:  tensor(0.7454, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m => new best model:  1
[36m(ClientAppActor pid=3654519)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3654519)[0m epoch:  2
[36m(ClientAppActor pid=3654519)[0m train ious:  0.9933069002095952
[36m(ClientAppActor pid=3654519)[0m train dice liver:  tensor(0.9958, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m train dice tumour:  tensor(0.7955, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation ious:  0.9805307880140216
[36m(ClientAppActor pid=3654519)[0m validation dice liver:  tensor(0.9907, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation dice tumour:  tensor(0.7465, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m => new best model:  2
[36m(ClientAppActor pid=3654519)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3654519)[0m epoch:  3
[36m(ClientAppActor pid=3654519)[0m train ious:  0.9933349679337362
[36m(ClientAppActor pid=3654519)[0m train dice liver:  tensor(0.9959, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m train dice tumour:  tensor(0.8003, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation ious:  0.9804865805125786
[36m(ClientAppActor pid=3654519)[0m validation dice liver:  tensor(0.9908, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation dice tumour:  tensor(0.7458, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m => new best model:  3
[2024-12-06 01:40:25,178][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[92mINFO [0m:      fit progress: (33, 0.003603306511366091, OrderedDict([('ind_iou_0', 0.9804865805125786), ('ind_dice_liver_0', tensor(0.9908, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7458, dtype=torch.float64)), ('ind_iou_1', 0.9874911892158853), ('ind_dice_liver_1', tensor(0.9935, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6642, dtype=torch.float64)), ('all_iou', 0.9811998316656121), ('all_dice_liver', tensor(0.9910, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7415, dtype=torch.float64))]), 134949.79011438228)
Entrei no test
Meio do test
Fim do test
[2024-12-06 01:45:19,064][flwr][INFO] - fit progress: (33, 0.003603306511366091, OrderedDict([('ind_iou_0', 0.9804865805125786), ('ind_dice_liver_0', tensor(0.9908, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7458, dtype=torch.float64)), ('ind_iou_1', 0.9874911892158853), ('ind_dice_liver_1', tensor(0.9935, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6642, dtype=torch.float64)), ('all_iou', 0.9811998316656121), ('all_dice_liver', tensor(0.9910, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7415, dtype=torch.float64))]), 134949.79011438228)
[92mINFO [0m:      configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-12-06 01:45:19,073][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[36m(ClientAppActor pid=3654519)[0m Entrei no validation 1 3
[2024-12-06 01:47:06,411][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-12-06 01:47:06,412][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 1 failures
[2024-12-06 01:47:06,412][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[92mINFO [0m:      
[2024-12-06 01:47:06,413][flwr][INFO] - 
[92mINFO [0m:      [ROUND 34]
[2024-12-06 01:47:06,413][flwr][INFO] - [ROUND 34]
[92mINFO [0m:      configure_fit: strategy sampled 1 clients (out of 1)
[2024-12-06 01:47:06,414][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[92mINFO [0m:      aggregate_fit: received 1 results and 0 failures
[36m(ClientAppActor pid=3654519)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3654519)[0m epoch:  0
[36m(ClientAppActor pid=3654519)[0m train ious:  0.9933833262916217
[36m(ClientAppActor pid=3654519)[0m train dice liver:  tensor(0.9959, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m train dice tumour:  tensor(0.8010, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation ious:  0.9805163515378993
[36m(ClientAppActor pid=3654519)[0m validation dice liver:  tensor(0.9907, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation dice tumour:  tensor(0.7468, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m => new best model:  0
[36m(ClientAppActor pid=3654519)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3654519)[0m epoch:  1
[36m(ClientAppActor pid=3654519)[0m train ious:  0.9934506447697297
[36m(ClientAppActor pid=3654519)[0m train dice liver:  tensor(0.9959, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m train dice tumour:  tensor(0.8023, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation ious:  0.9805757696647457
[36m(ClientAppActor pid=3654519)[0m validation dice liver:  tensor(0.9908, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation dice tumour:  tensor(0.7473, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m => new best model:  1
[36m(ClientAppActor pid=3654519)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3654519)[0m epoch:  2
[36m(ClientAppActor pid=3654519)[0m train ious:  0.993442396454016
[36m(ClientAppActor pid=3654519)[0m train dice liver:  tensor(0.9959, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m train dice tumour:  tensor(0.7985, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation ious:  0.9804235979869574
[36m(ClientAppActor pid=3654519)[0m validation dice liver:  tensor(0.9907, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation dice tumour:  tensor(0.7454, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m => new best model:  2
[36m(ClientAppActor pid=3654519)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3654519)[0m epoch:  3
[36m(ClientAppActor pid=3654519)[0m train ious:  0.9935136045391755
[36m(ClientAppActor pid=3654519)[0m train dice liver:  tensor(0.9960, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m train dice tumour:  tensor(0.8024, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation ious:  0.9805559863736416
[36m(ClientAppActor pid=3654519)[0m validation dice liver:  tensor(0.9908, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation dice tumour:  tensor(0.7478, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m => new best model:  3
[2024-12-06 02:42:55,100][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[92mINFO [0m:      fit progress: (34, 0.0035635193101131533, OrderedDict([('ind_iou_0', 0.9805559863736416), ('ind_dice_liver_0', tensor(0.9908, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7478, dtype=torch.float64)), ('ind_iou_1', 0.9876445598789428), ('ind_dice_liver_1', tensor(0.9935, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6638, dtype=torch.float64)), ('all_iou', 0.9812755557592018), ('all_dice_liver', tensor(0.9910, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7439, dtype=torch.float64))]), 138703.15580374468)
Entrei no test
Meio do test
Fim do test
[2024-12-06 02:47:52,429][flwr][INFO] - fit progress: (34, 0.0035635193101131533, OrderedDict([('ind_iou_0', 0.9805559863736416), ('ind_dice_liver_0', tensor(0.9908, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7478, dtype=torch.float64)), ('ind_iou_1', 0.9876445598789428), ('ind_dice_liver_1', tensor(0.9935, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6638, dtype=torch.float64)), ('all_iou', 0.9812755557592018), ('all_dice_liver', tensor(0.9910, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7439, dtype=torch.float64))]), 138703.15580374468)
[92mINFO [0m:      configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-12-06 02:47:52,434][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[36m(ClientAppActor pid=3654519)[0m Entrei no validation 1 3
[2024-12-06 02:49:28,153][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-12-06 02:49:28,154][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 1 failures
[2024-12-06 02:49:28,155][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[92mINFO [0m:      
[2024-12-06 02:49:28,156][flwr][INFO] - 
[92mINFO [0m:      [ROUND 35]
[2024-12-06 02:49:28,156][flwr][INFO] - [ROUND 35]
[92mINFO [0m:      configure_fit: strategy sampled 1 clients (out of 1)
[2024-12-06 02:49:28,157][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[92mINFO [0m:      aggregate_fit: received 1 results and 0 failures
[36m(ClientAppActor pid=3654519)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3654519)[0m epoch:  0
[36m(ClientAppActor pid=3654519)[0m train ious:  0.9935464250813287
[36m(ClientAppActor pid=3654519)[0m train dice liver:  tensor(0.9960, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m train dice tumour:  tensor(0.8000, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation ious:  0.9803527252019847
[36m(ClientAppActor pid=3654519)[0m validation dice liver:  tensor(0.9907, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation dice tumour:  tensor(0.7470, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m => new best model:  0
[36m(ClientAppActor pid=3654519)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3654519)[0m epoch:  1
[36m(ClientAppActor pid=3654519)[0m train ious:  0.9935503222484872
[36m(ClientAppActor pid=3654519)[0m train dice liver:  tensor(0.9960, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m train dice tumour:  tensor(0.8018, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation ious:  0.980626891149823
[36m(ClientAppActor pid=3654519)[0m validation dice liver:  tensor(0.9908, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation dice tumour:  tensor(0.7472, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m => new best model:  1
[36m(ClientAppActor pid=3654519)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3654519)[0m epoch:  2
[36m(ClientAppActor pid=3654519)[0m train ious:  0.9936163889946448
[36m(ClientAppActor pid=3654519)[0m train dice liver:  tensor(0.9960, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m train dice tumour:  tensor(0.8091, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation ious:  0.98049049250973
[36m(ClientAppActor pid=3654519)[0m validation dice liver:  tensor(0.9908, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation dice tumour:  tensor(0.7473, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m => new best model:  2
[36m(ClientAppActor pid=3654519)[0m Entrei no validation 1 3
[2024-12-06 03:47:15,048][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[92mINFO [0m:      fit progress: (35, 0.003682387338529865, OrderedDict([('ind_iou_0', 0.9805355426726553), ('ind_dice_liver_0', tensor(0.9908, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7470, dtype=torch.float64)), ('ind_iou_1', 0.9877338973058879), ('ind_dice_liver_1', tensor(0.9937, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6640, dtype=torch.float64)), ('all_iou', 0.9812670386956065), ('all_dice_liver', tensor(0.9911, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7434, dtype=torch.float64))]), 142581.2935127318)
[36m(ClientAppActor pid=3654519)[0m epoch:  3
[36m(ClientAppActor pid=3654519)[0m train ious:  0.9936808614528185
[36m(ClientAppActor pid=3654519)[0m train dice liver:  tensor(0.9961, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m train dice tumour:  tensor(0.8020, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation ious:  0.9805355426726553
[36m(ClientAppActor pid=3654519)[0m validation dice liver:  tensor(0.9908, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation dice tumour:  tensor(0.7470, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m => new best model:  3
Entrei no test
Meio do test
Fim do test
[2024-12-06 03:52:30,567][flwr][INFO] - fit progress: (35, 0.003682387338529865, OrderedDict([('ind_iou_0', 0.9805355426726553), ('ind_dice_liver_0', tensor(0.9908, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7470, dtype=torch.float64)), ('ind_iou_1', 0.9877338973058879), ('ind_dice_liver_1', tensor(0.9937, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6640, dtype=torch.float64)), ('all_iou', 0.9812670386956065), ('all_dice_liver', tensor(0.9911, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7434, dtype=torch.float64))]), 142581.2935127318)
[92mINFO [0m:      configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-12-06 03:52:30,573][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[36m(ClientAppActor pid=3654519)[0m Entrei no validation 1 3
[2024-12-06 03:54:27,403][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-12-06 03:54:27,404][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 1 failures
[2024-12-06 03:54:27,405][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[92mINFO [0m:      
[2024-12-06 03:54:27,406][flwr][INFO] - 
[92mINFO [0m:      [ROUND 36]
[2024-12-06 03:54:27,406][flwr][INFO] - [ROUND 36]
[92mINFO [0m:      configure_fit: strategy sampled 1 clients (out of 1)
[2024-12-06 03:54:27,406][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[92mINFO [0m:      aggregate_fit: received 1 results and 0 failures
[36m(ClientAppActor pid=3654519)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3654519)[0m epoch:  0
[36m(ClientAppActor pid=3654519)[0m train ious:  0.9937214994090664
[36m(ClientAppActor pid=3654519)[0m train dice liver:  tensor(0.9961, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m train dice tumour:  tensor(0.8061, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation ious:  0.9805211188933012
[36m(ClientAppActor pid=3654519)[0m validation dice liver:  tensor(0.9908, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation dice tumour:  tensor(0.7481, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m => new best model:  0
[36m(ClientAppActor pid=3654519)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3654519)[0m epoch:  1
[36m(ClientAppActor pid=3654519)[0m train ious:  0.9937229275104027
[36m(ClientAppActor pid=3654519)[0m train dice liver:  tensor(0.9961, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m train dice tumour:  tensor(0.8039, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation ious:  0.980506402912631
[36m(ClientAppActor pid=3654519)[0m validation dice liver:  tensor(0.9908, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation dice tumour:  tensor(0.7495, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m => new best model:  1
[36m(ClientAppActor pid=3654519)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3654519)[0m epoch:  2
[36m(ClientAppActor pid=3654519)[0m train ious:  0.9937421464026717
[36m(ClientAppActor pid=3654519)[0m train dice liver:  tensor(0.9961, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m train dice tumour:  tensor(0.8065, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation ious:  0.9805307646755677
[36m(ClientAppActor pid=3654519)[0m validation dice liver:  tensor(0.9908, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation dice tumour:  tensor(0.7478, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m => new best model:  2
[36m(ClientAppActor pid=3654519)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3654519)[0m epoch:  3
[36m(ClientAppActor pid=3654519)[0m train ious:  0.9937854695666857
[36m(ClientAppActor pid=3654519)[0m train dice liver:  tensor(0.9961, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m train dice tumour:  tensor(0.8120, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation ious:  0.9805378548410408
[36m(ClientAppActor pid=3654519)[0m validation dice liver:  tensor(0.9908, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation dice tumour:  tensor(0.7477, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m => new best model:  3
[2024-12-06 04:52:21,424][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[92mINFO [0m:      fit progress: (36, 0.00372388794476678, OrderedDict([('ind_iou_0', 0.9805378548410408), ('ind_dice_liver_0', tensor(0.9908, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7477, dtype=torch.float64)), ('ind_iou_1', 0.9877982194665248), ('ind_dice_liver_1', tensor(0.9937, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6640, dtype=torch.float64)), ('all_iou', 0.9812755504497777), ('all_dice_liver', tensor(0.9911, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7441, dtype=torch.float64))]), 146460.79117257148)
Entrei no test
Meio do test
Fim do test
[2024-12-06 04:57:10,065][flwr][INFO] - fit progress: (36, 0.00372388794476678, OrderedDict([('ind_iou_0', 0.9805378548410408), ('ind_dice_liver_0', tensor(0.9908, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7477, dtype=torch.float64)), ('ind_iou_1', 0.9877982194665248), ('ind_dice_liver_1', tensor(0.9937, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6640, dtype=torch.float64)), ('all_iou', 0.9812755504497777), ('all_dice_liver', tensor(0.9911, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7441, dtype=torch.float64))]), 146460.79117257148)
[92mINFO [0m:      configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-12-06 04:57:10,070][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[36m(ClientAppActor pid=3654519)[0m Entrei no validation 1 3
[2024-12-06 04:59:19,383][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-12-06 04:59:19,383][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 1 failures
[2024-12-06 04:59:19,383][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[92mINFO [0m:      
[2024-12-06 04:59:19,384][flwr][INFO] - 
[92mINFO [0m:      [ROUND 37]
[2024-12-06 04:59:19,386][flwr][INFO] - [ROUND 37]
[92mINFO [0m:      configure_fit: strategy sampled 1 clients (out of 1)
[2024-12-06 04:59:19,387][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[92mINFO [0m:      aggregate_fit: received 1 results and 0 failures
[36m(ClientAppActor pid=3654519)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3654519)[0m epoch:  0
[36m(ClientAppActor pid=3654519)[0m train ious:  0.9938469871895633
[36m(ClientAppActor pid=3654519)[0m train dice liver:  tensor(0.9962, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m train dice tumour:  tensor(0.8014, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation ious:  0.9806399906741623
[36m(ClientAppActor pid=3654519)[0m validation dice liver:  tensor(0.9909, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation dice tumour:  tensor(0.7486, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m => new best model:  0
[36m(ClientAppActor pid=3654519)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3654519)[0m epoch:  1
[36m(ClientAppActor pid=3654519)[0m train ious:  0.993863009458969
[36m(ClientAppActor pid=3654519)[0m train dice liver:  
[36m(ClientAppActor pid=3654519)[0m tensor(0.9962, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m train dice tumour:  tensor(0.8062, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation ious:  0.9805228998783192
[36m(ClientAppActor pid=3654519)[0m validation dice liver:  tensor(0.9908, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation dice tumour:  tensor(0.7471, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m => new best model:  1
[36m(ClientAppActor pid=3654519)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3654519)[0m epoch:  2
[36m(ClientAppActor pid=3654519)[0m train ious:  0.9938952604488613
[36m(ClientAppActor pid=3654519)[0m train dice liver:  tensor(0.9962, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m train dice tumour:  tensor(0.7945, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation ious:  0.9806161371386043
[36m(ClientAppActor pid=3654519)[0m validation dice liver:  tensor(0.9909, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation dice tumour:  tensor(0.7476, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m => new best model:  2
[36m(ClientAppActor pid=3654519)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3654519)[0m epoch:  3
[36m(ClientAppActor pid=3654519)[0m train ious:  0.9939360459010251
[36m(ClientAppActor pid=3654519)[0m train dice liver:  tensor(0.9962, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m train dice tumour:  tensor(0.8118, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation ious:  0.9805272608774467
[36m(ClientAppActor pid=3654519)[0m validation dice liver:  tensor(0.9909, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation dice tumour:  tensor(0.7485, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m => new best model:  3
[2024-12-06 05:53:42,011][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[92mINFO [0m:      fit progress: (37, 0.0037690799932497223, OrderedDict([('ind_iou_0', 0.9805272608774467), ('ind_dice_liver_0', tensor(0.9909, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7485, dtype=torch.float64)), ('ind_iou_1', 0.9880771920950169), ('ind_dice_liver_1', tensor(0.9939, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6655, dtype=torch.float64)), ('all_iou', 0.9812902741551258), ('all_dice_liver', tensor(0.9912, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7448, dtype=torch.float64))]), 150125.28822886106)
Entrei no test
Meio do test
Fim do test
[2024-12-06 05:58:14,562][flwr][INFO] - fit progress: (37, 0.0037690799932497223, OrderedDict([('ind_iou_0', 0.9805272608774467), ('ind_dice_liver_0', tensor(0.9909, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7485, dtype=torch.float64)), ('ind_iou_1', 0.9880771920950169), ('ind_dice_liver_1', tensor(0.9939, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6655, dtype=torch.float64)), ('all_iou', 0.9812902741551258), ('all_dice_liver', tensor(0.9912, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7448, dtype=torch.float64))]), 150125.28822886106)
[92mINFO [0m:      configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-12-06 05:58:14,569][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[36m(ClientAppActor pid=3654519)[0m Entrei no validation 1 3
[2024-12-06 06:00:20,798][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-12-06 06:00:20,799][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 1 failures
[2024-12-06 06:00:20,800][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[92mINFO [0m:      
[2024-12-06 06:00:20,801][flwr][INFO] - 
[92mINFO [0m:      [ROUND 38]
[2024-12-06 06:00:20,801][flwr][INFO] - [ROUND 38]
[92mINFO [0m:      configure_fit: strategy sampled 1 clients (out of 1)
[2024-12-06 06:00:20,802][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[92mINFO [0m:      aggregate_fit: received 1 results and 0 failures
[36m(ClientAppActor pid=3654519)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3654519)[0m epoch:  0
[36m(ClientAppActor pid=3654519)[0m train ious:  0.9939361322777736
[36m(ClientAppActor pid=3654519)[0m train dice liver:  tensor(0.9962, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m train dice tumour:  tensor(0.8036, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation ious:  0.980577495401376
[36m(ClientAppActor pid=3654519)[0m validation dice liver:  tensor(0.9909, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation dice tumour:  tensor(0.7480, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m => new best model:  0
[36m(ClientAppActor pid=3654519)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3654519)[0m epoch:  1
[36m(ClientAppActor pid=3654519)[0m train ious:  0.9940045751740035
[36m(ClientAppActor pid=3654519)[0m train dice liver:  tensor(0.9963, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m train dice tumour:  tensor(0.8043, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation ious:  0.9806197011303737
[36m(ClientAppActor pid=3654519)[0m validation dice liver:  tensor(0.9909, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation dice tumour:  tensor(0.7468, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m => new best model:  1
[36m(ClientAppActor pid=3654519)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3654519)[0m epoch:  2
[36m(ClientAppActor pid=3654519)[0m train ious:  0.9940291391601488
[36m(ClientAppActor pid=3654519)[0m train dice liver:  tensor(0.9963, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m train dice tumour:  tensor(0.8029, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation ious:  0.9805078469546203
[36m(ClientAppActor pid=3654519)[0m validation dice liver:  tensor(0.9909, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation dice tumour:  tensor(0.7480, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m => new best model:  2
[36m(ClientAppActor pid=3654519)[0m Entrei no validation 1 3
[2024-12-06 06:57:18,732][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[92mINFO [0m:      fit progress: (38, 0.003833987507661838, OrderedDict([('ind_iou_0', 0.980554560325031), ('ind_dice_liver_0', tensor(0.9909, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7477, dtype=torch.float64)), ('ind_iou_1', 0.9882166508655339), ('ind_dice_liver_1', tensor(0.9939, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6665, dtype=torch.float64)), ('all_iou', 0.9813244425761467), ('all_dice_liver', tensor(0.9912, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7444, dtype=torch.float64))]), 153969.0379202636)
[36m(ClientAppActor pid=3654519)[0m epoch:  3
[36m(ClientAppActor pid=3654519)[0m train ious:  0.9940740888138649
[36m(ClientAppActor pid=3654519)[0m train dice liver:  tensor(0.9963, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m train dice tumour:  tensor(0.7988, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation ious:  0.980554560325031
[36m(ClientAppActor pid=3654519)[0m validation dice liver:  tensor(0.9909, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation dice tumour:  tensor(0.7477, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m => new best model:  3
Entrei no test
Meio do test
Fim do test
[2024-12-06 07:02:18,311][flwr][INFO] - fit progress: (38, 0.003833987507661838, OrderedDict([('ind_iou_0', 0.980554560325031), ('ind_dice_liver_0', tensor(0.9909, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7477, dtype=torch.float64)), ('ind_iou_1', 0.9882166508655339), ('ind_dice_liver_1', tensor(0.9939, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6665, dtype=torch.float64)), ('all_iou', 0.9813244425761467), ('all_dice_liver', tensor(0.9912, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7444, dtype=torch.float64))]), 153969.0379202636)
[92mINFO [0m:      configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-12-06 07:02:18,319][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[36m(ClientAppActor pid=3654519)[0m Entrei no validation 1 3
[2024-12-06 07:04:11,638][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-12-06 07:04:11,639][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 1 failures
[2024-12-06 07:04:11,640][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[92mINFO [0m:      
[2024-12-06 07:04:11,641][flwr][INFO] - 
[92mINFO [0m:      [ROUND 39]
[2024-12-06 07:04:11,641][flwr][INFO] - [ROUND 39]
[92mINFO [0m:      configure_fit: strategy sampled 1 clients (out of 1)
[2024-12-06 07:04:11,642][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[92mINFO [0m:      aggregate_fit: received 1 results and 0 failures
[36m(ClientAppActor pid=3654519)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3654519)[0m epoch:  0
[36m(ClientAppActor pid=3654519)[0m train ious:  0.994085116231743
[36m(ClientAppActor pid=3654519)[0m train dice liver:  tensor(0.9963, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m train dice tumour:  tensor(0.8048, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation ious:  0.9806287186449222
[36m(ClientAppActor pid=3654519)[0m validation dice liver:  tensor(0.9909, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation dice tumour:  tensor(0.7483, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m => new best model:  0
[36m(ClientAppActor pid=3654519)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3654519)[0m epoch:  1
[36m(ClientAppActor pid=3654519)[0m train ious:  0.9941407589889342
[36m(ClientAppActor pid=3654519)[0m train dice liver:  tensor(0.9963, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m train dice tumour:  tensor(0.8053, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation ious:  0.9805177313350812
[36m(ClientAppActor pid=3654519)[0m validation dice liver:  tensor(0.9909, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation dice tumour:  tensor(0.7478, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m => new best model:  1
[36m(ClientAppActor pid=3654519)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3654519)[0m epoch:  2
[36m(ClientAppActor pid=3654519)[0m train ious:  0.9941430029689409
[36m(ClientAppActor pid=3654519)[0m train dice liver:  tensor(0.9964, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m train dice tumour:  tensor(0.8036, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation ious:  0.9805085938575182
[36m(ClientAppActor pid=3654519)[0m validation dice liver:  tensor(0.9909, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation dice tumour:  tensor(0.7467, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m => new best model:  2
[36m(ClientAppActor pid=3654519)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3654519)[0m epoch:  3
[36m(ClientAppActor pid=3654519)[0m train ious:  0.9941620273936771
[36m(ClientAppActor pid=3654519)[0m train dice liver:  tensor(0.9964, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m train dice tumour:  tensor(0.8066, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation ious:  0.9805101146633938
[36m(ClientAppActor pid=3654519)[0m validation dice liver:  tensor(0.9909, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation dice tumour:  tensor(0.7490, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m => new best model:  3
[2024-12-06 08:04:07,343][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[92mINFO [0m:      fit progress: (39, 0.003919898209025847, OrderedDict([('ind_iou_0', 0.9805101146633938), ('ind_dice_liver_0', tensor(0.9909, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7490, dtype=torch.float64)), ('ind_iou_1', 0.9881835686430218), ('ind_dice_liver_1', tensor(0.9940, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6652, dtype=torch.float64)), ('all_iou', 0.9812834626796675), ('all_dice_liver', tensor(0.9912, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7456, dtype=torch.float64))]), 157989.13017500285)
Entrei no test
Meio do test
Fim do test
[2024-12-06 08:09:18,404][flwr][INFO] - fit progress: (39, 0.003919898209025847, OrderedDict([('ind_iou_0', 0.9805101146633938), ('ind_dice_liver_0', tensor(0.9909, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7490, dtype=torch.float64)), ('ind_iou_1', 0.9881835686430218), ('ind_dice_liver_1', tensor(0.9940, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6652, dtype=torch.float64)), ('all_iou', 0.9812834626796675), ('all_dice_liver', tensor(0.9912, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7456, dtype=torch.float64))]), 157989.13017500285)
[92mINFO [0m:      configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-12-06 08:09:18,409][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[36m(ClientAppActor pid=3654519)[0m Entrei no validation 1 3
[2024-12-06 08:10:55,699][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-12-06 08:10:55,701][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 1 failures
[2024-12-06 08:10:55,703][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[92mINFO [0m:      
[2024-12-06 08:10:55,703][flwr][INFO] - 
[92mINFO [0m:      [ROUND 40]
[2024-12-06 08:10:55,703][flwr][INFO] - [ROUND 40]
[92mINFO [0m:      configure_fit: strategy sampled 1 clients (out of 1)
[2024-12-06 08:10:55,704][flwr][INFO] - configure_fit: strategy sampled 1 clients (out of 1)
[92mINFO [0m:      aggregate_fit: received 1 results and 0 failures
[36m(ClientAppActor pid=3654519)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3654519)[0m epoch:  0
[36m(ClientAppActor pid=3654519)[0m train ious:  0.9942054534454354
[36m(ClientAppActor pid=3654519)[0m train dice liver:  tensor(0.9964, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m train dice tumour:  tensor(0.8031, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation ious:  0.980354461102611
[36m(ClientAppActor pid=3654519)[0m validation dice liver:  tensor(0.9908, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation dice tumour:  tensor(0.7475, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m => new best model:  0
[36m(ClientAppActor pid=3654519)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3654519)[0m epoch:  1
[36m(ClientAppActor pid=3654519)[0m train ious:  0.9942361259244719
[36m(ClientAppActor pid=3654519)[0m train dice liver:  tensor(0.9964, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m train dice tumour:  tensor(0.8030, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation ious:  0.9805219795461406
[36m(ClientAppActor pid=3654519)[0m validation dice liver:  tensor(0.9909, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation dice tumour:  tensor(0.7488, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m => new best model:  1
[36m(ClientAppActor pid=3654519)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3654519)[0m epoch:  2
[36m(ClientAppActor pid=3654519)[0m train ious:  0.9942657028864285
[36m(ClientAppActor pid=3654519)[0m train dice liver:  tensor(0.9964, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m train dice tumour:  tensor(0.8019, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation ious:  0.9805149297616242
[36m(ClientAppActor pid=3654519)[0m validation dice liver:  tensor(0.9909, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation dice tumour:  tensor(0.7489, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m => new best model:  2
[36m(ClientAppActor pid=3654519)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3654519)[0m epoch:  3
[36m(ClientAppActor pid=3654519)[0m train ious:  0.9942704033628103
[36m(ClientAppActor pid=3654519)[0m train dice liver:  tensor(0.9964, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m train dice tumour:  tensor(0.7969, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation ious:  0.9804012946094569
[36m(ClientAppActor pid=3654519)[0m validation dice liver:  tensor(0.9908, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m validation dice tumour:  tensor(0.7485, dtype=torch.float64)
[36m(ClientAppActor pid=3654519)[0m => new best model:  3
[2024-12-06 09:13:44,925][flwr][INFO] - aggregate_fit: received 1 results and 0 failures
[92mINFO [0m:      fit progress: (40, 0.003916043597085271, OrderedDict([('ind_iou_0', 0.9804012946094569), ('ind_dice_liver_0', tensor(0.9908, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7485, dtype=torch.float64)), ('ind_iou_1', 0.9881644289529422), ('ind_dice_liver_1', tensor(0.9940, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6663, dtype=torch.float64)), ('all_iou', 0.981189859926939), ('all_dice_liver', tensor(0.9912, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7446, dtype=torch.float64))]), 162113.38599647302)
Entrei no test
Meio do test
Fim do test
[2024-12-06 09:18:02,659][flwr][INFO] - fit progress: (40, 0.003916043597085271, OrderedDict([('ind_iou_0', 0.9804012946094569), ('ind_dice_liver_0', tensor(0.9908, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7485, dtype=torch.float64)), ('ind_iou_1', 0.9881644289529422), ('ind_dice_liver_1', tensor(0.9940, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6663, dtype=torch.float64)), ('all_iou', 0.981189859926939), ('all_dice_liver', tensor(0.9912, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7446, dtype=torch.float64))]), 162113.38599647302)
[92mINFO [0m:      configure_evaluate: strategy sampled 1 clients (out of 1)
[2024-12-06 09:18:02,665][flwr][INFO] - configure_evaluate: strategy sampled 1 clients (out of 1)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[36m(ClientAppActor pid=3654519)[0m Entrei no validation 1 3
[2024-12-06 09:19:40,742][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2024-12-06 09:19:40,743][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3654519, ip=172.18.62.1, actor_id=e33b0eab74efde70cff4d25a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14e4c2817460>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 1 failures
[2024-12-06 09:19:40,744][flwr][INFO] - aggregate_evaluate: received 0 results and 1 failures
[92mINFO [0m:      
[2024-12-06 09:19:40,745][flwr][INFO] - 
[92mINFO [0m:      [SUMMARY]
[2024-12-06 09:19:40,746][flwr][INFO] - [SUMMARY]
[92mINFO [0m:      Run finished 40 round(s) in 162211.47s
[2024-12-06 09:19:40,746][flwr][INFO] - Run finished 40 round(s) in 162211.47s
[92mINFO [0m:      	History (loss, centralized):
[2024-12-06 09:19:40,960][flwr][INFO] - 	History (loss, centralized):
[92mINFO [0m:      		round 0: 0.6361709236673453
[2024-12-06 09:19:40,961][flwr][INFO] - 		round 0: 0.6361709236673453
[92mINFO [0m:      		round 1: 0.007309191065810523
[2024-12-06 09:19:40,961][flwr][INFO] - 		round 1: 0.007309191065810523
[92mINFO [0m:      		round 2: 0.005999681662090397
[2024-12-06 09:19:40,962][flwr][INFO] - 		round 2: 0.005999681662090397
[92mINFO [0m:      		round 3: 0.004877382856721721
[2024-12-06 09:19:40,962][flwr][INFO] - 		round 3: 0.004877382856721721
[92mINFO [0m:      		round 4: 0.004114746909442399
[2024-12-06 09:19:40,963][flwr][INFO] - 		round 4: 0.004114746909442399
[92mINFO [0m:      		round 5: 0.003674693956337736
[2024-12-06 09:19:40,963][flwr][INFO] - 		round 5: 0.003674693956337736
[92mINFO [0m:      		round 6: 0.003343490719314616
[2024-12-06 09:19:40,964][flwr][INFO] - 		round 6: 0.003343490719314616
[92mINFO [0m:      		round 7: 0.0030828677261232726
[2024-12-06 09:19:40,964][flwr][INFO] - 		round 7: 0.0030828677261232726
[92mINFO [0m:      		round 8: 0.002961892542494605
[2024-12-06 09:19:40,965][flwr][INFO] - 		round 8: 0.002961892542494605
[92mINFO [0m:      		round 9: 0.0029793664326893516
[2024-12-06 09:19:40,965][flwr][INFO] - 		round 9: 0.0029793664326893516
[92mINFO [0m:      		round 10: 0.002931450000951924
[2024-12-06 09:19:40,965][flwr][INFO] - 		round 10: 0.002931450000951924
[92mINFO [0m:      		round 11: 0.002835746582455747
[2024-12-06 09:19:40,966][flwr][INFO] - 		round 11: 0.002835746582455747
[92mINFO [0m:      		round 12: 0.002819015741277393
[2024-12-06 09:19:40,967][flwr][INFO] - 		round 12: 0.002819015741277393
[92mINFO [0m:      		round 13: 0.0028225321303853735
[2024-12-06 09:19:40,967][flwr][INFO] - 		round 13: 0.0028225321303853735
[92mINFO [0m:      		round 14: 0.002945382673931214
[2024-12-06 09:19:40,968][flwr][INFO] - 		round 14: 0.002945382673931214
[92mINFO [0m:      		round 15: 0.002851507365681435
[2024-12-06 09:19:40,968][flwr][INFO] - 		round 15: 0.002851507365681435
[92mINFO [0m:      		round 16: 0.0028903455226255777
[2024-12-06 09:19:40,969][flwr][INFO] - 		round 16: 0.0028903455226255777
[92mINFO [0m:      		round 17: 0.002981101287563202
[2024-12-06 09:19:40,970][flwr][INFO] - 		round 17: 0.002981101287563202
[92mINFO [0m:      		round 18: 0.0029185861430222814
[2024-12-06 09:19:40,970][flwr][INFO] - 		round 18: 0.0029185861430222814
[92mINFO [0m:      		round 19: 0.0029778361188715122
[2024-12-06 09:19:40,971][flwr][INFO] - 		round 19: 0.0029778361188715122
[92mINFO [0m:      		round 20: 0.003069441032116429
[2024-12-06 09:19:40,971][flwr][INFO] - 		round 20: 0.003069441032116429
[92mINFO [0m:      		round 21: 0.0030454325812229806
[2024-12-06 09:19:40,972][flwr][INFO] - 		round 21: 0.0030454325812229806
[92mINFO [0m:      		round 22: 0.003151106251172243
[2024-12-06 09:19:40,972][flwr][INFO] - 		round 22: 0.003151106251172243
[92mINFO [0m:      		round 23: 0.003194383338180135
[2024-12-06 09:19:40,973][flwr][INFO] - 		round 23: 0.003194383338180135
[92mINFO [0m:      		round 24: 0.003201173000701002
[2024-12-06 09:19:40,973][flwr][INFO] - 		round 24: 0.003201173000701002
[92mINFO [0m:      		round 25: 0.0032329137489647028
[2024-12-06 09:19:40,974][flwr][INFO] - 		round 25: 0.0032329137489647028
[92mINFO [0m:      		round 26: 0.003236916543988956
[2024-12-06 09:19:40,974][flwr][INFO] - 		round 26: 0.003236916543988956
[92mINFO [0m:      		round 27: 0.0032611715839898896
[2024-12-06 09:19:40,975][flwr][INFO] - 		round 27: 0.0032611715839898896
[92mINFO [0m:      		round 28: 0.0033295927750053023
[2024-12-06 09:19:40,975][flwr][INFO] - 		round 28: 0.0033295927750053023
[92mINFO [0m:      		round 29: 0.003369556012365183
[2024-12-06 09:19:40,976][flwr][INFO] - 		round 29: 0.003369556012365183
[92mINFO [0m:      		round 30: 0.003443805533228719
[2024-12-06 09:19:40,977][flwr][INFO] - 		round 30: 0.003443805533228719
[92mINFO [0m:      		round 31: 0.003432301622809893
[2024-12-06 09:19:40,977][flwr][INFO] - 		round 31: 0.003432301622809893
[92mINFO [0m:      		round 32: 0.0035083443612994253
[2024-12-06 09:19:40,980][flwr][INFO] - 		round 32: 0.0035083443612994253
[92mINFO [0m:      		round 33: 0.003603306511366091
[2024-12-06 09:19:40,980][flwr][INFO] - 		round 33: 0.003603306511366091
[92mINFO [0m:      		round 34: 0.0035635193101131533
[2024-12-06 09:19:40,981][flwr][INFO] - 		round 34: 0.0035635193101131533
[92mINFO [0m:      		round 35: 0.003682387338529865
[2024-12-06 09:19:40,982][flwr][INFO] - 		round 35: 0.003682387338529865
[92mINFO [0m:      		round 36: 0.00372388794476678
[2024-12-06 09:19:40,983][flwr][INFO] - 		round 36: 0.00372388794476678
[92mINFO [0m:      		round 37: 0.0037690799932497223
[2024-12-06 09:19:40,983][flwr][INFO] - 		round 37: 0.0037690799932497223
[92mINFO [0m:      		round 38: 0.003833987507661838
[2024-12-06 09:19:40,984][flwr][INFO] - 		round 38: 0.003833987507661838
[92mINFO [0m:      		round 39: 0.003919898209025847
[2024-12-06 09:19:40,984][flwr][INFO] - 		round 39: 0.003919898209025847
[92mINFO [0m:      		round 40: 0.003916043597085271
[2024-12-06 09:19:40,985][flwr][INFO] - 		round 40: 0.003916043597085271
[92mINFO [0m:      	History (metrics, centralized):
[2024-12-06 09:19:40,985][flwr][INFO] - 	History (metrics, centralized):
[92mINFO [0m:      	{'all_dice_liver': [(0, tensor(0.1502, dtype=torch.float64)),
[2024-12-06 09:19:40,986][flwr][INFO] - 	{'all_dice_liver': [(0, tensor(0.1502, dtype=torch.float64)),
[92mINFO [0m:      	                    (1, tensor(0.9612, dtype=torch.float64)),
[2024-12-06 09:19:40,986][flwr][INFO] - 	                    (1, tensor(0.9612, dtype=torch.float64)),
[92mINFO [0m:      	                    (2, tensor(0.9658, dtype=torch.float64)),
[2024-12-06 09:19:40,987][flwr][INFO] - 	                    (2, tensor(0.9658, dtype=torch.float64)),
[92mINFO [0m:      	                    (3, tensor(0.9721, dtype=torch.float64)),
[2024-12-06 09:19:40,987][flwr][INFO] - 	                    (3, tensor(0.9721, dtype=torch.float64)),
[92mINFO [0m:      	                    (4, tensor(0.9768, dtype=torch.float64)),
[2024-12-06 09:19:40,987][flwr][INFO] - 	                    (4, tensor(0.9768, dtype=torch.float64)),
[92mINFO [0m:      	                    (5, tensor(0.9804, dtype=torch.float64)),
[2024-12-06 09:19:40,988][flwr][INFO] - 	                    (5, tensor(0.9804, dtype=torch.float64)),
[92mINFO [0m:      	                    (6, tensor(0.9819, dtype=torch.float64)),
[2024-12-06 09:19:40,988][flwr][INFO] - 	                    (6, tensor(0.9819, dtype=torch.float64)),
[92mINFO [0m:      	                    (7, tensor(0.9841, dtype=torch.float64)),
[2024-12-06 09:19:40,989][flwr][INFO] - 	                    (7, tensor(0.9841, dtype=torch.float64)),
[92mINFO [0m:      	                    (8, tensor(0.9851, dtype=torch.float64)),
[2024-12-06 09:19:40,989][flwr][INFO] - 	                    (8, tensor(0.9851, dtype=torch.float64)),
[92mINFO [0m:      	                    (9, tensor(0.9861, dtype=torch.float64)),
[2024-12-06 09:19:40,990][flwr][INFO] - 	                    (9, tensor(0.9861, dtype=torch.float64)),
[92mINFO [0m:      	                    (10, tensor(0.9866, dtype=torch.float64)),
[2024-12-06 09:19:40,990][flwr][INFO] - 	                    (10, tensor(0.9866, dtype=torch.float64)),
[92mINFO [0m:      	                    (11, tensor(0.9878, dtype=torch.float64)),
[2024-12-06 09:19:40,991][flwr][INFO] - 	                    (11, tensor(0.9878, dtype=torch.float64)),
[92mINFO [0m:      	                    (12, tensor(0.9880, dtype=torch.float64)),
[2024-12-06 09:19:40,991][flwr][INFO] - 	                    (12, tensor(0.9880, dtype=torch.float64)),
[92mINFO [0m:      	                    (13, tensor(0.9884, dtype=torch.float64)),
[2024-12-06 09:19:40,992][flwr][INFO] - 	                    (13, tensor(0.9884, dtype=torch.float64)),
[92mINFO [0m:      	                    (14, tensor(0.9883, dtype=torch.float64)),
[2024-12-06 09:19:40,992][flwr][INFO] - 	                    (14, tensor(0.9883, dtype=torch.float64)),
[92mINFO [0m:      	                    (15, tensor(0.9890, dtype=torch.float64)),
[2024-12-06 09:19:40,993][flwr][INFO] - 	                    (15, tensor(0.9890, dtype=torch.float64)),
[92mINFO [0m:      	                    (16, tensor(0.9893, dtype=torch.float64)),
[2024-12-06 09:19:40,994][flwr][INFO] - 	                    (16, tensor(0.9893, dtype=torch.float64)),
[92mINFO [0m:      	                    (17, tensor(0.9895, dtype=torch.float64)),
[2024-12-06 09:19:40,994][flwr][INFO] - 	                    (17, tensor(0.9895, dtype=torch.float64)),
[92mINFO [0m:      	                    (18, tensor(0.9897, dtype=torch.float64)),
[2024-12-06 09:19:40,997][flwr][INFO] - 	                    (18, tensor(0.9897, dtype=torch.float64)),
[92mINFO [0m:      	                    (19, tensor(0.9898, dtype=torch.float64)),
[2024-12-06 09:19:40,997][flwr][INFO] - 	                    (19, tensor(0.9898, dtype=torch.float64)),
[92mINFO [0m:      	                    (20, tensor(0.9898, dtype=torch.float64)),
[2024-12-06 09:19:40,998][flwr][INFO] - 	                    (20, tensor(0.9898, dtype=torch.float64)),
[92mINFO [0m:      	                    (21, tensor(0.9902, dtype=torch.float64)),
[2024-12-06 09:19:40,998][flwr][INFO] - 	                    (21, tensor(0.9902, dtype=torch.float64)),
[92mINFO [0m:      	                    (22, tensor(0.9903, dtype=torch.float64)),
[2024-12-06 09:19:40,999][flwr][INFO] - 	                    (22, tensor(0.9903, dtype=torch.float64)),
[92mINFO [0m:      	                    (23, tensor(0.9904, dtype=torch.float64)),
[2024-12-06 09:19:41,000][flwr][INFO] - 	                    (23, tensor(0.9904, dtype=torch.float64)),
[92mINFO [0m:      	                    (24, tensor(0.9905, dtype=torch.float64)),
[2024-12-06 09:19:41,000][flwr][INFO] - 	                    (24, tensor(0.9905, dtype=torch.float64)),
[92mINFO [0m:      	                    (25, tensor(0.9905, dtype=torch.float64)),
[2024-12-06 09:19:41,001][flwr][INFO] - 	                    (25, tensor(0.9905, dtype=torch.float64)),
[92mINFO [0m:      	                    (26, tensor(0.9906, dtype=torch.float64)),
[2024-12-06 09:19:41,001][flwr][INFO] - 	                    (26, tensor(0.9906, dtype=torch.float64)),
[92mINFO [0m:      	                    (27, tensor(0.9906, dtype=torch.float64)),
[2024-12-06 09:19:41,002][flwr][INFO] - 	                    (27, tensor(0.9906, dtype=torch.float64)),
[92mINFO [0m:      	                    (28, tensor(0.9908, dtype=torch.float64)),
[2024-12-06 09:19:41,002][flwr][INFO] - 	                    (28, tensor(0.9908, dtype=torch.float64)),
[92mINFO [0m:      	                    (29, tensor(0.9908, dtype=torch.float64)),
[2024-12-06 09:19:41,003][flwr][INFO] - 	                    (29, tensor(0.9908, dtype=torch.float64)),
[92mINFO [0m:      	                    (30, tensor(0.9909, dtype=torch.float64)),
[2024-12-06 09:19:41,003][flwr][INFO] - 	                    (30, tensor(0.9909, dtype=torch.float64)),
[92mINFO [0m:      	                    (31, tensor(0.9909, dtype=torch.float64)),
[2024-12-06 09:19:41,004][flwr][INFO] - 	                    (31, tensor(0.9909, dtype=torch.float64)),
[92mINFO [0m:      	                    (32, tensor(0.9908, dtype=torch.float64)),
[2024-12-06 09:19:41,004][flwr][INFO] - 	                    (32, tensor(0.9908, dtype=torch.float64)),
[92mINFO [0m:      	                    (33, tensor(0.9910, dtype=torch.float64)),
[2024-12-06 09:19:41,005][flwr][INFO] - 	                    (33, tensor(0.9910, dtype=torch.float64)),
[92mINFO [0m:      	                    (34, tensor(0.9910, dtype=torch.float64)),
[2024-12-06 09:19:41,005][flwr][INFO] - 	                    (34, tensor(0.9910, dtype=torch.float64)),
[92mINFO [0m:      	                    (35, tensor(0.9911, dtype=torch.float64)),
[2024-12-06 09:19:41,006][flwr][INFO] - 	                    (35, tensor(0.9911, dtype=torch.float64)),
[92mINFO [0m:      	                    (36, tensor(0.9911, dtype=torch.float64)),
[2024-12-06 09:19:41,006][flwr][INFO] - 	                    (36, tensor(0.9911, dtype=torch.float64)),
[92mINFO [0m:      	                    (37, tensor(0.9912, dtype=torch.float64)),
[2024-12-06 09:19:41,007][flwr][INFO] - 	                    (37, tensor(0.9912, dtype=torch.float64)),
[92mINFO [0m:      	                    (38, tensor(0.9912, dtype=torch.float64)),
[2024-12-06 09:19:41,008][flwr][INFO] - 	                    (38, tensor(0.9912, dtype=torch.float64)),
[92mINFO [0m:      	                    (39, tensor(0.9912, dtype=torch.float64)),
[2024-12-06 09:19:41,009][flwr][INFO] - 	                    (39, tensor(0.9912, dtype=torch.float64)),
[92mINFO [0m:      	                    (40, tensor(0.9912, dtype=torch.float64))],
[2024-12-06 09:19:41,010][flwr][INFO] - 	                    (40, tensor(0.9912, dtype=torch.float64))],
[92mINFO [0m:      	 'all_dice_tumour': [(0, tensor(0.0084, dtype=torch.float64)),
[2024-12-06 09:19:41,010][flwr][INFO] - 	 'all_dice_tumour': [(0, tensor(0.0084, dtype=torch.float64)),
[92mINFO [0m:      	                     (1, tensor(0.5046, dtype=torch.float64)),
[2024-12-06 09:19:41,011][flwr][INFO] - 	                     (1, tensor(0.5046, dtype=torch.float64)),
[92mINFO [0m:      	                     (2, tensor(0.5706, dtype=torch.float64)),
[2024-12-06 09:19:41,011][flwr][INFO] - 	                     (2, tensor(0.5706, dtype=torch.float64)),
[92mINFO [0m:      	                     (3, tensor(0.6101, dtype=torch.float64)),
[2024-12-06 09:19:41,012][flwr][INFO] - 	                     (3, tensor(0.6101, dtype=torch.float64)),
[92mINFO [0m:      	                     (4, tensor(0.6456, dtype=torch.float64)),
[2024-12-06 09:19:41,012][flwr][INFO] - 	                     (4, tensor(0.6456, dtype=torch.float64)),
[92mINFO [0m:      	                     (5, tensor(0.6610, dtype=torch.float64)),
[2024-12-06 09:19:41,013][flwr][INFO] - 	                     (5, tensor(0.6610, dtype=torch.float64)),
[92mINFO [0m:      	                     (6, tensor(0.6793, dtype=torch.float64)),
[2024-12-06 09:19:41,013][flwr][INFO] - 	                     (6, tensor(0.6793, dtype=torch.float64)),
[92mINFO [0m:      	                     (7, tensor(0.6929, dtype=torch.float64)),
[2024-12-06 09:19:41,014][flwr][INFO] - 	                     (7, tensor(0.6929, dtype=torch.float64)),
[92mINFO [0m:      	                     (8, tensor(0.7012, dtype=torch.float64)),
[2024-12-06 09:19:41,015][flwr][INFO] - 	                     (8, tensor(0.7012, dtype=torch.float64)),
[92mINFO [0m:      	                     (9, tensor(0.7100, dtype=torch.float64)),
[2024-12-06 09:19:41,015][flwr][INFO] - 	                     (9, tensor(0.7100, dtype=torch.float64)),
[92mINFO [0m:      	                     (10, tensor(0.7108, dtype=torch.float64)),
[2024-12-06 09:19:41,016][flwr][INFO] - 	                     (10, tensor(0.7108, dtype=torch.float64)),
[92mINFO [0m:      	                     (11, tensor(0.7151, dtype=torch.float64)),
[2024-12-06 09:19:41,016][flwr][INFO] - 	                     (11, tensor(0.7151, dtype=torch.float64)),
[92mINFO [0m:      	                     (12, tensor(0.7189, dtype=torch.float64)),
[2024-12-06 09:19:41,017][flwr][INFO] - 	                     (12, tensor(0.7189, dtype=torch.float64)),
[92mINFO [0m:      	                     (13, tensor(0.7240, dtype=torch.float64)),
[2024-12-06 09:19:41,017][flwr][INFO] - 	                     (13, tensor(0.7240, dtype=torch.float64)),
[92mINFO [0m:      	                     (14, tensor(0.7231, dtype=torch.float64)),
[2024-12-06 09:19:41,018][flwr][INFO] - 	                     (14, tensor(0.7231, dtype=torch.float64)),
[92mINFO [0m:      	                     (15, tensor(0.7237, dtype=torch.float64)),
[2024-12-06 09:19:41,018][flwr][INFO] - 	                     (15, tensor(0.7237, dtype=torch.float64)),
[92mINFO [0m:      	                     (16, tensor(0.7272, dtype=torch.float64)),
[2024-12-06 09:19:41,019][flwr][INFO] - 	                     (16, tensor(0.7272, dtype=torch.float64)),
[92mINFO [0m:      	                     (17, tensor(0.7291, dtype=torch.float64)),
[2024-12-06 09:19:41,019][flwr][INFO] - 	                     (17, tensor(0.7291, dtype=torch.float64)),
[92mINFO [0m:      	                     (18, tensor(0.7325, dtype=torch.float64)),
[2024-12-06 09:19:41,020][flwr][INFO] - 	                     (18, tensor(0.7325, dtype=torch.float64)),
[92mINFO [0m:      	                     (19, tensor(0.7327, dtype=torch.float64)),
[2024-12-06 09:19:41,020][flwr][INFO] - 	                     (19, tensor(0.7327, dtype=torch.float64)),
[92mINFO [0m:      	                     (20, tensor(0.7322, dtype=torch.float64)),
[2024-12-06 09:19:41,021][flwr][INFO] - 	                     (20, tensor(0.7322, dtype=torch.float64)),
[92mINFO [0m:      	                     (21, tensor(0.7357, dtype=torch.float64)),
[2024-12-06 09:19:41,022][flwr][INFO] - 	                     (21, tensor(0.7357, dtype=torch.float64)),
[92mINFO [0m:      	                     (22, tensor(0.7372, dtype=torch.float64)),
[2024-12-06 09:19:41,022][flwr][INFO] - 	                     (22, tensor(0.7372, dtype=torch.float64)),
[92mINFO [0m:      	                     (23, tensor(0.7363, dtype=torch.float64)),
[2024-12-06 09:19:41,023][flwr][INFO] - 	                     (23, tensor(0.7363, dtype=torch.float64)),
[92mINFO [0m:      	                     (24, tensor(0.7372, dtype=torch.float64)),
[2024-12-06 09:19:41,024][flwr][INFO] - 	                     (24, tensor(0.7372, dtype=torch.float64)),
[92mINFO [0m:      	                     (25, tensor(0.7383, dtype=torch.float64)),
[2024-12-06 09:19:41,024][flwr][INFO] - 	                     (25, tensor(0.7383, dtype=torch.float64)),
[92mINFO [0m:      	                     (26, tensor(0.7387, dtype=torch.float64)),
[2024-12-06 09:19:41,025][flwr][INFO] - 	                     (26, tensor(0.7387, dtype=torch.float64)),
[92mINFO [0m:      	                     (27, tensor(0.7385, dtype=torch.float64)),
[2024-12-06 09:19:41,025][flwr][INFO] - 	                     (27, tensor(0.7385, dtype=torch.float64)),
[92mINFO [0m:      	                     (28, tensor(0.7408, dtype=torch.float64)),
[2024-12-06 09:19:41,026][flwr][INFO] - 	                     (28, tensor(0.7408, dtype=torch.float64)),
[92mINFO [0m:      	                     (29, tensor(0.7416, dtype=torch.float64)),
[2024-12-06 09:19:41,026][flwr][INFO] - 	                     (29, tensor(0.7416, dtype=torch.float64)),
[92mINFO [0m:      	                     (30, tensor(0.7413, dtype=torch.float64)),
[2024-12-06 09:19:41,027][flwr][INFO] - 	                     (30, tensor(0.7413, dtype=torch.float64)),
[92mINFO [0m:      	                     (31, tensor(0.7442, dtype=torch.float64)),
[2024-12-06 09:19:41,027][flwr][INFO] - 	                     (31, tensor(0.7442, dtype=torch.float64)),
[92mINFO [0m:      	                     (32, tensor(0.7410, dtype=torch.float64)),
[2024-12-06 09:19:41,028][flwr][INFO] - 	                     (32, tensor(0.7410, dtype=torch.float64)),
[92mINFO [0m:      	                     (33, tensor(0.7415, dtype=torch.float64)),
[2024-12-06 09:19:41,028][flwr][INFO] - 	                     (33, tensor(0.7415, dtype=torch.float64)),
[92mINFO [0m:      	                     (34, tensor(0.7439, dtype=torch.float64)),
[2024-12-06 09:19:41,029][flwr][INFO] - 	                     (34, tensor(0.7439, dtype=torch.float64)),
[92mINFO [0m:      	                     (35, tensor(0.7434, dtype=torch.float64)),
[2024-12-06 09:19:41,029][flwr][INFO] - 	                     (35, tensor(0.7434, dtype=torch.float64)),
[92mINFO [0m:      	                     (36, tensor(0.7441, dtype=torch.float64)),
[2024-12-06 09:19:41,030][flwr][INFO] - 	                     (36, tensor(0.7441, dtype=torch.float64)),
[92mINFO [0m:      	                     (37, tensor(0.7448, dtype=torch.float64)),
[2024-12-06 09:19:41,031][flwr][INFO] - 	                     (37, tensor(0.7448, dtype=torch.float64)),
[92mINFO [0m:      	                     (38, tensor(0.7444, dtype=torch.float64)),
[2024-12-06 09:19:41,032][flwr][INFO] - 	                     (38, tensor(0.7444, dtype=torch.float64)),
[92mINFO [0m:      	                     (39, tensor(0.7456, dtype=torch.float64)),
[2024-12-06 09:19:41,032][flwr][INFO] - 	                     (39, tensor(0.7456, dtype=torch.float64)),
[92mINFO [0m:      	                     (40, tensor(0.7446, dtype=torch.float64))],
[2024-12-06 09:19:41,033][flwr][INFO] - 	                     (40, tensor(0.7446, dtype=torch.float64))],
[92mINFO [0m:      	 'all_iou': [(0, 1.57065041257157e-10),
[2024-12-06 09:19:41,034][flwr][INFO] - 	 'all_iou': [(0, 1.57065041257157e-10),
[92mINFO [0m:      	             (1, 0.9386167649692311),
[2024-12-06 09:19:41,034][flwr][INFO] - 	             (1, 0.9386167649692311),
[92mINFO [0m:      	             (2, 0.9480325690091613),
[2024-12-06 09:19:41,035][flwr][INFO] - 	             (2, 0.9480325690091613),
[92mINFO [0m:      	             (3, 0.9565716408907092),
[2024-12-06 09:19:41,035][flwr][INFO] - 	             (3, 0.9565716408907092),
[92mINFO [0m:      	             (4, 0.9630616845607723),
[2024-12-06 09:19:41,036][flwr][INFO] - 	             (4, 0.9630616845607723),
[92mINFO [0m:      	             (5, 0.9673490812760697),
[2024-12-06 09:19:41,036][flwr][INFO] - 	             (5, 0.9673490812760697),
[92mINFO [0m:      	             (6, 0.9702936864649568),
[2024-12-06 09:19:41,037][flwr][INFO] - 	             (6, 0.9702936864649568),
[92mINFO [0m:      	             (7, 0.9731518338974533),
[2024-12-06 09:19:41,037][flwr][INFO] - 	             (7, 0.9731518338974533),
[92mINFO [0m:      	             (8, 0.9744806431261388),
[2024-12-06 09:19:41,039][flwr][INFO] - 	             (8, 0.9744806431261388),
[92mINFO [0m:      	             (9, 0.9752016474715582),
[2024-12-06 09:19:41,041][flwr][INFO] - 	             (9, 0.9752016474715582),
[92mINFO [0m:      	             (10, 0.9758783590974501),
[2024-12-06 09:19:41,041][flwr][INFO] - 	             (10, 0.9758783590974501),
[92mINFO [0m:      	             (11, 0.9774528064246356),
[2024-12-06 09:19:41,042][flwr][INFO] - 	             (11, 0.9774528064246356),
[92mINFO [0m:      	             (12, 0.9779222352364113),
[2024-12-06 09:19:41,042][flwr][INFO] - 	             (12, 0.9779222352364113),
[92mINFO [0m:      	             (13, 0.9784281164065824),
[2024-12-06 09:19:41,043][flwr][INFO] - 	             (13, 0.9784281164065824),
[92mINFO [0m:      	             (14, 0.9779347654689567),
[2024-12-06 09:19:41,044][flwr][INFO] - 	             (14, 0.9779347654689567),
[92mINFO [0m:      	             (15, 0.9791353131550928),
[2024-12-06 09:19:41,045][flwr][INFO] - 	             (15, 0.9791353131550928),
[92mINFO [0m:      	             (16, 0.979506409420907),
[2024-12-06 09:19:41,045][flwr][INFO] - 	             (16, 0.979506409420907),
[92mINFO [0m:      	             (17, 0.9795542152565662),
[2024-12-06 09:19:41,046][flwr][INFO] - 	             (17, 0.9795542152565662),
[92mINFO [0m:      	             (18, 0.9800859255290736),
[2024-12-06 09:19:41,046][flwr][INFO] - 	             (18, 0.9800859255290736),
[92mINFO [0m:      	             (19, 0.9800570414927205),
[2024-12-06 09:19:41,047][flwr][INFO] - 	             (19, 0.9800570414927205),
[92mINFO [0m:      	             (20, 0.9799466230551032),
[2024-12-06 09:19:41,047][flwr][INFO] - 	             (20, 0.9799466230551032),
[92mINFO [0m:      	             (21, 0.9804645655732592),
[2024-12-06 09:19:41,048][flwr][INFO] - 	             (21, 0.9804645655732592),
[92mINFO [0m:      	             (22, 0.9804260694351024),
[2024-12-06 09:19:41,048][flwr][INFO] - 	             (22, 0.9804260694351024),
[92mINFO [0m:      	             (23, 0.980452015392803),
[2024-12-06 09:19:41,049][flwr][INFO] - 	             (23, 0.980452015392803),
[92mINFO [0m:      	             (24, 0.9806770163719891),
[2024-12-06 09:19:41,049][flwr][INFO] - 	             (24, 0.9806770163719891),
[92mINFO [0m:      	             (25, 0.9808191685690155),
[2024-12-06 09:19:41,049][flwr][INFO] - 	             (25, 0.9808191685690155),
[92mINFO [0m:      	             (26, 0.9808140816480584),
[2024-12-06 09:19:41,050][flwr][INFO] - 	             (26, 0.9808140816480584),
[92mINFO [0m:      	             (27, 0.9807965655534554),
[2024-12-06 09:19:41,050][flwr][INFO] - 	             (27, 0.9807965655534554),
[92mINFO [0m:      	             (28, 0.98096153193942),
[2024-12-06 09:19:41,051][flwr][INFO] - 	             (28, 0.98096153193942),
[92mINFO [0m:      	             (29, 0.9810556426580472),
[2024-12-06 09:19:41,051][flwr][INFO] - 	             (29, 0.9810556426580472),
[92mINFO [0m:      	             (30, 0.9810619462591109),
[2024-12-06 09:19:41,052][flwr][INFO] - 	             (30, 0.9810619462591109),
[92mINFO [0m:      	             (31, 0.9811969110940825),
[2024-12-06 09:19:41,052][flwr][INFO] - 	             (31, 0.9811969110940825),
[92mINFO [0m:      	             (32, 0.980902278562422),
[2024-12-06 09:19:41,053][flwr][INFO] - 	             (32, 0.980902278562422),
[92mINFO [0m:      	             (33, 0.9811998316656121),
[2024-12-06 09:19:41,053][flwr][INFO] - 	             (33, 0.9811998316656121),
[92mINFO [0m:      	             (34, 0.9812755557592018),
[2024-12-06 09:19:41,054][flwr][INFO] - 	             (34, 0.9812755557592018),
[92mINFO [0m:      	             (35, 0.9812670386956065),
[2024-12-06 09:19:41,055][flwr][INFO] - 	             (35, 0.9812670386956065),
[92mINFO [0m:      	             (36, 0.9812755504497777),
[2024-12-06 09:19:41,055][flwr][INFO] - 	             (36, 0.9812755504497777),
[92mINFO [0m:      	             (37, 0.9812902741551258),
[2024-12-06 09:19:41,056][flwr][INFO] - 	             (37, 0.9812902741551258),
[92mINFO [0m:      	             (38, 0.9813244425761467),
[2024-12-06 09:19:41,056][flwr][INFO] - 	             (38, 0.9813244425761467),
[92mINFO [0m:      	             (39, 0.9812834626796675),
[2024-12-06 09:19:41,057][flwr][INFO] - 	             (39, 0.9812834626796675),
[92mINFO [0m:      	             (40, 0.981189859926939)],
[2024-12-06 09:19:41,057][flwr][INFO] - 	             (40, 0.981189859926939)],
[92mINFO [0m:      	 'ind_dice_liver_0': [(0, tensor(0.1504, dtype=torch.float64)),
[2024-12-06 09:19:41,057][flwr][INFO] - 	 'ind_dice_liver_0': [(0, tensor(0.1504, dtype=torch.float64)),
[92mINFO [0m:      	                      (1, tensor(0.9619, dtype=torch.float64)),
[2024-12-06 09:19:41,058][flwr][INFO] - 	                      (1, tensor(0.9619, dtype=torch.float64)),
[92mINFO [0m:      	                      (2, tensor(0.9663, dtype=torch.float64)),
[2024-12-06 09:19:41,058][flwr][INFO] - 	                      (2, tensor(0.9663, dtype=torch.float64)),
[92mINFO [0m:      	                      (3, tensor(0.9725, dtype=torch.float64)),
[2024-12-06 09:19:41,059][flwr][INFO] - 	                      (3, tensor(0.9725, dtype=torch.float64)),
[92mINFO [0m:      	                      (4, tensor(0.9771, dtype=torch.float64)),
[2024-12-06 09:19:41,059][flwr][INFO] - 	                      (4, tensor(0.9771, dtype=torch.float64)),
[92mINFO [0m:      	                      (5, tensor(0.9805, dtype=torch.float64)),
[2024-12-06 09:19:41,060][flwr][INFO] - 	                      (5, tensor(0.9805, dtype=torch.float64)),
[92mINFO [0m:      	                      (6, tensor(0.9820, dtype=torch.float64)),
[2024-12-06 09:19:41,060][flwr][INFO] - 	                      (6, tensor(0.9820, dtype=torch.float64)),
[92mINFO [0m:      	                      (7, tensor(0.9841, dtype=torch.float64)),
[2024-12-06 09:19:41,061][flwr][INFO] - 	                      (7, tensor(0.9841, dtype=torch.float64)),
[92mINFO [0m:      	                      (8, tensor(0.9851, dtype=torch.float64)),
[2024-12-06 09:19:41,061][flwr][INFO] - 	                      (8, tensor(0.9851, dtype=torch.float64)),
[92mINFO [0m:      	                      (9, tensor(0.9861, dtype=torch.float64)),
[2024-12-06 09:19:41,062][flwr][INFO] - 	                      (9, tensor(0.9861, dtype=torch.float64)),
[92mINFO [0m:      	                      (10, tensor(0.9865, dtype=torch.float64)),
[2024-12-06 09:19:41,062][flwr][INFO] - 	                      (10, tensor(0.9865, dtype=torch.float64)),
[92mINFO [0m:      	                      (11, tensor(0.9877, dtype=torch.float64)),
[2024-12-06 09:19:41,063][flwr][INFO] - 	                      (11, tensor(0.9877, dtype=torch.float64)),
[92mINFO [0m:      	                      (12, tensor(0.9879, dtype=torch.float64)),
[2024-12-06 09:19:41,063][flwr][INFO] - 	                      (12, tensor(0.9879, dtype=torch.float64)),
[92mINFO [0m:      	                      (13, tensor(0.9883, dtype=torch.float64)),
[2024-12-06 09:19:41,064][flwr][INFO] - 	                      (13, tensor(0.9883, dtype=torch.float64)),
[92mINFO [0m:      	                      (14, tensor(0.9882, dtype=torch.float64)),
[2024-12-06 09:19:41,064][flwr][INFO] - 	                      (14, tensor(0.9882, dtype=torch.float64)),
[92mINFO [0m:      	                      (15, tensor(0.9889, dtype=torch.float64)),
[2024-12-06 09:19:41,065][flwr][INFO] - 	                      (15, tensor(0.9889, dtype=torch.float64)),
[92mINFO [0m:      	                      (16, tensor(0.9891, dtype=torch.float64)),
[2024-12-06 09:19:41,065][flwr][INFO] - 	                      (16, tensor(0.9891, dtype=torch.float64)),
[92mINFO [0m:      	                      (17, tensor(0.9893, dtype=torch.float64)),
[2024-12-06 09:19:41,065][flwr][INFO] - 	                      (17, tensor(0.9893, dtype=torch.float64)),
[92mINFO [0m:      	                      (18, tensor(0.9896, dtype=torch.float64)),
[2024-12-06 09:19:41,066][flwr][INFO] - 	                      (18, tensor(0.9896, dtype=torch.float64)),
[92mINFO [0m:      	                      (19, tensor(0.9896, dtype=torch.float64)),
[2024-12-06 09:19:41,066][flwr][INFO] - 	                      (19, tensor(0.9896, dtype=torch.float64)),
[92mINFO [0m:      	                      (20, tensor(0.9896, dtype=torch.float64)),
[2024-12-06 09:19:41,067][flwr][INFO] - 	                      (20, tensor(0.9896, dtype=torch.float64)),
[92mINFO [0m:      	                      (21, tensor(0.9900, dtype=torch.float64)),
[2024-12-06 09:19:41,067][flwr][INFO] - 	                      (21, tensor(0.9900, dtype=torch.float64)),
[92mINFO [0m:      	                      (22, tensor(0.9901, dtype=torch.float64)),
[2024-12-06 09:19:41,068][flwr][INFO] - 	                      (22, tensor(0.9901, dtype=torch.float64)),
[92mINFO [0m:      	                      (23, tensor(0.9902, dtype=torch.float64)),
[2024-12-06 09:19:41,068][flwr][INFO] - 	                      (23, tensor(0.9902, dtype=torch.float64)),
[92mINFO [0m:      	                      (24, tensor(0.9902, dtype=torch.float64)),
[2024-12-06 09:19:41,069][flwr][INFO] - 	                      (24, tensor(0.9902, dtype=torch.float64)),
[92mINFO [0m:      	                      (25, tensor(0.9903, dtype=torch.float64)),
[2024-12-06 09:19:41,069][flwr][INFO] - 	                      (25, tensor(0.9903, dtype=torch.float64)),
[92mINFO [0m:      	                      (26, tensor(0.9903, dtype=torch.float64)),
[2024-12-06 09:19:41,070][flwr][INFO] - 	                      (26, tensor(0.9903, dtype=torch.float64)),
[92mINFO [0m:      	                      (27, tensor(0.9903, dtype=torch.float64)),
[2024-12-06 09:19:41,070][flwr][INFO] - 	                      (27, tensor(0.9903, dtype=torch.float64)),
[92mINFO [0m:      	                      (28, tensor(0.9905, dtype=torch.float64)),
[2024-12-06 09:19:41,071][flwr][INFO] - 	                      (28, tensor(0.9905, dtype=torch.float64)),
[92mINFO [0m:      	                      (29, tensor(0.9905, dtype=torch.float64)),
[2024-12-06 09:19:41,071][flwr][INFO] - 	                      (29, tensor(0.9905, dtype=torch.float64)),
[92mINFO [0m:      	                      (30, tensor(0.9906, dtype=torch.float64)),
[2024-12-06 09:19:41,072][flwr][INFO] - 	                      (30, tensor(0.9906, dtype=torch.float64)),
[92mINFO [0m:      	                      (31, tensor(0.9906, dtype=torch.float64)),
[2024-12-06 09:19:41,073][flwr][INFO] - 	                      (31, tensor(0.9906, dtype=torch.float64)),
[92mINFO [0m:      	                      (32, tensor(0.9906, dtype=torch.float64)),
[2024-12-06 09:19:41,074][flwr][INFO] - 	                      (32, tensor(0.9906, dtype=torch.float64)),
[92mINFO [0m:      	                      (33, tensor(0.9908, dtype=torch.float64)),
[2024-12-06 09:19:41,074][flwr][INFO] - 	                      (33, tensor(0.9908, dtype=torch.float64)),
[92mINFO [0m:      	                      (34, tensor(0.9908, dtype=torch.float64)),
[2024-12-06 09:19:41,075][flwr][INFO] - 	                      (34, tensor(0.9908, dtype=torch.float64)),
[92mINFO [0m:      	                      (35, tensor(0.9908, dtype=torch.float64)),
[2024-12-06 09:19:41,075][flwr][INFO] - 	                      (35, tensor(0.9908, dtype=torch.float64)),
[92mINFO [0m:      	                      (36, tensor(0.9908, dtype=torch.float64)),
[2024-12-06 09:19:41,076][flwr][INFO] - 	                      (36, tensor(0.9908, dtype=torch.float64)),
[92mINFO [0m:      	                      (37, tensor(0.9909, dtype=torch.float64)),
[2024-12-06 09:19:41,076][flwr][INFO] - 	                      (37, tensor(0.9909, dtype=torch.float64)),
[92mINFO [0m:      	                      (38, tensor(0.9909, dtype=torch.float64)),
[2024-12-06 09:19:41,077][flwr][INFO] - 	                      (38, tensor(0.9909, dtype=torch.float64)),
[92mINFO [0m:      	                      (39, tensor(0.9909, dtype=torch.float64)),
[2024-12-06 09:19:41,077][flwr][INFO] - 	                      (39, tensor(0.9909, dtype=torch.float64)),
[92mINFO [0m:      	                      (40, tensor(0.9908, dtype=torch.float64))],
[2024-12-06 09:19:41,078][flwr][INFO] - 	                      (40, tensor(0.9908, dtype=torch.float64))],
[92mINFO [0m:      	 'ind_dice_liver_1': [(0, tensor(0.1487, dtype=torch.float64)),
[2024-12-06 09:19:41,078][flwr][INFO] - 	 'ind_dice_liver_1': [(0, tensor(0.1487, dtype=torch.float64)),
[92mINFO [0m:      	                      (1, tensor(0.9548, dtype=torch.float64)),
[2024-12-06 09:19:41,079][flwr][INFO] - 	                      (1, tensor(0.9548, dtype=torch.float64)),
[92mINFO [0m:      	                      (2, tensor(0.9607, dtype=torch.float64)),
[2024-12-06 09:19:41,080][flwr][INFO] - 	                      (2, tensor(0.9607, dtype=torch.float64)),
[92mINFO [0m:      	                      (3, tensor(0.9682, dtype=torch.float64)),
[2024-12-06 09:19:41,080][flwr][INFO] - 	                      (3, tensor(0.9682, dtype=torch.float64)),
[92mINFO [0m:      	                      (4, tensor(0.9744, dtype=torch.float64)),
[2024-12-06 09:19:41,080][flwr][INFO] - 	                      (4, tensor(0.9744, dtype=torch.float64)),
[92mINFO [0m:      	                      (5, tensor(0.9794, dtype=torch.float64)),
[2024-12-06 09:19:41,081][flwr][INFO] - 	                      (5, tensor(0.9794, dtype=torch.float64)),
[92mINFO [0m:      	                      (6, tensor(0.9812, dtype=torch.float64)),
[2024-12-06 09:19:41,082][flwr][INFO] - 	                      (6, tensor(0.9812, dtype=torch.float64)),
[92mINFO [0m:      	                      (7, tensor(0.9839, dtype=torch.float64)),
[2024-12-06 09:19:41,083][flwr][INFO] - 	                      (7, tensor(0.9839, dtype=torch.float64)),
[92mINFO [0m:      	                      (8, tensor(0.9851, dtype=torch.float64)),
[2024-12-06 09:19:41,083][flwr][INFO] - 	                      (8, tensor(0.9851, dtype=torch.float64)),
[92mINFO [0m:      	                      (9, tensor(0.9864, dtype=torch.float64)),
[2024-12-06 09:19:41,084][flwr][INFO] - 	                      (9, tensor(0.9864, dtype=torch.float64)),
[92mINFO [0m:      	                      (10, tensor(0.9870, dtype=torch.float64)),
[2024-12-06 09:19:41,084][flwr][INFO] - 	                      (10, tensor(0.9870, dtype=torch.float64)),
[92mINFO [0m:      	                      (11, tensor(0.9885, dtype=torch.float64)),
[2024-12-06 09:19:41,085][flwr][INFO] - 	                      (11, tensor(0.9885, dtype=torch.float64)),
[92mINFO [0m:      	                      (12, tensor(0.9888, dtype=torch.float64)),
[2024-12-06 09:19:41,085][flwr][INFO] - 	                      (12, tensor(0.9888, dtype=torch.float64)),
[92mINFO [0m:      	                      (13, tensor(0.9893, dtype=torch.float64)),
[2024-12-06 09:19:41,086][flwr][INFO] - 	                      (13, tensor(0.9893, dtype=torch.float64)),
[92mINFO [0m:      	                      (14, tensor(0.9895, dtype=torch.float64)),
[2024-12-06 09:19:41,086][flwr][INFO] - 	                      (14, tensor(0.9895, dtype=torch.float64)),
[92mINFO [0m:      	                      (15, tensor(0.9902, dtype=torch.float64)),
[2024-12-06 09:19:41,087][flwr][INFO] - 	                      (15, tensor(0.9902, dtype=torch.float64)),
[92mINFO [0m:      	                      (16, tensor(0.9907, dtype=torch.float64)),
[2024-12-06 09:19:41,087][flwr][INFO] - 	                      (16, tensor(0.9907, dtype=torch.float64)),
[92mINFO [0m:      	                      (17, tensor(0.9909, dtype=torch.float64)),
[2024-12-06 09:19:41,088][flwr][INFO] - 	                      (17, tensor(0.9909, dtype=torch.float64)),
[92mINFO [0m:      	                      (18, tensor(0.9913, dtype=torch.float64)),
[2024-12-06 09:19:41,088][flwr][INFO] - 	                      (18, tensor(0.9913, dtype=torch.float64)),
[92mINFO [0m:      	                      (19, tensor(0.9913, dtype=torch.float64)),
[2024-12-06 09:19:41,088][flwr][INFO] - 	                      (19, tensor(0.9913, dtype=torch.float64)),
[92mINFO [0m:      	                      (20, tensor(0.9915, dtype=torch.float64)),
[2024-12-06 09:19:41,089][flwr][INFO] - 	                      (20, tensor(0.9915, dtype=torch.float64)),
[92mINFO [0m:      	                      (21, tensor(0.9920, dtype=torch.float64)),
[2024-12-06 09:19:41,089][flwr][INFO] - 	                      (21, tensor(0.9920, dtype=torch.float64)),
[92mINFO [0m:      	                      (22, tensor(0.9921, dtype=torch.float64)),
[2024-12-06 09:19:41,090][flwr][INFO] - 	                      (22, tensor(0.9921, dtype=torch.float64)),
[92mINFO [0m:      	                      (23, tensor(0.9922, dtype=torch.float64)),
[2024-12-06 09:19:41,090][flwr][INFO] - 	                      (23, tensor(0.9922, dtype=torch.float64)),
[92mINFO [0m:      	                      (24, tensor(0.9925, dtype=torch.float64)),
[2024-12-06 09:19:41,091][flwr][INFO] - 	                      (24, tensor(0.9925, dtype=torch.float64)),
[92mINFO [0m:      	                      (25, tensor(0.9926, dtype=torch.float64)),
[2024-12-06 09:19:41,091][flwr][INFO] - 	                      (25, tensor(0.9926, dtype=torch.float64)),
[92mINFO [0m:      	                      (26, tensor(0.9927, dtype=torch.float64)),
[2024-12-06 09:19:41,092][flwr][INFO] - 	                      (26, tensor(0.9927, dtype=torch.float64)),
[92mINFO [0m:      	                      (27, tensor(0.9927, dtype=torch.float64)),
[2024-12-06 09:19:41,092][flwr][INFO] - 	                      (27, tensor(0.9927, dtype=torch.float64)),
[92mINFO [0m:      	                      (28, tensor(0.9929, dtype=torch.float64)),
[2024-12-06 09:19:41,093][flwr][INFO] - 	                      (28, tensor(0.9929, dtype=torch.float64)),
[92mINFO [0m:      	                      (29, tensor(0.9931, dtype=torch.float64)),
[2024-12-06 09:19:41,093][flwr][INFO] - 	                      (29, tensor(0.9931, dtype=torch.float64)),
[92mINFO [0m:      	                      (30, tensor(0.9932, dtype=torch.float64)),
[2024-12-06 09:19:41,094][flwr][INFO] - 	                      (30, tensor(0.9932, dtype=torch.float64)),
[92mINFO [0m:      	                      (31, tensor(0.9934, dtype=torch.float64)),
[2024-12-06 09:19:41,094][flwr][INFO] - 	                      (31, tensor(0.9934, dtype=torch.float64)),
[92mINFO [0m:      	                      (32, tensor(0.9932, dtype=torch.float64)),
[2024-12-06 09:19:41,095][flwr][INFO] - 	                      (32, tensor(0.9932, dtype=torch.float64)),
[92mINFO [0m:      	                      (33, tensor(0.9935, dtype=torch.float64)),
[2024-12-06 09:19:41,095][flwr][INFO] - 	                      (33, tensor(0.9935, dtype=torch.float64)),
[92mINFO [0m:      	                      (34, tensor(0.9935, dtype=torch.float64)),
[2024-12-06 09:19:41,096][flwr][INFO] - 	                      (34, tensor(0.9935, dtype=torch.float64)),
[92mINFO [0m:      	                      (35, tensor(0.9937, dtype=torch.float64)),
[2024-12-06 09:19:41,097][flwr][INFO] - 	                      (35, tensor(0.9937, dtype=torch.float64)),
[92mINFO [0m:      	                      (36, tensor(0.9937, dtype=torch.float64)),
[2024-12-06 09:19:41,097][flwr][INFO] - 	                      (36, tensor(0.9937, dtype=torch.float64)),
[92mINFO [0m:      	                      (37, tensor(0.9939, dtype=torch.float64)),
[2024-12-06 09:19:41,098][flwr][INFO] - 	                      (37, tensor(0.9939, dtype=torch.float64)),
[92mINFO [0m:      	                      (38, tensor(0.9939, dtype=torch.float64)),
[2024-12-06 09:19:41,099][flwr][INFO] - 	                      (38, tensor(0.9939, dtype=torch.float64)),
[92mINFO [0m:      	                      (39, tensor(0.9940, dtype=torch.float64)),
[2024-12-06 09:19:41,099][flwr][INFO] - 	                      (39, tensor(0.9940, dtype=torch.float64)),
[92mINFO [0m:      	                      (40, tensor(0.9940, dtype=torch.float64))],
[2024-12-06 09:19:41,100][flwr][INFO] - 	                      (40, tensor(0.9940, dtype=torch.float64))],
[92mINFO [0m:      	 'ind_dice_tumour_0': [(0, tensor(0.0085, dtype=torch.float64)),
[2024-12-06 09:19:41,101][flwr][INFO] - 	 'ind_dice_tumour_0': [(0, tensor(0.0085, dtype=torch.float64)),
[92mINFO [0m:      	                       (1, tensor(0.5143, dtype=torch.float64)),
[2024-12-06 09:19:41,101][flwr][INFO] - 	                       (1, tensor(0.5143, dtype=torch.float64)),
[92mINFO [0m:      	                       (2, tensor(0.5766, dtype=torch.float64)),
[2024-12-06 09:19:41,102][flwr][INFO] - 	                       (2, tensor(0.5766, dtype=torch.float64)),
[92mINFO [0m:      	                       (3, tensor(0.6175, dtype=torch.float64)),
[2024-12-06 09:19:41,103][flwr][INFO] - 	                       (3, tensor(0.6175, dtype=torch.float64)),
[92mINFO [0m:      	                       (4, tensor(0.6529, dtype=torch.float64)),
[2024-12-06 09:19:41,103][flwr][INFO] - 	                       (4, tensor(0.6529, dtype=torch.float64)),
[92mINFO [0m:      	                       (5, tensor(0.6669, dtype=torch.float64)),
[2024-12-06 09:19:41,104][flwr][INFO] - 	                       (5, tensor(0.6669, dtype=torch.float64)),
[92mINFO [0m:      	                       (6, tensor(0.6856, dtype=torch.float64)),
[2024-12-06 09:19:41,105][flwr][INFO] - 	                       (6, tensor(0.6856, dtype=torch.float64)),
[92mINFO [0m:      	                       (7, tensor(0.6990, dtype=torch.float64)),
[2024-12-06 09:19:41,105][flwr][INFO] - 	                       (7, tensor(0.6990, dtype=torch.float64)),
[92mINFO [0m:      	                       (8, tensor(0.7075, dtype=torch.float64)),
[2024-12-06 09:19:41,106][flwr][INFO] - 	                       (8, tensor(0.7075, dtype=torch.float64)),
[92mINFO [0m:      	                       (9, tensor(0.7158, dtype=torch.float64)),
[2024-12-06 09:19:41,106][flwr][INFO] - 	                       (9, tensor(0.7158, dtype=torch.float64)),
[92mINFO [0m:      	                       (10, tensor(0.7158, dtype=torch.float64)),
[2024-12-06 09:19:41,107][flwr][INFO] - 	                       (10, tensor(0.7158, dtype=torch.float64)),
[92mINFO [0m:      	                       (11, tensor(0.7204, dtype=torch.float64)),
[2024-12-06 09:19:41,107][flwr][INFO] - 	                       (11, tensor(0.7204, dtype=torch.float64)),
[92mINFO [0m:      	                       (12, tensor(0.7246, dtype=torch.float64)),
[2024-12-06 09:19:41,108][flwr][INFO] - 	                       (12, tensor(0.7246, dtype=torch.float64)),
[92mINFO [0m:      	                       (13, tensor(0.7294, dtype=torch.float64)),
[2024-12-06 09:19:41,108][flwr][INFO] - 	                       (13, tensor(0.7294, dtype=torch.float64)),
[92mINFO [0m:      	                       (14, tensor(0.7286, dtype=torch.float64)),
[2024-12-06 09:19:41,108][flwr][INFO] - 	                       (14, tensor(0.7286, dtype=torch.float64)),
[92mINFO [0m:      	                       (15, tensor(0.7286, dtype=torch.float64)),
[2024-12-06 09:19:41,109][flwr][INFO] - 	                       (15, tensor(0.7286, dtype=torch.float64)),
[92mINFO [0m:      	                       (16, tensor(0.7316, dtype=torch.float64)),
[2024-12-06 09:19:41,109][flwr][INFO] - 	                       (16, tensor(0.7316, dtype=torch.float64)),
[92mINFO [0m:      	                       (17, tensor(0.7338, dtype=torch.float64)),
[2024-12-06 09:19:41,110][flwr][INFO] - 	                       (17, tensor(0.7338, dtype=torch.float64)),
[92mINFO [0m:      	                       (18, tensor(0.7371, dtype=torch.float64)),
[2024-12-06 09:19:41,110][flwr][INFO] - 	                       (18, tensor(0.7371, dtype=torch.float64)),
[92mINFO [0m:      	                       (19, tensor(0.7372, dtype=torch.float64)),
[2024-12-06 09:19:41,111][flwr][INFO] - 	                       (19, tensor(0.7372, dtype=torch.float64)),
[92mINFO [0m:      	                       (20, tensor(0.7366, dtype=torch.float64)),
[2024-12-06 09:19:41,111][flwr][INFO] - 	                       (20, tensor(0.7366, dtype=torch.float64)),
[92mINFO [0m:      	                       (21, tensor(0.7403, dtype=torch.float64)),
[2024-12-06 09:19:41,112][flwr][INFO] - 	                       (21, tensor(0.7403, dtype=torch.float64)),
[92mINFO [0m:      	                       (22, tensor(0.7417, dtype=torch.float64)),
[2024-12-06 09:19:41,112][flwr][INFO] - 	                       (22, tensor(0.7417, dtype=torch.float64)),
[92mINFO [0m:      	                       (23, tensor(0.7410, dtype=torch.float64)),
[2024-12-06 09:19:41,113][flwr][INFO] - 	                       (23, tensor(0.7410, dtype=torch.float64)),
[92mINFO [0m:      	                       (24, tensor(0.7423, dtype=torch.float64)),
[2024-12-06 09:19:41,113][flwr][INFO] - 	                       (24, tensor(0.7423, dtype=torch.float64)),
[92mINFO [0m:      	                       (25, tensor(0.7430, dtype=torch.float64)),
[2024-12-06 09:19:41,114][flwr][INFO] - 	                       (25, tensor(0.7430, dtype=torch.float64)),
[92mINFO [0m:      	                       (26, tensor(0.7428, dtype=torch.float64)),
[2024-12-06 09:19:41,114][flwr][INFO] - 	                       (26, tensor(0.7428, dtype=torch.float64)),
[92mINFO [0m:      	                       (27, tensor(0.7425, dtype=torch.float64)),
[2024-12-06 09:19:41,115][flwr][INFO] - 	                       (27, tensor(0.7425, dtype=torch.float64)),
[92mINFO [0m:      	                       (28, tensor(0.7448, dtype=torch.float64)),
[2024-12-06 09:19:41,115][flwr][INFO] - 	                       (28, tensor(0.7448, dtype=torch.float64)),
[92mINFO [0m:      	                       (29, tensor(0.7459, dtype=torch.float64)),
[2024-12-06 09:19:41,115][flwr][INFO] - 	                       (29, tensor(0.7459, dtype=torch.float64)),
[92mINFO [0m:      	                       (30, tensor(0.7456, dtype=torch.float64)),
[2024-12-06 09:19:41,116][flwr][INFO] - 	                       (30, tensor(0.7456, dtype=torch.float64)),
[92mINFO [0m:      	                       (31, tensor(0.7482, dtype=torch.float64)),
[2024-12-06 09:19:41,116][flwr][INFO] - 	                       (31, tensor(0.7482, dtype=torch.float64)),
[92mINFO [0m:      	                       (32, tensor(0.7452, dtype=torch.float64)),
[2024-12-06 09:19:41,117][flwr][INFO] - 	                       (32, tensor(0.7452, dtype=torch.float64)),
[92mINFO [0m:      	                       (33, tensor(0.7458, dtype=torch.float64)),
[2024-12-06 09:19:41,118][flwr][INFO] - 	                       (33, tensor(0.7458, dtype=torch.float64)),
[92mINFO [0m:      	                       (34, tensor(0.7478, dtype=torch.float64)),
[2024-12-06 09:19:41,118][flwr][INFO] - 	                       (34, tensor(0.7478, dtype=torch.float64)),
[92mINFO [0m:      	                       (35, tensor(0.7470, dtype=torch.float64)),
[2024-12-06 09:19:41,119][flwr][INFO] - 	                       (35, tensor(0.7470, dtype=torch.float64)),
[92mINFO [0m:      	                       (36, tensor(0.7477, dtype=torch.float64)),
[2024-12-06 09:19:41,119][flwr][INFO] - 	                       (36, tensor(0.7477, dtype=torch.float64)),
[92mINFO [0m:      	                       (37, tensor(0.7485, dtype=torch.float64)),
[2024-12-06 09:19:41,120][flwr][INFO] - 	                       (37, tensor(0.7485, dtype=torch.float64)),
[92mINFO [0m:      	                       (38, tensor(0.7477, dtype=torch.float64)),
[2024-12-06 09:19:41,120][flwr][INFO] - 	                       (38, tensor(0.7477, dtype=torch.float64)),
[92mINFO [0m:      	                       (39, tensor(0.7490, dtype=torch.float64)),
[2024-12-06 09:19:41,121][flwr][INFO] - 	                       (39, tensor(0.7490, dtype=torch.float64)),
[92mINFO [0m:      	                       (40, tensor(0.7485, dtype=torch.float64))],
[2024-12-06 09:19:41,121][flwr][INFO] - 	                       (40, tensor(0.7485, dtype=torch.float64))],
[92mINFO [0m:      	 'ind_dice_tumour_1': [(0, tensor(0.0077, dtype=torch.float64)),
[2024-12-06 09:19:41,122][flwr][INFO] - 	 'ind_dice_tumour_1': [(0, tensor(0.0077, dtype=torch.float64)),
[92mINFO [0m:      	                       (1, tensor(0.3782, dtype=torch.float64)),
[2024-12-06 09:19:41,122][flwr][INFO] - 	                       (1, tensor(0.3782, dtype=torch.float64)),
[92mINFO [0m:      	                       (2, tensor(0.4817, dtype=torch.float64)),
[2024-12-06 09:19:41,123][flwr][INFO] - 	                       (2, tensor(0.4817, dtype=torch.float64)),
[92mINFO [0m:      	                       (3, tensor(0.5189, dtype=torch.float64)),
[2024-12-06 09:19:41,123][flwr][INFO] - 	                       (3, tensor(0.5189, dtype=torch.float64)),
[92mINFO [0m:      	                       (4, tensor(0.5497, dtype=torch.float64)),
[2024-12-06 09:19:41,123][flwr][INFO] - 	                       (4, tensor(0.5497, dtype=torch.float64)),
[92mINFO [0m:      	                       (5, tensor(0.5803, dtype=torch.float64)),
[2024-12-06 09:19:41,124][flwr][INFO] - 	                       (5, tensor(0.5803, dtype=torch.float64)),
[92mINFO [0m:      	                       (6, tensor(0.5927, dtype=torch.float64)),
[2024-12-06 09:19:41,124][flwr][INFO] - 	                       (6, tensor(0.5927, dtype=torch.float64)),
[92mINFO [0m:      	                       (7, tensor(0.6094, dtype=torch.float64)),
[2024-12-06 09:19:41,125][flwr][INFO] - 	                       (7, tensor(0.6094, dtype=torch.float64)),
[92mINFO [0m:      	                       (8, tensor(0.6083, dtype=torch.float64)),
[2024-12-06 09:19:41,125][flwr][INFO] - 	                       (8, tensor(0.6083, dtype=torch.float64)),
[92mINFO [0m:      	                       (9, tensor(0.6222, dtype=torch.float64)),
[2024-12-06 09:19:41,126][flwr][INFO] - 	                       (9, tensor(0.6222, dtype=torch.float64)),
[92mINFO [0m:      	                       (10, tensor(0.6279, dtype=torch.float64)),
[2024-12-06 09:19:41,126][flwr][INFO] - 	                       (10, tensor(0.6279, dtype=torch.float64)),
[92mINFO [0m:      	                       (11, tensor(0.6312, dtype=torch.float64)),
[2024-12-06 09:19:41,127][flwr][INFO] - 	                       (11, tensor(0.6312, dtype=torch.float64)),
[92mINFO [0m:      	                       (12, tensor(0.6339, dtype=torch.float64)),
[2024-12-06 09:19:41,127][flwr][INFO] - 	                       (12, tensor(0.6339, dtype=torch.float64)),
[92mINFO [0m:      	                       (13, tensor(0.6353, dtype=torch.float64)),
[2024-12-06 09:19:41,128][flwr][INFO] - 	                       (13, tensor(0.6353, dtype=torch.float64)),
[92mINFO [0m:      	                       (14, tensor(0.6374, dtype=torch.float64)),
[2024-12-06 09:19:41,128][flwr][INFO] - 	                       (14, tensor(0.6374, dtype=torch.float64)),
[92mINFO [0m:      	                       (15, tensor(0.6421, dtype=torch.float64)),
[2024-12-06 09:19:41,129][flwr][INFO] - 	                       (15, tensor(0.6421, dtype=torch.float64)),
[92mINFO [0m:      	                       (16, tensor(0.6465, dtype=torch.float64)),
[2024-12-06 09:19:41,129][flwr][INFO] - 	                       (16, tensor(0.6465, dtype=torch.float64)),
[92mINFO [0m:      	                       (17, tensor(0.6489, dtype=torch.float64)),
[2024-12-06 09:19:41,130][flwr][INFO] - 	                       (17, tensor(0.6489, dtype=torch.float64)),
[92mINFO [0m:      	                       (18, tensor(0.6521, dtype=torch.float64)),
[2024-12-06 09:19:41,130][flwr][INFO] - 	                       (18, tensor(0.6521, dtype=torch.float64)),
[92mINFO [0m:      	                       (19, tensor(0.6530, dtype=torch.float64)),
[2024-12-06 09:19:41,131][flwr][INFO] - 	                       (19, tensor(0.6530, dtype=torch.float64)),
[92mINFO [0m:      	                       (20, tensor(0.6540, dtype=torch.float64)),
[2024-12-06 09:19:41,131][flwr][INFO] - 	                       (20, tensor(0.6540, dtype=torch.float64)),
[92mINFO [0m:      	                       (21, tensor(0.6551, dtype=torch.float64)),
[2024-12-06 09:19:41,132][flwr][INFO] - 	                       (21, tensor(0.6551, dtype=torch.float64)),
[92mINFO [0m:      	                       (22, tensor(0.6549, dtype=torch.float64)),
[2024-12-06 09:19:41,132][flwr][INFO] - 	                       (22, tensor(0.6549, dtype=torch.float64)),
[92mINFO [0m:      	                       (23, tensor(0.6567, dtype=torch.float64)),
[2024-12-06 09:19:41,133][flwr][INFO] - 	                       (23, tensor(0.6567, dtype=torch.float64)),
[92mINFO [0m:      	                       (24, tensor(0.6564, dtype=torch.float64)),
[2024-12-06 09:19:41,133][flwr][INFO] - 	                       (24, tensor(0.6564, dtype=torch.float64)),
[92mINFO [0m:      	                       (25, tensor(0.6579, dtype=torch.float64)),
[2024-12-06 09:19:41,134][flwr][INFO] - 	                       (25, tensor(0.6579, dtype=torch.float64)),
[92mINFO [0m:      	                       (26, tensor(0.6606, dtype=torch.float64)),
[2024-12-06 09:19:41,134][flwr][INFO] - 	                       (26, tensor(0.6606, dtype=torch.float64)),
[92mINFO [0m:      	                       (27, tensor(0.6595, dtype=torch.float64)),
[2024-12-06 09:19:41,134][flwr][INFO] - 	                       (27, tensor(0.6595, dtype=torch.float64)),
[92mINFO [0m:      	                       (28, tensor(0.6611, dtype=torch.float64)),
[2024-12-06 09:19:41,135][flwr][INFO] - 	                       (28, tensor(0.6611, dtype=torch.float64)),
[92mINFO [0m:      	                       (29, tensor(0.6613, dtype=torch.float64)),
[2024-12-06 09:19:41,136][flwr][INFO] - 	                       (29, tensor(0.6613, dtype=torch.float64)),
[92mINFO [0m:      	                       (30, tensor(0.6636, dtype=torch.float64)),
[2024-12-06 09:19:41,136][flwr][INFO] - 	                       (30, tensor(0.6636, dtype=torch.float64)),
[92mINFO [0m:      	                       (31, tensor(0.6644, dtype=torch.float64)),
[2024-12-06 09:19:41,137][flwr][INFO] - 	                       (31, tensor(0.6644, dtype=torch.float64)),
[92mINFO [0m:      	                       (32, tensor(0.6627, dtype=torch.float64)),
[2024-12-06 09:19:41,137][flwr][INFO] - 	                       (32, tensor(0.6627, dtype=torch.float64)),
[92mINFO [0m:      	                       (33, tensor(0.6642, dtype=torch.float64)),
[2024-12-06 09:19:41,138][flwr][INFO] - 	                       (33, tensor(0.6642, dtype=torch.float64)),
[92mINFO [0m:      	                       (34, tensor(0.6638, dtype=torch.float64)),
[2024-12-06 09:19:41,138][flwr][INFO] - 	                       (34, tensor(0.6638, dtype=torch.float64)),
[92mINFO [0m:      	                       (35, tensor(0.6640, dtype=torch.float64)),
[2024-12-06 09:19:41,139][flwr][INFO] - 	                       (35, tensor(0.6640, dtype=torch.float64)),
[92mINFO [0m:      	                       (36, tensor(0.6640, dtype=torch.float64)),
[2024-12-06 09:19:41,139][flwr][INFO] - 	                       (36, tensor(0.6640, dtype=torch.float64)),
[92mINFO [0m:      	                       (37, tensor(0.6655, dtype=torch.float64)),
[2024-12-06 09:19:41,139][flwr][INFO] - 	                       (37, tensor(0.6655, dtype=torch.float64)),
[92mINFO [0m:      	                       (38, tensor(0.6665, dtype=torch.float64)),
[2024-12-06 09:19:41,140][flwr][INFO] - 	                       (38, tensor(0.6665, dtype=torch.float64)),
[92mINFO [0m:      	                       (39, tensor(0.6652, dtype=torch.float64)),
[2024-12-06 09:19:41,140][flwr][INFO] - 	                       (39, tensor(0.6652, dtype=torch.float64)),
[92mINFO [0m:      	                       (40, tensor(0.6663, dtype=torch.float64))],
[2024-12-06 09:19:41,141][flwr][INFO] - 	                       (40, tensor(0.6663, dtype=torch.float64))],
[92mINFO [0m:      	 'ind_iou_0': [(0, 1.568745675242773e-10),
[2024-12-06 09:19:41,141][flwr][INFO] - 	 'ind_iou_0': [(0, 1.568745675242773e-10),
[92mINFO [0m:      	               (1, 0.9396470844317266),
[2024-12-06 09:19:41,142][flwr][INFO] - 	               (1, 0.9396470844317266),
[92mINFO [0m:      	               (2, 0.948530183129443),
[2024-12-06 09:19:41,142][flwr][INFO] - 	               (2, 0.948530183129443),
[92mINFO [0m:      	               (3, 0.9569305898169702),
[2024-12-06 09:19:41,143][flwr][INFO] - 	               (3, 0.9569305898169702),
[92mINFO [0m:      	               (4, 0.9632444633527052),
[2024-12-06 09:19:41,143][flwr][INFO] - 	               (4, 0.9632444633527052),
[92mINFO [0m:      	               (5, 0.9672453536128813),
[2024-12-06 09:19:41,144][flwr][INFO] - 	               (5, 0.9672453536128813),
[92mINFO [0m:      	               (6, 0.9701311595344998),
[2024-12-06 09:19:41,144][flwr][INFO] - 	               (6, 0.9701311595344998),
[92mINFO [0m:      	               (7, 0.9729366720537237),
[2024-12-06 09:19:41,145][flwr][INFO] - 	               (7, 0.9729366720537237),
[92mINFO [0m:      	               (8, 0.9742213045766417),
[2024-12-06 09:19:41,145][flwr][INFO] - 	               (8, 0.9742213045766417),
[92mINFO [0m:      	               (9, 0.9749532875956729),
[2024-12-06 09:19:41,146][flwr][INFO] - 	               (9, 0.9749532875956729),
[92mINFO [0m:      	               (10, 0.9755585946503212),
[2024-12-06 09:19:41,146][flwr][INFO] - 	               (10, 0.9755585946503212),
[92mINFO [0m:      	               (11, 0.9771057827067156),
[2024-12-06 09:19:41,147][flwr][INFO] - 	               (11, 0.9771057827067156),
[92mINFO [0m:      	               (12, 0.9775585144507694),
[2024-12-06 09:19:41,147][flwr][INFO] - 	               (12, 0.9775585144507694),
[92mINFO [0m:      	               (13, 0.9780513997752021),
[2024-12-06 09:19:41,148][flwr][INFO] - 	               (13, 0.9780513997752021),
[92mINFO [0m:      	               (14, 0.9774996637046156),
[2024-12-06 09:19:41,148][flwr][INFO] - 	               (14, 0.9774996637046156),
[92mINFO [0m:      	               (15, 0.9787129697883933),
[2024-12-06 09:19:41,148][flwr][INFO] - 	               (15, 0.9787129697883933),
[92mINFO [0m:      	               (16, 0.9790258688006265),
[2024-12-06 09:19:41,149][flwr][INFO] - 	               (16, 0.9790258688006265),
[92mINFO [0m:      	               (17, 0.9790783668283077),
[2024-12-06 09:19:41,149][flwr][INFO] - 	               (17, 0.9790783668283077),
[92mINFO [0m:      	               (18, 0.9795632566208574),
[2024-12-06 09:19:41,150][flwr][INFO] - 	               (18, 0.9795632566208574),
[92mINFO [0m:      	               (19, 0.9795482438629819),
[2024-12-06 09:19:41,150][flwr][INFO] - 	               (19, 0.9795482438629819),
[92mINFO [0m:      	               (20, 0.9794188233331589),
[2024-12-06 09:19:41,152][flwr][INFO] - 	               (20, 0.9794188233331589),
[92mINFO [0m:      	               (21, 0.9798966802547555),
[2024-12-06 09:19:41,153][flwr][INFO] - 	               (21, 0.9798966802547555),
[92mINFO [0m:      	               (22, 0.9798619112384731),
[2024-12-06 09:19:41,154][flwr][INFO] - 	               (22, 0.9798619112384731),
[92mINFO [0m:      	               (23, 0.9798777448117227),
[2024-12-06 09:19:41,154][flwr][INFO] - 	               (23, 0.9798777448117227),
[92mINFO [0m:      	               (24, 0.9800730770939928),
[2024-12-06 09:19:41,155][flwr][INFO] - 	               (24, 0.9800730770939928),
[92mINFO [0m:      	               (25, 0.9801961712750589),
[2024-12-06 09:19:41,155][flwr][INFO] - 	               (25, 0.9801961712750589),
[92mINFO [0m:      	               (26, 0.9801720946479946),
[2024-12-06 09:19:41,156][flwr][INFO] - 	               (26, 0.9801720946479946),
[92mINFO [0m:      	               (27, 0.9801539728370199),
[2024-12-06 09:19:41,156][flwr][INFO] - 	               (27, 0.9801539728370199),
[92mINFO [0m:      	               (28, 0.9803204932551977),
[2024-12-06 09:19:41,157][flwr][INFO] - 	               (28, 0.9803204932551977),
[92mINFO [0m:      	               (29, 0.9803765020449099),
[2024-12-06 09:19:41,157][flwr][INFO] - 	               (29, 0.9803765020449099),
[92mINFO [0m:      	               (30, 0.9803805257702991),
[2024-12-06 09:19:41,157][flwr][INFO] - 	               (30, 0.9803805257702991),
[92mINFO [0m:      	               (31, 0.9804924413128645),
[2024-12-06 09:19:41,158][flwr][INFO] - 	               (31, 0.9804924413128645),
[92mINFO [0m:      	               (32, 0.98022160733947),
[2024-12-06 09:19:41,158][flwr][INFO] - 	               (32, 0.98022160733947),
[92mINFO [0m:      	               (33, 0.9804865805125786),
[2024-12-06 09:19:41,159][flwr][INFO] - 	               (33, 0.9804865805125786),
[92mINFO [0m:      	               (34, 0.9805559863736416),
[2024-12-06 09:19:41,161][flwr][INFO] - 	               (34, 0.9805559863736416),
[92mINFO [0m:      	               (35, 0.9805355426726553),
[2024-12-06 09:19:41,162][flwr][INFO] - 	               (35, 0.9805355426726553),
[92mINFO [0m:      	               (36, 0.9805378548410408),
[2024-12-06 09:19:41,162][flwr][INFO] - 	               (36, 0.9805378548410408),
[92mINFO [0m:      	               (37, 0.9805272608774467),
[2024-12-06 09:19:41,163][flwr][INFO] - 	               (37, 0.9805272608774467),
[92mINFO [0m:      	               (38, 0.980554560325031),
[2024-12-06 09:19:41,163][flwr][INFO] - 	               (38, 0.980554560325031),
[92mINFO [0m:      	               (39, 0.9805101146633938),
[2024-12-06 09:19:41,164][flwr][INFO] - 	               (39, 0.9805101146633938),
[92mINFO [0m:      	               (40, 0.9804012946094569)],
[2024-12-06 09:19:41,164][flwr][INFO] - 	               (40, 0.9804012946094569)],
[92mINFO [0m:      	 'ind_iou_1': [(0, 1.5929912288390675e-10),
[2024-12-06 09:19:41,165][flwr][INFO] - 	 'ind_iou_1': [(0, 1.5929912288390675e-10),
[92mINFO [0m:      	               (1, 0.9279683534505377),
[2024-12-06 09:19:41,165][flwr][INFO] - 	               (1, 0.9279683534505377),
[92mINFO [0m:      	               (2, 0.9422741827408425),
[2024-12-06 09:19:41,165][flwr][INFO] - 	               (2, 0.9422741827408425),
[92mINFO [0m:      	               (3, 0.9521626762634431),
[2024-12-06 09:19:41,166][flwr][INFO] - 	               (3, 0.9521626762634431),
[92mINFO [0m:      	               (4, 0.9606060884754033),
[2024-12-06 09:19:41,166][flwr][INFO] - 	               (4, 0.9606060884754033),
[92mINFO [0m:      	               (5, 0.9680131477798649),
[2024-12-06 09:19:41,167][flwr][INFO] - 	               (5, 0.9680131477798649),
[92mINFO [0m:      	               (6, 0.9716150863678239),
[2024-12-06 09:19:41,167][flwr][INFO] - 	               (6, 0.9716150863678239),
[92mINFO [0m:      	               (7, 0.9749556336019467),
[2024-12-06 09:19:41,168][flwr][INFO] - 	               (7, 0.9749556336019467),
[92mINFO [0m:      	               (8, 0.9765056482338446),
[2024-12-06 09:19:41,168][flwr][INFO] - 	               (8, 0.9765056482338446),
[92mINFO [0m:      	               (9, 0.9773770339658858),
[2024-12-06 09:19:41,169][flwr][INFO] - 	               (9, 0.9773770339658858),
[92mINFO [0m:      	               (10, 0.9787096725065478),
[2024-12-06 09:19:41,169][flwr][INFO] - 	               (10, 0.9787096725065478),
[92mINFO [0m:      	               (11, 0.9804931154079066),
[2024-12-06 09:19:41,170][flwr][INFO] - 	               (11, 0.9804931154079066),
[92mINFO [0m:      	               (12, 0.9810897637723638),
[2024-12-06 09:19:41,170][flwr][INFO] - 	               (12, 0.9810897637723638),
[92mINFO [0m:      	               (13, 0.9817646682916628),
[2024-12-06 09:19:41,171][flwr][INFO] - 	               (13, 0.9817646682916628),
[92mINFO [0m:      	               (14, 0.9817258819590473),
[2024-12-06 09:19:41,171][flwr][INFO] - 	               (14, 0.9817258819590473),
[92mINFO [0m:      	               (15, 0.9827936456618482),
[2024-12-06 09:19:41,171][flwr][INFO] - 	               (15, 0.9827936456618482),
[92mINFO [0m:      	               (16, 0.983699885432905),
[2024-12-06 09:19:41,172][flwr][INFO] - 	               (16, 0.983699885432905),
[92mINFO [0m:      	               (17, 0.9836633101950607),
[2024-12-06 09:19:41,172][flwr][INFO] - 	               (17, 0.9836633101950607),
[92mINFO [0m:      	               (18, 0.9847325019454835),
[2024-12-06 09:19:41,173][flwr][INFO] - 	               (18, 0.9847325019454835),
[92mINFO [0m:      	               (19, 0.9845212804209821),
[2024-12-06 09:19:41,173][flwr][INFO] - 	               (19, 0.9845212804209821),
[92mINFO [0m:      	               (20, 0.9845431555152111),
[2024-12-06 09:19:41,174][flwr][INFO] - 	               (20, 0.9845431555152111),
[92mINFO [0m:      	               (21, 0.9854512857308466),
[2024-12-06 09:19:41,174][flwr][INFO] - 	               (21, 0.9854512857308466),
[92mINFO [0m:      	               (22, 0.9854489062436487),
[2024-12-06 09:19:41,175][flwr][INFO] - 	               (22, 0.9854489062436487),
[92mINFO [0m:      	               (23, 0.9855275710310719),
[2024-12-06 09:19:41,175][flwr][INFO] - 	               (23, 0.9855275710310719),
[92mINFO [0m:      	               (24, 0.9861303660393511),
[2024-12-06 09:19:41,177][flwr][INFO] - 	               (24, 0.9861303660393511),
[92mINFO [0m:      	               (25, 0.9863405139579186),
[2024-12-06 09:19:41,178][flwr][INFO] - 	               (25, 0.9863405139579186),
[92mINFO [0m:      	               (26, 0.986488093000365),
[2024-12-06 09:19:41,178][flwr][INFO] - 	               (26, 0.986488093000365),
[92mINFO [0m:      	               (27, 0.98652969026575),
[2024-12-06 09:19:41,179][flwr][INFO] - 	               (27, 0.98652969026575),
[92mINFO [0m:      	               (28, 0.9866649780647514),
[2024-12-06 09:19:41,179][flwr][INFO] - 	               (28, 0.9866649780647514),
[92mINFO [0m:      	               (29, 0.9871253303445999),
[2024-12-06 09:19:41,180][flwr][INFO] - 	               (29, 0.9871253303445999),
[92mINFO [0m:      	               (30, 0.9871052817041691),
[2024-12-06 09:19:41,181][flwr][INFO] - 	               (30, 0.9871052817041691),
[92mINFO [0m:      	               (31, 0.9875455921584697),
[2024-12-06 09:19:41,181][flwr][INFO] - 	               (31, 0.9875455921584697),
[92mINFO [0m:      	               (32, 0.9869060371067591),
[2024-12-06 09:19:41,182][flwr][INFO] - 	               (32, 0.9869060371067591),
[92mINFO [0m:      	               (33, 0.9874911892158853),
[2024-12-06 09:19:41,182][flwr][INFO] - 	               (33, 0.9874911892158853),
[92mINFO [0m:      	               (34, 0.9876445598789428),
[2024-12-06 09:19:41,183][flwr][INFO] - 	               (34, 0.9876445598789428),
[92mINFO [0m:      	               (35, 0.9877338973058879),
[2024-12-06 09:19:41,183][flwr][INFO] - 	               (35, 0.9877338973058879),
[92mINFO [0m:      	               (36, 0.9877982194665248),
[2024-12-06 09:19:41,184][flwr][INFO] - 	               (36, 0.9877982194665248),
[92mINFO [0m:      	               (37, 0.9880771920950169),
[2024-12-06 09:19:41,184][flwr][INFO] - 	               (37, 0.9880771920950169),
[92mINFO [0m:      	               (38, 0.9882166508655339),
[2024-12-06 09:19:41,184][flwr][INFO] - 	               (38, 0.9882166508655339),
[92mINFO [0m:      	               (39, 0.9881835686430218),
[2024-12-06 09:19:41,185][flwr][INFO] - 	               (39, 0.9881835686430218),
[92mINFO [0m:      	               (40, 0.9881644289529422)]}
[2024-12-06 09:19:41,185][flwr][INFO] - 	               (40, 0.9881644289529422)]}
[92mINFO [0m:      
[2024-12-06 09:19:41,186][flwr][INFO] - 
[33m(raylet)[0m cat: /sys/module/amdgpu/initstate: No such file or directory[32m [repeated 2x across cluster] (Ray deduplicates logs by default. Set RAY_DEDUP_LOGS=0 to disable log deduplication, or see https://docs.ray.io/en/master/ray-observability/ray-logging.html#log-deduplication for more options.)[0m
[33m(raylet)[0m ERROR:root:Driver not initialized (amdgpu not found in modules)[32m [repeated 2x across cluster][0m
