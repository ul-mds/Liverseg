/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/hydra/_internal/defaults_list.py:251: UserWarning: In 'base': Defaults list is missing `_self_`. See https://hydra.cc/docs/1.2/upgrades/1.0_to_1.1/default_composition_order for more information
  warnings.warn(msg, UserWarning)
[92mINFO [0m:      Starting Flower simulation, config: num_rounds=40, no round_timeout
strategy:
  _target_: flwr.server.strategy.FedAvg
  fraction_fit: 0.0001
  min_fit_clients: ${num_clients_per_round_fit}
  fraction_evaluate: 0.0001
  min_evaluate_clients: ${num_clients_per_round_eval}
  min_available_clients: ${num_clients}
  on_fit_config_fn:
    _target_: server.get_on_fit_config
    config: ${config_fit}
model:
  _target_: model.sepnet.U_net
dataset:
  input-channels: 3
  image-ext: npy
  mask-ext: npy
  num_partitions: 1
  batch_size: ${batch_size}
  transformation: false
  val_ratio: 0.1
  test_ratio: 0.2
  lits_data_path: /home/sc.uni-leipzig.de/mp096jdyo/lits_dataset/npy_files
  ircad_data_path: /home/sc.uni-leipzig.de/mp096jdyo/3dircad/npy_files
  sliver_data_path: /home/sc.uni-leipzig.de/mp096jdyo/sliver07
num_rounds: 40
num_clients: 2
local_epochs: 4
batch_size: 4
num_classes: 2
num_clients_per_round_fit: 2
num_clients_per_round_eval: 2
device: cuda:0
config_fit:
  lr: 0.0003
  momentum: 0.9
  weight_decay: 1.0e-05
  nesterov: false
  optimizer: Adam
  loss: BCEWithLogitsLoss

test set size
414
3791
4205
training set size
1658
15165
trainset clients num:  2
2 15165
3 3791
3 414
3 4205
cuda:0
[2025-01-15 10:19:03,234][flwr][INFO] - Starting Flower simulation, config: num_rounds=40, no round_timeout
2025-01-15 10:19:05,843	INFO worker.py:1752 -- Started a local Ray instance.
[92mINFO [0m:      Flower VCE: Ray initialized with resources: {'CPU': 128.0, 'accelerator_type:A30': 1.0, 'GPU': 3.0, 'memory': 831415327744.0, 'node:172.18.62.3': 1.0, 'node:__internal_head__': 1.0, 'object_store_memory': 200000000000.0}
[2025-01-15 10:19:25,788][flwr][INFO] - Flower VCE: Ray initialized with resources: {'CPU': 128.0, 'accelerator_type:A30': 1.0, 'GPU': 3.0, 'memory': 831415327744.0, 'node:172.18.62.3': 1.0, 'node:__internal_head__': 1.0, 'object_store_memory': 200000000000.0}
[92mINFO [0m:      Optimize your simulation with Flower VCE: https://flower.ai/docs/framework/how-to-run-simulations.html
[2025-01-15 10:19:25,788][flwr][INFO] - Optimize your simulation with Flower VCE: https://flower.ai/docs/framework/how-to-run-simulations.html
[92mINFO [0m:      Flower VCE: Resources for each Virtual Client: {'num_cpus': 3, 'num_gpus': 1.0}
[2025-01-15 10:19:25,789][flwr][INFO] - Flower VCE: Resources for each Virtual Client: {'num_cpus': 3, 'num_gpus': 1.0}
[92mINFO [0m:      Flower VCE: Creating VirtualClientEngineActorPool with 3 actors
[2025-01-15 10:19:25,834][flwr][INFO] - Flower VCE: Creating VirtualClientEngineActorPool with 3 actors
[92mINFO [0m:      [INIT]
[2025-01-15 10:19:25,834][flwr][INFO] - [INIT]
[92mINFO [0m:      Requesting initial parameters from one random client
[2025-01-15 10:19:25,835][flwr][INFO] - Requesting initial parameters from one random client
[92mINFO [0m:      Received initial parameters from one random client
[2025-01-15 10:19:30,460][flwr][INFO] - Received initial parameters from one random client
[92mINFO [0m:      Evaluating initial global parameters
[2025-01-15 10:19:30,462][flwr][INFO] - Evaluating initial global parameters
[92mINFO [0m:      initial parameters (loss, other metrics): 0.6833585619359465, OrderedDict([('ind_iou_0', 0.07417763321791147), ('ind_dice_liver_0', tensor(0.1605, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.0086, dtype=torch.float64)), ('ind_iou_1', 0.07341017585585831), ('ind_dice_liver_1', tensor(0.1591, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.0077, dtype=torch.float64)), ('all_iou', 0.07410924018462306), ('all_dice_liver', tensor(0.1603, dtype=torch.float64)), ('all_dice_tumour', tensor(0.0085, dtype=torch.float64))])
Entrei no test
Meio do test
Fim do test
[2025-01-15 10:29:32,181][flwr][INFO] - initial parameters (loss, other metrics): 0.6833585619359465, OrderedDict([('ind_iou_0', 0.07417763321791147), ('ind_dice_liver_0', tensor(0.1605, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.0086, dtype=torch.float64)), ('ind_iou_1', 0.07341017585585831), ('ind_dice_liver_1', tensor(0.1591, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.0077, dtype=torch.float64)), ('all_iou', 0.07410924018462306), ('all_dice_liver', tensor(0.1603, dtype=torch.float64)), ('all_dice_tumour', tensor(0.0085, dtype=torch.float64))])
[92mINFO [0m:      
[2025-01-15 10:29:32,333][flwr][INFO] - 
[92mINFO [0m:      [ROUND 1]
[2025-01-15 10:29:32,333][flwr][INFO] - [ROUND 1]
[92mINFO [0m:      configure_fit: strategy sampled 2 clients (out of 2)
[2025-01-15 10:29:32,333][flwr][INFO] - configure_fit: strategy sampled 2 clients (out of 2)
[92mINFO [0m:      aggregate_fit: received 2 results and 0 failures
[36m(ClientAppActor pid=3552294)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3552294)[0m epoch:  0
[36m(ClientAppActor pid=3552294)[0m train ious:  0.7663361758593111
[36m(ClientAppActor pid=3552294)[0m train dice liver:  tensor(0.8162, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m train dice tumour:  tensor(0.0177, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m validation ious:  0.8761505349359595
[36m(ClientAppActor pid=3552294)[0m validation dice liver:  tensor(0.9286, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m validation dice tumour:  tensor(0.0178, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m => new best model:  0
[36m(ClientAppActor pid=3552294)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3552294)[0m epoch:  1
[36m(ClientAppActor pid=3552294)[0m train ious:  0.8925768339761689
[36m(ClientAppActor pid=3552294)[0m train dice liver:  tensor(0.9420, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m train dice tumour:  tensor(0.0241, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m validation ious:  0.8980774775316772
[36m(ClientAppActor pid=3552294)[0m validation dice liver:  tensor(0.9506, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m validation dice tumour:  tensor(0.0551, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m => new best model:  1
[36m(ClientAppActor pid=3552294)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3552294)[0m epoch:  2
[36m(ClientAppActor pid=3552294)[0m train ious:  0.9164908207298427
[36m(ClientAppActor pid=3552294)[0m train dice liver:  tensor(0.9565, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m train dice tumour:  tensor(0.1464, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m validation ious:  0.9265791697453466
[36m(ClientAppActor pid=3552294)[0m validation dice liver:  tensor(0.9570, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m validation dice tumour:  tensor(0.2929, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m => new best model:  2
[36m(ClientAppActor pid=3552294)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3552294)[0m epoch:  3
[36m(ClientAppActor pid=3552294)[0m train ious:  0.9413180051292451
[36m(ClientAppActor pid=3552294)[0m train dice liver:  tensor(0.9644, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m train dice tumour:  tensor(0.3696, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m validation ious:  0.945494555378695
[36m(ClientAppActor pid=3552294)[0m validation dice liver:  tensor(0.9669, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m validation dice tumour:  tensor(0.4252, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m => new best model:  3
[36m(ClientAppActor pid=3552295)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3552295)[0m epoch:  0
[36m(ClientAppActor pid=3552295)[0m train ious:  
[36m(ClientAppActor pid=3552295)[0m 0.8629157247864647
[36m(ClientAppActor pid=3552295)[0m train dice liver:  
[36m(ClientAppActor pid=3552295)[0m tensor(0.9092, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m train dice tumour:  tensor(0.2380, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m validation ious:  0.8986436985570959
[36m(ClientAppActor pid=3552295)[0m validation dice liver:  tensor(0.9377, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m validation dice tumour:  tensor(0.3901, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m => new best model:  0
[36m(ClientAppActor pid=3552295)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3552295)[0m epoch:  1
[36m(ClientAppActor pid=3552295)[0m train ious:  0.9230485630897535
[36m(ClientAppActor pid=3552295)[0m train dice liver:  tensor(0.9525, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m train dice tumour:  tensor(0.4389, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m validation ious:  0.9345156243259741
[36m(ClientAppActor pid=3552295)[0m validation dice liver:  tensor(0.9602, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m validation dice tumour:  tensor(0.4852, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m => new best model:  1
[36m(ClientAppActor pid=3552295)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3552295)[0m epoch:  2
[36m(ClientAppActor pid=3552295)[0m train ious:  0.9355617673560346
[36m(ClientAppActor pid=3552295)[0m train dice liver:  tensor(0.9595, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m train dice tumour:  tensor(0.5043, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m validation ious:  0.9421390396050253
[36m(ClientAppActor pid=3552295)[0m validation dice liver:  tensor(0.9634, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m validation dice tumour:  tensor(0.5377, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m => new best model:  2
[36m(ClientAppActor pid=3552295)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3552295)[0m epoch:  3
[36m(ClientAppActor pid=3552295)[0m train ious:  0.9421753875046178
[36m(ClientAppActor pid=3552295)[0m train dice liver:  tensor(0.9638, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m train dice tumour:  tensor(0.5397, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m validation ious:  0.9445178200464678
[36m(ClientAppActor pid=3552295)[0m validation dice liver:  tensor(0.9648, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m validation dice tumour:  tensor(0.5450, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m => new best model:  3
[2025-01-15 13:30:38,365][flwr][INFO] - aggregate_fit: received 2 results and 0 failures
[93mWARNING [0m:   No fit_metrics_aggregation_fn provided
[2025-01-15 13:30:38,497][flwr][WARNING] - No fit_metrics_aggregation_fn provided
[92mINFO [0m:      fit progress: (1, 0.010689646102970867, OrderedDict([('ind_iou_0', 0.9151450515731123), ('ind_dice_liver_0', tensor(0.9442, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.4735, dtype=torch.float64)), ('ind_iou_1', 0.8960396234917282), ('ind_dice_liver_1', tensor(0.9323, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.3525, dtype=torch.float64)), ('all_iou', 0.9135292273245287), ('all_dice_liver', tensor(0.9431, dtype=torch.float64)), ('all_dice_tumour', tensor(0.4641, dtype=torch.float64))]), 11711.618718115613)
Entrei no test
Meio do test
Fim do test
[2025-01-15 13:44:43,952][flwr][INFO] - fit progress: (1, 0.010689646102970867, OrderedDict([('ind_iou_0', 0.9151450515731123), ('ind_dice_liver_0', tensor(0.9442, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.4735, dtype=torch.float64)), ('ind_iou_1', 0.8960396234917282), ('ind_dice_liver_1', tensor(0.9323, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.3525, dtype=torch.float64)), ('all_iou', 0.9135292273245287), ('all_dice_liver', tensor(0.9431, dtype=torch.float64)), ('all_dice_tumour', tensor(0.4641, dtype=torch.float64))]), 11711.618718115613)
[92mINFO [0m:      configure_evaluate: strategy sampled 2 clients (out of 2)
[2025-01-15 13:44:44,122][flwr][INFO] - configure_evaluate: strategy sampled 2 clients (out of 2)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3552294, ip=172.18.62.3, actor_id=7d0a08568fab681ba601f8f201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x154df422d430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3552294, ip=172.18.62.3, actor_id=7d0a08568fab681ba601f8f201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x154df422d430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[36m(ClientAppActor pid=3552294)[0m Entrei no validation 1 3
[2025-01-15 13:45:01,426][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3552294, ip=172.18.62.3, actor_id=7d0a08568fab681ba601f8f201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x154df422d430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3552294, ip=172.18.62.3, actor_id=7d0a08568fab681ba601f8f201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x154df422d430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=3552294, ip=172.18.62.3, actor_id=7d0a08568fab681ba601f8f201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x154df422d430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3552294, ip=172.18.62.3, actor_id=7d0a08568fab681ba601f8f201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x154df422d430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2025-01-15 13:45:01,427][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=3552294, ip=172.18.62.3, actor_id=7d0a08568fab681ba601f8f201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x154df422d430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3552294, ip=172.18.62.3, actor_id=7d0a08568fab681ba601f8f201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x154df422d430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3552295, ip=172.18.62.3, actor_id=3f52105c5cbc21879b66bbbb01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14f736741520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3552295, ip=172.18.62.3, actor_id=3f52105c5cbc21879b66bbbb01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14f736741520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[2025-01-15 13:46:40,549][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3552295, ip=172.18.62.3, actor_id=3f52105c5cbc21879b66bbbb01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14f736741520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3552295, ip=172.18.62.3, actor_id=3f52105c5cbc21879b66bbbb01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14f736741520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=3552295, ip=172.18.62.3, actor_id=3f52105c5cbc21879b66bbbb01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14f736741520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3552295, ip=172.18.62.3, actor_id=3f52105c5cbc21879b66bbbb01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14f736741520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2025-01-15 13:46:40,549][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=3552295, ip=172.18.62.3, actor_id=3f52105c5cbc21879b66bbbb01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14f736741520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3552295, ip=172.18.62.3, actor_id=3f52105c5cbc21879b66bbbb01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14f736741520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2025-01-15 13:46:40,561][flwr][INFO] - aggregate_evaluate: received 0 results and 2 failures
[2025-01-15 13:46:40,561][flwr][INFO] - 
[2025-01-15 13:46:40,561][flwr][INFO] - [ROUND 2]
[2025-01-15 13:46:40,561][flwr][INFO] - configure_fit: strategy sampled 2 clients (out of 2)
[92mINFO [0m:      aggregate_evaluate: received 0 results and 2 failures
[92mINFO [0m:      
[92mINFO [0m:      [ROUND 2]
[92mINFO [0m:      configure_fit: strategy sampled 2 clients (out of 2)
[92mINFO [0m:      aggregate_fit: received 2 results and 0 failures
[36m(ClientAppActor pid=3552294)[0m Entrei no validation 1 3[32m [repeated 2x across cluster] (Ray deduplicates logs by default. Set RAY_DEDUP_LOGS=0 to disable log deduplication, or see https://docs.ray.io/en/master/ray-observability/ray-logging.html#log-deduplication for more options.)[0m
[36m(ClientAppActor pid=3552294)[0m epoch:  0
[36m(ClientAppActor pid=3552294)[0m train ious:  0.94819617040218
[36m(ClientAppActor pid=3552294)[0m train dice liver:  tensor(0.9663, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m train dice tumour:  tensor(0.4797, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m validation ious:  0.9508095003417816
[36m(ClientAppActor pid=3552294)[0m validation dice liver:  tensor(0.9680, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m validation dice tumour:  tensor(0.4829, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m => new best model:  0
[36m(ClientAppActor pid=3552294)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3552294)[0m epoch:  1
[36m(ClientAppActor pid=3552294)[0m train ious:  0.9564902926121098
[36m(ClientAppActor pid=3552294)[0m train dice liver:  tensor(0.9716, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m train dice tumour:  tensor(0.5060, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m validation ious:  0.9569117324864892
[36m(ClientAppActor pid=3552294)[0m validation dice liver:  tensor(0.9725, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m validation dice tumour:  tensor(0.5123, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m => new best model:  1
[36m(ClientAppActor pid=3552294)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3552294)[0m epoch:  2
[36m(ClientAppActor pid=3552294)[0m train ious:  0.9621374572748891
[36m(ClientAppActor pid=3552294)[0m train dice liver:  tensor(0.9751, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m train dice tumour:  tensor(0.5471, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m validation ious:  0.9568777718821615
[36m(ClientAppActor pid=3552294)[0m validation dice liver:  tensor(0.9732, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m validation dice tumour:  tensor(0.5246, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m => new best model:  2
[36m(ClientAppActor pid=3552294)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3552294)[0m epoch:  3
[36m(ClientAppActor pid=3552294)[0m train ious:  0.964605251141906
[36m(ClientAppActor pid=3552294)[0m train dice liver:  tensor(0.9770, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m train dice tumour:  tensor(0.5614, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m validation ious:  0.9596132781738952
[36m(ClientAppActor pid=3552294)[0m validation dice liver:  tensor(0.9755, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m validation dice tumour:  tensor(0.5290, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m => new best model:  3
[36m(ClientAppActor pid=3552295)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3552295)[0m epoch:  0
[36m(ClientAppActor pid=3552295)[0m train ious:  0.9434596315873606
[36m(ClientAppActor pid=3552295)[0m train dice liver:  
[36m(ClientAppActor pid=3552295)[0m tensor(0.9642, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m train dice tumour:  tensor(0.5501, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m validation ious:  0.9466644557676447
[36m(ClientAppActor pid=3552295)[0m validation dice liver:  tensor(0.9658, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m validation dice tumour:  tensor(0.5697, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m => new best model:  0
[36m(ClientAppActor pid=3552295)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3552295)[0m epoch:  1
[36m(ClientAppActor pid=3552295)[0m train ious:  0.9482743366425822
[36m(ClientAppActor pid=3552295)[0m train dice liver:  tensor(0.9675, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m train dice tumour:  tensor(0.5708, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m validation ious:  0.9186336287230741
[36m(ClientAppActor pid=3552295)[0m validation dice liver:  tensor(0.9499, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m validation dice tumour:  tensor(0.4214, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m => new best model:  1
[36m(ClientAppActor pid=3552295)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3552295)[0m epoch:  2
[36m(ClientAppActor pid=3552295)[0m train ious:  0.9520178658311224
[36m(ClientAppActor pid=3552295)[0m train dice liver:  tensor(0.9696, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m train dice tumour:  tensor(0.6035, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m validation ious:  0.9436850599296283
[36m(ClientAppActor pid=3552295)[0m validation dice liver:  tensor(0.9648, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m validation dice tumour:  tensor(0.5424, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m => new best model:  2
[36m(ClientAppActor pid=3552295)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3552295)[0m epoch:  3
[36m(ClientAppActor pid=3552295)[0m train ious:  0.9531970427246715
[36m(ClientAppActor pid=3552295)[0m train dice liver:  
[36m(ClientAppActor pid=3552295)[0m tensor(0.9702, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m train dice tumour:  tensor(0.6060, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m validation ious:  0.9512879682167092
[36m(ClientAppActor pid=3552295)[0m validation dice liver:  tensor(0.9682, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m validation dice tumour:  tensor(0.5968, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m => new best model:  3
[2025-01-15 16:20:53,537][flwr][INFO] - aggregate_fit: received 2 results and 0 failures
[92mINFO [0m:      fit progress: (2, 0.0053668191789358185, OrderedDict([('ind_iou_0', 0.9529098491399829), ('ind_dice_liver_0', tensor(0.9696, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.5979, dtype=torch.float64)), ('ind_iou_1', 0.9522615095198804), ('ind_dice_liver_1', tensor(0.9675, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5084, dtype=torch.float64)), ('all_iou', 0.9528925357987572), ('all_dice_liver', tensor(0.9694, dtype=torch.float64)), ('all_dice_tumour', tensor(0.5916, dtype=torch.float64))]), 21729.341499859467)
Entrei no test
Meio do test
Fim do test
[2025-01-15 16:31:41,674][flwr][INFO] - fit progress: (2, 0.0053668191789358185, OrderedDict([('ind_iou_0', 0.9529098491399829), ('ind_dice_liver_0', tensor(0.9696, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.5979, dtype=torch.float64)), ('ind_iou_1', 0.9522615095198804), ('ind_dice_liver_1', tensor(0.9675, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5084, dtype=torch.float64)), ('all_iou', 0.9528925357987572), ('all_dice_liver', tensor(0.9694, dtype=torch.float64)), ('all_dice_tumour', tensor(0.5916, dtype=torch.float64))]), 21729.341499859467)
[92mINFO [0m:      configure_evaluate: strategy sampled 2 clients (out of 2)
[2025-01-15 16:31:41,759][flwr][INFO] - configure_evaluate: strategy sampled 2 clients (out of 2)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3552295, ip=172.18.62.3, actor_id=3f52105c5cbc21879b66bbbb01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14f736741520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3552295, ip=172.18.62.3, actor_id=3f52105c5cbc21879b66bbbb01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14f736741520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[36m(ClientAppActor pid=3552295)[0m Entrei no validation 1 3
[2025-01-15 16:32:04,927][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3552295, ip=172.18.62.3, actor_id=3f52105c5cbc21879b66bbbb01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14f736741520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3552295, ip=172.18.62.3, actor_id=3f52105c5cbc21879b66bbbb01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14f736741520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=3552295, ip=172.18.62.3, actor_id=3f52105c5cbc21879b66bbbb01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14f736741520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3552295, ip=172.18.62.3, actor_id=3f52105c5cbc21879b66bbbb01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14f736741520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2025-01-15 16:32:04,927][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=3552295, ip=172.18.62.3, actor_id=3f52105c5cbc21879b66bbbb01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14f736741520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3552295, ip=172.18.62.3, actor_id=3f52105c5cbc21879b66bbbb01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14f736741520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3552294, ip=172.18.62.3, actor_id=7d0a08568fab681ba601f8f201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x154df422d430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3552294, ip=172.18.62.3, actor_id=7d0a08568fab681ba601f8f201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x154df422d430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[2025-01-15 16:33:42,237][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3552294, ip=172.18.62.3, actor_id=7d0a08568fab681ba601f8f201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x154df422d430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3552294, ip=172.18.62.3, actor_id=7d0a08568fab681ba601f8f201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x154df422d430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=3552294, ip=172.18.62.3, actor_id=7d0a08568fab681ba601f8f201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x154df422d430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3552294, ip=172.18.62.3, actor_id=7d0a08568fab681ba601f8f201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x154df422d430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2025-01-15 16:33:42,237][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=3552294, ip=172.18.62.3, actor_id=7d0a08568fab681ba601f8f201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x154df422d430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3552294, ip=172.18.62.3, actor_id=7d0a08568fab681ba601f8f201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x154df422d430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 2 failures
[2025-01-15 16:33:42,238][flwr][INFO] - aggregate_evaluate: received 0 results and 2 failures
[92mINFO [0m:      
[2025-01-15 16:33:42,238][flwr][INFO] - 
[92mINFO [0m:      [ROUND 3]
[2025-01-15 16:33:42,238][flwr][INFO] - [ROUND 3]
[92mINFO [0m:      configure_fit: strategy sampled 2 clients (out of 2)
[2025-01-15 16:33:42,238][flwr][INFO] - configure_fit: strategy sampled 2 clients (out of 2)
[92mINFO [0m:      aggregate_fit: received 2 results and 0 failures
[36m(ClientAppActor pid=3552294)[0m Entrei no validation 1 3[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=3552294)[0m epoch:  0
[36m(ClientAppActor pid=3552294)[0m train ious:  0.9568703989847217
[36m(ClientAppActor pid=3552294)[0m train dice liver:  tensor(0.9718, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m train dice tumour:  tensor(0.5479, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m validation ious:  0.9582110723496378
[36m(ClientAppActor pid=3552294)[0m validation dice liver:  tensor(0.9741, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m validation dice tumour:  tensor(0.5429, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m => new best model:  0
[36m(ClientAppActor pid=3552294)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3552294)[0m epoch:  1
[36m(ClientAppActor pid=3552294)[0m train ious:  0.96468596774046
[36m(ClientAppActor pid=3552294)[0m train dice liver:  tensor(0.9767, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m train dice tumour:  tensor(0.5779, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m validation ious:  0.9630627892063219
[36m(ClientAppActor pid=3552294)[0m validation dice liver:  tensor(0.9761, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m validation dice tumour:  tensor(0.5568, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m => new best model:  1
[36m(ClientAppActor pid=3552294)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3552294)[0m epoch:  2
[36m(ClientAppActor pid=3552294)[0m train ious:  0.9593858332294233
[36m(ClientAppActor pid=3552294)[0m train dice liver:  tensor(0.9735, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m train dice tumour:  tensor(0.5370, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m validation ious:  0.962782507859553
[36m(ClientAppActor pid=3552294)[0m validation dice liver:  tensor(0.9761, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m validation dice tumour:  tensor(0.5459, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m => new best model:  2
[36m(ClientAppActor pid=3552294)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3552294)[0m epoch:  3
[36m(ClientAppActor pid=3552294)[0m train ious:  0.9700660336697691
[36m(ClientAppActor pid=3552294)[0m train dice liver:  tensor(0.9801, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m train dice tumour:  tensor(0.5779, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m validation ious:  0.9659789962820287
[36m(ClientAppActor pid=3552294)[0m validation dice liver:  tensor(0.9789, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m validation dice tumour:  tensor(0.5640, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m => new best model:  3
[36m(ClientAppActor pid=3552295)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3552295)[0m epoch:  0
[36m(ClientAppActor pid=3552295)[0m train ious:  0.9545085357471805
[36m(ClientAppActor pid=3552295)[0m train dice liver:  
[36m(ClientAppActor pid=3552295)[0m tensor(0.9711, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m train dice tumour:  tensor(0.6126, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m validation ious:  0.9558492442228742
[36m(ClientAppActor pid=3552295)[0m validation dice liver:  tensor(0.9728, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m validation dice tumour:  tensor(0.6132, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m => new best model:  0
[36m(ClientAppActor pid=3552295)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3552295)[0m epoch:  1
[36m(ClientAppActor pid=3552295)[0m train ious:  0.9574206602941342
[36m(ClientAppActor pid=3552295)[0m train dice liver:  
[36m(ClientAppActor pid=3552295)[0m tensor(0.9728, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m train dice tumour:  tensor(0.6281, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m validation ious:  0.9588928185761294
[36m(ClientAppActor pid=3552295)[0m validation dice liver:  tensor(0.9743, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m validation dice tumour:  tensor(0.6347, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m => new best model:  1
[36m(ClientAppActor pid=3552295)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3552295)[0m epoch:  2
[36m(ClientAppActor pid=3552295)[0m train ious:  0.9589345931415585
[36m(ClientAppActor pid=3552295)[0m train dice liver:  tensor(0.9739, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m train dice tumour:  tensor(0.6400, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m validation ious:  0.9564316396709223
[36m(ClientAppActor pid=3552295)[0m validation dice liver:  tensor(0.9728, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m validation dice tumour:  tensor(0.6227, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m => new best model:  2
[36m(ClientAppActor pid=3552295)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3552295)[0m epoch:  3
[36m(ClientAppActor pid=3552295)[0m train ious:  0.9621411249411334
[36m(ClientAppActor pid=3552295)[0m train dice liver:  
[36m(ClientAppActor pid=3552295)[0m tensor(0.9759, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m train dice tumour:  tensor(0.6492, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m validation ious:  0.959992546855443
[36m(ClientAppActor pid=3552295)[0m validation dice liver:  tensor(0.9750, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m validation dice tumour:  tensor(0.6442, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m => new best model:  3
[2025-01-15 18:59:38,487][flwr][INFO] - aggregate_fit: received 2 results and 0 failures
[92mINFO [0m:      fit progress: (3, 0.0044215885628852, OrderedDict([('ind_iou_0', 0.9605193739637266), ('ind_dice_liver_0', tensor(0.9756, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.6485, dtype=torch.float64)), ('ind_iou_1', 0.9609285547124046), ('ind_dice_liver_1', tensor(0.9740, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5567, dtype=torch.float64)), ('all_iou', 0.9606140058278722), ('all_dice_liver', tensor(0.9754, dtype=torch.float64)), ('all_dice_tumour', tensor(0.6420, dtype=torch.float64))]), 31186.31116631441)
Entrei no test
Meio do test
Fim do test
[2025-01-15 19:09:18,644][flwr][INFO] - fit progress: (3, 0.0044215885628852, OrderedDict([('ind_iou_0', 0.9605193739637266), ('ind_dice_liver_0', tensor(0.9756, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.6485, dtype=torch.float64)), ('ind_iou_1', 0.9609285547124046), ('ind_dice_liver_1', tensor(0.9740, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5567, dtype=torch.float64)), ('all_iou', 0.9606140058278722), ('all_dice_liver', tensor(0.9754, dtype=torch.float64)), ('all_dice_tumour', tensor(0.6420, dtype=torch.float64))]), 31186.31116631441)
[92mINFO [0m:      configure_evaluate: strategy sampled 2 clients (out of 2)
[2025-01-15 19:09:18,742][flwr][INFO] - configure_evaluate: strategy sampled 2 clients (out of 2)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3552294, ip=172.18.62.3, actor_id=7d0a08568fab681ba601f8f201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x154df422d430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3552294, ip=172.18.62.3, actor_id=7d0a08568fab681ba601f8f201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x154df422d430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[36m(ClientAppActor pid=3552295)[0m Entrei no validation 1 3
[2025-01-15 19:09:36,484][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3552294, ip=172.18.62.3, actor_id=7d0a08568fab681ba601f8f201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x154df422d430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3552294, ip=172.18.62.3, actor_id=7d0a08568fab681ba601f8f201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x154df422d430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2025-01-15 19:09:36,485][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=3552294, ip=172.18.62.3, actor_id=7d0a08568fab681ba601f8f201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x154df422d430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3552294, ip=172.18.62.3, actor_id=7d0a08568fab681ba601f8f201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x154df422d430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=3552294, ip=172.18.62.3, actor_id=7d0a08568fab681ba601f8f201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x154df422d430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3552294, ip=172.18.62.3, actor_id=7d0a08568fab681ba601f8f201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x154df422d430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3552295, ip=172.18.62.3, actor_id=3f52105c5cbc21879b66bbbb01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14f736741520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3552295, ip=172.18.62.3, actor_id=3f52105c5cbc21879b66bbbb01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14f736741520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[2025-01-15 19:11:03,074][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3552295, ip=172.18.62.3, actor_id=3f52105c5cbc21879b66bbbb01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14f736741520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3552295, ip=172.18.62.3, actor_id=3f52105c5cbc21879b66bbbb01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14f736741520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=3552295, ip=172.18.62.3, actor_id=3f52105c5cbc21879b66bbbb01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14f736741520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3552295, ip=172.18.62.3, actor_id=3f52105c5cbc21879b66bbbb01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14f736741520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2025-01-15 19:11:03,074][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=3552295, ip=172.18.62.3, actor_id=3f52105c5cbc21879b66bbbb01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14f736741520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3552295, ip=172.18.62.3, actor_id=3f52105c5cbc21879b66bbbb01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14f736741520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 2 failures
[2025-01-15 19:11:03,075][flwr][INFO] - aggregate_evaluate: received 0 results and 2 failures
[92mINFO [0m:      
[2025-01-15 19:11:03,075][flwr][INFO] - 
[92mINFO [0m:      [ROUND 4]
[2025-01-15 19:11:03,075][flwr][INFO] - [ROUND 4]
[92mINFO [0m:      configure_fit: strategy sampled 2 clients (out of 2)
[2025-01-15 19:11:03,076][flwr][INFO] - configure_fit: strategy sampled 2 clients (out of 2)
[92mINFO [0m:      aggregate_fit: received 2 results and 0 failures
[36m(ClientAppActor pid=3552295)[0m Entrei no validation 1 3[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=3552295)[0m epoch:  0
[36m(ClientAppActor pid=3552295)[0m train ious:  0.9638446574969654
[36m(ClientAppActor pid=3552295)[0m train dice liver:  tensor(0.9762, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m train dice tumour:  tensor(0.5669, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m validation ious:  0.9654623283743264
[36m(ClientAppActor pid=3552295)[0m validation dice liver:  tensor(0.9772, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m validation dice tumour:  tensor(0.5741, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m => new best model:  0
[36m(ClientAppActor pid=3552295)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3552295)[0m epoch:  1
[36m(ClientAppActor pid=3552295)[0m train ious:  0.9691343289982832
[36m(ClientAppActor pid=3552295)[0m train dice liver:  tensor(0.9797, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m train dice tumour:  tensor(0.5854, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m validation ious:  0.966263073597505
[36m(ClientAppActor pid=3552295)[0m validation dice liver:  tensor(0.9788, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m validation dice tumour:  tensor(0.5716, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m => new best model:  1
[36m(ClientAppActor pid=3552295)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3552295)[0m epoch:  2
[36m(ClientAppActor pid=3552295)[0m train ious:  0.9735957491153603
[36m(ClientAppActor pid=3552295)[0m train dice liver:  tensor(0.9826, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m train dice tumour:  tensor(0.6139, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m validation ious:  0.9691907807482069
[36m(ClientAppActor pid=3552295)[0m validation dice liver:  tensor(0.9813, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m validation dice tumour:  tensor(0.5770, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m => new best model:  2
[36m(ClientAppActor pid=3552295)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3552295)[0m epoch:  3
[36m(ClientAppActor pid=3552295)[0m train ious:  0.9760752812132035
[36m(ClientAppActor pid=3552295)[0m train dice liver:  tensor(0.9843, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m train dice tumour:  tensor(0.6071, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m validation ious:  0.9700009623463287
[36m(ClientAppActor pid=3552295)[0m validation dice liver:  tensor(0.9817, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m validation dice tumour:  tensor(0.5777, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m => new best model:  3
[36m(ClientAppActor pid=3552294)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3552294)[0m epoch:  0
[36m(ClientAppActor pid=3552294)[0m train ious:  
[36m(ClientAppActor pid=3552294)[0m 0.9626858067932135
[36m(ClientAppActor pid=3552294)[0m train dice liver:  tensor(0.9762, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m train dice tumour:  tensor(0.6580, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m validation ious:  0.9600768108770277
[36m(ClientAppActor pid=3552294)[0m validation dice liver:  tensor(0.9751, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m validation dice tumour:  tensor(0.6372, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m => new best model:  0
[36m(ClientAppActor pid=3552294)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3552294)[0m epoch:  1
[36m(ClientAppActor pid=3552294)[0m train ious:  0.964600127731949
[36m(ClientAppActor pid=3552294)[0m train dice liver:  tensor(0.9774, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m train dice tumour:  tensor(0.6683, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m validation ious:  0.962801207291768
[36m(ClientAppActor pid=3552294)[0m validation dice liver:  tensor(0.9770, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m validation dice tumour:  tensor(0.6591, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m => new best model:  1
[36m(ClientAppActor pid=3552294)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3552294)[0m epoch:  2
[36m(ClientAppActor pid=3552294)[0m train ious:  0.9661411870394044
[36m(ClientAppActor pid=3552294)[0m train dice liver:  
[36m(ClientAppActor pid=3552294)[0m tensor(0.9786, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m train dice tumour:  tensor(0.6715, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m validation ious:  
[36m(ClientAppActor pid=3552294)[0m 0.9608043496485756
[36m(ClientAppActor pid=3552294)[0m validation dice liver:  tensor(0.9755, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m validation dice tumour:  tensor(0.6479, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m => new best model:  2
[36m(ClientAppActor pid=3552294)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3552294)[0m epoch:  3
[36m(ClientAppActor pid=3552294)[0m train ious:  0.9652689526977914
[36m(ClientAppActor pid=3552294)[0m train dice liver:  
[36m(ClientAppActor pid=3552294)[0m tensor(0.9781, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m train dice tumour:  tensor(0.6704, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m validation ious:  0.9542144355734293
[36m(ClientAppActor pid=3552294)[0m validation dice liver:  tensor(0.9718, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m validation dice tumour:  tensor(0.6501, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m => new best model:  3
[2025-01-15 20:53:18,815][flwr][INFO] - aggregate_fit: received 2 results and 0 failures
[92mINFO [0m:      fit progress: (4, 0.00491547830918899, OrderedDict([('ind_iou_0', 0.9563608136063804), ('ind_dice_liver_0', tensor(0.9736, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.6586, dtype=torch.float64)), ('ind_iou_1', 0.9577975502470804), ('ind_dice_liver_1', tensor(0.9728, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5692, dtype=torch.float64)), ('all_iou', 0.9565689706038065), ('all_dice_liver', tensor(0.9736, dtype=torch.float64)), ('all_dice_tumour', tensor(0.6524, dtype=torch.float64))]), 37969.99647567421)
Entrei no test
Meio do test
Fim do test
[2025-01-15 21:02:22,329][flwr][INFO] - fit progress: (4, 0.00491547830918899, OrderedDict([('ind_iou_0', 0.9563608136063804), ('ind_dice_liver_0', tensor(0.9736, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.6586, dtype=torch.float64)), ('ind_iou_1', 0.9577975502470804), ('ind_dice_liver_1', tensor(0.9728, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5692, dtype=torch.float64)), ('all_iou', 0.9565689706038065), ('all_dice_liver', tensor(0.9736, dtype=torch.float64)), ('all_dice_tumour', tensor(0.6524, dtype=torch.float64))]), 37969.99647567421)
[92mINFO [0m:      configure_evaluate: strategy sampled 2 clients (out of 2)
[2025-01-15 21:02:22,417][flwr][INFO] - configure_evaluate: strategy sampled 2 clients (out of 2)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3552294, ip=172.18.62.3, actor_id=7d0a08568fab681ba601f8f201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x154df422d430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3552294, ip=172.18.62.3, actor_id=7d0a08568fab681ba601f8f201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x154df422d430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[36m(ClientAppActor pid=3552294)[0m Entrei no validation 1 3
[2025-01-15 21:02:42,638][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3552294, ip=172.18.62.3, actor_id=7d0a08568fab681ba601f8f201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x154df422d430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3552294, ip=172.18.62.3, actor_id=7d0a08568fab681ba601f8f201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x154df422d430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2025-01-15 21:02:42,638][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=3552294, ip=172.18.62.3, actor_id=7d0a08568fab681ba601f8f201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x154df422d430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3552294, ip=172.18.62.3, actor_id=7d0a08568fab681ba601f8f201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x154df422d430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=3552294, ip=172.18.62.3, actor_id=7d0a08568fab681ba601f8f201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x154df422d430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3552294, ip=172.18.62.3, actor_id=7d0a08568fab681ba601f8f201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x154df422d430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3552295, ip=172.18.62.3, actor_id=3f52105c5cbc21879b66bbbb01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14f736741520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3552295, ip=172.18.62.3, actor_id=3f52105c5cbc21879b66bbbb01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14f736741520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[2025-01-15 21:04:26,183][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3552295, ip=172.18.62.3, actor_id=3f52105c5cbc21879b66bbbb01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14f736741520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3552295, ip=172.18.62.3, actor_id=3f52105c5cbc21879b66bbbb01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14f736741520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=3552295, ip=172.18.62.3, actor_id=3f52105c5cbc21879b66bbbb01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14f736741520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3552295, ip=172.18.62.3, actor_id=3f52105c5cbc21879b66bbbb01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14f736741520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2025-01-15 21:04:26,183][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=3552295, ip=172.18.62.3, actor_id=3f52105c5cbc21879b66bbbb01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14f736741520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3552295, ip=172.18.62.3, actor_id=3f52105c5cbc21879b66bbbb01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14f736741520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 2 failures
[2025-01-15 21:04:26,184][flwr][INFO] - aggregate_evaluate: received 0 results and 2 failures
[92mINFO [0m:      
[2025-01-15 21:04:26,184][flwr][INFO] - 
[92mINFO [0m:      [ROUND 5]
[2025-01-15 21:04:26,184][flwr][INFO] - [ROUND 5]
[92mINFO [0m:      configure_fit: strategy sampled 2 clients (out of 2)
[2025-01-15 21:04:26,185][flwr][INFO] - configure_fit: strategy sampled 2 clients (out of 2)
[92mINFO [0m:      aggregate_fit: received 2 results and 0 failures
[36m(ClientAppActor pid=3552295)[0m Entrei no validation 1 3[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=3552295)[0m epoch:  0
[36m(ClientAppActor pid=3552295)[0m train ious:  0.965372629383427
[36m(ClientAppActor pid=3552295)[0m train dice liver:  tensor(0.9770, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m train dice tumour:  tensor(0.5621, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m validation ious:  0.9669076760230503
[36m(ClientAppActor pid=3552295)[0m validation dice liver:  tensor(0.9778, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m validation dice tumour:  tensor(0.5836, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m => new best model:  0
[36m(ClientAppActor pid=3552295)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3552295)[0m epoch:  1
[36m(ClientAppActor pid=3552295)[0m train ious:  0.9732582994677869
[36m(ClientAppActor pid=3552295)[0m train dice liver:  tensor(0.9822, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m train dice tumour:  tensor(0.5982, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m validation ious:  0.9710104233782946
[36m(ClientAppActor pid=3552295)[0m validation dice liver:  tensor(0.9818, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m validation dice tumour:  tensor(0.5868, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m => new best model:  1
[36m(ClientAppActor pid=3552295)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3552295)[0m epoch:  2
[36m(ClientAppActor pid=3552295)[0m train ious:  0.9763140853161116
[36m(ClientAppActor pid=3552295)[0m train dice liver:  tensor(0.9845, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m train dice tumour:  tensor(0.6117, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m validation ious:  0.9717113364618364
[36m(ClientAppActor pid=3552295)[0m validation dice liver:  tensor(0.9830, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m validation dice tumour:  tensor(0.5976, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m => new best model:  2
[36m(ClientAppActor pid=3552295)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3552295)[0m epoch:  3
[36m(ClientAppActor pid=3552295)[0m train ious:  0.9784074872388775
[36m(ClientAppActor pid=3552295)[0m train dice liver:  tensor(0.9859, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m train dice tumour:  tensor(0.5987, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m validation ious:  0.9727961036912461
[36m(ClientAppActor pid=3552295)[0m validation dice liver:  tensor(0.9838, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m validation dice tumour:  tensor(0.5996, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m => new best model:  3
[36m(ClientAppActor pid=3552294)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3552294)[0m epoch:  0
[36m(ClientAppActor pid=3552294)[0m train ious:  
[36m(ClientAppActor pid=3552294)[0m 0.9661806039515505
[36m(ClientAppActor pid=3552294)[0m train dice liver:  tensor(0.9784, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m train dice tumour:  tensor(0.6774, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m validation ious:  0.9653997846524414
[36m(ClientAppActor pid=3552294)[0m validation dice liver:  tensor(0.9788, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m validation dice tumour:  tensor(0.6726, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m => new best model:  0
[36m(ClientAppActor pid=3552294)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3552294)[0m epoch:  1
[36m(ClientAppActor pid=3552294)[0m train ious:  0.9693644097464694
[36m(ClientAppActor pid=3552294)[0m train dice liver:  
[36m(ClientAppActor pid=3552294)[0m tensor(0.9805, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m train dice tumour:  tensor(0.6824, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m validation ious:  0.9653991156665892
[36m(ClientAppActor pid=3552294)[0m validation dice liver:  tensor(0.9793, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m validation dice tumour:  tensor(0.6680, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m => new best model:  1
[36m(ClientAppActor pid=3552294)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3552294)[0m epoch:  2
[36m(ClientAppActor pid=3552294)[0m train ious:  0.9692699656240095
[36m(ClientAppActor pid=3552294)[0m train dice liver:  tensor(0.9805, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m train dice tumour:  tensor(0.6846, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m validation ious:  0.9655334136833665
[36m(ClientAppActor pid=3552294)[0m validation dice liver:  tensor(0.9789, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m validation dice tumour:  tensor(0.6706, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m => new best model:  2
[36m(ClientAppActor pid=3552294)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3552294)[0m epoch:  3
[36m(ClientAppActor pid=3552294)[0m train ious:  0.9698882562812051
[36m(ClientAppActor pid=3552294)[0m train dice liver:  tensor(0.9808, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m train dice tumour:  tensor(0.6961, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m validation ious:  0.9676260762847099
[36m(ClientAppActor pid=3552294)[0m validation dice liver:  tensor(0.9807, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m validation dice tumour:  tensor(0.6760, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m => new best model:  3
[2025-01-15 23:23:58,312][flwr][INFO] - aggregate_fit: received 2 results and 0 failures
[92mINFO [0m:      fit progress: (5, 0.0035606679405272893, OrderedDict([('ind_iou_0', 0.968143632232176), ('ind_dice_liver_0', tensor(0.9812, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.6806, dtype=torch.float64)), ('ind_iou_1', 0.9710280653503988), ('ind_dice_liver_1', tensor(0.9813, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5928, dtype=torch.float64)), ('all_iou', 0.9684447522196982), ('all_dice_liver', tensor(0.9812, dtype=torch.float64)), ('all_dice_tumour', tensor(0.6748, dtype=torch.float64))]), 47088.698318241164)
Entrei no test
Meio do test
Fim do test
[2025-01-15 23:34:21,031][flwr][INFO] - fit progress: (5, 0.0035606679405272893, OrderedDict([('ind_iou_0', 0.968143632232176), ('ind_dice_liver_0', tensor(0.9812, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.6806, dtype=torch.float64)), ('ind_iou_1', 0.9710280653503988), ('ind_dice_liver_1', tensor(0.9813, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5928, dtype=torch.float64)), ('all_iou', 0.9684447522196982), ('all_dice_liver', tensor(0.9812, dtype=torch.float64)), ('all_dice_tumour', tensor(0.6748, dtype=torch.float64))]), 47088.698318241164)
[92mINFO [0m:      configure_evaluate: strategy sampled 2 clients (out of 2)
[2025-01-15 23:34:21,094][flwr][INFO] - configure_evaluate: strategy sampled 2 clients (out of 2)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3552295, ip=172.18.62.3, actor_id=3f52105c5cbc21879b66bbbb01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14f736741520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3552295, ip=172.18.62.3, actor_id=3f52105c5cbc21879b66bbbb01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14f736741520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[36m(ClientAppActor pid=3552294)[0m Entrei no validation 1 3
[2025-01-15 23:34:36,977][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3552295, ip=172.18.62.3, actor_id=3f52105c5cbc21879b66bbbb01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14f736741520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3552295, ip=172.18.62.3, actor_id=3f52105c5cbc21879b66bbbb01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14f736741520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=3552295, ip=172.18.62.3, actor_id=3f52105c5cbc21879b66bbbb01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14f736741520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3552295, ip=172.18.62.3, actor_id=3f52105c5cbc21879b66bbbb01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14f736741520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2025-01-15 23:34:36,977][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=3552295, ip=172.18.62.3, actor_id=3f52105c5cbc21879b66bbbb01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14f736741520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3552295, ip=172.18.62.3, actor_id=3f52105c5cbc21879b66bbbb01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14f736741520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3552294, ip=172.18.62.3, actor_id=7d0a08568fab681ba601f8f201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x154df422d430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3552294, ip=172.18.62.3, actor_id=7d0a08568fab681ba601f8f201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x154df422d430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[2025-01-15 23:36:16,652][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3552294, ip=172.18.62.3, actor_id=7d0a08568fab681ba601f8f201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x154df422d430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3552294, ip=172.18.62.3, actor_id=7d0a08568fab681ba601f8f201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x154df422d430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=3552294, ip=172.18.62.3, actor_id=7d0a08568fab681ba601f8f201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x154df422d430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3552294, ip=172.18.62.3, actor_id=7d0a08568fab681ba601f8f201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x154df422d430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2025-01-15 23:36:16,652][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=3552294, ip=172.18.62.3, actor_id=7d0a08568fab681ba601f8f201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x154df422d430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3552294, ip=172.18.62.3, actor_id=7d0a08568fab681ba601f8f201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x154df422d430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 2 failures
[2025-01-15 23:36:16,654][flwr][INFO] - aggregate_evaluate: received 0 results and 2 failures
[92mINFO [0m:      
[2025-01-15 23:36:16,654][flwr][INFO] - 
[92mINFO [0m:      [ROUND 6]
[2025-01-15 23:36:16,654][flwr][INFO] - [ROUND 6]
[92mINFO [0m:      configure_fit: strategy sampled 2 clients (out of 2)
[2025-01-15 23:36:16,654][flwr][INFO] - configure_fit: strategy sampled 2 clients (out of 2)
[92mINFO [0m:      aggregate_fit: received 2 results and 0 failures
[36m(ClientAppActor pid=3552295)[0m Entrei no validation 1 3[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=3552295)[0m epoch:  0
[36m(ClientAppActor pid=3552295)[0m train ious:  0.9709078919253595
[36m(ClientAppActor pid=3552295)[0m train dice liver:  tensor(0.9808, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m train dice tumour:  tensor(0.5717, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m validation ious:  0.971983585101133
[36m(ClientAppActor pid=3552295)[0m validation dice liver:  tensor(0.9820, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m validation dice tumour:  tensor(0.6053, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m => new best model:  0
[36m(ClientAppActor pid=3552295)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3552295)[0m epoch:  1
[36m(ClientAppActor pid=3552295)[0m train ious:  0.9753386219402683
[36m(ClientAppActor pid=3552295)[0m train dice liver:  tensor(0.9836, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m train dice tumour:  tensor(0.6096, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m validation ious:  0.9722269721860526
[36m(ClientAppActor pid=3552295)[0m validation dice liver:  tensor(0.9823, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m validation dice tumour:  tensor(0.6042, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m => new best model:  1
[36m(ClientAppActor pid=3552295)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3552295)[0m epoch:  2
[36m(ClientAppActor pid=3552295)[0m train ious:  0.9777716558085803
[36m(ClientAppActor pid=3552295)[0m train dice liver:  tensor(0.9853, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m train dice tumour:  tensor(0.5864, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m validation ious:  0.9739451584614912
[36m(ClientAppActor pid=3552295)[0m validation dice liver:  tensor(0.9840, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m validation dice tumour:  tensor(0.6106, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m => new best model:  2
[36m(ClientAppActor pid=3552295)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3552295)[0m epoch:  3
[36m(ClientAppActor pid=3552295)[0m train ious:  0.9800037826964343
[36m(ClientAppActor pid=3552295)[0m train dice liver:  tensor(0.9869, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m train dice tumour:  tensor(0.6239, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m validation ious:  0.9747112545325093
[36m(ClientAppActor pid=3552295)[0m validation dice liver:  tensor(0.9849, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m validation dice tumour:  tensor(0.6069, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m => new best model:  3
[36m(ClientAppActor pid=3552294)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3552294)[0m epoch:  0
[36m(ClientAppActor pid=3552294)[0m train ious:  
[36m(ClientAppActor pid=3552294)[0m 0.9713320992901693
[36m(ClientAppActor pid=3552294)[0m train dice liver:  tensor(0.9820, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m train dice tumour:  tensor(0.7003, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m validation ious:  0.9659974527258595
[36m(ClientAppActor pid=3552294)[0m validation dice liver:  tensor(0.9793, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m validation dice tumour:  tensor(0.6747, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m => new best model:  0
[36m(ClientAppActor pid=3552294)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3552294)[0m epoch:  1
[36m(ClientAppActor pid=3552294)[0m train ious:  0.9719031647408932
[36m(ClientAppActor pid=3552294)[0m train dice liver:  tensor(0.9823, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m train dice tumour:  tensor(0.7002, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m validation ious:  0.9667549325400322
[36m(ClientAppActor pid=3552294)[0m validation dice liver:  tensor(0.9800, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m validation dice tumour:  tensor(0.6729, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m => new best model:  1
[36m(ClientAppActor pid=3552294)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3552294)[0m epoch:  2
[36m(ClientAppActor pid=3552294)[0m train ious:  0.9732316271674835
[36m(ClientAppActor pid=3552294)[0m train dice liver:  tensor(0.9831, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m train dice tumour:  tensor(0.7093, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m validation ious:  0.967745085550461
[36m(ClientAppActor pid=3552294)[0m validation dice liver:  tensor(0.9810, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m validation dice tumour:  tensor(0.6843, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m => new best model:  2
[36m(ClientAppActor pid=3552294)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3552294)[0m epoch:  3
[36m(ClientAppActor pid=3552294)[0m train ious:  0.9720988316605529
[36m(ClientAppActor pid=3552294)[0m train dice liver:  
[36m(ClientAppActor pid=3552294)[0m tensor(0.9824, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m train dice tumour:  tensor(0.6993, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m validation ious:  0.9641219351901732
[36m(ClientAppActor pid=3552294)[0m validation dice liver:  tensor(0.9785, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m validation dice tumour:  tensor(0.6622, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m => new best model:  3
[2025-01-16 01:54:35,872][flwr][INFO] - aggregate_fit: received 2 results and 0 failures
[92mINFO [0m:      fit progress: (6, 0.003911167854281512, OrderedDict([('ind_iou_0', 0.9655495718779004), ('ind_dice_liver_0', tensor(0.9796, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.6700, dtype=torch.float64)), ('ind_iou_1', 0.9675166168054126), ('ind_dice_liver_1', tensor(0.9793, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5842, dtype=torch.float64)), ('all_iou', 0.9658384748569165), ('all_dice_liver', tensor(0.9797, dtype=torch.float64)), ('all_dice_tumour', tensor(0.6644, dtype=torch.float64))]), 56045.74991750717)
Entrei no test
Meio do test
Fim do test
[2025-01-16 02:03:38,083][flwr][INFO] - fit progress: (6, 0.003911167854281512, OrderedDict([('ind_iou_0', 0.9655495718779004), ('ind_dice_liver_0', tensor(0.9796, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.6700, dtype=torch.float64)), ('ind_iou_1', 0.9675166168054126), ('ind_dice_liver_1', tensor(0.9793, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5842, dtype=torch.float64)), ('all_iou', 0.9658384748569165), ('all_dice_liver', tensor(0.9797, dtype=torch.float64)), ('all_dice_tumour', tensor(0.6644, dtype=torch.float64))]), 56045.74991750717)
[92mINFO [0m:      configure_evaluate: strategy sampled 2 clients (out of 2)
[2025-01-16 02:03:38,137][flwr][INFO] - configure_evaluate: strategy sampled 2 clients (out of 2)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3552295, ip=172.18.62.3, actor_id=3f52105c5cbc21879b66bbbb01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14f736741520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3552295, ip=172.18.62.3, actor_id=3f52105c5cbc21879b66bbbb01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14f736741520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[36m(ClientAppActor pid=3552294)[0m Entrei no validation 1 3
[2025-01-16 02:03:54,401][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3552295, ip=172.18.62.3, actor_id=3f52105c5cbc21879b66bbbb01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14f736741520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3552295, ip=172.18.62.3, actor_id=3f52105c5cbc21879b66bbbb01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14f736741520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2025-01-16 02:03:54,401][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=3552295, ip=172.18.62.3, actor_id=3f52105c5cbc21879b66bbbb01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14f736741520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3552295, ip=172.18.62.3, actor_id=3f52105c5cbc21879b66bbbb01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14f736741520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=3552295, ip=172.18.62.3, actor_id=3f52105c5cbc21879b66bbbb01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14f736741520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3552295, ip=172.18.62.3, actor_id=3f52105c5cbc21879b66bbbb01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14f736741520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3552294, ip=172.18.62.3, actor_id=7d0a08568fab681ba601f8f201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x154df422d430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3552294, ip=172.18.62.3, actor_id=7d0a08568fab681ba601f8f201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x154df422d430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[2025-01-16 02:05:29,509][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3552294, ip=172.18.62.3, actor_id=7d0a08568fab681ba601f8f201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x154df422d430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3552294, ip=172.18.62.3, actor_id=7d0a08568fab681ba601f8f201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x154df422d430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=3552294, ip=172.18.62.3, actor_id=7d0a08568fab681ba601f8f201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x154df422d430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3552294, ip=172.18.62.3, actor_id=7d0a08568fab681ba601f8f201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x154df422d430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2025-01-16 02:05:29,509][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=3552294, ip=172.18.62.3, actor_id=7d0a08568fab681ba601f8f201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x154df422d430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3552294, ip=172.18.62.3, actor_id=7d0a08568fab681ba601f8f201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x154df422d430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 2 failures
[2025-01-16 02:05:29,509][flwr][INFO] - aggregate_evaluate: received 0 results and 2 failures
[92mINFO [0m:      
[2025-01-16 02:05:29,509][flwr][INFO] - 
[92mINFO [0m:      [ROUND 7]
[2025-01-16 02:05:29,510][flwr][INFO] - [ROUND 7]
[92mINFO [0m:      configure_fit: strategy sampled 2 clients (out of 2)
[2025-01-16 02:05:29,510][flwr][INFO] - configure_fit: strategy sampled 2 clients (out of 2)
[92mINFO [0m:      aggregate_fit: received 2 results and 0 failures
[36m(ClientAppActor pid=3552295)[0m Entrei no validation 1 3[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=3552295)[0m epoch:  0
[36m(ClientAppActor pid=3552295)[0m train ious:  0.9717389081830093
[36m(ClientAppActor pid=3552295)[0m train dice liver:  tensor(0.9814, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m train dice tumour:  tensor(0.5848, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m validation ious:  0.9720029734521308
[36m(ClientAppActor pid=3552295)[0m validation dice liver:  tensor(0.9822, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m validation dice tumour:  tensor(0.6039, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m => new best model:  0
[36m(ClientAppActor pid=3552295)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3552295)[0m epoch:  1
[36m(ClientAppActor pid=3552295)[0m train ious:  0.9767472653139627
[36m(ClientAppActor pid=3552295)[0m train dice liver:  tensor(0.9847, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m train dice tumour:  tensor(0.6114, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m validation ious:  0.972751545595613
[36m(ClientAppActor pid=3552295)[0m validation dice liver:  tensor(0.9834, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m validation dice tumour:  tensor(0.6078, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m => new best model:  1
[36m(ClientAppActor pid=3552295)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3552295)[0m epoch:  2
[36m(ClientAppActor pid=3552295)[0m train ious:  0.9791659942921324
[36m(ClientAppActor pid=3552295)[0m train dice liver:  
[36m(ClientAppActor pid=3552295)[0m tensor(0.9863, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m train dice tumour:  tensor(0.6049, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m validation ious:  0.9745198499199477
[36m(ClientAppActor pid=3552295)[0m validation dice liver:  tensor(0.9846, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m validation dice tumour:  tensor(0.6073, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m => new best model:  2
[36m(ClientAppActor pid=3552295)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3552295)[0m epoch:  3
[36m(ClientAppActor pid=3552295)[0m train ious:  0.9814952864715989
[36m(ClientAppActor pid=3552295)[0m train dice liver:  tensor(0.9878, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m train dice tumour:  tensor(0.6324, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m validation ious:  0.9741496635945849
[36m(ClientAppActor pid=3552295)[0m validation dice liver:  tensor(0.9848, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m validation dice tumour:  tensor(0.6047, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m => new best model:  3
[36m(ClientAppActor pid=3552294)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3552294)[0m epoch:  0
[36m(ClientAppActor pid=3552294)[0m train ious:  0.9728602203390694
[36m(ClientAppActor pid=3552294)[0m train dice liver:  tensor(0.9830, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m train dice tumour:  tensor(0.6962, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m validation ious:  0.9689882815389556
[36m(ClientAppActor pid=3552294)[0m validation dice liver:  tensor(0.9817, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m validation dice tumour:  tensor(0.6911, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m => new best model:  0
[36m(ClientAppActor pid=3552294)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3552294)[0m epoch:  1
[36m(ClientAppActor pid=3552294)[0m train ious:  0.9751466264625955
[36m(ClientAppActor pid=3552294)[0m train dice liver:  tensor(0.9843, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m train dice tumour:  tensor(0.7103, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m validation ious:  0.9689117733113517
[36m(ClientAppActor pid=3552294)[0m validation dice liver:  tensor(0.9819, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m validation dice tumour:  tensor(0.6904, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m => new best model:  1
[36m(ClientAppActor pid=3552294)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3552294)[0m epoch:  2
[36m(ClientAppActor pid=3552294)[0m train ious:  0.9742120634759818
[36m(ClientAppActor pid=3552294)[0m train dice liver:  tensor(0.9837, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m train dice tumour:  tensor(0.7074, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m validation ious:  0.9695341885260472
[36m(ClientAppActor pid=3552294)[0m validation dice liver:  tensor(0.9821, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m validation dice tumour:  tensor(0.6877, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m => new best model:  2
[36m(ClientAppActor pid=3552294)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3552294)[0m epoch:  3
[36m(ClientAppActor pid=3552294)[0m train ious:  0.9760561283477804
[36m(ClientAppActor pid=3552294)[0m train dice liver:  tensor(0.9850, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m train dice tumour:  tensor(0.7124, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m validation ious:  0.9699627884190203
[36m(ClientAppActor pid=3552294)[0m validation dice liver:  tensor(0.9826, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m validation dice tumour:  tensor(0.6957, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m => new best model:  3
[2025-01-16 04:25:55,941][flwr][INFO] - aggregate_fit: received 2 results and 0 failures
[92mINFO [0m:      fit progress: (7, 0.0032749986190207117, OrderedDict([('ind_iou_0', 0.9708347609633803), ('ind_dice_liver_0', tensor(0.9832, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.6988, dtype=torch.float64)), ('ind_iou_1', 0.9747661069102949), ('ind_dice_liver_1', tensor(0.9840, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6097, dtype=torch.float64)), ('all_iou', 0.9712467350511965), ('all_dice_liver', tensor(0.9833, dtype=torch.float64)), ('all_dice_tumour', tensor(0.6930, dtype=torch.float64))]), 65181.78872379847)
Entrei no test
Meio do test
Fim do test
[2025-01-16 04:35:54,122][flwr][INFO] - fit progress: (7, 0.0032749986190207117, OrderedDict([('ind_iou_0', 0.9708347609633803), ('ind_dice_liver_0', tensor(0.9832, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.6988, dtype=torch.float64)), ('ind_iou_1', 0.9747661069102949), ('ind_dice_liver_1', tensor(0.9840, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6097, dtype=torch.float64)), ('all_iou', 0.9712467350511965), ('all_dice_liver', tensor(0.9833, dtype=torch.float64)), ('all_dice_tumour', tensor(0.6930, dtype=torch.float64))]), 65181.78872379847)
[92mINFO [0m:      configure_evaluate: strategy sampled 2 clients (out of 2)
[2025-01-16 04:35:54,188][flwr][INFO] - configure_evaluate: strategy sampled 2 clients (out of 2)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3552295, ip=172.18.62.3, actor_id=3f52105c5cbc21879b66bbbb01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14f736741520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3552295, ip=172.18.62.3, actor_id=3f52105c5cbc21879b66bbbb01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14f736741520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[36m(ClientAppActor pid=3552294)[0m Entrei no validation 1 3
[2025-01-16 04:36:10,456][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3552295, ip=172.18.62.3, actor_id=3f52105c5cbc21879b66bbbb01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14f736741520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3552295, ip=172.18.62.3, actor_id=3f52105c5cbc21879b66bbbb01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14f736741520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=3552295, ip=172.18.62.3, actor_id=3f52105c5cbc21879b66bbbb01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14f736741520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3552295, ip=172.18.62.3, actor_id=3f52105c5cbc21879b66bbbb01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14f736741520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2025-01-16 04:36:10,458][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=3552295, ip=172.18.62.3, actor_id=3f52105c5cbc21879b66bbbb01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14f736741520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3552295, ip=172.18.62.3, actor_id=3f52105c5cbc21879b66bbbb01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14f736741520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3552294, ip=172.18.62.3, actor_id=7d0a08568fab681ba601f8f201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x154df422d430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3552294, ip=172.18.62.3, actor_id=7d0a08568fab681ba601f8f201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x154df422d430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[2025-01-16 04:37:44,955][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3552294, ip=172.18.62.3, actor_id=7d0a08568fab681ba601f8f201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x154df422d430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3552294, ip=172.18.62.3, actor_id=7d0a08568fab681ba601f8f201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x154df422d430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=3552294, ip=172.18.62.3, actor_id=7d0a08568fab681ba601f8f201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x154df422d430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3552294, ip=172.18.62.3, actor_id=7d0a08568fab681ba601f8f201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x154df422d430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2025-01-16 04:37:44,956][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=3552294, ip=172.18.62.3, actor_id=7d0a08568fab681ba601f8f201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x154df422d430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3552294, ip=172.18.62.3, actor_id=7d0a08568fab681ba601f8f201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x154df422d430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 2 failures
[2025-01-16 04:37:44,956][flwr][INFO] - aggregate_evaluate: received 0 results and 2 failures
[92mINFO [0m:      
[2025-01-16 04:37:44,957][flwr][INFO] - 
[92mINFO [0m:      [ROUND 8]
[2025-01-16 04:37:44,957][flwr][INFO] - [ROUND 8]
[92mINFO [0m:      configure_fit: strategy sampled 2 clients (out of 2)
[2025-01-16 04:37:44,957][flwr][INFO] - configure_fit: strategy sampled 2 clients (out of 2)
[92mINFO [0m:      aggregate_fit: received 2 results and 0 failures
[36m(ClientAppActor pid=3552295)[0m Entrei no validation 1 3[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=3552295)[0m epoch:  0
[36m(ClientAppActor pid=3552295)[0m train ious:  0.975385918207728
[36m(ClientAppActor pid=3552295)[0m train dice liver:  tensor(0.9836, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m train dice tumour:  tensor(0.6056, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m validation ious:  0.974751534077868
[36m(ClientAppActor pid=3552295)[0m validation dice liver:  tensor(0.9833, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m validation dice tumour:  tensor(0.6136, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m => new best model:  0
[36m(ClientAppActor pid=3552295)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3552295)[0m epoch:  1
[36m(ClientAppActor pid=3552295)[0m train ious:  0.97976007420879
[36m(ClientAppActor pid=3552295)[0m train dice liver:  tensor(0.9867, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m train dice tumour:  tensor(0.6253, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m validation ious:  0.9760341760682546
[36m(ClientAppActor pid=3552295)[0m validation dice liver:  tensor(0.9848, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m validation dice tumour:  tensor(0.6150, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m => new best model:  1
[36m(ClientAppActor pid=3552295)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3552295)[0m epoch:  2
[36m(ClientAppActor pid=3552295)[0m train ious:  0.9816303762760166
[36m(ClientAppActor pid=3552295)[0m train dice liver:  tensor(0.9880, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m train dice tumour:  tensor(0.6049, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m validation ious:  0.9760655122939208
[36m(ClientAppActor pid=3552295)[0m validation dice liver:  tensor(0.9856, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m validation dice tumour:  tensor(0.6198, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m => new best model:  2
[36m(ClientAppActor pid=3552295)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3552295)[0m epoch:  3
[36m(ClientAppActor pid=3552295)[0m train ious:  0.9825279430573818
[36m(ClientAppActor pid=3552295)[0m train dice liver:  tensor(0.9886, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m train dice tumour:  tensor(0.6299, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m validation ious:  0.975983470035428
[36m(ClientAppActor pid=3552295)[0m validation dice liver:  tensor(0.9858, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m validation dice tumour:  tensor(0.6207, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m => new best model:  3
[36m(ClientAppActor pid=3552294)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3552294)[0m epoch:  0
[36m(ClientAppActor pid=3552294)[0m train ious:  
[36m(ClientAppActor pid=3552294)[0m 0.9753626909413085
[36m(ClientAppActor pid=3552294)[0m train dice liver:  
[36m(ClientAppActor pid=3552294)[0m tensor(0.9845, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m train dice tumour:  tensor(0.7186, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m validation ious:  0.9707010987544455
[36m(ClientAppActor pid=3552294)[0m validation dice liver:  tensor(0.9832, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m validation dice tumour:  tensor(0.6943, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m => new best model:  0
[36m(ClientAppActor pid=3552294)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3552294)[0m epoch:  1
[36m(ClientAppActor pid=3552294)[0m train ious:  0.977562604603366
[36m(ClientAppActor pid=3552294)[0m train dice liver:  tensor(0.9859, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m train dice tumour:  tensor(0.7288, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m validation ious:  0.9704028303993506
[36m(ClientAppActor pid=3552294)[0m validation dice liver:  tensor(0.9826, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m validation dice tumour:  tensor(0.7001, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m => new best model:  1
[36m(ClientAppActor pid=3552294)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3552294)[0m epoch:  2
[36m(ClientAppActor pid=3552294)[0m train ious:  0.9764849066250332
[36m(ClientAppActor pid=3552294)[0m train dice liver:  tensor(0.9851, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m train dice tumour:  tensor(0.7183, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m validation ious:  0.9629448595461222
[36m(ClientAppActor pid=3552294)[0m validation dice liver:  tensor(0.9772, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m validation dice tumour:  tensor(0.6624, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m => new best model:  2
[36m(ClientAppActor pid=3552294)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3552294)[0m epoch:  3
[36m(ClientAppActor pid=3552294)[0m train ious:  0.9780369201555708
[36m(ClientAppActor pid=3552294)[0m train dice liver:  tensor(0.9862, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m train dice tumour:  tensor(0.7340, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m validation ious:  0.9713209795671608
[36m(ClientAppActor pid=3552294)[0m validation dice liver:  tensor(0.9837, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m validation dice tumour:  tensor(0.7010, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m => new best model:  3
[2025-01-16 07:10:07,228][flwr][INFO] - aggregate_fit: received 2 results and 0 failures
[92mINFO [0m:      fit progress: (8, 0.0031890360429200847, OrderedDict([('ind_iou_0', 0.9721105405669097), ('ind_dice_liver_0', tensor(0.9842, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7043, dtype=torch.float64)), ('ind_iou_1', 0.9758983016775155), ('ind_dice_liver_1', tensor(0.9850, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6168, dtype=torch.float64)), ('all_iou', 0.9725279226018884), ('all_dice_liver', tensor(0.9843, dtype=torch.float64)), ('all_dice_tumour', tensor(0.6988, dtype=torch.float64))]), 75172.65509520471)
Entrei no test
Meio do test
Fim do test
[2025-01-16 07:22:24,988][flwr][INFO] - fit progress: (8, 0.0031890360429200847, OrderedDict([('ind_iou_0', 0.9721105405669097), ('ind_dice_liver_0', tensor(0.9842, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7043, dtype=torch.float64)), ('ind_iou_1', 0.9758983016775155), ('ind_dice_liver_1', tensor(0.9850, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6168, dtype=torch.float64)), ('all_iou', 0.9725279226018884), ('all_dice_liver', tensor(0.9843, dtype=torch.float64)), ('all_dice_tumour', tensor(0.6988, dtype=torch.float64))]), 75172.65509520471)
[92mINFO [0m:      configure_evaluate: strategy sampled 2 clients (out of 2)
[2025-01-16 07:22:25,060][flwr][INFO] - configure_evaluate: strategy sampled 2 clients (out of 2)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3552295, ip=172.18.62.3, actor_id=3f52105c5cbc21879b66bbbb01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14f736741520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3552295, ip=172.18.62.3, actor_id=3f52105c5cbc21879b66bbbb01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14f736741520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[36m(ClientAppActor pid=3552295)[0m Entrei no validation 1 3
[2025-01-16 07:22:42,862][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3552295, ip=172.18.62.3, actor_id=3f52105c5cbc21879b66bbbb01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14f736741520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3552295, ip=172.18.62.3, actor_id=3f52105c5cbc21879b66bbbb01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14f736741520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=3552295, ip=172.18.62.3, actor_id=3f52105c5cbc21879b66bbbb01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14f736741520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3552295, ip=172.18.62.3, actor_id=3f52105c5cbc21879b66bbbb01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14f736741520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2025-01-16 07:22:42,862][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=3552295, ip=172.18.62.3, actor_id=3f52105c5cbc21879b66bbbb01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14f736741520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3552295, ip=172.18.62.3, actor_id=3f52105c5cbc21879b66bbbb01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14f736741520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3552294, ip=172.18.62.3, actor_id=7d0a08568fab681ba601f8f201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x154df422d430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3552294, ip=172.18.62.3, actor_id=7d0a08568fab681ba601f8f201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x154df422d430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2025-01-16 07:24:48,744][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3552294, ip=172.18.62.3, actor_id=7d0a08568fab681ba601f8f201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x154df422d430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3552294, ip=172.18.62.3, actor_id=7d0a08568fab681ba601f8f201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x154df422d430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=3552294, ip=172.18.62.3, actor_id=7d0a08568fab681ba601f8f201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x154df422d430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3552294, ip=172.18.62.3, actor_id=7d0a08568fab681ba601f8f201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x154df422d430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2025-01-16 07:24:48,745][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=3552294, ip=172.18.62.3, actor_id=7d0a08568fab681ba601f8f201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x154df422d430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3552294, ip=172.18.62.3, actor_id=7d0a08568fab681ba601f8f201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x154df422d430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 2 failures
[2025-01-16 07:24:48,746][flwr][INFO] - aggregate_evaluate: received 0 results and 2 failures
[92mINFO [0m:      
[2025-01-16 07:24:48,746][flwr][INFO] - 
[92mINFO [0m:      [ROUND 9]
[2025-01-16 07:24:48,746][flwr][INFO] - [ROUND 9]
[92mINFO [0m:      configure_fit: strategy sampled 2 clients (out of 2)
[2025-01-16 07:24:48,747][flwr][INFO] - configure_fit: strategy sampled 2 clients (out of 2)
[92mINFO [0m:      aggregate_fit: received 2 results and 0 failures
[36m(ClientAppActor pid=3552294)[0m Entrei no validation 1 3[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=3552294)[0m epoch:  0
[36m(ClientAppActor pid=3552294)[0m train ious:  0.9771261101022941
[36m(ClientAppActor pid=3552294)[0m train dice liver:  tensor(0.9849, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m train dice tumour:  tensor(0.5989, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m validation ious:  0.9758629991436549
[36m(ClientAppActor pid=3552294)[0m validation dice liver:  tensor(0.9847, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m validation dice tumour:  tensor(0.6146, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m => new best model:  0
[36m(ClientAppActor pid=3552294)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3552294)[0m epoch:  1
[36m(ClientAppActor pid=3552294)[0m train ious:  0.9805630453837466
[36m(ClientAppActor pid=3552294)[0m train dice liver:  tensor(0.9873, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m train dice tumour:  tensor(0.5896, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m validation ious:  0.9774633800830644
[36m(ClientAppActor pid=3552294)[0m validation dice liver:  tensor(0.9860, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m validation dice tumour:  tensor(0.6189, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m => new best model:  1
[36m(ClientAppActor pid=3552294)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3552294)[0m epoch:  2
[36m(ClientAppActor pid=3552294)[0m train ious:  0.982454083139592
[36m(ClientAppActor pid=3552294)[0m train dice liver:  tensor(0.9885, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m train dice tumour:  tensor(0.6428, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m validation ious:  0.976792531994755
[36m(ClientAppActor pid=3552294)[0m validation dice liver:  tensor(0.9863, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m validation dice tumour:  tensor(0.6165, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m => new best model:  2
[36m(ClientAppActor pid=3552294)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3552294)[0m epoch:  3
[36m(ClientAppActor pid=3552294)[0m train ious:  0.9835942122045801
[36m(ClientAppActor pid=3552294)[0m train dice liver:  tensor(0.9892, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m train dice tumour:  tensor(0.6211, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m validation ious:  0.9763599513006919
[36m(ClientAppActor pid=3552294)[0m validation dice liver:  tensor(0.9865, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m validation dice tumour:  tensor(0.6218, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m => new best model:  3
[36m(ClientAppActor pid=3552295)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3552295)[0m epoch:  0
[36m(ClientAppActor pid=3552295)[0m train ious:  0.9771168223361634
[36m(ClientAppActor pid=3552295)[0m train dice liver:  tensor(0.9855, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m train dice tumour:  tensor(0.7211, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m validation ious:  0.9720334921527424
[36m(ClientAppActor pid=3552295)[0m validation dice liver:  tensor(0.9840, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m validation dice tumour:  tensor(0.7057, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m => new best model:  0
[36m(ClientAppActor pid=3552295)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3552295)[0m epoch:  1
[36m(ClientAppActor pid=3552295)[0m train ious:  0.9792581096501489
[36m(ClientAppActor pid=3552295)[0m train dice liver:  tensor(0.9870, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m train dice tumour:  tensor(0.7389, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m validation ious:  0.9703066617467079
[36m(ClientAppActor pid=3552295)[0m validation dice liver:  tensor(0.9830, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m validation dice tumour:  tensor(0.6957, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m => new best model:  1
[36m(ClientAppActor pid=3552295)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3552295)[0m epoch:  2
[36m(ClientAppActor pid=3552295)[0m train ious:  0.9776078143080407
[36m(ClientAppActor pid=3552295)[0m train dice liver:  tensor(0.9860, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m train dice tumour:  tensor(0.7251, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m validation ious:  0.9722310983488675
[36m(ClientAppActor pid=3552295)[0m validation dice liver:  tensor(0.9840, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m validation dice tumour:  tensor(0.7063, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m => new best model:  2
[36m(ClientAppActor pid=3552295)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3552295)[0m epoch:  3
[36m(ClientAppActor pid=3552295)[0m train ious:  0.9793143061596212
[36m(ClientAppActor pid=3552295)[0m train dice liver:  tensor(0.9870, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m train dice tumour:  tensor(0.7271, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m validation ious:  0.9588571011595699
[36m(ClientAppActor pid=3552295)[0m validation dice liver:  tensor(0.9755, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m validation dice tumour:  tensor(0.6672, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m => new best model:  3
[2025-01-16 09:53:14,492][flwr][INFO] - aggregate_fit: received 2 results and 0 failures
[92mINFO [0m:      fit progress: (9, 0.004455766621390169, OrderedDict([('ind_iou_0', 0.9632196922448444), ('ind_dice_liver_0', tensor(0.9784, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.6810, dtype=torch.float64)), ('ind_iou_1', 0.9637084077403533), ('ind_dice_liver_1', tensor(0.9771, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5945, dtype=torch.float64)), ('all_iou', 0.9634389896255369), ('all_dice_liver', tensor(0.9783, dtype=torch.float64)), ('all_dice_tumour', tensor(0.6747, dtype=torch.float64))]), 84811.1289043203)
Entrei no test
Meio do test
Fim do test
[2025-01-16 10:03:03,462][flwr][INFO] - fit progress: (9, 0.004455766621390169, OrderedDict([('ind_iou_0', 0.9632196922448444), ('ind_dice_liver_0', tensor(0.9784, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.6810, dtype=torch.float64)), ('ind_iou_1', 0.9637084077403533), ('ind_dice_liver_1', tensor(0.9771, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.5945, dtype=torch.float64)), ('all_iou', 0.9634389896255369), ('all_dice_liver', tensor(0.9783, dtype=torch.float64)), ('all_dice_tumour', tensor(0.6747, dtype=torch.float64))]), 84811.1289043203)
[92mINFO [0m:      configure_evaluate: strategy sampled 2 clients (out of 2)
[2025-01-16 10:03:03,597][flwr][INFO] - configure_evaluate: strategy sampled 2 clients (out of 2)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3552295, ip=172.18.62.3, actor_id=3f52105c5cbc21879b66bbbb01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14f736741520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3552295, ip=172.18.62.3, actor_id=3f52105c5cbc21879b66bbbb01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14f736741520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[36m(ClientAppActor pid=3552294)[0m Entrei no validation 1 3
[2025-01-16 10:03:18,707][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3552295, ip=172.18.62.3, actor_id=3f52105c5cbc21879b66bbbb01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14f736741520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3552295, ip=172.18.62.3, actor_id=3f52105c5cbc21879b66bbbb01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14f736741520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=3552295, ip=172.18.62.3, actor_id=3f52105c5cbc21879b66bbbb01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14f736741520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3552295, ip=172.18.62.3, actor_id=3f52105c5cbc21879b66bbbb01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14f736741520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2025-01-16 10:03:18,708][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=3552295, ip=172.18.62.3, actor_id=3f52105c5cbc21879b66bbbb01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14f736741520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3552295, ip=172.18.62.3, actor_id=3f52105c5cbc21879b66bbbb01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14f736741520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3552294, ip=172.18.62.3, actor_id=7d0a08568fab681ba601f8f201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x154df422d430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3552294, ip=172.18.62.3, actor_id=7d0a08568fab681ba601f8f201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x154df422d430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[2025-01-16 10:04:57,189][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3552294, ip=172.18.62.3, actor_id=7d0a08568fab681ba601f8f201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x154df422d430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3552294, ip=172.18.62.3, actor_id=7d0a08568fab681ba601f8f201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x154df422d430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=3552294, ip=172.18.62.3, actor_id=7d0a08568fab681ba601f8f201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x154df422d430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3552294, ip=172.18.62.3, actor_id=7d0a08568fab681ba601f8f201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x154df422d430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2025-01-16 10:04:57,190][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=3552294, ip=172.18.62.3, actor_id=7d0a08568fab681ba601f8f201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x154df422d430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3552294, ip=172.18.62.3, actor_id=7d0a08568fab681ba601f8f201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x154df422d430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 2 failures
[2025-01-16 10:04:57,191][flwr][INFO] - aggregate_evaluate: received 0 results and 2 failures
[92mINFO [0m:      
[2025-01-16 10:04:57,191][flwr][INFO] - 
[92mINFO [0m:      [ROUND 10]
[2025-01-16 10:04:57,192][flwr][INFO] - [ROUND 10]
[92mINFO [0m:      configure_fit: strategy sampled 2 clients (out of 2)
[2025-01-16 10:04:57,192][flwr][INFO] - configure_fit: strategy sampled 2 clients (out of 2)
[92mINFO [0m:      aggregate_fit: received 2 results and 0 failures
[36m(ClientAppActor pid=3552294)[0m Entrei no validation 1 3[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=3552294)[0m epoch:  0
[36m(ClientAppActor pid=3552294)[0m train ious:  0.9769973095208344
[36m(ClientAppActor pid=3552294)[0m train dice liver:  tensor(0.9848, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m train dice tumour:  tensor(0.5785, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m validation ious:  0.9766882682575472
[36m(ClientAppActor pid=3552294)[0m validation dice liver:  tensor(0.9851, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m validation dice tumour:  tensor(0.6167, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m => new best model:  0
[36m(ClientAppActor pid=3552294)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3552294)[0m epoch:  1
[36m(ClientAppActor pid=3552294)[0m train ious:  0.9809842465532153
[36m(ClientAppActor pid=3552294)[0m train dice liver:  tensor(0.9874, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m train dice tumour:  tensor(0.6225, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m validation ious:  0.9769389549036718
[36m(ClientAppActor pid=3552294)[0m validation dice liver:  tensor(0.9858, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m validation dice tumour:  tensor(0.6241, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m => new best model:  1
[36m(ClientAppActor pid=3552294)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3552294)[0m epoch:  2
[36m(ClientAppActor pid=3552294)[0m train ious:  0.9825125074927041
[36m(ClientAppActor pid=3552294)[0m train dice liver:  tensor(0.9885, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m train dice tumour:  tensor(0.6170, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m validation ious:  0.9773074060606213
[36m(ClientAppActor pid=3552294)[0m validation dice liver:  tensor(0.9863, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m validation dice tumour:  tensor(0.6172, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m => new best model:  2
[36m(ClientAppActor pid=3552294)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3552294)[0m epoch:  3
[36m(ClientAppActor pid=3552294)[0m train ious:  0.9837213595077489
[36m(ClientAppActor pid=3552294)[0m train dice liver:  tensor(0.9893, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m train dice tumour:  tensor(0.6497, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m validation ious:  0.9774023298667153
[36m(ClientAppActor pid=3552294)[0m validation dice liver:  tensor(0.9867, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m validation dice tumour:  tensor(0.6280, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m => new best model:  3
[36m(ClientAppActor pid=3552295)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3552295)[0m epoch:  0
[36m(ClientAppActor pid=3552295)[0m train ious:  0.9794141124232973
[36m(ClientAppActor pid=3552295)[0m train dice liver:  tensor(0.9871, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m train dice tumour:  tensor(0.7331, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m validation ious:  0.9722961275148958
[36m(ClientAppActor pid=3552295)[0m validation dice liver:  tensor(0.9845, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m validation dice tumour:  tensor(0.6979, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m => new best model:  0
[36m(ClientAppActor pid=3552295)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3552295)[0m epoch:  1
[36m(ClientAppActor pid=3552295)[0m train ious:  
[36m(ClientAppActor pid=3552295)[0m 0.9781207230380103
[36m(ClientAppActor pid=3552295)[0m train dice liver:  tensor(0.9861, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m train dice tumour:  tensor(0.7244, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m validation ious:  0.9727265324014278
[36m(ClientAppActor pid=3552295)[0m validation dice liver:  tensor(0.9846, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m validation dice tumour:  tensor(0.7056, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m => new best model:  1
[36m(ClientAppActor pid=3552295)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3552295)[0m epoch:  2
[36m(ClientAppActor pid=3552295)[0m train ious:  0.9807064181137807
[36m(ClientAppActor pid=3552295)[0m train dice liver:  
[36m(ClientAppActor pid=3552295)[0m tensor(0.9879, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m train dice tumour:  tensor(0.7417, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m validation ious:  0.972281879466797
[36m(ClientAppActor pid=3552295)[0m validation dice liver:  tensor(0.9843, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m validation dice tumour:  tensor(0.7032, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m => new best model:  2
[36m(ClientAppActor pid=3552295)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3552295)[0m epoch:  3
[36m(ClientAppActor pid=3552295)[0m train ious:  
[36m(ClientAppActor pid=3552295)[0m 0.9797039484201613
[36m(ClientAppActor pid=3552295)[0m train dice liver:  
[36m(ClientAppActor pid=3552295)[0m tensor(0.9872, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m train dice tumour:  tensor(0.7414, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m validation ious:  0.9725625716853676
[36m(ClientAppActor pid=3552295)[0m validation dice liver:  tensor(0.9845, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m validation dice tumour:  tensor(0.7052, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m => new best model:  3
[2025-01-16 12:21:42,191][flwr][INFO] - aggregate_fit: received 2 results and 0 failures
[92mINFO [0m:      fit progress: (10, 0.003068926351922304, OrderedDict([('ind_iou_0', 0.9733627392815208), ('ind_dice_liver_0', tensor(0.9850, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7098, dtype=torch.float64)), ('ind_iou_1', 0.9773783003048186), ('ind_dice_liver_1', tensor(0.9860, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6258, dtype=torch.float64)), ('all_iou', 0.9738059218082862), ('all_dice_liver', tensor(0.9852, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7043, dtype=torch.float64))]), 93521.41476725414)
Entrei no test
Meio do test
Fim do test
[2025-01-16 12:28:13,748][flwr][INFO] - fit progress: (10, 0.003068926351922304, OrderedDict([('ind_iou_0', 0.9733627392815208), ('ind_dice_liver_0', tensor(0.9850, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7098, dtype=torch.float64)), ('ind_iou_1', 0.9773783003048186), ('ind_dice_liver_1', tensor(0.9860, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6258, dtype=torch.float64)), ('all_iou', 0.9738059218082862), ('all_dice_liver', tensor(0.9852, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7043, dtype=torch.float64))]), 93521.41476725414)
[92mINFO [0m:      configure_evaluate: strategy sampled 2 clients (out of 2)
[2025-01-16 12:28:13,837][flwr][INFO] - configure_evaluate: strategy sampled 2 clients (out of 2)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3552294, ip=172.18.62.3, actor_id=7d0a08568fab681ba601f8f201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x154df422d430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3552294, ip=172.18.62.3, actor_id=7d0a08568fab681ba601f8f201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x154df422d430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[36m(ClientAppActor pid=3552295)[0m Entrei no validation 1 3
[2025-01-16 12:28:26,187][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3552294, ip=172.18.62.3, actor_id=7d0a08568fab681ba601f8f201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x154df422d430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3552294, ip=172.18.62.3, actor_id=7d0a08568fab681ba601f8f201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x154df422d430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=3552294, ip=172.18.62.3, actor_id=7d0a08568fab681ba601f8f201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x154df422d430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3552294, ip=172.18.62.3, actor_id=7d0a08568fab681ba601f8f201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x154df422d430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2025-01-16 12:28:26,188][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=3552294, ip=172.18.62.3, actor_id=7d0a08568fab681ba601f8f201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x154df422d430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3552294, ip=172.18.62.3, actor_id=7d0a08568fab681ba601f8f201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x154df422d430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3552295, ip=172.18.62.3, actor_id=3f52105c5cbc21879b66bbbb01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14f736741520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3552295, ip=172.18.62.3, actor_id=3f52105c5cbc21879b66bbbb01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14f736741520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[2025-01-16 12:29:35,199][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3552295, ip=172.18.62.3, actor_id=3f52105c5cbc21879b66bbbb01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14f736741520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3552295, ip=172.18.62.3, actor_id=3f52105c5cbc21879b66bbbb01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14f736741520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=3552295, ip=172.18.62.3, actor_id=3f52105c5cbc21879b66bbbb01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14f736741520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3552295, ip=172.18.62.3, actor_id=3f52105c5cbc21879b66bbbb01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14f736741520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2025-01-16 12:29:35,199][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=3552295, ip=172.18.62.3, actor_id=3f52105c5cbc21879b66bbbb01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14f736741520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3552295, ip=172.18.62.3, actor_id=3f52105c5cbc21879b66bbbb01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14f736741520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 2 failures
[2025-01-16 12:29:35,199][flwr][INFO] - aggregate_evaluate: received 0 results and 2 failures
[92mINFO [0m:      
[2025-01-16 12:29:35,200][flwr][INFO] - 
[92mINFO [0m:      [ROUND 11]
[2025-01-16 12:29:35,200][flwr][INFO] - [ROUND 11]
[92mINFO [0m:      configure_fit: strategy sampled 2 clients (out of 2)
[2025-01-16 12:29:35,200][flwr][INFO] - configure_fit: strategy sampled 2 clients (out of 2)
[92mINFO [0m:      aggregate_fit: received 2 results and 0 failures
[36m(ClientAppActor pid=3552294)[0m Entrei no validation 1 3[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=3552294)[0m epoch:  0
[36m(ClientAppActor pid=3552294)[0m train ious:  0.9794668902858099
[36m(ClientAppActor pid=3552294)[0m train dice liver:  tensor(0.9865, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m train dice tumour:  tensor(0.6190, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m validation ious:  0.9779627908609735
[36m(ClientAppActor pid=3552294)[0m validation dice liver:  tensor(0.9859, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m validation dice tumour:  tensor(0.6272, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m => new best model:  0
[36m(ClientAppActor pid=3552294)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3552294)[0m epoch:  1
[36m(ClientAppActor pid=3552294)[0m train ious:  0.9825861358045094
[36m(ClientAppActor pid=3552294)[0m train dice liver:  tensor(0.9886, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m train dice tumour:  tensor(0.6383, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m validation ious:  0.9783814590690924
[36m(ClientAppActor pid=3552294)[0m validation dice liver:  tensor(0.9869, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m validation dice tumour:  tensor(0.6286, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m => new best model:  1
[36m(ClientAppActor pid=3552294)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3552294)[0m epoch:  2
[36m(ClientAppActor pid=3552294)[0m train ious:  0.9843909069938402
[36m(ClientAppActor pid=3552294)[0m train dice liver:  tensor(0.9897, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m train dice tumour:  tensor(0.6062, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m validation ious:  0.978986273382249
[36m(ClientAppActor pid=3552294)[0m validation dice liver:  tensor(0.9875, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m validation dice tumour:  tensor(0.6312, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m => new best model:  2
[36m(ClientAppActor pid=3552294)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3552294)[0m epoch:  3
[36m(ClientAppActor pid=3552294)[0m train ious:  0.9851399753979199
[36m(ClientAppActor pid=3552294)[0m train dice liver:  tensor(0.9903, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m train dice tumour:  tensor(0.6375, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m validation ious:  0.9774285900545797
[36m(ClientAppActor pid=3552294)[0m validation dice liver:  tensor(0.9872, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m validation dice tumour:  tensor(0.6225, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m => new best model:  3
[36m(ClientAppActor pid=3552295)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3552295)[0m epoch:  0
[36m(ClientAppActor pid=3552295)[0m train ious:  0.9805873794309505
[36m(ClientAppActor pid=3552295)[0m train dice liver:  
[36m(ClientAppActor pid=3552295)[0m tensor(0.9878, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m train dice tumour:  tensor(0.7422, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m validation ious:  0.9722487806745126
[36m(ClientAppActor pid=3552295)[0m validation dice liver:  tensor(0.9844, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m validation dice tumour:  tensor(0.7068, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m => new best model:  0
[36m(ClientAppActor pid=3552295)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3552295)[0m epoch:  1
[36m(ClientAppActor pid=3552295)[0m train ious:  0.9803516641624246
[36m(ClientAppActor pid=3552295)[0m train dice liver:  
[36m(ClientAppActor pid=3552295)[0m tensor(0.9876, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m train dice tumour:  tensor(0.7400, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m validation ious:  0.9728588308154182
[36m(ClientAppActor pid=3552295)[0m validation dice liver:  tensor(0.9847, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m validation dice tumour:  tensor(0.7087, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m => new best model:  1
[36m(ClientAppActor pid=3552295)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3552295)[0m epoch:  2
[36m(ClientAppActor pid=3552295)[0m train ious:  0.9812325296344062
[36m(ClientAppActor pid=3552295)[0m train dice liver:  tensor(0.9882, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m train dice tumour:  tensor(0.7455, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m validation ious:  0.9728133500877267
[36m(ClientAppActor pid=3552295)[0m validation dice liver:  tensor(0.9847, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m validation dice tumour:  tensor(0.7111, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m => new best model:  2
[36m(ClientAppActor pid=3552295)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3552295)[0m epoch:  3
[36m(ClientAppActor pid=3552295)[0m train ious:  0.9814333974345852
[36m(ClientAppActor pid=3552295)[0m train dice liver:  
[36m(ClientAppActor pid=3552295)[0m tensor(0.9884, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m train dice tumour:  tensor(0.7400, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m validation ious:  0.9669773232107064
[36m(ClientAppActor pid=3552295)[0m validation dice liver:  tensor(0.9815, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m validation dice tumour:  tensor(0.6957, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m => new best model:  3
[2025-01-16 14:11:56,902][flwr][INFO] - aggregate_fit: received 2 results and 0 failures
[92mINFO [0m:      fit progress: (11, 0.003633854584325455, OrderedDict([('ind_iou_0', 0.9698191641442093), ('ind_dice_liver_0', tensor(0.9831, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7032, dtype=torch.float64)), ('ind_iou_1', 0.9732479015913795), ('ind_dice_liver_1', tensor(0.9839, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6200, dtype=torch.float64)), ('all_iou', 0.9701697231383848), ('all_dice_liver', tensor(0.9832, dtype=torch.float64)), ('all_dice_tumour', tensor(0.6977, dtype=torch.float64))]), 100146.42920617387)
Entrei no test
Meio do test
Fim do test
[2025-01-16 14:18:38,762][flwr][INFO] - fit progress: (11, 0.003633854584325455, OrderedDict([('ind_iou_0', 0.9698191641442093), ('ind_dice_liver_0', tensor(0.9831, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7032, dtype=torch.float64)), ('ind_iou_1', 0.9732479015913795), ('ind_dice_liver_1', tensor(0.9839, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6200, dtype=torch.float64)), ('all_iou', 0.9701697231383848), ('all_dice_liver', tensor(0.9832, dtype=torch.float64)), ('all_dice_tumour', tensor(0.6977, dtype=torch.float64))]), 100146.42920617387)
[92mINFO [0m:      configure_evaluate: strategy sampled 2 clients (out of 2)
[2025-01-16 14:18:38,853][flwr][INFO] - configure_evaluate: strategy sampled 2 clients (out of 2)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3552294, ip=172.18.62.3, actor_id=7d0a08568fab681ba601f8f201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x154df422d430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3552294, ip=172.18.62.3, actor_id=7d0a08568fab681ba601f8f201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x154df422d430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[36m(ClientAppActor pid=3552294)[0m Entrei no validation 1 3
[2025-01-16 14:18:51,666][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3552294, ip=172.18.62.3, actor_id=7d0a08568fab681ba601f8f201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x154df422d430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3552294, ip=172.18.62.3, actor_id=7d0a08568fab681ba601f8f201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x154df422d430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=3552294, ip=172.18.62.3, actor_id=7d0a08568fab681ba601f8f201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x154df422d430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3552294, ip=172.18.62.3, actor_id=7d0a08568fab681ba601f8f201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x154df422d430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2025-01-16 14:18:51,667][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=3552294, ip=172.18.62.3, actor_id=7d0a08568fab681ba601f8f201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x154df422d430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3552294, ip=172.18.62.3, actor_id=7d0a08568fab681ba601f8f201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x154df422d430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3552295, ip=172.18.62.3, actor_id=3f52105c5cbc21879b66bbbb01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14f736741520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3552295, ip=172.18.62.3, actor_id=3f52105c5cbc21879b66bbbb01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14f736741520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[2025-01-16 14:20:00,752][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3552295, ip=172.18.62.3, actor_id=3f52105c5cbc21879b66bbbb01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14f736741520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3552295, ip=172.18.62.3, actor_id=3f52105c5cbc21879b66bbbb01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14f736741520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=3552295, ip=172.18.62.3, actor_id=3f52105c5cbc21879b66bbbb01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14f736741520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3552295, ip=172.18.62.3, actor_id=3f52105c5cbc21879b66bbbb01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14f736741520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2025-01-16 14:20:00,752][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=3552295, ip=172.18.62.3, actor_id=3f52105c5cbc21879b66bbbb01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14f736741520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3552295, ip=172.18.62.3, actor_id=3f52105c5cbc21879b66bbbb01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14f736741520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 2 failures
[2025-01-16 14:20:00,753][flwr][INFO] - aggregate_evaluate: received 0 results and 2 failures
[92mINFO [0m:      
[2025-01-16 14:20:00,753][flwr][INFO] - 
[92mINFO [0m:      [ROUND 12]
[2025-01-16 14:20:00,753][flwr][INFO] - [ROUND 12]
[92mINFO [0m:      configure_fit: strategy sampled 2 clients (out of 2)
[2025-01-16 14:20:00,753][flwr][INFO] - configure_fit: strategy sampled 2 clients (out of 2)
[92mINFO [0m:      aggregate_fit: received 2 results and 0 failures
[36m(ClientAppActor pid=3552295)[0m Entrei no validation 1 3[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=3552295)[0m epoch:  0
[36m(ClientAppActor pid=3552295)[0m train ious:  0.9802330094439422
[36m(ClientAppActor pid=3552295)[0m train dice liver:  tensor(0.9870, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m train dice tumour:  tensor(0.6271, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m validation ious:  0.9794105184699026
[36m(ClientAppActor pid=3552295)[0m validation dice liver:  tensor(0.9870, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m validation dice tumour:  tensor(0.6272, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m => new best model:  0
[36m(ClientAppActor pid=3552295)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3552295)[0m epoch:  1
[36m(ClientAppActor pid=3552295)[0m train ious:  0.9833216818806197
[36m(ClientAppActor pid=3552295)[0m train dice liver:  
[36m(ClientAppActor pid=3552295)[0m tensor(0.9890, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m train dice tumour:  tensor(0.6370, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m validation ious:  0.9792363586536695
[36m(ClientAppActor pid=3552295)[0m validation dice liver:  tensor(0.9874, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m validation dice tumour:  tensor(0.6319, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m => new best model:  1
[36m(ClientAppActor pid=3552295)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3552295)[0m epoch:  2
[36m(ClientAppActor pid=3552295)[0m train ious:  0.9843827483561143
[36m(ClientAppActor pid=3552295)[0m train dice liver:  tensor(0.9899, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m train dice tumour:  tensor(0.6352, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m validation ious:  0.9789428919995414
[36m(ClientAppActor pid=3552295)[0m validation dice liver:  tensor(0.9873, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m validation dice tumour:  tensor(0.6255, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m => new best model:  2
[36m(ClientAppActor pid=3552295)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3552295)[0m epoch:  3
[36m(ClientAppActor pid=3552295)[0m train ious:  0.9846916908213754
[36m(ClientAppActor pid=3552295)[0m train dice liver:  tensor(0.9899, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m train dice tumour:  tensor(0.6407, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m validation ious:  0.9798472556844272
[36m(ClientAppActor pid=3552295)[0m validation dice liver:  tensor(0.9882, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m validation dice tumour:  tensor(0.6408, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m => new best model:  3
[36m(ClientAppActor pid=3552294)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3552294)[0m epoch:  0
[36m(ClientAppActor pid=3552294)[0m train ious:  0.9819925281449989
[36m(ClientAppActor pid=3552294)[0m train dice liver:  tensor(0.9887, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m train dice tumour:  tensor(0.7361, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m validation ious:  0.9731235029298484
[36m(ClientAppActor pid=3552294)[0m validation dice liver:  tensor(0.9849, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m validation dice tumour:  tensor(0.7063, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m => new best model:  0
[36m(ClientAppActor pid=3552294)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3552294)[0m epoch:  1
[36m(ClientAppActor pid=3552294)[0m train ious:  0.9820059645558317
[36m(ClientAppActor pid=3552294)[0m train dice liver:  
[36m(ClientAppActor pid=3552294)[0m tensor(0.9887, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m train dice tumour:  tensor(0.7469, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m validation ious:  0.9732109792601372
[36m(ClientAppActor pid=3552294)[0m validation dice liver:  tensor(0.9851, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m validation dice tumour:  tensor(0.7049, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m => new best model:  1
[36m(ClientAppActor pid=3552294)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3552294)[0m epoch:  2
[36m(ClientAppActor pid=3552294)[0m train ious:  0.9819877108965221
[36m(ClientAppActor pid=3552294)[0m train dice liver:  tensor(0.9888, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m train dice tumour:  tensor(0.7387, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m validation ious:  0.9731730263690525
[36m(ClientAppActor pid=3552294)[0m validation dice liver:  tensor(0.9851, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m validation dice tumour:  tensor(0.7041, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m => new best model:  2
[36m(ClientAppActor pid=3552294)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3552294)[0m epoch:  3
[36m(ClientAppActor pid=3552294)[0m train ious:  0.9821426790210213
[36m(ClientAppActor pid=3552294)[0m train dice liver:  
[36m(ClientAppActor pid=3552294)[0m tensor(0.9888, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m train dice tumour:  tensor(0.7519, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m validation ious:  0.9741311092481444
[36m(ClientAppActor pid=3552294)[0m validation dice liver:  tensor(0.9856, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m validation dice tumour:  tensor(0.7098, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m => new best model:  3
[2025-01-16 15:54:32,836][flwr][INFO] - aggregate_fit: received 2 results and 0 failures
[92mINFO [0m:      fit progress: (12, 0.002963485148393158, OrderedDict([('ind_iou_0', 0.9749198458362323), ('ind_dice_liver_0', tensor(0.9861, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7134, dtype=torch.float64)), ('ind_iou_1', 0.9796099355837032), ('ind_dice_liver_1', tensor(0.9875, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6312, dtype=torch.float64)), ('all_iou', 0.9753995768437698), ('all_dice_liver', tensor(0.9862, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7087, dtype=torch.float64))]), 106712.47599909641)
Entrei no test
Meio do test
Fim do test
[2025-01-16 16:08:04,809][flwr][INFO] - fit progress: (12, 0.002963485148393158, OrderedDict([('ind_iou_0', 0.9749198458362323), ('ind_dice_liver_0', tensor(0.9861, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7134, dtype=torch.float64)), ('ind_iou_1', 0.9796099355837032), ('ind_dice_liver_1', tensor(0.9875, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6312, dtype=torch.float64)), ('all_iou', 0.9753995768437698), ('all_dice_liver', tensor(0.9862, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7087, dtype=torch.float64))]), 106712.47599909641)
[92mINFO [0m:      configure_evaluate: strategy sampled 2 clients (out of 2)
[2025-01-16 16:08:04,895][flwr][INFO] - configure_evaluate: strategy sampled 2 clients (out of 2)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3552295, ip=172.18.62.3, actor_id=3f52105c5cbc21879b66bbbb01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14f736741520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3552295, ip=172.18.62.3, actor_id=3f52105c5cbc21879b66bbbb01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14f736741520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[36m(ClientAppActor pid=3552294)[0m Entrei no validation 1 3
[2025-01-16 16:08:17,135][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3552295, ip=172.18.62.3, actor_id=3f52105c5cbc21879b66bbbb01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14f736741520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3552295, ip=172.18.62.3, actor_id=3f52105c5cbc21879b66bbbb01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14f736741520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=3552295, ip=172.18.62.3, actor_id=3f52105c5cbc21879b66bbbb01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14f736741520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3552295, ip=172.18.62.3, actor_id=3f52105c5cbc21879b66bbbb01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14f736741520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2025-01-16 16:08:17,136][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=3552295, ip=172.18.62.3, actor_id=3f52105c5cbc21879b66bbbb01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14f736741520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3552295, ip=172.18.62.3, actor_id=3f52105c5cbc21879b66bbbb01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14f736741520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3552294, ip=172.18.62.3, actor_id=7d0a08568fab681ba601f8f201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x154df422d430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3552294, ip=172.18.62.3, actor_id=7d0a08568fab681ba601f8f201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x154df422d430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[2025-01-16 16:09:31,286][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3552294, ip=172.18.62.3, actor_id=7d0a08568fab681ba601f8f201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x154df422d430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3552294, ip=172.18.62.3, actor_id=7d0a08568fab681ba601f8f201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x154df422d430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=3552294, ip=172.18.62.3, actor_id=7d0a08568fab681ba601f8f201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x154df422d430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3552294, ip=172.18.62.3, actor_id=7d0a08568fab681ba601f8f201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x154df422d430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2025-01-16 16:09:31,286][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=3552294, ip=172.18.62.3, actor_id=7d0a08568fab681ba601f8f201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x154df422d430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3552294, ip=172.18.62.3, actor_id=7d0a08568fab681ba601f8f201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x154df422d430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 2 failures
[2025-01-16 16:09:31,287][flwr][INFO] - aggregate_evaluate: received 0 results and 2 failures
[92mINFO [0m:      
[2025-01-16 16:09:31,287][flwr][INFO] - 
[92mINFO [0m:      [ROUND 13]
[2025-01-16 16:09:31,287][flwr][INFO] - [ROUND 13]
[92mINFO [0m:      configure_fit: strategy sampled 2 clients (out of 2)
[2025-01-16 16:09:31,287][flwr][INFO] - configure_fit: strategy sampled 2 clients (out of 2)
[92mINFO [0m:      aggregate_fit: received 2 results and 0 failures
[36m(ClientAppActor pid=3552294)[0m Entrei no validation 1 3[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=3552294)[0m epoch:  0
[36m(ClientAppActor pid=3552294)[0m train ious:  0.9812711924306486
[36m(ClientAppActor pid=3552294)[0m train dice liver:  tensor(0.9877, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m train dice tumour:  tensor(0.5919, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m validation ious:  0.979488999317514
[36m(ClientAppActor pid=3552294)[0m validation dice liver:  tensor(0.9864, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m validation dice tumour:  tensor(0.6346, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m => new best model:  0
[36m(ClientAppActor pid=3552294)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3552294)[0m epoch:  1
[36m(ClientAppActor pid=3552294)[0m train ious:  0.9835924813663552
[36m(ClientAppActor pid=3552294)[0m train dice liver:  tensor(0.9891, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m train dice tumour:  tensor(0.6174, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m validation ious:  0.9799728299923176
[36m(ClientAppActor pid=3552294)[0m validation dice liver:  tensor(0.9876, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m validation dice tumour:  tensor(0.6394, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m => new best model:  1
[36m(ClientAppActor pid=3552294)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3552294)[0m epoch:  2
[36m(ClientAppActor pid=3552294)[0m train ious:  0.9851125833700793
[36m(ClientAppActor pid=3552294)[0m train dice liver:  tensor(0.9902, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m train dice tumour:  tensor(0.6352, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m validation ious:  0.9790909375912463
[36m(ClientAppActor pid=3552294)[0m validation dice liver:  tensor(0.9879, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m validation dice tumour:  tensor(0.6300, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m => new best model:  2
[36m(ClientAppActor pid=3552294)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3552294)[0m epoch:  3
[36m(ClientAppActor pid=3552294)[0m train ious:  0.9862110439870806
[36m(ClientAppActor pid=3552294)[0m train dice liver:  tensor(0.9909, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m train dice tumour:  tensor(0.6483, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m validation ious:  0.980210618647639
[36m(ClientAppActor pid=3552294)[0m validation dice liver:  tensor(0.9886, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m validation dice tumour:  tensor(0.6360, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m => new best model:  3
[36m(ClientAppActor pid=3552295)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3552295)[0m epoch:  0
[36m(ClientAppActor pid=3552295)[0m train ious:  0.9825176017849268
[36m(ClientAppActor pid=3552295)[0m train dice liver:  tensor(0.9889, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m train dice tumour:  tensor(0.7531, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m validation ious:  0.9742715213215184
[36m(ClientAppActor pid=3552295)[0m validation dice liver:  tensor(0.9860, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m validation dice tumour:  tensor(0.7103, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m => new best model:  0
[36m(ClientAppActor pid=3552295)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3552295)[0m epoch:  1
[36m(ClientAppActor pid=3552295)[0m train ious:  0.9815813331539708
[36m(ClientAppActor pid=3552295)[0m train dice liver:  
[36m(ClientAppActor pid=3552295)[0m tensor(0.9884, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m train dice tumour:  tensor(0.7450, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m validation ious:  0.9744342703433048
[36m(ClientAppActor pid=3552295)[0m validation dice liver:  tensor(0.9858, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m validation dice tumour:  tensor(0.7139, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m => new best model:  1
[36m(ClientAppActor pid=3552295)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3552295)[0m epoch:  2
[36m(ClientAppActor pid=3552295)[0m train ious:  0.981749941631446
[36m(ClientAppActor pid=3552295)[0m train dice liver:  tensor(0.9884, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m train dice tumour:  tensor(0.7526, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m validation ious:  0.9707393463312324
[36m(ClientAppActor pid=3552295)[0m validation dice liver:  tensor(0.9832, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m validation dice tumour:  tensor(0.6952, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m => new best model:  2
[36m(ClientAppActor pid=3552295)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3552295)[0m epoch:  3
[36m(ClientAppActor pid=3552295)[0m train ious:  
[36m(ClientAppActor pid=3552295)[0m 0.9834220546985032
[36m(ClientAppActor pid=3552295)[0m train dice liver:  
[36m(ClientAppActor pid=3552295)[0m tensor(0.9896, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m train dice tumour:  tensor(0.7425, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m validation ious:  0.9747123089661015
[36m(ClientAppActor pid=3552295)[0m validation dice liver:  tensor(0.9862, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m validation dice tumour:  tensor(0.7176, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m => new best model:  3
[2025-01-16 18:16:42,133][flwr][INFO] - aggregate_fit: received 2 results and 0 failures
[92mINFO [0m:      fit progress: (13, 0.0029528355450722677, OrderedDict([('ind_iou_0', 0.9753741824577855), ('ind_dice_liver_0', tensor(0.9866, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7208, dtype=torch.float64)), ('ind_iou_1', 0.9805341186483733), ('ind_dice_liver_1', tensor(0.9882, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6387, dtype=torch.float64)), ('all_iou', 0.975902657592119), ('all_dice_liver', tensor(0.9868, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7157, dtype=torch.float64))]), 115167.14680731483)
Entrei no test
Meio do test
Fim do test
[2025-01-16 18:28:59,480][flwr][INFO] - fit progress: (13, 0.0029528355450722677, OrderedDict([('ind_iou_0', 0.9753741824577855), ('ind_dice_liver_0', tensor(0.9866, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7208, dtype=torch.float64)), ('ind_iou_1', 0.9805341186483733), ('ind_dice_liver_1', tensor(0.9882, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6387, dtype=torch.float64)), ('all_iou', 0.975902657592119), ('all_dice_liver', tensor(0.9868, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7157, dtype=torch.float64))]), 115167.14680731483)
[92mINFO [0m:      configure_evaluate: strategy sampled 2 clients (out of 2)
[2025-01-16 18:28:59,586][flwr][INFO] - configure_evaluate: strategy sampled 2 clients (out of 2)
[36m(ClientAppActor pid=3552294)[0m Entrei no validation 1 3
[2025-01-16 18:29:13,082][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3552295, ip=172.18.62.3, actor_id=3f52105c5cbc21879b66bbbb01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14f736741520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3552295, ip=172.18.62.3, actor_id=3f52105c5cbc21879b66bbbb01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14f736741520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3552295, ip=172.18.62.3, actor_id=3f52105c5cbc21879b66bbbb01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14f736741520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3552295, ip=172.18.62.3, actor_id=3f52105c5cbc21879b66bbbb01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14f736741520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2025-01-16 18:29:13,082][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=3552295, ip=172.18.62.3, actor_id=3f52105c5cbc21879b66bbbb01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14f736741520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3552295, ip=172.18.62.3, actor_id=3f52105c5cbc21879b66bbbb01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14f736741520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=3552295, ip=172.18.62.3, actor_id=3f52105c5cbc21879b66bbbb01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14f736741520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3552295, ip=172.18.62.3, actor_id=3f52105c5cbc21879b66bbbb01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14f736741520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3552294, ip=172.18.62.3, actor_id=7d0a08568fab681ba601f8f201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x154df422d430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3552294, ip=172.18.62.3, actor_id=7d0a08568fab681ba601f8f201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x154df422d430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2025-01-16 18:30:37,607][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3552294, ip=172.18.62.3, actor_id=7d0a08568fab681ba601f8f201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x154df422d430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3552294, ip=172.18.62.3, actor_id=7d0a08568fab681ba601f8f201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x154df422d430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=3552294, ip=172.18.62.3, actor_id=7d0a08568fab681ba601f8f201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x154df422d430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3552294, ip=172.18.62.3, actor_id=7d0a08568fab681ba601f8f201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x154df422d430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2025-01-16 18:30:37,609][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=3552294, ip=172.18.62.3, actor_id=7d0a08568fab681ba601f8f201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x154df422d430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3552294, ip=172.18.62.3, actor_id=7d0a08568fab681ba601f8f201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x154df422d430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 2 failures
[2025-01-16 18:30:37,610][flwr][INFO] - aggregate_evaluate: received 0 results and 2 failures
[92mINFO [0m:      
[2025-01-16 18:30:37,610][flwr][INFO] - 
[92mINFO [0m:      [ROUND 14]
[2025-01-16 18:30:37,610][flwr][INFO] - [ROUND 14]
[92mINFO [0m:      configure_fit: strategy sampled 2 clients (out of 2)
[2025-01-16 18:30:37,611][flwr][INFO] - configure_fit: strategy sampled 2 clients (out of 2)
[92mINFO [0m:      aggregate_fit: received 2 results and 0 failures
[36m(ClientAppActor pid=3552295)[0m Entrei no validation 1 3[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=3552295)[0m epoch:  0
[36m(ClientAppActor pid=3552295)[0m train ious:  0.9815997729839799
[36m(ClientAppActor pid=3552295)[0m train dice liver:  tensor(0.9879, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m train dice tumour:  tensor(0.6104, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m validation ious:  0.9800598062419564
[36m(ClientAppActor pid=3552295)[0m validation dice liver:  tensor(0.9873, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m validation dice tumour:  tensor(0.6370, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m => new best model:  0
[36m(ClientAppActor pid=3552295)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3552295)[0m epoch:  1
[36m(ClientAppActor pid=3552295)[0m train ious:  0.9843737545581641
[36m(ClientAppActor pid=3552295)[0m train dice liver:  
[36m(ClientAppActor pid=3552295)[0m tensor(0.9896, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m train dice tumour:  tensor(0.6393, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m validation ious:  0.98071460420903
[36m(ClientAppActor pid=3552295)[0m validation dice liver:  tensor(0.9883, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m validation dice tumour:  tensor(0.6371, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m => new best model:  1
[36m(ClientAppActor pid=3552295)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3552295)[0m epoch:  2
[36m(ClientAppActor pid=3552295)[0m train ious:  0.9858826983047865
[36m(ClientAppActor pid=3552295)[0m train dice liver:  tensor(0.9907, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m train dice tumour:  tensor(0.6436, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m validation ious:  0.9801341850033047
[36m(ClientAppActor pid=3552295)[0m validation dice liver:  tensor(0.9880, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m validation dice tumour:  tensor(0.6342, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m => new best model:  2
[36m(ClientAppActor pid=3552295)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3552295)[0m epoch:  3
[36m(ClientAppActor pid=3552295)[0m train ious:  0.9859638614068932
[36m(ClientAppActor pid=3552295)[0m train dice liver:  tensor(0.9908, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m train dice tumour:  tensor(0.6613, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m validation ious:  0.9809892295722603
[36m(ClientAppActor pid=3552295)[0m validation dice liver:  tensor(0.9888, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m validation dice tumour:  tensor(0.6343, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m => new best model:  3
[36m(ClientAppActor pid=3552294)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3552294)[0m epoch:  0
[36m(ClientAppActor pid=3552294)[0m train ious:  0.9833280312771026
[36m(ClientAppActor pid=3552294)[0m train dice liver:  
[36m(ClientAppActor pid=3552294)[0m tensor(0.9896, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m train dice tumour:  tensor(0.7538, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m validation ious:  0.9744325738818871
[36m(ClientAppActor pid=3552294)[0m validation dice liver:  tensor(0.9860, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m validation dice tumour:  tensor(0.7172, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m => new best model:  0
[36m(ClientAppActor pid=3552294)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3552294)[0m epoch:  1
[36m(ClientAppActor pid=3552294)[0m train ious:  0.9832555924517209
[36m(ClientAppActor pid=3552294)[0m train dice liver:  
[36m(ClientAppActor pid=3552294)[0m tensor(0.9895, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m train dice tumour:  tensor(0.7589, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m validation ious:  0.9744146502939091
[36m(ClientAppActor pid=3552294)[0m validation dice liver:  tensor(0.9861, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m validation dice tumour:  tensor(0.7166, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m => new best model:  1
[36m(ClientAppActor pid=3552294)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3552294)[0m epoch:  2
[36m(ClientAppActor pid=3552294)[0m train ious:  0.982517545304565
[36m(ClientAppActor pid=3552294)[0m train dice liver:  
[36m(ClientAppActor pid=3552294)[0m tensor(0.9889, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m train dice tumour:  tensor(0.7497, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m validation ious:  0.9732894780161518
[36m(ClientAppActor pid=3552294)[0m validation dice liver:  tensor(0.9850, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m validation dice tumour:  tensor(0.7135, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m => new best model:  2
[36m(ClientAppActor pid=3552294)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3552294)[0m epoch:  3
[36m(ClientAppActor pid=3552294)[0m train ious:  
[36m(ClientAppActor pid=3552294)[0m 0.9840562066679933
[36m(ClientAppActor pid=3552294)[0m train dice liver:  
[36m(ClientAppActor pid=3552294)[0m tensor(0.9900, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m train dice tumour:  tensor(0.7544, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m validation ious:  0.9750853942576658
[36m(ClientAppActor pid=3552294)[0m validation dice liver:  tensor(0.9866, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m validation dice tumour:  tensor(0.7199, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m => new best model:  3
[2025-01-16 20:31:13,634][flwr][INFO] - aggregate_fit: received 2 results and 0 failures
[92mINFO [0m:      fit progress: (14, 0.002947111854520178, OrderedDict([('ind_iou_0', 0.975680320904159), ('ind_dice_liver_0', tensor(0.9869, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7234, dtype=torch.float64)), ('ind_iou_1', 0.9804402123666389), ('ind_dice_liver_1', tensor(0.9884, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6324, dtype=torch.float64)), ('all_iou', 0.9762065621485525), ('all_dice_liver', tensor(0.9871, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7177, dtype=torch.float64))]), 123124.69911281578)
Entrei no test
Meio do test
Fim do test
[2025-01-16 20:41:37,032][flwr][INFO] - fit progress: (14, 0.002947111854520178, OrderedDict([('ind_iou_0', 0.975680320904159), ('ind_dice_liver_0', tensor(0.9869, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7234, dtype=torch.float64)), ('ind_iou_1', 0.9804402123666389), ('ind_dice_liver_1', tensor(0.9884, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6324, dtype=torch.float64)), ('all_iou', 0.9762065621485525), ('all_dice_liver', tensor(0.9871, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7177, dtype=torch.float64))]), 123124.69911281578)
[92mINFO [0m:      configure_evaluate: strategy sampled 2 clients (out of 2)
[2025-01-16 20:41:37,109][flwr][INFO] - configure_evaluate: strategy sampled 2 clients (out of 2)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3552294, ip=172.18.62.3, actor_id=7d0a08568fab681ba601f8f201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x154df422d430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3552294, ip=172.18.62.3, actor_id=7d0a08568fab681ba601f8f201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x154df422d430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[36m(ClientAppActor pid=3552294)[0m Entrei no validation 1 3
[2025-01-16 20:41:50,325][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3552294, ip=172.18.62.3, actor_id=7d0a08568fab681ba601f8f201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x154df422d430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3552294, ip=172.18.62.3, actor_id=7d0a08568fab681ba601f8f201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x154df422d430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=3552294, ip=172.18.62.3, actor_id=7d0a08568fab681ba601f8f201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x154df422d430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3552294, ip=172.18.62.3, actor_id=7d0a08568fab681ba601f8f201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x154df422d430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2025-01-16 20:41:50,325][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=3552294, ip=172.18.62.3, actor_id=7d0a08568fab681ba601f8f201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x154df422d430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3552294, ip=172.18.62.3, actor_id=7d0a08568fab681ba601f8f201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x154df422d430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3552295, ip=172.18.62.3, actor_id=3f52105c5cbc21879b66bbbb01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14f736741520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3552295, ip=172.18.62.3, actor_id=3f52105c5cbc21879b66bbbb01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14f736741520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2025-01-16 20:43:16,267][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3552295, ip=172.18.62.3, actor_id=3f52105c5cbc21879b66bbbb01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14f736741520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3552295, ip=172.18.62.3, actor_id=3f52105c5cbc21879b66bbbb01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14f736741520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=3552295, ip=172.18.62.3, actor_id=3f52105c5cbc21879b66bbbb01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14f736741520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3552295, ip=172.18.62.3, actor_id=3f52105c5cbc21879b66bbbb01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14f736741520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2025-01-16 20:43:16,268][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=3552295, ip=172.18.62.3, actor_id=3f52105c5cbc21879b66bbbb01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14f736741520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3552295, ip=172.18.62.3, actor_id=3f52105c5cbc21879b66bbbb01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14f736741520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 2 failures
[2025-01-16 20:43:16,269][flwr][INFO] - aggregate_evaluate: received 0 results and 2 failures
[92mINFO [0m:      
[2025-01-16 20:43:16,270][flwr][INFO] - 
[92mINFO [0m:      [ROUND 15]
[2025-01-16 20:43:16,270][flwr][INFO] - [ROUND 15]
[92mINFO [0m:      configure_fit: strategy sampled 2 clients (out of 2)
[2025-01-16 20:43:16,270][flwr][INFO] - configure_fit: strategy sampled 2 clients (out of 2)
[92mINFO [0m:      aggregate_fit: received 2 results and 0 failures
[36m(ClientAppActor pid=3552294)[0m Entrei no validation 1 3[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=3552294)[0m epoch:  0
[36m(ClientAppActor pid=3552294)[0m train ious:  0.9826932163035538
[36m(ClientAppActor pid=3552294)[0m train dice liver:  tensor(0.9887, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m train dice tumour:  tensor(0.6044, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m validation ious:  0.9796304882169674
[36m(ClientAppActor pid=3552294)[0m validation dice liver:  tensor(0.9873, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m validation dice tumour:  tensor(0.6356, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m => new best model:  0
[36m(ClientAppActor pid=3552294)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3552294)[0m epoch:  1
[36m(ClientAppActor pid=3552294)[0m train ious:  0.9848892402386318
[36m(ClientAppActor pid=3552294)[0m train dice liver:  tensor(0.9900, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m train dice tumour:  tensor(0.6244, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m validation ious:  0.9801117134431184
[36m(ClientAppActor pid=3552294)[0m validation dice liver:  tensor(0.9881, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m validation dice tumour:  tensor(0.6367, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m => new best model:  1
[36m(ClientAppActor pid=3552294)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3552294)[0m epoch:  2
[36m(ClientAppActor pid=3552294)[0m train ious:  0.9859996741930435
[36m(ClientAppActor pid=3552294)[0m train dice liver:  tensor(0.9909, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m train dice tumour:  tensor(0.6291, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m validation ious:  0.9802583024304166
[36m(ClientAppActor pid=3552294)[0m validation dice liver:  tensor(0.9883, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m validation dice tumour:  tensor(0.6358, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m => new best model:  2
[36m(ClientAppActor pid=3552294)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3552294)[0m epoch:  3
[36m(ClientAppActor pid=3552294)[0m train ious:  0.9860177337771092
[36m(ClientAppActor pid=3552294)[0m train dice liver:  tensor(0.9908, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m train dice tumour:  tensor(0.6163, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m validation ious:  0.9801008165051254
[36m(ClientAppActor pid=3552294)[0m validation dice liver:  tensor(0.9886, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m validation dice tumour:  tensor(0.6315, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m => new best model:  3
[36m(ClientAppActor pid=3552295)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3552295)[0m epoch:  0
[36m(ClientAppActor pid=3552295)[0m train ious:  0.9839166437716399
[36m(ClientAppActor pid=3552295)[0m train dice liver:  tensor(0.9899, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m train dice tumour:  tensor(0.7484, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m validation ious:  0.9748303257250927
[36m(ClientAppActor pid=3552295)[0m validation dice liver:  tensor(0.9862, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m validation dice tumour:  tensor(0.7173, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m => new best model:  0
[36m(ClientAppActor pid=3552295)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3552295)[0m epoch:  1
[36m(ClientAppActor pid=3552295)[0m train ious:  0.984004111666544
[36m(ClientAppActor pid=3552295)[0m train dice liver:  tensor(0.9900, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m train dice tumour:  tensor(0.7508, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m validation ious:  0.9750058208016895
[36m(ClientAppActor pid=3552295)[0m validation dice liver:  tensor(0.9865, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m validation dice tumour:  tensor(0.7214, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m => new best model:  1
[36m(ClientAppActor pid=3552295)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3552295)[0m epoch:  2
[36m(ClientAppActor pid=3552295)[0m train ious:  
[36m(ClientAppActor pid=3552295)[0m 0.984205789131753
[36m(ClientAppActor pid=3552295)[0m train dice liver:  tensor(0.9901, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m train dice tumour:  tensor(0.7634, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m validation ious:  0.9749105718377623
[36m(ClientAppActor pid=3552295)[0m validation dice liver:  tensor(0.9863, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m validation dice tumour:  tensor(0.7154, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m => new best model:  2
[36m(ClientAppActor pid=3552295)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3552295)[0m epoch:  3
[36m(ClientAppActor pid=3552295)[0m train ious:  0.9843132367192903
[36m(ClientAppActor pid=3552295)[0m train dice liver:  
[36m(ClientAppActor pid=3552295)[0m tensor(0.9902, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m train dice tumour:  tensor(0.7566, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m validation ious:  0.9746430367058748
[36m(ClientAppActor pid=3552295)[0m validation dice liver:  tensor(0.9863, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m validation dice tumour:  tensor(0.7113, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m => new best model:  3
[2025-01-16 22:58:42,393][flwr][INFO] - aggregate_fit: received 2 results and 0 failures
[92mINFO [0m:      fit progress: (15, 0.002960587437868154, OrderedDict([('ind_iou_0', 0.9754051973984026), ('ind_dice_liver_0', tensor(0.9867, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7157, dtype=torch.float64)), ('ind_iou_1', 0.9799469824035014), ('ind_dice_liver_1', tensor(0.9882, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6339, dtype=torch.float64)), ('all_iou', 0.9759063776228294), ('all_dice_liver', tensor(0.9869, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7110, dtype=torch.float64))]), 131873.63693534583)
Entrei no test
Meio do test
Fim do test
[2025-01-16 23:07:25,970][flwr][INFO] - fit progress: (15, 0.002960587437868154, OrderedDict([('ind_iou_0', 0.9754051973984026), ('ind_dice_liver_0', tensor(0.9867, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7157, dtype=torch.float64)), ('ind_iou_1', 0.9799469824035014), ('ind_dice_liver_1', tensor(0.9882, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6339, dtype=torch.float64)), ('all_iou', 0.9759063776228294), ('all_dice_liver', tensor(0.9869, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7110, dtype=torch.float64))]), 131873.63693534583)
[92mINFO [0m:      configure_evaluate: strategy sampled 2 clients (out of 2)
[2025-01-16 23:07:26,057][flwr][INFO] - configure_evaluate: strategy sampled 2 clients (out of 2)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3552294, ip=172.18.62.3, actor_id=7d0a08568fab681ba601f8f201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x154df422d430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3552294, ip=172.18.62.3, actor_id=7d0a08568fab681ba601f8f201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x154df422d430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[36m(ClientAppActor pid=3552295)[0m Entrei no validation 1 3
[2025-01-16 23:07:38,222][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3552294, ip=172.18.62.3, actor_id=7d0a08568fab681ba601f8f201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x154df422d430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3552294, ip=172.18.62.3, actor_id=7d0a08568fab681ba601f8f201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x154df422d430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2025-01-16 23:07:38,223][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=3552294, ip=172.18.62.3, actor_id=7d0a08568fab681ba601f8f201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x154df422d430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3552294, ip=172.18.62.3, actor_id=7d0a08568fab681ba601f8f201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x154df422d430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=3552294, ip=172.18.62.3, actor_id=7d0a08568fab681ba601f8f201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x154df422d430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3552294, ip=172.18.62.3, actor_id=7d0a08568fab681ba601f8f201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x154df422d430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3552295, ip=172.18.62.3, actor_id=3f52105c5cbc21879b66bbbb01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14f736741520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3552295, ip=172.18.62.3, actor_id=3f52105c5cbc21879b66bbbb01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14f736741520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2025-01-16 23:08:58,181][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3552295, ip=172.18.62.3, actor_id=3f52105c5cbc21879b66bbbb01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14f736741520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3552295, ip=172.18.62.3, actor_id=3f52105c5cbc21879b66bbbb01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14f736741520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=3552295, ip=172.18.62.3, actor_id=3f52105c5cbc21879b66bbbb01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14f736741520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3552295, ip=172.18.62.3, actor_id=3f52105c5cbc21879b66bbbb01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14f736741520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2025-01-16 23:08:58,183][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=3552295, ip=172.18.62.3, actor_id=3f52105c5cbc21879b66bbbb01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14f736741520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3552295, ip=172.18.62.3, actor_id=3f52105c5cbc21879b66bbbb01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14f736741520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 2 failures
[2025-01-16 23:08:58,184][flwr][INFO] - aggregate_evaluate: received 0 results and 2 failures
[92mINFO [0m:      
[2025-01-16 23:08:58,184][flwr][INFO] - 
[92mINFO [0m:      [ROUND 16]
[2025-01-16 23:08:58,184][flwr][INFO] - [ROUND 16]
[92mINFO [0m:      configure_fit: strategy sampled 2 clients (out of 2)
[2025-01-16 23:08:58,184][flwr][INFO] - configure_fit: strategy sampled 2 clients (out of 2)
[92mINFO [0m:      aggregate_fit: received 2 results and 0 failures
[36m(ClientAppActor pid=3552294)[0m Entrei no validation 1 3[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=3552294)[0m epoch:  0
[36m(ClientAppActor pid=3552294)[0m train ious:  0.9823524224081867
[36m(ClientAppActor pid=3552294)[0m train dice liver:  tensor(0.9884, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m train dice tumour:  tensor(0.6130, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m validation ious:  0.9802619112002278
[36m(ClientAppActor pid=3552294)[0m validation dice liver:  tensor(0.9877, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m validation dice tumour:  tensor(0.6379, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m => new best model:  0
[36m(ClientAppActor pid=3552294)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3552294)[0m epoch:  1
[36m(ClientAppActor pid=3552294)[0m train ious:  0.9856376849412831
[36m(ClientAppActor pid=3552294)[0m train dice liver:  tensor(0.9905, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m train dice tumour:  tensor(0.6496, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m validation ious:  0.9819368155574445
[36m(ClientAppActor pid=3552294)[0m validation dice liver:  tensor(0.9890, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m validation dice tumour:  tensor(0.6449, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m => new best model:  1
[36m(ClientAppActor pid=3552294)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3552294)[0m epoch:  2
[36m(ClientAppActor pid=3552294)[0m train ious:  0.9873020614298527
[36m(ClientAppActor pid=3552294)[0m train dice liver:  tensor(0.9916, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m 
[36m(ClientAppActor pid=3552294)[0m train dice tumour: 
[36m(ClientAppActor pid=3552294)[0m  
[36m(ClientAppActor pid=3552294)[0m tensor(0.6489, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m validation ious:  0.981815315237248
[36m(ClientAppActor pid=3552294)[0m validation dice liver:  
[36m(ClientAppActor pid=3552294)[0m tensor(0.9895, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m validation dice tumour:  tensor(0.6444, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m => new best model:  2
[36m(ClientAppActor pid=3552294)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3552294)[0m epoch:  3
[36m(ClientAppActor pid=3552294)[0m train ious:  0.9878704791722221
[36m(ClientAppActor pid=3552294)[0m train dice liver:  tensor(0.9921, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m train dice tumour:  tensor(0.6259, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m validation ious:  0.9817542680266629
[36m(ClientAppActor pid=3552294)[0m validation dice liver:  tensor(0.9896, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m validation dice tumour:  tensor(0.6344, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m => new best model:  3
[36m(ClientAppActor pid=3552295)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3552295)[0m epoch:  0
[36m(ClientAppActor pid=3552295)[0m train ious:  
[36m(ClientAppActor pid=3552295)[0m 0.984450285840657
[36m(ClientAppActor pid=3552295)[0m train dice liver:  tensor(0.9902, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m train dice tumour:  tensor(0.7637, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m validation ious:  0.9755467482660238
[36m(ClientAppActor pid=3552295)[0m validation dice liver:  tensor(0.9865, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m validation dice tumour:  tensor(0.7222, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m => new best model:  0
[36m(ClientAppActor pid=3552295)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3552295)[0m epoch:  1
[36m(ClientAppActor pid=3552295)[0m train ious:  0.9847194932595502
[36m(ClientAppActor pid=3552295)[0m train dice liver:  
[36m(ClientAppActor pid=3552295)[0m tensor(0.9904, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m train dice tumour:  tensor(0.7593, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m validation ious:  0.9750166138376383
[36m(ClientAppActor pid=3552295)[0m validation dice liver:  tensor(0.9865, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m validation dice tumour:  tensor(0.7202, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m => new best model:  1
[36m(ClientAppActor pid=3552295)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3552295)[0m epoch:  2
[36m(ClientAppActor pid=3552295)[0m train ious:  0.9846043626226931
[36m(ClientAppActor pid=3552295)[0m train dice liver:  tensor(0.9903, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m train dice tumour:  tensor(0.7598, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m validation ious:  0.975383573475502
[36m(ClientAppActor pid=3552295)[0m validation dice liver:  tensor(0.9869, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m validation dice tumour:  tensor(0.7225, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m => new best model:  2
[36m(ClientAppActor pid=3552295)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3552295)[0m epoch:  3
[36m(ClientAppActor pid=3552295)[0m train ious:  0.9840254948191474
[36m(ClientAppActor pid=3552295)[0m train dice liver:  
[36m(ClientAppActor pid=3552295)[0m tensor(0.9900, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m train dice tumour:  tensor(0.7594, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m validation ious:  0.9756488112869995
[36m(ClientAppActor pid=3552295)[0m validation dice liver:  tensor(0.9868, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m validation dice tumour:  tensor(0.7202, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m => new best model:  3
[2025-01-17 01:32:26,332][flwr][INFO] - aggregate_fit: received 2 results and 0 failures
[92mINFO [0m:      fit progress: (16, 0.0028803900105150043, OrderedDict([('ind_iou_0', 0.976295860368998), ('ind_dice_liver_0', tensor(0.9872, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7236, dtype=torch.float64)), ('ind_iou_1', 0.9819093630307387), ('ind_dice_liver_1', tensor(0.9891, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6390, dtype=torch.float64)), ('all_iou', 0.9768702732326463), ('all_dice_liver', tensor(0.9874, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7185, dtype=torch.float64))]), 141164.85543403774)
Entrei no test
Meio do test
Fim do test
[2025-01-17 01:42:17,188][flwr][INFO] - fit progress: (16, 0.0028803900105150043, OrderedDict([('ind_iou_0', 0.976295860368998), ('ind_dice_liver_0', tensor(0.9872, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7236, dtype=torch.float64)), ('ind_iou_1', 0.9819093630307387), ('ind_dice_liver_1', tensor(0.9891, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6390, dtype=torch.float64)), ('all_iou', 0.9768702732326463), ('all_dice_liver', tensor(0.9874, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7185, dtype=torch.float64))]), 141164.85543403774)
[92mINFO [0m:      configure_evaluate: strategy sampled 2 clients (out of 2)
[2025-01-17 01:42:17,266][flwr][INFO] - configure_evaluate: strategy sampled 2 clients (out of 2)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3552295, ip=172.18.62.3, actor_id=3f52105c5cbc21879b66bbbb01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14f736741520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3552295, ip=172.18.62.3, actor_id=3f52105c5cbc21879b66bbbb01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14f736741520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[36m(ClientAppActor pid=3552294)[0m Entrei no validation 1 3
[2025-01-17 01:42:29,824][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3552295, ip=172.18.62.3, actor_id=3f52105c5cbc21879b66bbbb01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14f736741520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3552295, ip=172.18.62.3, actor_id=3f52105c5cbc21879b66bbbb01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14f736741520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=3552295, ip=172.18.62.3, actor_id=3f52105c5cbc21879b66bbbb01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14f736741520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3552295, ip=172.18.62.3, actor_id=3f52105c5cbc21879b66bbbb01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14f736741520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2025-01-17 01:42:29,824][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=3552295, ip=172.18.62.3, actor_id=3f52105c5cbc21879b66bbbb01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14f736741520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3552295, ip=172.18.62.3, actor_id=3f52105c5cbc21879b66bbbb01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14f736741520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3552294, ip=172.18.62.3, actor_id=7d0a08568fab681ba601f8f201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x154df422d430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3552294, ip=172.18.62.3, actor_id=7d0a08568fab681ba601f8f201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x154df422d430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[2025-01-17 01:43:45,095][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3552294, ip=172.18.62.3, actor_id=7d0a08568fab681ba601f8f201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x154df422d430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3552294, ip=172.18.62.3, actor_id=7d0a08568fab681ba601f8f201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x154df422d430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=3552294, ip=172.18.62.3, actor_id=7d0a08568fab681ba601f8f201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x154df422d430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3552294, ip=172.18.62.3, actor_id=7d0a08568fab681ba601f8f201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x154df422d430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2025-01-17 01:43:45,096][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=3552294, ip=172.18.62.3, actor_id=7d0a08568fab681ba601f8f201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x154df422d430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3552294, ip=172.18.62.3, actor_id=7d0a08568fab681ba601f8f201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x154df422d430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 2 failures
[2025-01-17 01:43:45,096][flwr][INFO] - aggregate_evaluate: received 0 results and 2 failures
[92mINFO [0m:      
[2025-01-17 01:43:45,096][flwr][INFO] - 
[92mINFO [0m:      [ROUND 17]
[2025-01-17 01:43:45,096][flwr][INFO] - [ROUND 17]
[92mINFO [0m:      configure_fit: strategy sampled 2 clients (out of 2)
[2025-01-17 01:43:45,096][flwr][INFO] - configure_fit: strategy sampled 2 clients (out of 2)
[92mINFO [0m:      aggregate_fit: received 2 results and 0 failures
[36m(ClientAppActor pid=3552295)[0m Entrei no validation 1 3[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=3552295)[0m epoch:  0
[36m(ClientAppActor pid=3552295)[0m train ious:  0.9833893293996652
[36m(ClientAppActor pid=3552295)[0m train dice liver:  
[36m(ClientAppActor pid=3552295)[0m tensor(0.9890, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m train dice tumour:  tensor(0.6230, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m validation ious:  0.9814340563712202
[36m(ClientAppActor pid=3552295)[0m validation dice liver:  tensor(0.9884, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m validation dice tumour:  tensor(0.6342, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m => new best model:  0
[36m(ClientAppActor pid=3552295)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3552295)[0m epoch:  1
[36m(ClientAppActor pid=3552295)[0m train ious:  0.9859805141598901
[36m(ClientAppActor pid=3552295)[0m train dice liver:  tensor(0.9908, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m train dice tumour:  tensor(0.6402, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m validation ious:  0.9817186755374805
[36m(ClientAppActor pid=3552295)[0m validation dice liver:  tensor(0.9890, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m validation dice tumour:  tensor(0.6504, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m => new best model:  1
[36m(ClientAppActor pid=3552295)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3552295)[0m epoch:  2
[36m(ClientAppActor pid=3552295)[0m train ious:  0.9872003817274809
[36m(ClientAppActor pid=3552295)[0m train dice liver:  tensor(0.9916, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m train dice tumour:  tensor(0.6236, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m validation ious:  0.9824150428518171
[36m(ClientAppActor pid=3552295)[0m validation dice liver:  tensor(0.9898, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m validation dice tumour:  tensor(0.6521, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m => new best model:  2
[36m(ClientAppActor pid=3552295)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3552295)[0m epoch:  3
[36m(ClientAppActor pid=3552295)[0m train ious:  0.9878835540735286
[36m(ClientAppActor pid=3552295)[0m train dice liver:  tensor(0.9921, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m train dice tumour:  tensor(0.6308, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m validation ious:  0.9821621308812135
[36m(ClientAppActor pid=3552295)[0m validation dice liver:  tensor(0.9897, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m validation dice tumour:  tensor(0.6524, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m => new best model:  3
[36m(ClientAppActor pid=3552294)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3552294)[0m epoch:  0
[36m(ClientAppActor pid=3552294)[0m train ious:  0.9851176669886942
[36m(ClientAppActor pid=3552294)[0m train dice liver:  
[36m(ClientAppActor pid=3552294)[0m tensor(0.9907, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m train dice tumour:  tensor(0.7655, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m validation ious:  0.9754708791161638
[36m(ClientAppActor pid=3552294)[0m validation dice liver:  tensor(0.9868, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m validation dice tumour:  tensor(0.7223, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m => new best model:  0
[36m(ClientAppActor pid=3552294)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3552294)[0m epoch:  1
[36m(ClientAppActor pid=3552294)[0m train ious:  0.9846741849567271
[36m(ClientAppActor pid=3552294)[0m train dice liver:  tensor(0.9904, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m train dice tumour:  tensor(0.7555, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m validation ious:  0.975763148522806
[36m(ClientAppActor pid=3552294)[0m validation dice liver:  tensor(0.9870, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m validation dice tumour:  tensor(0.7259, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m => new best model:  1
[36m(ClientAppActor pid=3552294)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3552294)[0m epoch:  2
[36m(ClientAppActor pid=3552294)[0m train ious:  
[36m(ClientAppActor pid=3552294)[0m 0.9852892125440695
[36m(ClientAppActor pid=3552294)[0m train dice liver:  
[36m(ClientAppActor pid=3552294)[0m tensor(0.9908, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m train dice tumour:  tensor(0.7648, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m validation ious:  0.9756021661735763
[36m(ClientAppActor pid=3552294)[0m validation dice liver:  tensor(0.9870, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m validation dice tumour:  tensor(0.7218, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m => new best model:  2
[36m(ClientAppActor pid=3552294)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3552294)[0m epoch:  3
[36m(ClientAppActor pid=3552294)[0m train ious:  0.9854039325338327
[36m(ClientAppActor pid=3552294)[0m train dice liver:  
[36m(ClientAppActor pid=3552294)[0m tensor(0.9909, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m train dice tumour:  tensor(0.7648, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m validation ious:  0.9756416280267318
[36m(ClientAppActor pid=3552294)[0m validation dice liver:  tensor(0.9870, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m validation dice tumour:  tensor(0.7249, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m => new best model:  3
[2025-01-17 03:53:24,504][flwr][INFO] - aggregate_fit: received 2 results and 0 failures
[92mINFO [0m:      fit progress: (17, 0.0029232926879910913, OrderedDict([('ind_iou_0', 0.976266306798886), ('ind_dice_liver_0', tensor(0.9874, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7279, dtype=torch.float64)), ('ind_iou_1', 0.9819516822698249), ('ind_dice_liver_1', tensor(0.9893, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6393, dtype=torch.float64)), ('all_iou', 0.9768402029605129), ('all_dice_liver', tensor(0.9876, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7226, dtype=torch.float64))]), 149595.3294862304)
Entrei no test
Meio do test
Fim do test
[2025-01-17 04:02:47,662][flwr][INFO] - fit progress: (17, 0.0029232926879910913, OrderedDict([('ind_iou_0', 0.976266306798886), ('ind_dice_liver_0', tensor(0.9874, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7279, dtype=torch.float64)), ('ind_iou_1', 0.9819516822698249), ('ind_dice_liver_1', tensor(0.9893, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6393, dtype=torch.float64)), ('all_iou', 0.9768402029605129), ('all_dice_liver', tensor(0.9876, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7226, dtype=torch.float64))]), 149595.3294862304)
[92mINFO [0m:      configure_evaluate: strategy sampled 2 clients (out of 2)
[2025-01-17 04:02:47,746][flwr][INFO] - configure_evaluate: strategy sampled 2 clients (out of 2)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3552295, ip=172.18.62.3, actor_id=3f52105c5cbc21879b66bbbb01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14f736741520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3552295, ip=172.18.62.3, actor_id=3f52105c5cbc21879b66bbbb01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14f736741520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[36m(ClientAppActor pid=3552294)[0m Entrei no validation 1 3
[2025-01-17 04:02:59,748][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3552295, ip=172.18.62.3, actor_id=3f52105c5cbc21879b66bbbb01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14f736741520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3552295, ip=172.18.62.3, actor_id=3f52105c5cbc21879b66bbbb01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14f736741520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2025-01-17 04:02:59,749][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=3552295, ip=172.18.62.3, actor_id=3f52105c5cbc21879b66bbbb01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14f736741520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3552295, ip=172.18.62.3, actor_id=3f52105c5cbc21879b66bbbb01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14f736741520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=3552295, ip=172.18.62.3, actor_id=3f52105c5cbc21879b66bbbb01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14f736741520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3552295, ip=172.18.62.3, actor_id=3f52105c5cbc21879b66bbbb01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14f736741520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3552294, ip=172.18.62.3, actor_id=7d0a08568fab681ba601f8f201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x154df422d430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3552294, ip=172.18.62.3, actor_id=7d0a08568fab681ba601f8f201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x154df422d430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[2025-01-17 04:04:10,426][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3552294, ip=172.18.62.3, actor_id=7d0a08568fab681ba601f8f201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x154df422d430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3552294, ip=172.18.62.3, actor_id=7d0a08568fab681ba601f8f201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x154df422d430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=3552294, ip=172.18.62.3, actor_id=7d0a08568fab681ba601f8f201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x154df422d430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3552294, ip=172.18.62.3, actor_id=7d0a08568fab681ba601f8f201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x154df422d430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2025-01-17 04:04:10,427][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=3552294, ip=172.18.62.3, actor_id=7d0a08568fab681ba601f8f201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x154df422d430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3552294, ip=172.18.62.3, actor_id=7d0a08568fab681ba601f8f201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x154df422d430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 2 failures
[2025-01-17 04:04:10,428][flwr][INFO] - aggregate_evaluate: received 0 results and 2 failures
[92mINFO [0m:      
[2025-01-17 04:04:10,429][flwr][INFO] - 
[92mINFO [0m:      [ROUND 18]
[2025-01-17 04:04:10,430][flwr][INFO] - [ROUND 18]
[92mINFO [0m:      configure_fit: strategy sampled 2 clients (out of 2)
[2025-01-17 04:04:10,431][flwr][INFO] - configure_fit: strategy sampled 2 clients (out of 2)
[92mINFO [0m:      aggregate_fit: received 2 results and 0 failures
[36m(ClientAppActor pid=3552294)[0m Entrei no validation 1 3[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=3552294)[0m epoch:  0
[36m(ClientAppActor pid=3552294)[0m train ious:  0.983905385691385
[36m(ClientAppActor pid=3552294)[0m train dice liver:  tensor(0.9894, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m train dice tumour:  tensor(0.6287, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m validation ious:  0.9822537709372382
[36m(ClientAppActor pid=3552294)[0m validation dice liver:  tensor(0.9888, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m validation dice tumour:  tensor(0.6390, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m => new best model:  0
[36m(ClientAppActor pid=3552294)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3552294)[0m epoch:  1
[36m(ClientAppActor pid=3552294)[0m train ious:  0.9862652446682525
[36m(ClientAppActor pid=3552294)[0m train dice liver:  tensor(0.9909, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m train dice tumour:  tensor(0.6389, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m validation ious:  0.9814960718245329
[36m(ClientAppActor pid=3552294)[0m validation dice liver:  tensor(0.9889, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m validation dice tumour:  tensor(0.6421, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m => new best model:  1
[36m(ClientAppActor pid=3552294)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3552294)[0m epoch:  2
[36m(ClientAppActor pid=3552294)[0m train ious:  0.9875146649657539
[36m(ClientAppActor pid=3552294)[0m train dice liver:  tensor(0.9918, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m train dice tumour:  tensor(0.6350, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m validation ious:  0.9827778340807406
[36m(ClientAppActor pid=3552294)[0m validation dice liver:  tensor(0.9900, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m validation dice tumour:  tensor(0.6399, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m => new best model:  2
[36m(ClientAppActor pid=3552294)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3552294)[0m epoch:  3
[36m(ClientAppActor pid=3552294)[0m train ious:  0.9879841742169978
[36m(ClientAppActor pid=3552294)[0m train dice liver:  tensor(0.9922, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m train dice tumour:  tensor(0.6551, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m validation ious:  0.980960634198412
[36m(ClientAppActor pid=3552294)[0m validation dice liver:  tensor(0.9889, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m validation dice tumour:  tensor(0.6299, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m => new best model:  3
[36m(ClientAppActor pid=3552295)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3552295)[0m epoch:  0
[36m(ClientAppActor pid=3552295)[0m train ious:  0.9856885060999508
[36m(ClientAppActor pid=3552295)[0m train dice liver:  
[36m(ClientAppActor pid=3552295)[0m tensor(0.9910, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m train dice tumour:  tensor(0.7544, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m validation ious:  0.9756285930212988
[36m(ClientAppActor pid=3552295)[0m validation dice liver:  tensor(0.9871, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m validation dice tumour:  tensor(0.7249, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m => new best model:  0
[36m(ClientAppActor pid=3552295)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3552295)[0m epoch:  1
[36m(ClientAppActor pid=3552295)[0m train ious:  
[36m(ClientAppActor pid=3552295)[0m 0.9854856903739251
[36m(ClientAppActor pid=3552295)[0m train dice liver:  tensor(0.9909, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m train dice tumour:  tensor(0.7552, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m validation ious:  0.9757075527413078
[36m(ClientAppActor pid=3552295)[0m validation dice liver:  tensor(0.9871, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m validation dice tumour:  tensor(0.7194, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m => new best model:  1
[36m(ClientAppActor pid=3552295)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3552295)[0m epoch:  2
[36m(ClientAppActor pid=3552295)[0m train ious:  0.985130619416352
[36m(ClientAppActor pid=3552295)[0m train dice liver:  
[36m(ClientAppActor pid=3552295)[0m tensor(0.9906, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m train dice tumour:  tensor(0.7594, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m validation ious:  0.9751988220814873
[36m(ClientAppActor pid=3552295)[0m validation dice liver:  tensor(0.9866, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m validation dice tumour:  tensor(0.7159, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m => new best model:  2
[36m(ClientAppActor pid=3552295)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3552295)[0m epoch:  3
[36m(ClientAppActor pid=3552295)[0m train ious:  0.9858948225214782
[36m(ClientAppActor pid=3552295)[0m train dice liver:  tensor(0.9911, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m train dice tumour:  tensor(0.7691, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m validation ious:  0.975953513409146
[36m(ClientAppActor pid=3552295)[0m validation dice liver:  tensor(0.9872, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m validation dice tumour:  tensor(0.7244, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m => new best model:  3
[2025-01-17 06:26:04,396][flwr][INFO] - aggregate_fit: received 2 results and 0 failures
[92mINFO [0m:      fit progress: (18, 0.0028994154097295314, OrderedDict([('ind_iou_0', 0.9766349217773511), ('ind_dice_liver_0', tensor(0.9875, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7273, dtype=torch.float64)), ('ind_iou_1', 0.9820304522018418), ('ind_dice_liver_1', tensor(0.9894, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6464, dtype=torch.float64)), ('all_iou', 0.9772116426768427), ('all_dice_liver', tensor(0.9877, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7231, dtype=torch.float64))]), 158745.34471043013)
Entrei no test
Meio do test
Fim do test
[2025-01-17 06:35:17,678][flwr][INFO] - fit progress: (18, 0.0028994154097295314, OrderedDict([('ind_iou_0', 0.9766349217773511), ('ind_dice_liver_0', tensor(0.9875, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7273, dtype=torch.float64)), ('ind_iou_1', 0.9820304522018418), ('ind_dice_liver_1', tensor(0.9894, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6464, dtype=torch.float64)), ('all_iou', 0.9772116426768427), ('all_dice_liver', tensor(0.9877, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7231, dtype=torch.float64))]), 158745.34471043013)
[92mINFO [0m:      configure_evaluate: strategy sampled 2 clients (out of 2)
[2025-01-17 06:35:17,760][flwr][INFO] - configure_evaluate: strategy sampled 2 clients (out of 2)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3552294, ip=172.18.62.3, actor_id=7d0a08568fab681ba601f8f201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x154df422d430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3552294, ip=172.18.62.3, actor_id=7d0a08568fab681ba601f8f201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x154df422d430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[36m(ClientAppActor pid=3552294)[0m Entrei no validation 1 3
[2025-01-17 06:35:30,214][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3552294, ip=172.18.62.3, actor_id=7d0a08568fab681ba601f8f201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x154df422d430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3552294, ip=172.18.62.3, actor_id=7d0a08568fab681ba601f8f201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x154df422d430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=3552294, ip=172.18.62.3, actor_id=7d0a08568fab681ba601f8f201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x154df422d430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3552294, ip=172.18.62.3, actor_id=7d0a08568fab681ba601f8f201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x154df422d430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2025-01-17 06:35:30,215][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=3552294, ip=172.18.62.3, actor_id=7d0a08568fab681ba601f8f201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x154df422d430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3552294, ip=172.18.62.3, actor_id=7d0a08568fab681ba601f8f201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x154df422d430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3552295, ip=172.18.62.3, actor_id=3f52105c5cbc21879b66bbbb01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14f736741520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3552295, ip=172.18.62.3, actor_id=3f52105c5cbc21879b66bbbb01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14f736741520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[2025-01-17 06:36:51,162][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3552295, ip=172.18.62.3, actor_id=3f52105c5cbc21879b66bbbb01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14f736741520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3552295, ip=172.18.62.3, actor_id=3f52105c5cbc21879b66bbbb01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14f736741520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=3552295, ip=172.18.62.3, actor_id=3f52105c5cbc21879b66bbbb01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14f736741520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3552295, ip=172.18.62.3, actor_id=3f52105c5cbc21879b66bbbb01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14f736741520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2025-01-17 06:36:51,162][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=3552295, ip=172.18.62.3, actor_id=3f52105c5cbc21879b66bbbb01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14f736741520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3552295, ip=172.18.62.3, actor_id=3f52105c5cbc21879b66bbbb01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14f736741520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 2 failures
[2025-01-17 06:36:51,162][flwr][INFO] - aggregate_evaluate: received 0 results and 2 failures
[92mINFO [0m:      
[2025-01-17 06:36:51,163][flwr][INFO] - 
[92mINFO [0m:      [ROUND 19]
[2025-01-17 06:36:51,163][flwr][INFO] - [ROUND 19]
[92mINFO [0m:      configure_fit: strategy sampled 2 clients (out of 2)
[2025-01-17 06:36:51,163][flwr][INFO] - configure_fit: strategy sampled 2 clients (out of 2)
[92mINFO [0m:      aggregate_fit: received 2 results and 0 failures
[36m(ClientAppActor pid=3552294)[0m Entrei no validation 1 3[32m [repeated 2x across cluster][0m
[36m(ClientAppActor pid=3552294)[0m epoch:  0
[36m(ClientAppActor pid=3552294)[0m train ious:  0.983584202019735
[36m(ClientAppActor pid=3552294)[0m train dice liver:  tensor(0.9891, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m train dice tumour:  tensor(0.6446, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m validation ious:  0.9819143525444962
[36m(ClientAppActor pid=3552294)[0m validation dice liver:  tensor(0.9889, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m validation dice tumour:  tensor(0.6459, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m => new best model:  0
[36m(ClientAppActor pid=3552294)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3552294)[0m epoch:  1
[36m(ClientAppActor pid=3552294)[0m train ious:  0.98664826440925
[36m(ClientAppActor pid=3552294)[0m train dice liver:  tensor(0.9912, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m train dice tumour:  tensor(0.6557, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m validation ious:  0.9813834991674947
[36m(ClientAppActor pid=3552294)[0m validation dice liver:  tensor(0.9890, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m validation dice tumour:  tensor(0.6480, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m => new best model:  1
[36m(ClientAppActor pid=3552294)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3552294)[0m epoch:  2
[36m(ClientAppActor pid=3552294)[0m train ious:  0.9869062500542751
[36m(ClientAppActor pid=3552294)[0m train dice liver:  tensor(0.9917, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m train dice tumour:  tensor(0.6407, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m validation ious:  0.965412658199051
[36m(ClientAppActor pid=3552294)[0m validation dice liver:  tensor(0.9871, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m validation dice tumour:  tensor(0.4929, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m => new best model:  2
[36m(ClientAppActor pid=3552294)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3552294)[0m epoch:  3
[36m(ClientAppActor pid=3552294)[0m train ious:  0.9828895159795472
[36m(ClientAppActor pid=3552294)[0m train dice liver:  tensor(0.9892, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m train dice tumour:  tensor(0.6135, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m validation ious:  0.9813870036400202
[36m(ClientAppActor pid=3552294)[0m validation dice liver:  tensor(0.9890, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m validation dice tumour:  tensor(0.6445, dtype=torch.float64)
[36m(ClientAppActor pid=3552294)[0m => new best model:  3
[36m(ClientAppActor pid=3552295)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3552295)[0m epoch:  0
[36m(ClientAppActor pid=3552295)[0m train ious:  0.9859857040426637
[36m(ClientAppActor pid=3552295)[0m train dice liver:  
[36m(ClientAppActor pid=3552295)[0m tensor(0.9912, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m train dice tumour:  tensor(0.7634, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m validation ious:  0.9754938822127547
[36m(ClientAppActor pid=3552295)[0m validation dice liver:  tensor(0.9869, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m validation dice tumour:  tensor(0.7214, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m => new best model:  0
[36m(ClientAppActor pid=3552295)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3552295)[0m epoch:  1
[36m(ClientAppActor pid=3552295)[0m train ious:  0.9861242146701169
[36m(ClientAppActor pid=3552295)[0m train dice liver:  
[36m(ClientAppActor pid=3552295)[0m tensor(0.9913, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m train dice tumour:  tensor(0.7677, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m validation ious:  0.9758110863008028
[36m(ClientAppActor pid=3552295)[0m validation dice liver:  tensor(0.9871, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m validation dice tumour:  tensor(0.7129, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m => new best model:  1
[36m(ClientAppActor pid=3552295)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3552295)[0m epoch:  2
[36m(ClientAppActor pid=3552295)[0m train ious:  0.9863061304689538
[36m(ClientAppActor pid=3552295)[0m train dice liver:  
[36m(ClientAppActor pid=3552295)[0m tensor(0.9914, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m train dice tumour:  tensor(0.7618, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m validation ious:  0.9761416492675633
[36m(ClientAppActor pid=3552295)[0m validation dice liver:  tensor(0.9872, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m validation dice tumour:  tensor(0.7237, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m => new best model:  2
[36m(ClientAppActor pid=3552295)[0m Entrei no validation 1 3
[36m(ClientAppActor pid=3552295)[0m epoch:  3
[36m(ClientAppActor pid=3552295)[0m train ious:  0.9848871361110892
[36m(ClientAppActor pid=3552295)[0m train dice liver:  tensor(0.9905, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m train dice tumour:  tensor(0.7644, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m validation ious:  0.9761525734963072
[36m(ClientAppActor pid=3552295)[0m validation dice liver:  tensor(0.9872, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m validation dice tumour:  tensor(0.7283, dtype=torch.float64)
[36m(ClientAppActor pid=3552295)[0m => new best model:  3
[2025-01-17 08:48:22,204][flwr][INFO] - aggregate_fit: received 2 results and 0 failures
[92mINFO [0m:      fit progress: (19, 0.002878487904862845, OrderedDict([('ind_iou_0', 0.9767591111850689), ('ind_dice_liver_0', tensor(0.9875, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7303, dtype=torch.float64)), ('ind_iou_1', 0.9828966257695565), ('ind_dice_liver_1', tensor(0.9897, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6482, dtype=torch.float64)), ('all_iou', 0.9773796052450753), ('all_dice_liver', tensor(0.9877, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7260, dtype=torch.float64))]), 167295.10817955062)
Entrei no test
Meio do test
Fim do test
[2025-01-17 08:57:47,441][flwr][INFO] - fit progress: (19, 0.002878487904862845, OrderedDict([('ind_iou_0', 0.9767591111850689), ('ind_dice_liver_0', tensor(0.9875, dtype=torch.float64)), ('ind_dice_tumour_0', tensor(0.7303, dtype=torch.float64)), ('ind_iou_1', 0.9828966257695565), ('ind_dice_liver_1', tensor(0.9897, dtype=torch.float64)), ('ind_dice_tumour_1', tensor(0.6482, dtype=torch.float64)), ('all_iou', 0.9773796052450753), ('all_dice_liver', tensor(0.9877, dtype=torch.float64)), ('all_dice_tumour', tensor(0.7260, dtype=torch.float64))]), 167295.10817955062)
[92mINFO [0m:      configure_evaluate: strategy sampled 2 clients (out of 2)
[2025-01-17 08:57:47,610][flwr][INFO] - configure_evaluate: strategy sampled 2 clients (out of 2)
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3552295, ip=172.18.62.3, actor_id=3f52105c5cbc21879b66bbbb01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14f736741520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3552295, ip=172.18.62.3, actor_id=3f52105c5cbc21879b66bbbb01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14f736741520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[36m(ClientAppActor pid=3552294)[0m Entrei no validation 1 3
[2025-01-17 08:57:59,443][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3552295, ip=172.18.62.3, actor_id=3f52105c5cbc21879b66bbbb01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14f736741520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3552295, ip=172.18.62.3, actor_id=3f52105c5cbc21879b66bbbb01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14f736741520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=3552295, ip=172.18.62.3, actor_id=3f52105c5cbc21879b66bbbb01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14f736741520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3552295, ip=172.18.62.3, actor_id=3f52105c5cbc21879b66bbbb01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14f736741520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2025-01-17 08:57:59,443][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=3552295, ip=172.18.62.3, actor_id=3f52105c5cbc21879b66bbbb01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14f736741520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3552295, ip=172.18.62.3, actor_id=3f52105c5cbc21879b66bbbb01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14f736741520>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[91mERROR [0m:     Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3552294, ip=172.18.62.3, actor_id=7d0a08568fab681ba601f8f201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x154df422d430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3552294, ip=172.18.62.3, actor_id=7d0a08568fab681ba601f8f201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x154df422d430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
[2025-01-17 08:59:14,697][flwr][ERROR] - Traceback (most recent call last):
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=3552294, ip=172.18.62.3, actor_id=7d0a08568fab681ba601f8f201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x154df422d430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3552294, ip=172.18.62.3, actor_id=7d0a08568fab681ba601f8f201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x154df422d430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=3552294, ip=172.18.62.3, actor_id=7d0a08568fab681ba601f8f201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x154df422d430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3552294, ip=172.18.62.3, actor_id=7d0a08568fab681ba601f8f201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x154df422d430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[2025-01-17 08:59:14,698][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=3552294, ip=172.18.62.3, actor_id=7d0a08568fab681ba601f8f201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x154df422d430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/client/message_handler/message_handler.py", line 141, in handle_legacy_message_from_msgtype
    out_recordset = evaluateres_to_recordset(evaluate_res)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/recordset_compat.py", line 301, in evaluateres_to_recordset
    recordset.configs_records[f"{res_str}.metrics"] = ConfigsRecord(
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 85, in __init__
    self[k] = configs_dict[k]
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/typeddict.py", line 38, in __setitem__
    self._check_value_fn(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 57, in _check_value
    is_valid(value)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/common/record/configsrecord.py", line 35, in is_valid
    raise TypeError(
TypeError: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=3552294, ip=172.18.62.3, actor_id=7d0a08568fab681ba601f8f201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x154df422d430>)
  File "/home/sc.uni-leipzig.de/zc19tube/liverseg_v2/envs/.env2/lib/python3.9/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Not all values are of valid type. Expected `typing.Union[int, float, str, bytes, bool, typing.List[int], typing.List[float], typing.List[str], typing.List[bytes], typing.List[bool]]` but `<class 'torch.Tensor'>` was passed.
[92mINFO [0m:      aggregate_evaluate: received 0 results and 2 failures
[2025-01-17 08:59:14,698][flwr][INFO] - aggregate_evaluate: received 0 results and 2 failures
[92mINFO [0m:      
[2025-01-17 08:59:14,698][flwr][INFO] - 
[92mINFO [0m:      [ROUND 20]
[2025-01-17 08:59:14,698][flwr][INFO] - [ROUND 20]
[92mINFO [0m:      configure_fit: strategy sampled 2 clients (out of 2)
[2025-01-17 08:59:14,699][flwr][INFO] - configure_fit: strategy sampled 2 clients (out of 2)
slurmstepd: error: *** STEP 11874588.0 ON paula03 CANCELLED AT 2025-01-17T10:18:50 DUE TO TIME LIMIT ***
srun: Job step aborted: Waiting up to 32 seconds for job step to finish.
*** SIGTERM received at time=1737105530 on cpu 32 ***
[failure_signal_handler.cc : 332] RAW: Signal 15 raised at PC=0x14da9b7f0ad4 while already in AbslFailureSignalHandler()
*** SIGTERM received at time=1737105530 on cpu 32 ***
PC: @     0x14da9b7f0ad4  (unknown)  __read
    @     0x14da9b7f1d10  (unknown)  (unknown)
[2025-01-17 10:18:50,135 E 3543835 3543835] logging.cc:361: *** SIGTERM received at time=1737105530 on cpu 32 ***
[2025-01-17 10:18:50,135 E 3543835 3543835] logging.cc:361: PC: @     0x14da9b7f0ad4  (unknown)  __read
[2025-01-17 10:18:50,135 E 3543835 3543835] logging.cc:361:     @     0x14da9b7f1d10  (unknown)  (unknown)
PC: @     0x14da9b7efdc6  (unknown)  do_futex_wait.constprop.1
    @     0x14da9b7f1d10  (unknown)  (unknown)
    @ ... and at least 1 more frames
[2025-01-17 10:18:50,139 E 3543835 3543835] logging.cc:361: *** SIGTERM received at time=1737105530 on cpu 32 ***
[2025-01-17 10:18:50,140 E 3543835 3543835] logging.cc:361: PC: @     0x14da9b7efdc6  (unknown)  do_futex_wait.constprop.1
[2025-01-17 10:18:50,140 E 3543835 3543835] logging.cc:361:     @     0x14da9b7f1d10  (unknown)  (unknown)
[2025-01-17 10:18:50,140 E 3543835 3543835] logging.cc:361:     @ ... and at least 1 more frames
